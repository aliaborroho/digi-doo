define("rEditor/app/panelHelpers",["lodash","util","core"],function(a,b,c){"use strict";function h(){return(g++).toString()}function i(c){var d=a.map(c.items,function(a){var c=a.link;return{id:h(),data:a,linkText:c?b.linkRenderer.renderLinkDataItemForPropertyPanel(this,c):""}},this);return d}function j(a,b){a&&a(b)}function k(a,b){var c=this.selection.getSelectedComponentData(),d=this.components.properties.get(this.selection.getSelectedComponents());return{imageDatas:i.call(this,c),isPreset:c.metaData.isPreset,imageMode:d.imageMode,imagesChanged:j.bind(this,b),createImageDataItem:this.data.createItem.bind(null,"Image"),galleryType:a}}function l(b,c){var d=this.panelManager.getOpenPanels();a.find(d,{name:b})?c&&this.panelManager.updatePanelProps(b,c):this.panelManager.openPanel(b,c)}var d="panels.focusPanels.organizeImagesPanel",e="panels.focusPanels.aviaryPanel",f={NOTIFICATION_RATE:10,FORBIDDEN_COMP_TYPES:["wysiwyg.common.components.anchor.viewer.Anchor","mobile.core.components.Page"],DESKTOP:{DONT_SHOW_AGAIN_KEY:c.constants.USER_PREFS.OUT_OF_GRID.DESKTOP.OUT_OF_GRID_DONT_SHOW_AGAIN,OUT_OF_GRID_COUNT_KEY:c.constants.USER_PREFS.OUT_OF_GRID.DESKTOP.OUT_OF_GRID_COUNT,PANEL_NAME:"panels.focusPanels.outOfGridDesktopPanel"},MOBILE:{DONT_SHOW_AGAIN_KEY:c.constants.USER_PREFS.OUT_OF_GRID.MOBILE.OUT_OF_GRID_DONT_SHOW_AGAIN,OUT_OF_GRID_COUNT_KEY:c.constants.USER_PREFS.OUT_OF_GRID.MOBILE.OUT_OF_GRID_COUNT,PANEL_NAME:"panels.focusPanels.outOfGridMobilePanel"}},g=0;return{openOrganizeImagesPanel:function(a){this.panelManager.openPanel(d,k.call(this,"images",a),!0)},openOrganizeSocialIconsPanel:function(a){this.panelManager.openPanel(d,k.call(this,"socialIcons",a))},openAviaryPanel:function(a){this.panelManager.openPanel(e,{imageLink:a,editorAPI:this,onDialogResult:function(){this.panelManager.closePanelByName(e)}.bind(this)},!0)},openPagesPanel:function(a){var b=this.isMobileEditor()?"rEditor.panels.pagesPanelMobile":"rEditor.panels.pagesPanel";l.call(this,b,a)},openMobileElementsPanel:function(a){if(this.isMobileEditor()){var b="mobileEditor.mobileElementsPanel",d=(new Date).getTime();a=a||{},a.key=c.lazyComponent.isLoaded(b)?b+d:b+"loading",l.call(this,b,a,"leftPanelFrame")}},openCompOutOfGridPanel:function(b){var c=this.isMobileEditor()?f.MOBILE:f.DESKTOP,d=this.components.getType(this.selection.getSelectedComponents()),e=this.userPreferences.site.get(c.DONT_SHOW_AGAIN_KEY);if(!e&&!a.contains(f.FORBIDDEN_COMP_TYPES,d)){var g=this.userPreferences.session.get(c.OUT_OF_GRID_COUNT_KEY)||0;g%f.NOTIFICATION_RATE===0&&this.panelManager.openPanel(c.PANEL_NAME,b,!0),g+=1,this.userPreferences.session.set(c.OUT_OF_GRID_COUNT_KEY,g)}},openDragToHeaderPanel:function(a){var b=this.userPreferences.site.get(c.constants.USER_PREFS.DRAG_TO_HEADER.DONT_SHOW_AGAIN);if(!b){var d=this.userPreferences.session.get(c.constants.USER_PREFS.DRAG_TO_HEADER.DRAG_COUNT)||0;d%10===0&&this.panelManager.openPanel("panels.focusPanels.dragToHeaderPanel",a),d+=1,this.userPreferences.session.set(c.constants.USER_PREFS.DRAG_TO_HEADER.DRAG_COUNT,d)}},openPinModeSizeRestrictionPanel:function(a){var b=this.userPreferences.site.get(c.constants.PANELS.PIN_TOO_BIG.PIN_TOO_BIG_DONT_SHOW_AGAIN);b||this.panelManager.openPanel(c.constants.PANELS.PIN_TOO_BIG.PANEL_NAME,a,!0)},openLinkPanel:function(b,c){var d={data:{pages:this.pages.getPagesData(),menuItems:this.mainMenu.getMenu(),anchors:this.getAnchors(),currentPageId:this.pages.getCurrentPageId()},createDefaultData:this.data.createItem};b=a.merge(d,b),this.panelManager.openPanel("panels.toolPanels.linkPanel",b,!c)}}}),define("rEditor/app/updateOperationsPlugins",["lodash"],function(a){"use strict";function b(){var b=arguments;a.forEach(this.list,function(a){a.apply(this,b)})}return{setHomePagePlugins:{list:[],run:b},updatePagePlugins:{list:[],run:b}}}),define("rEditor/app/updateOperationsPlugins/siteSeoUpdateOperationPlugin",["rEditor/app/updateOperationsPlugins"],function(a){"use strict";function b(a,b){b=b&&b.replace(/^#/,"")||a.homePage.get();var c=a.pages.data.get(b);return{name:c.pageTitleSEO,description:c.descriptionSEO,keywords:c.metaKeywordsSEO}}function c(a,b){a.site.setSEOSiteName(b.name),a.site.setSEOSiteDescription(b.description),a.site.setSEOSiteKeywords(b.keywords)}return{register:function(){a.setHomePagePlugins.list.push(function(a,d){c(a,b(a,d))}),a.updatePagePlugins.list.push(function(a,d){var e=d===a.homePage.get();e&&c(a,b(a,d))})}}}),define("rEditor/app/pluginsRegistrar",["rEditor/app/updateOperationsPlugins/siteSeoUpdateOperationPlugin"],function(a){"use strict";return{register:function(){a.register()}}}),define("rEditor/utils/removeUtil",["lodash","panels","util","core"],function(a,b,c,d){"use strict";function m(a,b,c,d){var e=b.tpa.app.getData(a.applicationId);c.app_id=e.appDefinitionId,c.app_site_id=e.instanceId,c.instance_id=d}function s(b,d,f,g,h,i){var j=f[0];e.openPanel("tpa.confirmation.deleteContainerContainsPremiumTpa",{appName:j.appDefinitionName,appDefId:j.appDefinitionId,appCount:f.length,onConfirm:function(e){r(b,d,g,!1,i),e.bi.reportBI(c.bi.events.COMPONENT_REMOVED,h),a.forEach(h,function(a){e.bi.event(c.bi.events.REMOVE_COMPONENT_SECOND_STEP_CLICK,a)})}},!0)}var e=b.panelManager,f=function(a){return!!a.tpaApplicationId},g=function(a,b,c){var d=a.app.isPremium(b);return d&&c>1?!0:!d&&c>0?!0:!1},h=function(b,d,h,i,k){var l=d.pages.getReference(i),m=d.pages.data.get(i),n=d.tpa.getPremiumTpaChildrenOnPage(l,m.tpaApplicationId,!0),o=d.wixapps.classics.isBlogPage(i),p=d.components.getTpaChildren(l);o&&(p=p.concat(d.components.getBlogChildren(l)));var q=b.bi.getComponentsBIParams(p);a.map(q,function(a){a.removal_method="delete_page"});var r=f(m)&&d.tpa.app.isMultiSectionInstalled(m.tpaApplicationId);if(n.length>0&&!r||r&&g(d.tpa,m.tpaApplicationId,n.length)){var s=m&&m.title||"",t=n[0];e.openPanel("tpa.confirmation.deletePageContainsPremiumTpa",{appName:t.appDefinitionName,appDefId:t.appDefinitionId,appCount:n.length,pageTitle:s,onConfirm:function(){j(b,d,i,m,h,!1,q,k),a.forEach(n,function(a,e){var f={app_id:a.appDefinitionId,app_site_id:a.instanceId,instance_id:p[e].id,is_last_tpa:d.tpa.app.isLastAppComp(a.applicationId)?1:0,component_type:"tpa"};b.bi.event(c.bi.events.REMOVE_COMPONENT_SECOND_STEP_CLICK,f)})}},!0)}else o?e.openPanel("blog.blogDeleteConfirmation",{onConfirm:function(){j(b,d,i,m,h,!1,q,k)}},!0):j(b,d,i,m,h,!0,q,k)},i=function(a,b){a.bi.reportBI(c.bi.events.COMPONENT_REMOVED,b)},j=function(b,c,d,f,g,h,j,l){var m=c.tpa.section.getPageData(d),n=m.hasSection&&g[c.tpa.constants.COMP_TYPES.TPA_SECTION],o=c.wixapps.classics.isBlogPage(d);if(o)g.blog&&g.blog(),b.pages.beforePageRemoveHook(d,function(){a.each(c.pages.getPagesData(),function(a){c.wixapps.classics.isBlogPage(a.id)&&(c.pages.remove(a.id),i(b,j))}),l&&l()});else if(n)g[c.tpa.constants.COMP_TYPES.TPA_SECTION](d,m.title,m.appData,h,l,j);else if(h){var p={pageTitle:f.title,onConfirm:k.bind(this,b,c,d,l,j)};e.openPanel("pagesMenu.deletePageMessage",p,!0)}else k(b,c,d,l,j)},k=function(a,b,c,d,e){a.pages.beforePageRemoveHook(c,function(){b.pages.remove(c),d&&d(),i(a,e)})},l=function(a,b){a.components.remove(b)},n=function(b,c,f){a.forEach(f,function(a){var f=b.components.getType(a),g=c.mobile.mobileOnlyComponents.isMobileOnlyComponent(a.id)?a.id:f,h=b.components.data.get(a);b.mobile.hiddenComponents.hide(a),e.openPanel("mobileEditor.hiddenItemsPanel");var i={current_page_name:b.pages.getCurrentPageId(),component_id:g,origin:"",component_type:f};c.isTpa(f)&&m(h,c,i,a.id),c.bi.event(d.bi.events.mobileEditor.hiddenElements.HIDDEN_ELEMENTS_HIDE,i)})},o=function(b,d,e,f,g){var h=a.some(e,b.components.is.container),i=e.length>1;if(b.viewMode.get()===b.viewMode.VIEW_MODES.MOBILE)n(b,f,e),g&&g();else{var j=b.tpa.getPremiumTpaChildren(e),k=a.reject(j,b.tpa.app.hasSections),l=p(b,f,e);if((h||i)&&k.length>0)s(b,d,j,e,l,g);else{var m=q(e.length,function(){f.bi.reportBI(c.bi.events.COMPONENT_REMOVED,l)});r(b,d,e,!0,function(){return m(),g?g(arguments):null})}}},p=function(b,c,d){var e=b.tpa.getTpaPointersRecursive(d),f=d.concat(e);f=a.uniq(f,"id");var g=c.bi.getComponentsBIParams(f);return g},q=function(a,b){var c=a;return function(){c--,0===c&&b()}},r=function(b,c,d,e,f){a.forEach(d,function(a){var d=b.components.getType(a);c[d]?c[d](a,e,f):(b.components.remove(a),f&&f())})};return{removePage:h,removeComponent:o,cutComponent:l}}),define("rEditor/app/APISections/themeWrapper",["lodash"],function(a){"use strict";return{theme:{colors:{get:function(b){return a.contains(b,"color")?this.documentServices.theme.colors.get(b):b}},styles:{getExcludedList:function(){return this.theme.styles.excludedList||[]},setExcluded:function(a){var b=this.theme.styles;b.excludedList||(b.excludedList=[]),b.excludedList.push(a)},update:function(a,b,c){this.documentServices.theme.styles.update(a,b),c||this.history.debouncedAdd("Update component style")},getAllIds:function(){var b=this.documentServices.theme.styles;return a.difference(b.getAllIds(),this.theme.styles.getExcludedList())}}}}}),define("rEditor/app/APISections/historyWrapper",["lodash"],function(a){"use strict";function c(){a.forEach(b,this.panelManager.closePanelByName)}function d(b,d){var e=this,f=d.isMobileEditor===this.isMobileEditor(),g=this.selection.getSelectedComponents();c.call(this),this.selection.deselectComponents(),this.setEditorMode(d.isMobileEditor,function(){b.call(e.documentServices.history),e.waitForChangesApplied(function(){var b=a.filter(g,e.components.is.exist,this);if(!a.isEmpty(b)){var c=e.components.getPage(b),d=c&&c.id===e.documentServices.pages.getCurrentPageId(),h=c&&"masterPage"===c.id;f&&(d||h)&&e.selection.selectComponentByCompRef(b)}})},!0)}var b=["panels.toolPanels.colorPicker.colorPickerPanel","rEditor.panels.backgroundApplyPanel"];return{history:{add:function(a){var b=this.isMobileEditor();this.documentServices.history.add(a,{label:a,currentPage:this.pages.getCurrentPageId(),isMobileEditor:b})},debouncedAdd:function(b){this.history._debouncedAdd||(this.history._debouncedAdd=a.debounce(this.history.add,500)),this.history._debouncedAdd(b)},undo:function(){this.waitForChangesApplied(function(){if(this.text.isEditingText())return void this.text.undo();var a=this.documentServices.history;if(a.canUndo()){var b=a.getUndoLastSnapshotParams();b.currentPage===this.documentServices.pages.getCurrentPageId()?d.call(this,a.undo,b):this.pages.navigateTo(b.currentPage,d.bind(this,a.undo,b))}}.bind(this))},redo:function(){this.waitForChangesApplied(function(){if(this.text.isEditingText())return void this.text.redo();var a=this.documentServices.history;if(a.canRedo()){var b=a.getRedoLastSnapshotParams();b.currentPage===this.documentServices.pages.getCurrentPageId()?d.call(this,a.redo,b):this.pages.navigateTo(b.currentPage,d.bind(this,a.redo,b))}}.bind(this))}}}}),define("rEditor/app/APISections/siteWrapper",["core","util"],function(a,b){"use strict";function c(a){var c=b.url,d=c.getParameterByName("ReactSource");return a=d?c.setUrlParam(a,"ReactSource",d):a}return{site:{getCurrentSiteDomain:function(){var a=window.location.hostname,b=a.match(/editor\.(.*)/);return b?"www."+b[1]:"www.wix.com"},getSEOSiteName:function(){return this.documentServices.seo.title.get()},setSEOSiteName:function(a){return this.documentServices.seo.title.set(a)},getSEOSiteDescription:function(){return this.documentServices.seo.description.get()},setSEOSiteDescription:function(a){return this.documentServices.seo.description.set(a)},getSEOSiteKeywords:function(){return this.documentServices.seo.keywords.get()},setSEOSiteKeywords:function(a){return this.documentServices.seo.keywords.set(a)},getMetaSiteId:function(){return this.documentServices.generalInfo.getMetaSiteId()},isPremium:function(){return this.documentServices&&this.documentServices.premiumFeatures&&this.documentServices.premiumFeatures.get().length>0},getXPos:function(){return this.components.layout.getRelativeToScreen(this.siteSegments.getPagesContainer()).x},getSiteDomainInfo:function(b,c){var d=this.documentServices.generalInfo.getMetaSiteId();a.premiumServicesAPI.getSiteDomainInfo(d,b,c)},getSitePremiumPackage:function(){return this.editor.state.site.premiumPackage||-1},getSitePublicUrl:function(){var a=this.generalInfo.getPublicUrl()||this.domain.getFreeDomainPrefix()+this.siteName.get();return a=c(a)}}}}),define("rEditor/app/APISections/domainWrapper",["lodash","util"],function(a,b){"use strict";return{domain:{isDomainConnected:function(){var b=this.generalInfo.getPublicUrl();return null!==b&&void 0!==b&&!a.contains(b,"wix.com")},getFreeDomainPrefix:function(){var a=this.generalInfo.getPublicUrl();if(a){var b=a.lastIndexOf("/");return a.slice(0,b+1)}return"http://"+this.generalInfo.getUserInfo().name+".wix.com/"},doesUserOwnGoogleDomain:function(){var a=b.cookie.getCookie("wixClient");return a.indexOf("GOOGLE_DOMAIN")>0||a.indexOf("REGRU")>0}}}}),define("rEditor/app/APISections/selectedComponent",["lodash"],function(a){"use strict";var b=function(a){var b=this.components.layout.get(a),c=!b.fixedPosition;return this.components.layout.setFixed(a,c),c};return{selectedComponent:{sendSelectedComponentBI:function(b,c){var d=this.selection.getSelectedComponents();if(b&&d){var e=this.getComponentType(d),f={component_id:a.first(d).id,component_type:e};c&&a.merge(f,c),this.bi.event(b,f)}},copy:function(){return this.components.copy(this.selection.getSelectedComponents())},duplicate:function(){return this.components.duplicate(this.selection.getSelectedComponents())},cut:function(){var a=this.selection.getSelectedComponents();return this.selection.isComponentSelected()&&this.components.cut(a),a},remove:function(a){var b=this.selection.getSelectedComponents();return this.selection.isComponentSelected()&&this.components.remove(b,a),b},copyStyle:function(){console.log("copyStyle")},pasteStyle:function(){console.log("pasteStyle")},lock:function(){console.log("lock")},toggleFixedPosition:function(){var a=this.selection.getSelectedComponents();return a&&this.components.layout.canBeFixedPosition(a)?b.call(this,a):!1},togglePin:function(){var a=this.selection.getSelectedComponents();return a?b.call(this,a):!1}}}}),define("rEditor/app/APISections/savePublishWrapper",["lodash","core","util","savePublish"],function(a,b,c,d){"use strict";function f(){this.userPreferences.loadSitePreferences(this.documentServices.generalInfo.getSiteId(),!0),this.leftBar.collapseMenu()}function g(a){try{return JSON.stringify(a)}catch(b){return"Failed to stringify save error info"}}function h(c,d,e){var f=a.keys(d),g=a.compact(a.pluck(d,"errorCode")),h=a.compact(a.pluck(d,"errorType")),i={p1:f,p2:h,p3:g};e?c.bi.error(b.bi.errors.FIRST_SAVE_ERROR,i):c.bi.error(b.bi.errors.SAVE_ERROR,i)}function i(a,b){return a?"first":b?"full":"partial"}var e=[f],j=c.newrelic,k=0,l=0;return{savePublish:{save:function(c,f,l){function s(){q.duration=a.now()-p,m.bi.event(b.bi.events.save.saveProcess.SUCCESS_SAVE_PROCESS,q),r=a.assign(r,q,{result:"success"}),j.addPageAction("save finish",r),n&&a.forEach(e,function(a){a.call(m)}),c&&c(),m.editor.setState({savingStatus:d.status.DONE_SUCCESS}),setTimeout(function(){m.editor.setState({savingStatus:d.status.IDLE})},b.constants.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)}function t(c){h(m,c,n),r=a.assign(r,{result:"failure",error:g(c)}),j.addPageAction("save finish",r),f&&f(c),m.editor.setState({savingStatus:d.status.DONE_FAILED}),setTimeout(function(){m.editor.setState({savingStatus:d.status.IDLE})},b.constants.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)}var m=this;this.editor.setState({savingStatus:d.status.IN_PROGRESS});var n=this.documentServices.generalInfo.isFirstSave(),o=i(n,l),p=a.now(),q={save_type:o};m.bi.event(b.bi.events.save.saveProcess.START_SAVE_PROCESS,q);var r=a.assign({is_first_save:n,save_count:++k},q);j.addPageAction("save start",a.clone(r)),m.documentServices.save(s,t,l)},saveAsTemplate:function(a,b){function c(a){b&&b(a),console.log("Failed saving as template ",a)}function d(){a&&a()}this.documentServices.saveAsTemplate(d,c)},publish:function(c,e){function h(){g.result="success",j.addPageAction("publish finish",g),a.each(f.sitePublishedCallbacks,function(a){a()}),c&&c(),f.editor.setState({publishingStatus:d.status.DONE_SUCCESS}),setTimeout(function(){f.editor.setState({publishingStatus:d.status.IDLE})},b.constants.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)}function i(a){g.result="failure",j.addPageAction("publish finish",g),e&&e(a),f.editor.setState({publishingStatus:d.status.DONE_FAILED}),setTimeout(function(){f.editor.setState({publishingStatus:d.status.IDLE})},b.constants.SAVE_PUBLISH.DURATION_TO_SHOW_RESULT)}var f=this;this.editor.setState({publishingStatus:d.status.IN_PROGRESS});var g={publish_count:++l};j.addPageAction("publish start",a.clone(g)),this.documentServices.publish(h,i)},registerFirstSaveCallback:function(a){e.push(a)}}}}),define("rEditor/utils/multiSelectHandler",["lodash"],function(a){"use strict";return function(){var b=a.toArray(arguments),c=b.shift(),d=b.pop(),e=this.components.asArray(c);return this.multiselect.isMultiselect(e)?d.multiCompHandler.apply(this,[e].concat(b)):d.singleCompHandler.apply(this,[e[0]].concat(b))}}),define("rEditor/app/APISections/componentsFacade/layoutWrapper",["lodash","core","util","rEditor/utils/multiSelectHandler"],function(a,b,c,d){"use strict";function e(b,c){var d=a.pick(c,function(c,d){return!a.isEqual(c,b[d])});return 0===b.rotationInDegrees||a.isUndefined(d.width)&&a.isUndefined(d.height)?c:d}function f(a,b,d){var e=c.layoutUtils.getLayoutRelativeToParentFromRelativeToScreen(this,a,b);this.components.layout.update(a,e,d)}function g(a,b,d){var e=c.layoutUtils.getLayoutRelativeToParentFromRelativeToStructure(this,a,b);this.components.layout.update(a,e,d)}function h(a,b,d){var e=c.layoutUtils.getLayoutRelativeToParentFromRelativeToScreen(this,a,b);this.components.layout.applyPositionAndSize(a,e,d)}function i(a){var b=this.siteSegments.getFooter();return this.components.isShowOnAllPages(a)&&!this.utils.isSameRef(a,b)}function j(a,b,d,e){var f=c.layoutUtils.getLayoutRelativeToParentFromRelativeToScreen(this,a,b);this.components.layout.updateAndPreserveProportions(a,f,d,e)}function k(a,b,c,d){this.documentServices.components.layout.updateAndPreserveProportions(a,b,c,d)}function l(a,c){var d=this.components.layout.get(a),f=e(d,c),g=b.utils.updateLayoutUtil.getLayoutAfterConstraints(this,a,f,d);return g}return{get:function(a){return d.call(this,a,{multiCompHandler:this.multiselect.layout.get,singleCompHandler:this.documentServices.components.layout.get})},getPositionAndSize:function(a){return d.call(this,a,{multiCompHandler:this.multiselect.layout.getPositionAndSize,singleCompHandler:this.documentServices.components.layout.getPositionAndSize})},isRenderedInFixedPosition:function(b){var c=this.components.asArray(b),d=a.every(c,function(a){return this.documentServices.components.layout.isRenderedInFixedPosition(a)},this);return d},isAncestorRenderedInFixedPosition:function(b){var c=this.components.asArray(b),d=a.every(c,function(a){return this.documentServices.components.layout.isAncestorRenderedInFixedPosition(a)},this);return d},isShowOnFixedPosition:function(b){var c=this.components.asArray(b),d=a.every(c,function(a){return this.documentServices.components.layout.isShowOnFixedPosition(a)},this);return d},isDocked:function(b){var c=this.components.asArray(b),d=a.every(c,function(a){return this.documentServices.components.layout.isDocked(a)},this);return d},isRotated:function(b){var c=this.components.asArray(b);return a.every(c,function(a){return this.documentServices.components.layout.isRotated(a)},this)},isPinned:function(b){var c=this.components.asArray(b);return a.isEmpty(c)?!1:a.every(c,function(b){var c=this.documentServices.components.layout.get(b);return!a.isUndefined(c.docked)&&c.fixedPosition},this)},canBeFixedPosition:function(a){return d.call(this,a,{multiCompHandler:this.multiselect.layout.canBeFixedPosition,singleCompHandler:this.documentServices.components.layout.canBeFixedPosition})},getRelativeToScreen:function(a){return d.call(this,a,{multiCompHandler:this.multiselect.layout.getRelativeToScreen,singleCompHandler:this.documentServices.components.layout.getRelativeToScreen})},getRelativeToScreenConsideringScroll:function(a){return d.call(this,a,{multiCompHandler:this.multiselect.layout.getRelativeToScreenConsideringScroll,singleCompHandler:this.documentServices.components.layout.getRelativeToScreenConsideringScroll})},getRelativeToStructure:function(a){return d.call(this,a,{multiCompHandler:this.multiselect.layout.getRelativeToStructure,singleCompHandler:this.documentServices.components.layout.getRelativeToStructure})},getResizableSides:function(b){return d.call(this,b,{multiCompHandler:this.multiselect.layout.getResizableSides,singleCompHandler:function(b){var c={left:this.components.layout.RESIZE_SIDES.LEFT,right:this.components.layout.RESIZE_SIDES.RIGHT,top:this.components.layout.RESIZE_SIDES.TOP,bottom:this.components.layout.RESIZE_SIDES.BOTTOM},d=this.documentServices.components.layout.getResizableSides(b),e=this.components.layout.get(b),f=a.map(e.docked,function(a,b){return c[b]});return a.difference(d,f)}})},getProportionStructure:function(a){return d.call(this,a,{multiCompHandler:this.multiselect.layout.getProportionStructure,singleCompHandler:this.documentServices.components.layout.getProportionStructure})},update:function(a,c,e){if(c){var f=l.call(this,a,c);d.call(this,a,f,{multiCompHandler:this.multiselect.layout.update,singleCompHandler:b.utils.updateLayoutUtil.updateLayout.bind(null,this,this.documentServices.components.layout.update)}),e||this.history.debouncedAdd("component - update layout")}},updateRelativeToStructure:function(a,b,c){d.call(this,a,b,c,{multiCompHandler:this.multiselect.layout.updateRelativeToStructure,singleCompHandler:g})},updateRelativeToScreen:function(a,b,c){d.call(this,a,b,c,{multiCompHandler:this.multiselect.layout.updateRelativeToScreen,singleCompHandler:f})},applyPositionAndSizeRelativeToScreen:function(a,b,c){d.call(this,a,b,c,{multiCompHandler:this.multiselect.layout.applyPositionAndSizeRelativeToScreen,singleCompHandler:h})},updateRelativeToScreenAndPreserveProportions:function(a,b,c,e){d.call(this,a,b,c,e,{multiCompHandler:this.multiselect.layout.updateRelativeToScreenAndPreserveProportions,singleCompHandler:j})},updateAndPreserveProportions:function(a,b,c,e){var f=l.call(this,a,b);d.call(this,a,f,c,{multiCompHandler:this.multiselect.layout.updateAndPreserveProportions,singleCompHandler:k}),e||this.history.debouncedAdd("component - update layout")},updateAndAdjustLayout:function(a,c,e){var f=d.call(this,a,c,{multiCompHandler:this.multiselect.layout.updateAndAdjustLayout,singleCompHandler:b.utils.updateLayoutUtil.updateLayout.bind(null,this,this.documentServices.components.layout.updateAndAdjustLayout)});return e||this.history.debouncedAdd("component - update layout"),f},updateRelativeToStructureAndAdjustLayout:function(a,b,d){var e=c.layoutUtils.getLayoutRelativeToParentFromRelativeToStructure(this,a,b);return this.components.layout.updateAndAdjustLayout(a,e,d)},updateRelativeToScreenAndAdjustLayout:function(a,b,d){var e=c.layoutUtils.getLayoutRelativeToParentFromRelativeToScreen(this,a,b);return this.components.layout.updateAndAdjustLayout(a,e,d)},setFixed:function(a,c){return d.call(this,this,a,c,{multiCompHandler:this.multiselect.layout.setFixed,singleCompHandler:b.utils.fixedPositionUtils.setFixedPosition})},shouldBeConstrained:function(a){return d.call(this,a,{multiCompHandler:this.multiselect.layout.shouldBeConstrained,singleCompHandler:i})}}}),define("rEditor/app/APISections/componentsFacade/arrangementFacade",["core"],function(a){"use strict";return{moveForward:function(a){var b=this.components.asArray(a);return this.components.arrangement.canMoveForward(b)?(this.documentServices.components.arrangement.moveForward(b[0]),void this.history.add("component - move forward")):null},moveBackward:function(a){var b=this.components.asArray(a);return this.components.arrangement.canMoveBackward(b)?(this.documentServices.components.arrangement.moveBackward(b[0]),void this.history.add("component - move backward")):null},moveToFront:function(a){var b=this.components.asArray(a);return this.components.arrangement.canMoveForward(b)?(this.documentServices.components.arrangement.moveToFront(b[0]),void this.history.add("component - move to front")):null},moveToBack:function(a){var b=this.components.asArray(a);return this.components.arrangement.canMoveBackward(b)?(this.documentServices.components.arrangement.moveToBack(b[0]),void this.history.add("component - move to back")):null},moveToIndex:function(a,b){var c=this.components.asArray(a);this.documentServices.components.arrangement.moveToIndex(c[0],b),this.history.add("component - move to index")},canMoveBackward:function(b){var c=this.components.asArray(b);if(this.multiselect.isMultiselect(c))return this.multiselect.arrangement.canMoveBackward(c);var d=this.components.getType(c)===a.constants.COMP_TYPES.ANCHOR;return!d&&this.documentServices.components.arrangement.canMoveBackward(c[0])},canMoveForward:function(b){var c=this.components.asArray(b);if(this.multiselect.isMultiselect(c))return this.multiselect.arrangement.canMoveForward(c);var d=this.components.getType(c)===a.constants.COMP_TYPES.ANCHOR;return!d&&this.documentServices.components.arrangement.canMoveForward(c[0])}}}),define("rEditor/app/APISections/componentsFacade/behaviorsFacade",["rEditor/utils/multiSelectHandler"],function(a){"use strict";return{update:function(b,c,d){return a.call(this,b,c,d,{multiCompHandler:this.multiselect.behaviors.update,singleCompHandler:this.documentServices.components.behaviors.update})},get:function(b){return a.call(this,b,{multiCompHandler:this.multiselect.behaviors.get,singleCompHandler:this.documentServices.components.behaviors.get})},remove:function(b,c,d){return a.call(this,b,c,d,{multiCompHandler:this.multiselect.behaviors.remove,singleCompHandler:this.documentServices.components.behaviors.remove})},removeAll:function(b){return a.call(this,b,{multiCompHandler:this.multiselect.behaviors.removeAll,singleCompHandler:this.documentServices.components.behaviors.removeAll})},previewAnimation:function(b,c,d){return a.call(this,b,c,d,{multiCompHandler:this.multiselect.behaviors.previewAnimation,singleCompHandler:this.documentServices.components.behaviors.previewAnimation})},stopPreviewAnimation:function(b){return a.call(this,b,{multiCompHandler:this.multiselect.behaviors.stopPreviewAnimation,singleCompHandler:this.documentServices.components.behaviors.stopPreviewAnimation})},execute:function(b,c,d){return a.call(this,b,c,d,{multiCompHandler:this.multiselect.behaviors.execute,singleCompHandler:this.documentServices.components.behaviors.execute})}}}),define("rEditor/componentsMetaData/components/bgImageStrip",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/fiveGridLine",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/footer",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/header",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/screenWidthContainer",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/stripShowcase",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/stripSlideshow",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/blogComponents",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/rssButton",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/tpaGluedWidget",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/page",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/boxSlideShow",[],function(){"use strict";return{slidesContainer:!0}}),define("rEditor/componentsMetaData/components/anchor",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/components/wRichText",[],function(){"use strict";return{pinnable:!1}}),define("rEditor/componentsMetaData/metaDataMap",["rEditor/componentsMetaData/components/bgImageStrip","rEditor/componentsMetaData/components/fiveGridLine","rEditor/componentsMetaData/components/footer","rEditor/componentsMetaData/components/header","rEditor/componentsMetaData/components/screenWidthContainer","rEditor/componentsMetaData/components/stripShowcase","rEditor/componentsMetaData/components/stripSlideshow","rEditor/componentsMetaData/components/blogComponents","rEditor/componentsMetaData/components/rssButton","rEditor/componentsMetaData/components/tpaGluedWidget","rEditor/componentsMetaData/components/page","rEditor/componentsMetaData/components/boxSlideShow","rEditor/componentsMetaData/components/anchor","rEditor/componentsMetaData/components/wRichText"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";return{"wysiwyg.viewer.components.BgImageStrip":a,"wysiwyg.viewer.components.FiveGridLine":b,"wysiwyg.viewer.components.FooterContainer":c,"wysiwyg.viewer.components.HeaderContainer":d,"wysiwyg.viewer.components.ScreenWidthContainer":e,"tpa.viewer.components.StripSlideshow":g,"tpa.viewer.components.StripShowcase":f,"wixapps.integration.components.AppPart":h,"wysiwyg.common.components.rssbutton.viewer.RSSButton":i,"wysiwyg.viewer.components.tpapps.TPAGluedWidget":j,"mobile.core.components.Page":k,"wysiwyg.viewer.components.BoxSlideShow":l,"wysiwyg.common.components.anchor.viewer.Anchor":m,"wysiwyg.viewer.components.WRichText":n}}),define("rEditor/app/APISections/singleCompHandlers/componentsMetaData",["lodash","rEditor/componentsMetaData/metaDataMap"],function(a,b){"use strict";function d(d,e){return!b[d]||a.isUndefined(b[d][e])?c[e]:b[d][e]}function e(b,c,e){var f=b.components.getType(e),g=d(f,c);if("function"==typeof g){var h=a.toArray(arguments);return h.splice(1,1),g.apply(this,h)}return g}var c={pinnable:!0,duplicatable:!0,containable:!0,resizable:!0,rotatable:!0,slidesContainer:!1};return{is:{fixed:function(a){return this.documentServices.components.layout.get(a).fixedPosition},exist:function(a){return this.documentServices.components.is.exist(a)},container:function(a){return this.documentServices.components.is.container(a)},selectable:function(a){return this.documentServices.components.is.selectable(a)},siteSegment:function(b){var c=this.siteSegments.getRefs();return a.find(c,b)},removable:function(a){return this.documentServices.components.is.removable(a)},duplicatable:function(a){return e(this,"duplicatable",a)&&this.documentServices.components.is.duplicatable(a)},containable:function(a,b){return e(this,"containable",a,b)&&this.documentServices.components.is.containable(a,b)},styleCanBeApplied:function(a,b){return this.documentServices.components.is.styleCanBeApplied(a,b)},movable:function(a){return this.documentServices.components.is.movable(a)},horizontallyMovable:function(a){return this.documentServices.components.is.horizontallyMovable(a)},verticallyMovable:function(a){return this.documentServices.components.is.verticallyMovable(a)},canMoveUp:function(a){return this.documentServices.components.is.canMoveUp(a)},fullWidth:function(a){return this.documentServices.components.is.fullWidth(a)},rotatable:function(a){return e(this,"rotatable",a)&&this.documentServices.components.is.rotatable(a)},slidesContainer:function(a){return e(this,"slidesContainer",a)},resizable:function(a){return e(this,"resizable",a)&&this.documentServices.components.is.resizable(a)},horizontallyResizable:function(a){return this.documentServices.components.is.horizontallyResizable(a)},verticallyResizable:function(a){return this.documentServices.components.is.verticallyResizable(a)},group:function(a){return this.documentServices.components.is.group(a)},groupable:function(a){return this.documentServices.components.is.groupable(a);
},topMost:function(a,b){return this.documentServices.components.is.topMost(a,b)},leftMost:function(a,b){return this.documentServices.components.is.leftMost(a,b)},groupedComponent:function(a){return this.documentServices.components.is.groupedComponent(a)},animatable:function(a,b){return this.documentServices.components.is.animatable(a,b)},pinnable:function(a){return e(this,"pinnable",a)&&this.documentServices.components.is.pinnable(a)&&!this.components.layout.isRotated(a)},alignable:function(a){return this.documentServices.components.is.alignable(a)&&this.components.is.movable(a)}}}}),define("rEditor/app/APISections/componentsFacade/componentsMetaDataFacade",["lodash","rEditor/utils/multiSelectHandler","rEditor/app/APISections/singleCompHandlers/componentsMetaData"],function(a,b,c){"use strict";return{fixed:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.fixed,singleCompHandler:c.is.fixed})},exist:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.exist,singleCompHandler:c.is.exist})},container:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.container,singleCompHandler:c.is.container})},selectable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.selectable,singleCompHandler:c.is.selectable})},siteSegment:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.siteSegment,singleCompHandler:c.is.siteSegment})},siblings:function(b){if(a.include(b,void 0))return!1;var c=b.pop(),d=this.components.getSiblings(c);return a.every(b,function(b){return a.find(d,b)})},removable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.removable,singleCompHandler:c.is.removable})},duplicatable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.duplicatable,singleCompHandler:c.is.duplicatable})},containable:function(a,d){return b.call(this,a,d,{multiCompHandler:this.multiselect.is.containable,singleCompHandler:c.is.containable})},styleCanBeApplied:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.styleCanBeApplied,singleCompHandler:c.is.styleCanBeApplied})},movable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.movable,singleCompHandler:c.is.movable})},horizontallyMovable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.horizontallyMovable,singleCompHandler:c.is.horizontallyMovable})},verticallyMovable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.verticallyMovable,singleCompHandler:c.is.verticallyMovable})},canMoveUp:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.canMoveUp,singleCompHandler:c.is.canMoveUp})},fullWidth:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.fullWidth,singleCompHandler:c.is.fullWidth})},resizable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.resizable,singleCompHandler:c.is.resizable})},horizontallyResizable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.horizontallyResizable,singleCompHandler:c.is.horizontallyResizable})},verticallyResizable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.verticallyResizable,singleCompHandler:c.is.verticallyResizable})},group:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.group,singleCompHandler:c.is.group})},groupable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.groupable,singleCompHandler:c.is.groupable})},page:function(a){var b=this.components.asArray(a);return this.pages.isPageExist(b[0].id)},topMost:function(a,d){return b.call(this,a,d,{multiCompHandler:this.multiselect.is.topMost,singleCompHandler:c.is.topMost})},leftMost:function(a,d){return b.call(this,a,d,{multiCompHandler:this.multiselect.is.leftMost,singleCompHandler:c.is.leftMost})},groupedComponent:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.groupedComponent,singleCompHandler:c.is.groupedComponent})},rotatable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.rotatable,singleCompHandler:c.is.rotatable})},animatable:function(a,d){return b.call(this,a,d,{multiCompHandler:this.multiselect.is.animatable,singleCompHandler:c.is.animatable})},pinnable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.pinnable,singleCompHandler:c.is.pinnable})},slidesContainer:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.slidesContainer,singleCompHandler:c.is.slidesContainer})},alignable:function(a){return b.call(this,a,{multiCompHandler:this.multiselect.is.alignable,singleCompHandler:c.is.alignable})}}}),define("rEditor/app/APISections/componentsWrapper",["lodash","core","util","rEditor/utils/removeUtil","rEditor/utils/multiSelectHandler","rEditor/app/APISections/componentsFacade/layoutWrapper","rEditor/app/APISections/componentsFacade/arrangementFacade","rEditor/app/APISections/componentsFacade/behaviorsFacade","rEditor/app/APISections/componentsFacade/componentsMetaDataFacade","experiment!dontCloseAddPanelOnAdd"],function(a,b,c,d,e,f,g,h,i,j){"use strict";function l(b,c){return a.every(c,function(c,d){return a.isEqual(b[d],c)})}function m(b){var c=this.components.layout.getRelativeToStructure(b),d=this.pages.getCurrentPageId();return this.pasteLogic.pasteContext.setPasteData(c,d),{snugLayoutRelativeToStructure:c,components:a.map(b,function(a){var b=this.components.serialize(a),d=this.components.style.getId(a);d&&(b.style=d),b.layout=this.components.layout.getRelativeToStructure(a);var e=this.components.getType(a);return this.copyComponentPlugins[e]&&(b=this.copyComponentPlugins[e](a,b)),{serializedComp:b,positionRelativeToSnug:{x:b.layout.x-c.x,y:b.layout.y-c.y},isShowOnAllPages:this.components.isShowOnAllPages(a)}},this)}}function n(b){return a.has(b,"x")&&a.has(b,"y")}function o(b){return a.contains(k,b)}function p(b,c,d){var e=this.pages.getCurrentPageId(),f=[],g=this.components.asArray(b.components),h=this.siteSegments.getPagesContainer(),i=this.siteSegments.layout.get(h);c=n(c)?c:null;var j=this.pasteLogic.pasteContext.getPastePosition(this,b.snugLayoutRelativeToStructure,e);return a.forEach(g,function(b){var g=b.serializedComp,h=o(g.componentType),k=this.pages.getReference(h?"masterPage":e),l=a.clone(c),m=a.clone(j);l?h&&(l.y+=i.y):(h||(m.y-=i.y),l=m),g.layout.x=l.x+b.positionRelativeToSnug.x,g.layout.y=l.y+b.positionRelativeToSnug.y,d&&(g.layout.x-=g.layout.width/2,g.layout.y-=g.layout.height/2);var n=this.components.add(k,g);f.push(n)},this),f}function q(b){var c=this.pages.getCurrentPageId(),d=[],e=this.siteSegments.getPagesContainer(),f=this.siteSegments.layout.get(e);return a.forEach(b,function(a){var b=this.components.serialize(a),e=o(b.componentType),g=this.components.layout.getRelativeToStructure(a).bounding,h=this.components.style.getId(a);h&&(b.style=h),this.pasteLogic.duplicateContext.setPasteData(g,c);var i=this.pasteLogic.duplicateContext.getPastePosition(this,g,c);e||(i.y-=f.y),b.layout.x=i.x,b.layout.y=i.y;var j=this.pages.getReference(e?"masterPage":c),k=this.components.getType(a);this.copyComponentPlugins[k]&&(b=this.copyComponentPlugins[k](a,b));var l=this.components.add(j,b);d.push(l)},this),d}function r(b){if(a.isEmpty(b))return!1;var c=this.isMobileEditor(),d=this.pages.data.get(this.pages.getCurrentPageId()).isLandingPage,e=a.any(b.components,"isShowOnAllPages");return!(c||d&&e)}function s(a){return this.components.is.duplicatable(a)}function t(a,b,c){var d=this.documentServices.components.properties,e=d.get(a),f=!e||!l(e,b),g=d.mobile.isForked(a);f&&(this.isMobileEditor()&&e&&!g&&d.mobile.fork(a),d.update(a,b),c||this.history.debouncedAdd("comp properties changed"))}var k=["wysiwyg.viewer.components.tpapps.TPAGluedWidget"];return{layouters:{getRenderedNonMasterChildren:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.getRenderedNonMasterChildren,singleCompHandler:this.documentServices.layouters.getRenderedNonMasterChildren})}},components:{onPreviewReady:function(c){var d=b.utils.componentPreviewReadyPlugins;a.forEach(d,function(a){a(c)},this)},getPage:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.getPage,singleCompHandler:this.documentServices.components.getPage})},canBeShownOnAllStates:function(a,b){return e.call(this,a,b,{multiCompHandler:this.multiselect.canBeMasterChild,singleCompHandler:this.documentServices.layouters.canBeMasterChild})},asArray:function(b){return a.compact(a.isArray(b)?b:[b])},copy:function(a){if(a){var c=this.components.asArray(a);if(c=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(c),!s.call(this,c))return void(this.isMobileEditor()&&this.openCantCopyPastePanel());var d=m.call(this,c);this.clipboard.setItem(b.constants.EDITOR_CLIPBOARD_TYPES.COMPONENT,d)}},toggleShowOnAllStates:function(a,b){return e.call(this,a,b,{multiCompHandler:this.multiselect.toggleShowOnAllStates,singleCompHandler:this.documentServices.layouters.toggleMasterChild})},isShowOnAllPages:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.isShowOnAllPages,singleCompHandler:this.documentServices.components.isShowOnAllPages})},isShownOnAllStates:function(a,b){return e.call(this,a,b,{multiCompHandler:this.multiselect.isShownOnAllStates,singleCompHandler:this.documentServices.layouters.isMasterChild})},paste:function(a,c){var d=this.clipboard.getItem(b.constants.EDITOR_CLIPBOARD_TYPES.COMPONENT);if(!r.call(this,d))return void(this.isMobileEditor()&&this.openCantCopyPastePanel());var e=p.call(this,d,a,c);this.editor.state.performingMouseMoveAction||this.waitForChangesApplied(function(){this.selection.selectComponentByCompRef(e)}.bind(this))},cut:function(b){var c=this.selection.getSelectedComponents();return c=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(c),b=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(b),a.isEqual(c,b)&&this.selection.deselectComponents(),this.isMobileEditor()?void this.openCantCopyPastePanel():void(this.components.is.duplicatable(b)&&(this.components.copy(b),a.forEach(b,function(a){d.cutComponent(this.documentServices,a)},this)))},add:function(c,d,e,f){return b.utils.addUtil.addComponent(this,this.documentServices.components.add,c,d,e,function(){j||this.panelManager.closePanelByName("addPanelInfra.addPanel"),this.utils.isSameRef(c,this.siteSegments.getHeader())&&this.openDragToHeaderPanel(),a.isFunction(f)&&f.apply(this,arguments)}.bind(this))},addAndAdjustLayout:function(a,c,d,e){return b.utils.addUtil.addComponent(this,this.documentServices.components.addAndAdjustLayout,a,c,d,e)},remove:function(b,c){var e=this.components.asArray(b),f=this;return this.components.is.removable(e)?(this.selection.deselectComponents(e),void d.removeComponent(this.documentServices,this.removePlugins,e,this,c)):void a.each(e,function(a){var b=f.components.getType(a);f.cannotRemovePlugins[b]&&f.cannotRemovePlugins[b](a)})},setContainer:function(a,b){var c=this.components.isShowOnAllPages(a),d=e.call(this,a,b,{multiCompHandler:this.multiselect.setContainer,singleCompHandler:this.documentServices.components.setContainer});return!c&&this.utils.isSameRef(b,this.siteSegments.getHeader())&&this.openDragToHeaderPanel(),d},duplicate:function(b){if(b){var c=this.selection.getSelectedComponents(),d=this.components.asArray(b);if(c=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(c),d=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(d),this.components.is.duplicatable(d)){a.isEqual(d,c)&&this.selection.deselectComponents();var e=q.call(this,d);this.waitForChangesApplied(function(){this.selection.selectComponentByCompRef(e)}.bind(this))}}},getType:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.getType,singleCompHandler:this.documentServices.components.getType})},getSiblings:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.getSiblings,singleCompHandler:this.documentServices.components.getSiblings})},getChildren:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.getChildren,singleCompHandler:this.documentServices.components.getChildren})},getDisplayName:function(a){var b=this.documentServices.components.getType(a);return this.compNamePlugins[b]?this.compNamePlugins[b](a):c.translate("component_label_"+b.split(".").pop())},ungroup:function(a){var b=this.components.asArray(a);if(this.components.is.exist(b[0])){var c=this.documentServices.components.getChildren(b[0]);this.selection.selectComponentByCompRef(c),this.documentServices.components.ungroup(b[0]),this.history.add("ungroup")}},getIconInfo:function(a,b){var d=this.documentServices.components.getType(a);return this.compIconPlugins[d]?this.compIconPlugins[d](a):c.compIcon.getCompIconInfo(a,d,b,this)},getContainer:function(a){var b=this.components.asArray(a);return this.documentServices.components.getContainer(b[0])},moveToFooter:function(a){var b=15,c=this.components.layout.getRelativeToStructure(a),d=this.siteSegments.getFooter(),e=this.components.layout.get(d),f=this.components.setContainer(a,d),g=e.height<c.bounding.height+b;g&&this.components.layout.update(d,{height:c.bounding.height+2*b}),this.waitForChangesApplied(function(){this.components.layout.update(f,{y:c.y-c.bounding.y+b})}.bind(this))},isDescendantOfComp:function(a,b){return e.call(this,a,b,{multiCompHandler:this.multiselect.isDescendantOfComp,singleCompHandler:this.documentServices.components.isDescendantOfComp})},isAscendantOfComp:function(b,c){return a.any(b,function(a){return this.components.isDescendantOfComp(c,a)},this)},data:{update:function(a,c,d){c=b.utils.updateDataUtil.fixData(c),e.call(this,a,c,{multiCompHandler:this.multiselect.data.update,singleCompHandler:this.documentServices.components.data.update}),d||this.history.debouncedAdd("comp data changed")},get:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.data.get,singleCompHandler:this.documentServices.components.data.get})},remove:function(a,b){e.call(this,a,{multiCompHandler:this.multiselect.data.remove,singleCompHandler:this.documentServices.components.data.remove}),b||this.history.add("comp data removed")}},properties:{update:function(a,b,c){return e.call(this,a,b,c,{multiCompHandler:this.multiselect.properties.update,singleCompHandler:t})},get:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.properties.get,singleCompHandler:this.documentServices.components.properties.get})}},alignment:{align:function(a,b){e.call(this,a,b,{multiCompHandler:this.multiselect.alignment.align,singleCompHandler:this.documentServices.components.alignment.alignInContainer}),this.history.add("component - align - "+b)}},layout:f,style:{getId:function(a){var b=this.components.asArray(a);if(this.multiselect.isMultiselect(b))throw"components.style.getId isn't suported for multi select";return this.documentServices.components.style.getId(b[0])},setId:function(a,b,c){var d=this.components.asArray(a);if(this.multiselect.isMultiselect(d))throw"components.style.setId isn't suported for multi select";return this.documentServices.components.style.setId(d[0],b,c)}},arrangement:g,is:i,skin:{getComponentSkinExports:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.skin.getComponentSkinExports,singleCompHandler:this.documentServices.components.skin.getComponentSkinExports})},get:function(a){return e.call(this,a,{multiCompHandler:this.multiselect.skin.get,singleCompHandler:this.documentServices.components.skin.get})}},behaviors:h,canToggleShowOnAllPages:function(a){return this.components.canShowOnAllPages(a)&&this.components.canShowOnCurrentPage(a)},canShowOnCurrentPage:function(a){var b=this.documentServices.pages.getCurrentPage();return this.components.is.containable(a,b)&&!this.components.isDescendantOfComp(a,this.siteSegments.getFooter())},canShowOnAllPages:function(b){b=this.components.asArray(b);var c=this.documentServices.siteSegments.getSiteStructure(),d=a.some(b,function(a){return this.documentServices.components.is.groupedComponent(a)},this),e=this.components.is.containable(b,c),f=!1;return a.each(b,function(a){"wixapps.integration.components.AppPart"===this.components.getType(a)&&(f=this.wixapps.classics.isAppPartPageFixed(a))},this),!this.isCurrentPageLandingPage()&&e&&!d&&!f},setShowOnAllPages:function(a,b){var c;return a=this.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(a),c=b?this.documentServices.siteSegments.getSiteStructure():this.documentServices.pages.getReference(this.pages.getCurrentPageId()),this.components.setContainer(a,c)},toggleShowOnAllPages:function(a){var b=this.selection.getSelectedComponents(),c=!this.components.isShowOnAllPages(a),d=this.components.setShowOnAllPages(a,c);b===a&&this.selection.selectComponentByCompRef(d);var e=this.components.isShowOnAllPages(d);return this.history.add(e?"Show component on all pages":"Show component on current page"),e}}}}),define("rEditor/app/APISections/mainMenuWrapper",["lodash"],function(a){"use strict";function b(c,d,e){var f;return a.some(c,function(a){var h,i,c=a.link&&a.link.pageId,g=c&&c.substr(1);return g&&(h=e.pages.isContainsCompWithType(g,e.tpa.constants.COMP_TYPES.TPA_MULTI_SECTION),i=e.wixapps.classics.isBlogPage(g)&&"single-post"===e.pages.data.get(g).pageUriSEO),!g||g===d||h||i?a.items&&a.items.length&&(f=b(a.items,d,e))?!0:void 0:(f=a,!0)}),f}function d(b){return a.each(c,function(a){b=a(this,b)}),b}var c=[];return{mainMenu:{hasOnlyOneMenuItem:function(){var b=this.documentServices.pages.getPagesData(),c=a.uniq(a.pluck(b,"appInnerId")),d=a.uniq(a.pluck(b,"tpaApplicationId")),e=1===d.length&&1===a.compact(d).length,f=e&&a.compact(d)[0];return b&&1===b.length||1===c.length&&1===a.compact(c).length||e&&!this.documentServices.tpa.app.isMultiSectionInstalled(f)},getFirstNonHomePageMenuItem:function(){var a=this.documentServices.homePage.get(),c=this.documentServices.mainMenu.getMenu();return b(c,a,this.documentServices)},registerVisibilityFilter:function(a){c.push(a)},getVisibleMenuItemsTree:function(){var a=this.mainMenu.getMenu();return d.call(this,a)}}}}),define("rEditor/app/APISections/multiselect",["lodash","core","util","experiment!useProportionalResize"],function(a,b,c,d){"use strict";function e(c){return a.some(c,function(c){var d=this.components.getType(c);return a.contains(b.constants.MULTISELECT.SINGLE_SELECTION_COMPONENT_TYPES,d)||this.components.layout.isShowOnFixedPosition(c)},this)}function f(b,d,e){return a.map(d,function(d){var f=a.pick(b.components.layout.get(d),["x","y"]),g=c.layoutUtils.addXYOffsetsToLayout(f,e);return{component:d,newLayout:g}})}function g(b,d,e,g){var h=c.layoutUtils.getLayoutsXYDiff(g,e),i=f(b,d,h);a.forEach(i,function(a){b.components.layout.update(a.component,a.newLayout)})}function h(a,b){for(var c=a.components.getContainer(b);c&&!a.components.is.group(c);)c=a.components.getContainer(c);return c}function i(a,b){var d=c.layoutUtils.calcLayoutFromLayoutAndRatio(b,a.proportions),e=c.layoutUtils.addXYOffsetsToLayout(d,b);return e}return{multiselect:{canBeMasterChild:function(){return!1},getRenderedNonMasterChildren:function(){},isShownOnAllStates:function(){return!1},isDescendantOfComp:function(b,c){return a.every(b,function(a){return this.documentServices.components.isDescendantOfComp(a,c)},this)},getType:function(){return b.constants.MULTISELECT.TYPE},canBeShownOnAllStates:function(){return!1},toggleShowOnAllStates:function(){},getPage:function(b){return this.multiselect.areComponentsOfSamePage(b)?this.documentServices.components.getPage(a.first(b)):null},count:function(b){return a.isArray(b)?b.length:0},isMultiselect:function(a){return this.multiselect.count(a)>1},getContainer:function(b){return this.multiselect.containsSiblingsOnly(b)?this.documentServices.components.getContainer(a.first(b)):null},getChildren:function(){return[]},isProportionalResizeEnabled:function(){return!!d},getSiblings:function(b){if(!this.multiselect.containsSiblingsOnly(b))throw"Cannot obtain siblings of the given compoents since they are not siblings";var c=this.documentServices.components.getSiblings(b[0]),d=a.reject(c,function(c){return a.some(b,{id:c.id})},this);return d},isShowOnAllPages:function(b){var c=a.every(b,function(a){return this.documentServices.components.isShowOnAllPages(a)},this);return c},canBeSelectedTogether:function(a){return this.multiselect.count(a)<=1?!0:!e.call(this,a)},containsSiblingsOnly:function(b){if(!this.multiselect.isMultiselect(b))return!0;var c=this.components.getSiblings(a.first(b)),d=a.rest(b);return a.every(d,function(b){return!!a.find(c,b)})},containsAncestorsAndDescendants:function(b){return this.multiselect.isMultiselect(b)?a.every(b,function(d,e){var f=b.slice(e+1);return a.every(f,function(a){return this.components.isDescendantOfComp(d,a)||this.components.isDescendantOfComp(a,d)},this)},this):!1},areComponentsOfSamePage:function(b){if(!this.multiselect.isMultiselect(b))return!0;var c=a.first(b),d=a.rest(b),e=this.documentServices.components.getPage(c);return a.every(d,function(b){var c=this.documentServices.components.getPage(b);return a.isEqual(c,e)},this)},getComponentsWhichDontHaveAncestorsInTheArray:function(b){var c=a.clone(b);return a.forEach(b,function(d,e){var f=b.slice(e+1);a.forEach(f,function(b){return this.components.isDescendantOfComp(d,b)?(a.remove(c,d),!1):void(this.components.isDescendantOfComp(b,d)&&a.remove(c,b))},this)},this),c},removeGroupedCompsIfTheirGroupIsInArray:function(b){return a.reject(b,function(d){var e=h(this,d);return e&&!!a.find(b,e)},this)},setContainer:function(b,c){var d=a.map(b,function(a){return this.documentServices.components.setContainer(a,c)},this);return d},data:{update:function(){throw"Cannot update data for multiple components"},get:function(b){var c=a.map(b,function(a){return this.documentServices.components.data.get(a)},this);return c},remove:function(){throw"Cannot remove data for multiple components"}},properties:{update:function(){throw"cannot update multiple components properties"},get:function(b){var c=a.map(b,function(a){return this.documentServices.components.properties.get(a)},this);return c}},arrangement:{canMoveForward:function(){return!1},canMoveBackward:function(){return!1}},alignment:{align:function(a,b){this.documentServices.components.alignment.alignComponents(a,b)}},layout:{get:function(a){if(!this.multiselect.containsSiblingsOnly(a))throw"Cannot get layout for non-siblings components";var b=this.documentServices.components.layout.getSnugLayout(a);return b},getPositionAndSize:function(a){if(!this.multiselect.containsSiblingsOnly(a))throw"Cannot get layout for non-siblings components";var b=this.documentServices.components.layout.getSnugPositionAndSize(a);return b},canBeFixedPosition:function(b){var c=a.every(b,function(a){return this.documentServices.components.layout.canBeFixedPosition(a)},this);return c},getRelativeToScreen:function(a){return this.documentServices.components.layout.getSnugLayoutRelativeToScreen(a)},getRelativeToScreenConsideringScroll:function(a){return this.documentServices.components.layout.getSnugLayoutRelativeToScreenConsideringScroll(a)},getRelativeToStructure:function(a){return this.documentServices.components.layout.getSnugLayoutRelativeToStructure(a)},getResizableSides:function(){return this.multiselect.isProportionalResizeEnabled()?["RESIZE_TOP","RESIZE_LEFT","RESIZE_BOTTOM","RESIZE_RIGHT"]:[]},update:function(a,b){if(!this.multiselect.containsSiblingsOnly(a))throw"Selected components do not share the same parent and therefore cannot be positioned relative to their container";var c=this.documentServices.components.layout.getSnugLayout(a);g(this,a,c,b)},updateRelativeToStructure:function(b,c){var d=a.pick(this.multiselect.layout.getRelativeToStructure(b),["x","y"]);g(this,b,d,c)},updateRelativeToScreen:function(b,c){var d=a.pick(this.multiselect.layout.getRelativeToScreen(b),["x","y"]);g(this,d,c)},updateRelativeToScreenAndPreserveProportions:function(b,c,d,e){a.defaults(c,d.layout),a.forEach(d.children,function(a){var b=i(a,c);this.components.layout.updateRelativeToScreenAndPreserveProportions(a.component,b,a,e)},this)},updateAndPreserveProportions:function(b,d,e,f){if(!this.multiselect.containsSiblingsOnly(b))throw"Selected components do not share the same parent and therefore cannot be positioned relative to their container";var g=this.components.getContainer(b),h=this.components.layout.getRelativeToScreen(g),i=c.layoutUtils.addXYOffsetsToLayout(d,a.pick(h,["x","y"]));this.multiselect.layout.updateRelativeToScreenAndPreserveProportions(b,i,e,f)},getProportionStructure:function(b){var d=this.components.layout.getRelativeToScreen(b);return{component:null,layout:d,children:a.map(b,function(b){var e=this.components.layout.getRelativeToScreen(b),f=c.layoutUtils.getLayoutsXYDiff(e,d),g=a.defaults(f,e),h=c.layoutUtils.getChildContainerLayoutRatio(g,d),i=this.components.getChildren(b);return{component:b,proportions:h,children:a.map(i,this.components.layout.getProportionStructure)}},this)}},updateAndAdjustLayout:function(d,e){if(!this.multiselect.containsSiblingsOnly(d))throw"Cannot update and adjust layout of non-siblings components";var g=this.documentServices.components.layout.getSnugLayout(d);g=a.pick(g,"y");var h=c.layoutUtils.getLayoutsXYDiff(e,g),i=f(this,d,h);a.forEach(i,function(a){b.utils.updateLayoutUtil.updateLayout(this,this.documentServices.components.layout.updateAndAdjustLayout,a.component,a.newLayout)},this)},setFixed:function(c,d){return a.map(c,function(a){return b.utils.fixedPositionUtils.setFixedPosition(this,a,d)})},shouldBeConstrained:function(b){return a.some(b,function(a){return this.components.isShowOnAllPages(a)},this)}},skin:{get:function(){throw"cannot get skin of multiple components"},getComponentSkinExports:function(){throw"Cannot get component skin exports for multiple components"}},is:{fixed:function(b){return a.every(b,this.components.is.fixed,this)},selectable:function(){return!0},alignable:function(b){return a.every(b,this.components.is.alignable)},container:function(){return!1},exist:function(b){return a.every(b,function(a){return this.documentServices.components.is.exist(a)},this)},siteSegment:function(){return!1},removable:function(b){var c=a.every(b,function(a){return this.documentServices.components.is.removable(a)},this);return c},duplicatable:function(b){var c=a.every(b,function(a){return this.documentServices.components.is.duplicatable(a)},this);return c},styleCanBeApplied:function(){return!1},containable:function(b,c){var d=a.every(b,function(a){return this.documentServices.components.is.containable(a,c)},this);return d},movable:function(b){var c=a.every(b,function(a){return this.documentServices.components.is.movable(a)},this);return c},horizontallyMovable:function(b){var c=a.every(b,function(a){return this.documentServices.components.is.horizontallyMovable(a)},this);return c},verticallyMovable:function(b){var c=a.every(b,function(a){return this.documentServices.components.is.verticallyMovable(a)},this);return c},canMoveUp:function(b){var c=a.every(b,function(a){return this.documentServices.components.is.canMoveUp(a)},this);return c&&this.multiselect.containsSiblingsOnly(b)},fullWidth:function(b){var c=a.every(b,function(a){return this.documentServices.components.is.fullWidth(a)},this);return c},horizontallyResizable:function(){return this.multiselect.isProportionalResizeEnabled()},verticallyResizable:function(){return this.multiselect.isProportionalResizeEnabled()},group:function(){return!1},groupable:function(b){return a.every(b,function(a){return this.documentServices.components.is.groupable(a)},this)},groupedComponent:function(b){var c=a.every(b,function(a){return this.documentServices.components.is.groupedComponent(a)},this);return c},topMost:function(b,c){var d=a.some(b,function(a){return this.documentServices.components.is.topMost(a,c)},this);return d},leftMost:function(b,c){var d=a.some(b,function(a){return this.documentServices.components.is.leftMost(a,c)},this);return d},resizable:function(){return!1},rotatable:function(){return!1},animatable:function(b,c){var d=a.every(b,function(a){return this.documentServices.components.is.animatable(a,c)},this);return d},pinnable:function(){return!1},slidesContainer:function(){return!1}},behaviors:{update:function(b,c,d){a.forEach(b,function(a){this.documentServices.components.behaviors.update(a,c,d)},this)},get:function(b){var c=a.reduce(b,function(a,b){return a.concat(this.documentServices.components.behaviors.get(b)||[])},[],this);return c},remove:function(b,c,d){a.forEach(b,function(a){this.documentServices.components.behaviors.remove(a,c,d)},this)},removeAll:function(b){a.forEach(b,function(a){this.documentServices.components.behaviors.removeAll(a)},this)},previewAnimation:function(b,c,d){var e=a.map(b,function(b,e,f){return this.documentServices.components.behaviors.previewAnimation(b,a.cloneDeep(c),e===f.length-1?d:void 0)},this);return e},stopPreviewAnimation:function(b){a.forEach(b,function(a){this.documentServices.components.behaviors.stopPreviewAnimation(a)},this)},execute:function(b,c,d){a.forEach(b,function(a){this.documentServices.components.behaviors.execute(a,c,d)},this)}}}}}),define("rEditor/app/APISections/leftBarAPI",["lodash","core"],function(a,b){"use strict";function c(c,d,e,f,g){return{panelName:c,panelProps:d,label:e,className:f,symbolName:g,order:a.indexOf(b.constants.LEFT_BAR.SUPER_APPS_ORDER.DESKTOP,c)}}function d(a,b){delete a.notifications[b],this.panelManager.closePanelByName(b)}return{leftBar:{collapseMenu:function(){var b=a.cloneDeep(this.editor.state.leftBar);b.isCollapsed=!0,this.editor.setState({leftBar:b})},superApps:{addButton:function(b,d,e,f,g,h){var i=c(b,d,e,f,g),j=a.cloneDeep(this.editor.state.leftBar),k=[j.superApps.desktop];h&&k.push(j.superApps.mobile),k.forEach(function(c){var d=a.find(c,{panelName:b});d?a.assign(d,i):c.push(i)}),this.editor.setState({leftBar:j})},removeButton:function(b){var c=a.cloneDeep(this.editor.state.leftBar);c.superApps.desktop=a.reject(this.editor.state.leftBar.superApps.desktop,{panelName:b}),c.superApps.mobile=a.reject(this.editor.state.leftBar.superApps.mobile,{panelName:b}),d.call(this,c,b),this.editor.setState({leftBar:c})}},notifications:{setCount:function(b,c){var d=a.cloneDeep(this.editor.state.leftBar);d.notifications[b]=c,this.editor.setState({leftBar:d})},getCount:function(a){return this.editor.state.leftBar.notifications[a]},increaseCount:function(b,c){var d=a.cloneDeep(this.editor.state.leftBar);d.notifications[b]+=c||1,this.editor.setState({leftBar:d})},decreaseCount:function(b,c){var d=a.cloneDeep(this.editor.state.leftBar);d.notifications[b]-=c||1,this.editor.setState({leftBar:d})}}}}}),define("rEditor/app/APISections/selectionUtils/selectionUtils",["lodash","experiment!boxSlideShow"],function(a,b){"use strict";return{findCompGroupAncestor:function(a,b){for(var c=a.components.getContainer(b);c&&!a.components.is.group(c);)c=a.components.getContainer(c);return c},findIfUnderSameRootComp:function(b,c,d){if(!c||!d)return null;for(var e=b.components.getContainer(c);e&&!a.isEqual(e,d);)e=b.components.getContainer(e);return e},findAncestorMatchesCondition:function(a,b,c){if(!b)return null;for(var d=a.components.getContainer(b);d&&!c(d);)d=a.components.getContainer(d);return d},replaceComponentSelectedIfNeeded:function(a,c,d){var e=b?this.findAncestorMatchesCondition(a,c,a.components.is.group):this.findCompGroupAncestor(a,c),f=b?this.findAncestorMatchesCondition(a,c,a.components.is.slidesContainer):void 0,g=a.selection.isComponentSelected(c),h=e&&!a.components.is.siblings([d,c])||f&&!this.findIfUnderSameRootComp(a,d,f)&&!a.components.is.siblings([d,c])||f&&!(this.findIfUnderSameRootComp(a,c,f)&&this.findIfUnderSameRootComp.call(a,d,f));return!g&&h?e||f:c}}}),define("rEditor/app/APISections/selection",["lodash","jquery","core","util","baseUI","experiment!sectionsReorganizeExp","experiment!boxSlideShow","rEditor/app/APISections/selectionUtils/selectionUtils"],function(a,b,c,d,e,f,g,h){"use strict";function o(a,b){return this.selection.isComponentSelected(a)?b.button===j?null:this.selection.deselectComponents(a):(this.closeCompPanelIfExists(),
this.selection.addComponentToSelectionByRef(a))}function p(a){if(this.closeCompPanelIfExists(),g){var b=this.utils.getParentIfCompCanBeSelected(a);b&&(a=b)}this.selection.selectComponentByCompRef(a)}function q(b){var c=this.components.getSiblings(b),d=a.reject(c,function(a){return this.components.is.siteSegment(a)},this);return d}function r(a,b){var c=a.getComponentType(b);return"Page"===c||"AppPage"===c}var i="compPanels.panels.MultiSelect.layoutPanel",j=2,k=e.uiConstants,l=d.browserUtil,m=!0,n=!1;return{selection:{isMultiSelectKeyPressed:function(a){return a.shiftKey||l.isSpecialKeyPressed(a)},setIsMouseUpSelectionEnabled:function(a){m=a},getIsMouseUpSelectionEnabled:function(){return m},setIsHiddenComponentDraggedNext:function(a){n=!!a},isHiddenComponentDraggedNext:function(){return n},getAnchorsUnderClick:function(b,c){var d=this.pages.getReference(this.pages.getCurrentPageId()),e=this.components.get.byType("wysiwyg.common.components.anchor.viewer.Anchor",d);return a.filter(e,function(a){var d=this.components.layout.getRelativeToScreen(a);return d.y+=k.ANCHOR_OFFSET_TOP-window.pageYOffset,b>=d.x&&b<=d.x+k.ANCHOR_WIDTH&&c>=d.y&&c<=d.y+k.ANCHOR_HEIGHT},this)},getComponentsUnderClick:function(a,c){var d=f?this.getSiteScale():1,e=b("body").width()*(1-d)/(2*d),g=this.editorConfig.previewTop/d+window.pageYOffset*(d-1)/d,h=this.components.get.byXYRelativeToScreen(a-e,c-g),i=this.selection.getAnchorsUnderClick(a-e,c-g);return i.concat(h)},getNonGroupCompUnderCursor:function(b,c,d){var e=this.selection.getComponentsUnderClick(b,c),f=0,h=e[f],i=h?this.components.getContainer(e[f]):null;if(g){if(d&&h&&i)for(;this.components.is.group(h)||(h&&i&&"SITE_STRUCTURE"!==i.id?!a.contains(a.pluck(e,"id"),i.id):!1);)f++,h=e[f],i=h?this.components.getContainer(e[f]):null}else for(;this.components.is.group(h);)f++,h=e[f];return h||null},getComponentUnderClickToBeSelected:function(b,c,d){var e=this.selection.getNonGroupCompUnderCursor(b,c,d),f=a.first(this.selection.getSelectedComponents());return e?e=h.replaceComponentSelectedIfNeeded(this,e,f):null},getComponentToBeMarkedByHoverBox:function(a,b){var c=this.selection.getComponentUnderClickToBeSelected(a,b,!0);return c},selectComponentByClick:function(a,b){var c=this.selection.getComponentUnderClickToBeSelected(a.clientX,a.clientY,!1,b),d=this.selection.isComponentSelected(c),e=this.selection.getSelectedComponents();if(!c)return void this.selection.deselectComponents();if(this.selection.isMultiSelectKeyPressed(a)&&!d)o.call(this,c,a),this.selection.setLastSelectionClickPos(null);else{if(this.multiselect.isMultiselect(e)||this.selection.setLastSelectionClickPos({x:a.pageX,y:a.pageY}),d)return void this.selection.setIsMouseUpSelectionEnabled(!0);p.call(this,c)}},selectNonGroupCompUnderCursor:function(a){var b=this.selection.getNonGroupCompUnderCursor(a.clientX,a.clientY);return this.selection.isComponentSelected(b)?null:this.selection.isMultiSelectKeyPressed(a)?o.call(this,b):p.call(this,b)},selectComponentByCompRef:function(b){var c=this.components.asArray(b);c=a.uniq(c,"id"),c.length>30||g&&c.length>0&&!this.components.is.selectable(c)||this.multiselect.canBeSelectedTogether(c)&&(c=a.isEmpty(c)?null:this.multiselect.removeGroupedCompsIfTheirGroupIsInArray(c),a.size(c)<2&&this.panelManager.closePanelByName(i),this.components.layout.isPinned(c)?d.keyboardShortcuts.setContext(d.keyboardShortcuts.CONTEXTS.PIN_MODE):d.keyboardShortcuts.setContext(d.keyboardShortcuts.CONTEXTS.EDITOR),this.editor.setState({selectedComponents:c,hoveredComp:null}))},addComponentToSelectionByRef:function(a){var b=this.components.asArray(a),d=this.selection.getSelectedComponents()||[],e=d.concat(b);return e.length>1&&this.bi.event(c.bi.events.selection.MULTISELECT,{num_of_elements_selected:e.length,selection_method:"keyboard"}),this.selection.selectComponentByCompRef(e),d},deselectComponent:function(){d.keyboardShortcuts.setContext(d.keyboardShortcuts.CONTEXTS.EDITOR),this.editor.setState({selectedComponents:null})},getSelectedComponentId:function(){var b=this.selection.getSelectedComponents();return!!b&&a.first(b).id},getSelectedComponents:function(){return this.editor.state.selectedComponents},selectAll:function(){var d,e,b=this.selection.getSelectedComponents();this.multiselect.containsSiblingsOnly(b)&&this.selection.isComponentSelected()?this.components.is.siteSegment(b)||r(this,b)?d=this.components.getChildren(b):(e=q.call(this,b),d=b.concat(e)):d=(b||[]).concat(this.components.getChildren(this.pages.getCurrentPage())),a.isEmpty(d)||(this.closeCompPanelIfExists(),d.length>1&&this.bi.event(c.bi.events.selection.MULTISELECT,{num_of_elements_selected:d.length,selection_method:"keyboard"}),this.selection.selectComponentByCompRef(d))},getSelectedComponentData:function(){var a=this.selection.getSelectedComponents();return a?this.components.data.get(a):null},deselectComponents:function(b){d.keyboardShortcuts.setContext(d.keyboardShortcuts.CONTEXTS.EDITOR);var c=!b,e=this.components.asArray(b),f=this.selection.getSelectedComponents(),g=a.reject(f,function(b){return c||a.some(e,b)},this);this.selection.selectComponentByCompRef(g)},isComponentSelected:function(b){var c=this.selection.getSelectedComponents();if(a.isEmpty(b))return!!c;var d=this.components.asArray(b);return a.every(d,function(b){return a.some(c,b)})},setLastSelectionClickPos:function(a){this.editor.setState({lastSelectionClickPos:a})}}}}),define("rEditor/app/APISections/databaseEditor",["savePublish","experiment!disableDbEditorAutoSave"],function(a,b){"use strict";function c(a,c,d){a.openPanel("compPanels.panels.AppPart2.databaseEditorPanel",{listId:c,compRef:d,autoSave:!b})}function d(a){a.openPanel("savePublish.panels.common.failPanel",{titleKey:"PUBLISH_ERROR_TITLE_LABEL",description:"SAVE_PUBLISH_ERROR_BODY_DESCRIPTION",steps:["SAVE_PUBLISH_ERROR_OPTION_1","SAVE_PUBLISH_ERROR_OPTION_2"],helpMessage:"SAVE_ERROR_LEARN_MORE_LABEL",helpLinkMessage:"SAVE_PUBLISH_ERROR_LEARN_MORE_LINK",helpLink:"http://www.wix.com/"})}function e(e,f){var g=this.panelManager;!b&&this.generalInfo.isFirstSave()?a.saveInBackground(this,c.bind(null,g,e,f),d.bind(null,g)):c(g,e,f)}return{openDatabaseEditor:e}}),define("rEditor/app/pluginService",["lodash"],function(a){"use strict";var b={doubleClick:{}},c={DOUBLE_CLICK:"doubleClick"},d=function(d,e,f){a.contains(c,d)&&a.isString(e)&&(b[d][e]=f)},e=function(a,c){return b[a]&&b[a][c]};return{pluginConstants:c,registerPlugin:d,getPlugin:e}}),define("rEditor/app/componentsPlugins",["lodash","core"],function(a,b){"use strict";function c(c){var d=c.pluginService;d.registerPlugin(d.pluginConstants.DOUBLE_CLICK,"wysiwyg.viewer.components.WRichText",function(){c.isMobileEditor()?c.openComponentPanel(b.constants.componentPanels.settings):(c.bi.event(b.bi.events.textControls.Text_Panel_opened,{origin:b.constants.USER_ACTIONS.ORIGIN.DOUBLE_CLICK}),c.text.startEditing())}),d.registerPlugin(d.pluginConstants.DOUBLE_CLICK,b.constants.MULTISELECT.TYPE,a.noop),d.registerPlugin(d.pluginConstants.DOUBLE_CLICK,"mobile.core.components.Page",function(a,d){var e=c.siteSegments.getPagesContainerAbsLayout(),f=d.evt.pageX<e.x||d.evt.pageX>e.x+e.width;return f?void c.panelManager.openPanel("rEditor.panels.backgroundPanel"):void c.openComponentPanel(b.constants.componentPanels.design)})}return{registerComponentsPlugins:c}}),define("rEditor/app/tooltipTextService",["lodash"],function(a){"use strict";function c(c,d,e){a.isUndefined(b[c])&&(b[c]={}),b[c][d]=e}function d(a,c){return b[a]?b[a][c]||null:null}function e(a){var b=this.selection.getSelectedComponents();return this.tooltipTextService.getComponentTooltipText(b,a)}function f(a,b){var c=this.components.getType(a);return this.tooltipTextService.getTooltipText(c,b)}function g(){b={}}var b={};return{registerTooltipText:c,getTooltipText:d,getSelectedComponentTooltipText:e,getComponentTooltipText:f,clearAllToolTipsText:g}}),define("rEditor/pasteLogic/pasteLogicCalculations",[],function(){"use strict";function b(b){return{x:b.x+a.xOffset,y:b.y+a.yOffset}}function c(b){return{x:b.x+a.newStackOffset.x,y:b.y-a.newStackOffset.y}}function d(b,c,d){var e=a.rightThreshold,f=a.bottomThreshold;return d&&(e=0,f=0),c.x+e>b.rightX||c.y+f>b.stageLayout.bottom+b.scrollTop}function e(a,b,c){var d=a.siteSegments.getPagesContainer(),e=a.siteSegments.layout.get(d);return{x:(e.width-c.width)/2,y:(b.stageLayout.height-c.height)/2+b.scrollTop-e.y}}function f(a,b,c){var d=a.siteSegments.getPagesContainer(),e=a.siteSegments.layout.get(d);return c.y>e.height+b.stageLayout.top}function g(b,c){return c.y>=b.stageLayout.top&&c.y+a.bottomThreshold<=b.stageLayout.bottom-b.stageLayout.top+b.scrollTop}var a={xOffset:40,yOffset:30,newStackOffset:{x:60,y:40},bottomThreshold:80,rightThreshold:80};return{getNextComponentPosition:b,getNewStackComponentPosition:c,cannotFitIntoViewPort:d,getCenteredCompPosition:e,isComponentInViewPort:g,cannotFitIntoPageHeight:f}}),define("rEditor/pasteLogic/ComponentPasteLogic",["lodash","core","rEditor/pasteLogic/pasteLogicCalculations"],function(a,b,c){"use strict";function d(){return a.isEmpty(this.firstCompPosition)}function e(a){return a!==this.lastCompPage}function f(a,b,d){return this.centerOnFirstPaste||e.call(this,d)&&c.cannotFitIntoPageHeight(a,b,this.originalCompPosition)}function g(a,b){c.isComponentInViewPort(a,b)||window.scrollTo(0,b.y)}function h(a){this.lastCompPage||(this.lastCompPage=a),e.call(this,a)&&this.resetPastePosition()}function i(a){return a.y<0}function j(a,b,d,h){var j={};return f.call(this,a,b,h)?(j=c.getCenteredCompPosition(a,b,d),i(j)&&(j.y=0)):e.call(this,h)?(j=this.originalCompPosition,g(b,j)):j={x:this.originalCompPosition.x,y:this.originalCompPosition.y-this.originalScrollPosition+window.pageYOffset},this.firstCompPosition=j,j}function k(a){var b=c.getNextComponentPosition(this.lastCompPosition);return c.cannotFitIntoViewPort(a,b)&&(b=c.getNewStackComponentPosition(this.firstCompPosition),this.firstCompPosition=b),b}function l(a){a=a||{},this.originalCompPosition={},this.originalScrollPosition=0,this.firstCompPosition={},this.lastCompPosition={},this.lastCompPage="",this.centerOnFirstPaste=a.centerOnFirstPaste||!1}return l.prototype.setPasteData=function(a,b){this.originalScrollPosition=window.pageYOffset,this.originalCompPosition={x:a.x,y:a.y},this.firstCompPosition={x:a.x,y:a.y},this.lastCompPosition={x:a.x,y:a.y},this.lastCompPage=b},l.prototype.resetPastePosition=function(){this.firstCompPosition={},this.lastCompPosition={}},l.prototype.getPastePosition=function(c,e,f){var g=b.utils.stageUtils.getViewPort(!0),i=a.pick(e,["width","height"]),l={};return h.call(this,f),l=d.call(this)?j.call(this,c,g,i,f):k.call(this,g),this.lastCompPosition=l,this.lastCompPage=f,a.clone(l)},l}),define("rEditor/pasteLogic/pasteLogicContext",["lodash","jquery","rEditor/pasteLogic/ComponentPasteLogic"],function(a,b,c){"use strict";function g(){d.resetPastePosition.call(d),e.resetPastePosition.call(f),f.resetPastePosition.call(f)}var d=new c,e=new c,f=new c({centerOnFirstPaste:!0});return b(window).on("scroll",g),{pasteContext:d,duplicateContext:e,addContext:f}}),define("rEditor/app/EditorAPI",["lodash","jquery","react","core","baseUI","panels","util","uiAnimations","mediaServices","rEditor/app/panelHelpers","rEditor/app/updateOperationsPlugins","rEditor/app/pluginsRegistrar","userPreferences","savePublish","rEditor/utils/removeUtil","rEditor/app/APISections/themeWrapper","rEditor/app/APISections/historyWrapper","rEditor/app/APISections/siteWrapper","rEditor/app/APISections/domainWrapper","rEditor/app/APISections/selectedComponent","rEditor/app/APISections/savePublishWrapper","rEditor/app/APISections/componentsWrapper","rEditor/app/APISections/mainMenuWrapper","rEditor/app/APISections/multiselect","rEditor/app/APISections/leftBarAPI","rEditor/app/APISections/selection","rEditor/app/APISections/databaseEditor","rEditor/app/pluginService","rEditor/app/componentsPlugins","rEditor/app/tooltipTextService","rEditor/pasteLogic/pasteLogicContext","textControls","experiment!userRoles","experiment!boxSlideShow","experiment!toolbarDefaultOff","experiment!musicPromotionFixed","experiment!musicPromotionRotation"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K){"use strict";function M(){return{topBarHeight:L.TOPBAR_HEIGHT,previewTop:L.TOPBAR_HEIGHT,previewHeight:"100%",previewWidth:null,languages:["latin"],extraSiteHeight:40}}function Q(b,c){return a.forIn(b,function(d,e){a.isFunction(d)?b[e]=d.bind(c):a.isPlainObject(d)&&(b[e]=Q(a.clone(d),c))}),b}function R(a){var b=a.refs.preview.getDOMNode(),c=b.contentWindow;c.selection?c.selection.empty():c.getSelection&&c.getSelection().removeAllRanges()}function S(b,c){var d=a.pick(b,["top","left","height","width"]);return d.top+=c,d}function T(b,c){g.keyboardShortcuts.enable(),this.applyPreviewScrollToEditorScroll(),a.each(this.pageNavigationCallbacks.concat(c),function(a){a&&a(b)})}function U(b){var c={backgroundColor:"rgba(255, 255, 255, 0.85)"};b.renderPlugins.setCompsToShowOnTop(a.pluck(b.selection.getSelectedComponents(),"id")),b.renderPlugins.setBlockingLayer(c)}function V(a){var b=null;a.renderPlugins.setCompsToShowOnTop(null),a.renderPlugins.setBlockingLayer(b)}function W(a){a.editor.setState({pinMode:!0,contextMenu:null})}function X(a){a.editor.setState({pinMode:!1})}function Y(a){Q(this,this),this.previewReady=!1,this.documentServices=null,this.userPreferences=new m,this.editor=a,this.editorConfig=M(),this.pendingStateChanges={},this.removePlugins={},this.compNamePlugins={},this.compIconPlugins={},this.cannotRemovePlugins={},this.copyComponentPlugins={},this.pageNavigationCallbacks=[],this.viewerUpdateCallbacks=[this.onViewerChanged],this.userPreferencesInitCallbacks=[this.initViewToolsFromUserPrefs,this.initUserAddedColors],this.sitePublishedCallbacks=[],this.deviceTypeChangeCallbacks=[],this.mediaServices=i,this.panelManager=f.panelManager,window.testApi&&window.testApi.domSelectors&&(window.testApi.domSelectors.setSearchRoot(this.editor),window.testApi.editorAPI=this,window.testApi.bi=g.automationUtil.bi)}function Z(b,c){var e=b.style;a.isObject(b.style)&&(e=d.styleManager.getStyleIdByDef(c.theme,c.components,b.style,b.componentType)),e&&(b.style=e),a.forEach(b.components,function(a){Z(a,c)})}var L=e.uiConstants,N={toolbarEnabled:!I,rulersEnabled:!1,guidelinesEnabled:!0,snapToEnabled:!0},O=["latin"],P=null;return Y.prototype=a.assign({},x,u,v,w,y,p,q,r,s,t,z,A,{onPreviewReady:function(a){this.previewReady=!0,this.setDocumentServices(a),G&&(this.bi.event=this.bi.eventWithEditorPresets(this.bi.event)),this.onViewerChanged(),this.updateUserPreferencesOnPreviewReady(),this.components.onPreviewReady(this),this.synchronizeSiteSEOToMainPageSEO(),n.setTimerForSaveReminder(this),this.panelManager.initBIHandler(this.bi),this.documentServices.registerToSiteChanged(this.notifyViewerUpdate),this.documentServices.documentMode.enableAction("screenIn",!1),this.documentServices.documentMode.enableBgVideoAutoplay(!1),this.documentServices.generalInfo.isFirstSave()||this.leftBar.collapseMenu(),d.bi.registerEvents(this),C.registerComponentsPlugins(this),l.register(),this.campaigns.fetchCampaignInfo(),this.documentServices.generalInfo.isFirstSave()&&this.initTemplateCharacterSet(),this.promotions.initPromotions()},triggerMouseUpOnEditor:function(a){this.editor.onMouseUp(a)},synchronizeSiteSEOToMainPageSEO:function(){var a=this.seo.title.get()||"",b=this.seo.description.get()||"",c=this.seo.keywords.get()||"",d=this.homePage.get(),e=this.pages.data.get(d);e.pageTitleSEO=a,e.descriptionSEO=b,e.metaKeywordsSEO=c,this.pages.data.update(d,e)},initTemplateCharacterSet:function(){function c(b){return a.isEqual(b,O)}function d(b){return a.contains(b,"arabic")&&a.contains(b,"hebrew")}var b=this.documentServices.theme.fonts.getCharacterSet();if(c(b)||d(b)){var e=this.documentServices.theme.fonts.getLanguageCharacterSet(this.getLanguageCode());if(e)this.documentServices.theme.fonts.updateCharacterSet(e);else{var f=this.documentServices.theme.fonts.getCharacterSetByGeo();this.documentServices.theme.fonts.updateCharacterSet(f)}}},initPanelManager:function(){this.panelManager.registerObserver(this.onPanelsUpdated)},setDocumentServices:function(b){this.documentServices=b;var c={};a.merge(c,this.documentServices,this),a.merge(this,c)},getLanguageCode:function(){return g.languages.getLanguageCode()},getViewTools:function(){return a.clone(this.editor.state.viewTools)},updateUserPreferencesOnPreviewReady:function(){function d(){b.userPreferencesInitCallbacksInvoked=!0,a.forEach(b.userPreferencesInitCallbacks,function(a){a()})}var b=this,c=this.generalInfo.getSiteId();this.userPreferences.loadGlobalPreferences(),this.documentServices.generalInfo.isFirstSave()?d():this.userPreferences.loadSitePreferences(c,!1,d,a.noop)},initViewToolsFromUserPrefs:function(){var b=d.constants.USER_PREFS.VIEW_TOOLS,c={toolbarEnabled:!I,rulersEnabled:this.userPreferences.site.get(b.RULERS_ENABLED),guidelinesEnabled:this.userPreferences.site.get(b.GUIDELINES_ENABLED),snapToEnabled:this.userPreferences.site.get(b.SNAPTO_ENABLED)};a.defaults(c,N),this.editor.setState({viewTools:c})},initUserAddedColors:function(){var b=this.documentServices.theme.colors.getCustomUsedInSkins(),c=d.constants.USER_PREFS.THEME.COLORS.CUSTOM.USER_ADDED,e=this.userPreferences.session.get(c);e=a.intersection(e,b),this.userPreferences.session.set(c,e)},updateConfig:function(){this.editorConfig.previewHeight=this.documentServices.site.getHeight(),this.editorConfig.previewTop=L.TOPBAR_HEIGHT,this.isMobileEditor()&&(this.editorConfig.previewTop+=L.MOBILE_PREVIEW_TOP)},onPanelsUpdated:function(){this.editor.setState({openPanels:this.panelManager.getOpenPanels(),helpProps:this.panelManager.getHelpPanelProps()})},notifyViewerUpdate:function(b){a.forEach(this.viewerUpdateCallbacks,function(a){a(b)})},setStateWaitForViewer:function(b){a.assign(this.pendingStateChanges,b)},onViewerChanged:function(){this.editor.state.editorIsInit||this.setDocumentMode(!1),this.updateConfig();var b=this.pendingStateChanges;this.pendingStateChanges={},this.editor.setState(a.defaults({config:this.editorConfig,editorIsInit:!0},b))},registerInitUserPrefsCallback:function(a){this.userPreferencesInitCallbacks.push(a),this.userPreferencesInitCallbacksInvoked&&a()},exitEditor:function(){window.open("http://www.wix.com/my-account/?referralInfo=EDITOR","_self")},getUserPreferences:function(){return this.userPreferences},isTpa:function(a){return this.documentServices.tpa.isTpaByCompType(a)},registerToViewerChange:function(a){this.viewerUpdateCallbacks.push(a)},registerRemovePlugin:function(a,b){this.removePlugins[a]=b},registerCannotRemovePlugin:function(a,b){this.cannotRemovePlugins[a]=b},registerCopyComponentPlugin:function(a,b){this.copyComponentPlugins[a]=b},registerPageNavigationCallback:function(a){this.pageNavigationCallbacks.push(a)},registerCompNamePlugin:function(a,b){this.compNamePlugins[a]=b},registerCompIconPlugin:function(a,b){this.compIconPlugins[a]=b},registerSitePublishedCallbacks:function(a){this.sitePublishedCallbacks.push(a)},registerDeviceTypeChangeCallbacks:function(a){this.deviceTypeChangeCallbacks.push(a)},applyPreviewScrollToEditorScroll:function(){var a=this.site.getScroll();window.scrollTo(a.x,a.y)},togglePreview:function(){var a=!this.editor.state.previewMode;this.setDocumentMode(a),this.setRenderPlugins(a,this.isMobileEditor()),a?this.goToPreview():this.exitPreview()},goToPreview:function(){R(this.editor),this.panelManager.closeAllPanels(),this.editor.setState({previewMode:!0,contextMenu:null}),this.selection.deselectComponents(),g.keyboardShortcuts.setContext(g.keyboardShortcuts.CONTEXTS.PREVIEW)},exitPreview:function(){this.editor.setState({previewMode:!1,floatingBubble:{}},function(){this.applyPreviewScrollToEditorScroll(),g.keyboardShortcuts.setContext(g.keyboardShortcuts.CONTEXTS.EDITOR)}.bind(this))},setRenderPlugins:function(a){this.renderPlugins.allowSiteOverflow(a),this.renderPlugins.setExtraSiteHeight(a||this.isMobileEditor()?0:this.editorConfig.extraSiteHeight),this.renderPlugins.setPreviewTooltipCallback(function(a,b){var c=S(a,this.editorConfig.previewTop);this.showFloatingBubble(b,c),P=setTimeout(this.hideFloatingBubble,d.constants.PREVIEW.FLOATING_BUBBLE_TIMEOUT)}.bind(this))},setDocumentMode:function(a){this.documentServices.documentMode.enablePlaying(a),this.documentServices.documentMode.enableZoom(a),this.documentServices.documentMode.enableSocialInteraction(!1),this.documentServices.documentMode.enableExternalNavigation(!1),this.documentServices.documentMode.enableSlideShowGalleryClick(a),this.documentServices.documentMode.enableTinyMenuOpening(a),this.documentServices.documentMode.enableRenderFixedPositionContainers(a),this.documentServices.documentMode.enableRenderFixedPositionBackgrounds(a),this.documentServices.documentMode.enableBackToTopButton(a),this.documentServices.documentMode.enablePageProtection(!1),this.documentServices.documentMode.toggleWixAds(a),this.documentServices.documentMode.enableBgVideoAutoplay(a&&this.isDesktopEditor()),this.documentServices.documentMode.enableSiteMembersDialogsOpening(a),this.documentServices.documentMode.enableResetGalleryToOriginalState(a),this.documentServices.documentMode.enableResetComponent(!a),this.documentServices.documentMode.resetBehaviors(a),this.documentServices.documentMode.enableAction("screenIn",a&&this.isDesktopEditor()),this.documentServices.documentMode.enableAction("bgScrub",a&&this.isDesktopEditor()),this.documentServices.documentMode.setExtraSiteHeight(a||this.isMobileEditor()?0:this.editorConfig.extraSiteHeight),this.documentServices.documentMode.enableShouldUpdateJsonFromMeasureMap(!a),this.documentServices.documentMode.allowSiteOverflow(a),this.documentServices.documentMode.setComponentViewMode(a?"preview":"editor")},getPreviewMode:function(){return this.editor.state.previewMode},isCurrentPageLandingPage:function(){var a=this.pages.data.get(this.pages.getCurrentPageId());return a.isLandingPage},isDesktopEditor:function(){return!this.isMobileEditor()},isMobileEditor:function(){return this.editor.state&&this.editor.state.isMobileEditor},openCantCopyPastePanel:function(){var a=this.userPreferences.site.get(d.constants.USER_PREFS.CANT_MAKE_CHANGES.MOBILE_CANT_MAKE_CHANGE_DONT_SHOW_AGAIN);a||this.panelManager.openPanel("mobileEditor.panels.cantMakeChangeMobile",{},!0)},setDesktopEditor:function(){this.setEditorMode(!1)},setMobileEditor:function(){this.setEditorMode(!0)},setEditorMode:function(b,c,d){if(b===this.isMobileEditor())return void(c&&c());a.each(this.deviceTypeChangeCallbacks,function(a){a()});var e=b?this.viewMode.VIEW_MODES.MOBILE:this.viewMode.VIEW_MODES.DESKTOP;this.panelManager.closeAllPanels(),this.selection.deselectComponents(),this.viewMode.set(e),this.setRenderPlugins(this.getPreviewMode(),b);var f=b;this.editor.setState({isMobileEditor:f},c),!d&&f&&this.documentServices.history.canUndo()&&this.history.add("mobile structure was updated"),this.documentServices.documentMode.setExtraSiteHeight(this.editor.state.previewMode||f?0:this.editorConfig.extraSiteHeight),this.documentServices.documentMode.resetBehaviors(this.getPreviewMode()),this.documentServices.documentMode.enableAction("screenIn",this.getPreviewMode()&&!b),this.documentServices.documentMode.enableAction("bgScrub",this.getPreviewMode()&&!b)},isMobileOptimizedSite:function(){return this.documentServices?this.documentServices.mobile.isOptimized():!1},setMobileOptimizedSite:function(a){this.documentServices&&this.documentServices.mobile.enableOptimizedView(a)},groupComponents:function(a){if(!this.components.is.groupedComponent(a)){this.selection.deselectComponents();var b=this.components.groupComponents(a);this.closeCompPanelIfExists(),this.history.add("group components"),this.selection.selectComponentByCompRef(b)}},getLeftBarButtonsBoundingRect:function(){return this.editor.state.pinMode?0:this.editor.refs.leftBar.getButtonsBoundingRect()},openRightClickMenu:function(a,b){var c={position:{x:a,y:b}};this.editor.setState({contextMenu:c})},onTopBarClicked:function(){},closeRightClickMenu:function(){this.editor.setState({contextMenu:null})},closeCompPanelIfExists:function(){var a=this.panelManager.getPanelsOfType("compPanelFrame");a.length&&this.panelManager.closeAllPanelsOfType("compPanelFrame")},toggleShowOnAllPages:function(a){var b;return b=this.components.isShowOnAllPages(a)?this.documentServices.pages.getReference(this.pages.getCurrentPageId()):this.documentServices.siteSegments.getSiteStructure(),this.components.setContainer(a,b)},getCompRestrictions:function(a){if(!a)return{};var b={container:this.components.is.container(a),containable:this.components.is.containable(a),movable:this.components.is.movable(a)&&!this.editor.state.isOpenTextEditor,alignable:this.components.is.alignable(a),horizontallyMovable:this.components.is.horizontallyMovable(a)&&!this.editor.state.isOpenTextEditor&&!this.components.layout.isPinned(a)&&!this.editor.state.pinMode,verticallyMovable:this.components.is.verticallyMovable(a)&&!this.editor.state.isOpenTextEditor&&!this.components.layout.isPinned(a)&&!this.editor.state.pinMode,canMoveUp:this.components.is.canMoveUp(a)&&!this.editor.state.isOpenTextEditor,resizable:this.components.is.resizable(a),horizontallyResizable:this.components.is.horizontallyResizable(a)&&!this.components.layout.isPinned(a),verticallyResizable:this.components.is.verticallyResizable(a)&&!this.components.layout.isPinned(a),resizeableSides:this.components.layout.getResizableSides(a),rotatable:this.components.is.rotatable(a)&&!this.components.layout.isPinned(a),removable:this.components.is.removable(a)&&!this.editor.state.isOpenTextEditor,duplicatable:this.components.is.duplicatable(a)&&!this.editor.state.isOpenTextEditor&&!this.components.layout.isPinned(a),isFixed:this.components.is.fixed(a),canBeFixed:this.components.layout.canBeFixedPosition(a),canShowOnAllPages:this.components.canShowOnAllPages(a),canToggleShowOnAllPages:this.components.canToggleShowOnAllPages(a),canMoveForward:this.components.arrangement.canMoveForward(a)&&!this.components.layout.isPinned(a),canMoveBackward:this.components.arrangement.canMoveBackward(a)&&!this.components.layout.isPinned(a)};return H&&(b.canBeShownOnAllStates=this.components.canBeShownOnAllStates(a,"wysiwyg.viewer.components.BoxSlideShow")),b},getComponentType:function(a){return this.components.getType(a).split(".").pop()},openPagesPanel:j.openPagesPanel,openMobileElementsPanel:j.openMobileElementsPanel,openComponentPanel:function(a,b){b=b||{};var c=this.getComponentType(this.editor.state.selectedComponents),d=this.getPanelPathByType(c,a);this.panelManager.openComponentPanel(d,b)},openCompOutOfGridPanelIfNeeded:function(a){var b=this.components.layout.getRelativeToScreen(a);d.utils.layoutConstraintsLogic.isCompOutOfPageBounds(this,b)&&this.openCompOutOfGridPanel()},openCompOutOfGridPanel:j.openCompOutOfGridPanel,openDragToHeaderPanel:j.openDragToHeaderPanel,openOrganizeImagesPanel:j.openOrganizeImagesPanel,openOrganizeSocialIconsPanel:j.openOrganizeSocialIconsPanel,openAviaryPanel:j.openAviaryPanel,openLinkPanel:j.openLinkPanel,openPinModeSizeRestrictionPanel:j.openPinModeSizeRestrictionPanel,getPanelPathByType:function(a,b){var c="compPanels.panels."+a+"."+b;return this.isTpa(a)?b===d.constants.componentPanels.settings&&(c="tpa.compPanels.tpaSettings"):b===d.constants.componentPanels.animation?c="compPanels.dynamicPanels."+d.constants.componentPanels.animation:b===d.constants.componentPanels.design&&(c="designPanel."+d.constants.componentPanels.design),c},openLearnMore:function(a){a&&"string"==typeof a&&console.log("opening learn more with key - ",a)},isPreviewReady:function(){return this.previewReady},registerMouseMoveAction:function(a,b){this.editor.registerMouseMoveAction(a,b)},setPortalChildren:function(b,c){var d=a.cloneDeep(this.editor.state.portalComps);a.isEmpty(c)?delete d[b]:d[b]=c,this.editor.setState({portalComps:d})},hasExternalDesign:function(a){return this.documentServices.tpa.isTpaByCompType(this.components.getType(a))},setAttachCandidate:function(a,b){b?this.editor.setState({attachCandidate:a}):this.setStateWaitForViewer({attachCandidate:a})},setConstraintArea:function(a){this.setStateWaitForViewer({constraintArea:a})},setPageSections:function(a,b){this.editor.setState({pageSections:{sections:a,selectedSection:b}})},clearPageSections:function(){this.setPageSections(null,null)},setSiteScale:function(a,b){this.editor.setSiteScale(a,b)},getAnchors:function(){return a.map(this.documentServices.components.get.byType("wysiwyg.common.components.anchor.viewer.Anchor"),function(a){var b=this.documentServices.components.data.get(a),c=this.documentServices.components.getPage(a).id;return{anchorName:b.name,pageId:"#"+c,anchorDataId:"#"+b.id,y:this.components.layout.get(a).y}},this)},snapLines:{set:function(a,b){b?this.editor.setState({snapLines:a}):this.setStateWaitForViewer({snapLines:a})},clear:function(a){a?this.editor.setState({snapLines:null}):this.setStateWaitForViewer({snapLines:null})}},lasso:{setCandidates:function(a){this.editor.setState({lassoCandidates:a})},setLayout:function(a){this.editor.setState({lassoLayout:a})},clear:function(){this.editor.setState({lassoLayout:null,lassoCandidates:[]})}},hoverBox:{set:function(a,b){var c=this.utils.getParentIfCompCanBeSelected(a),d=c?c:a;this.editor.setState({hoveredComp:H?d:a,hoverBoxOverlay:!!b})},clear:function(){this.editor.setState({hoveredComp:null,hoverBoxOverlay:!1})}},clipboard:{types:d.constants.EDITOR_CLIPBOARD_TYPES,setItem:function(b,c){var d=a.cloneDeep(this.editor.state.clipboard);d[b]=c,this.editor.setState({clipboard:d})},getItem:function(a){return this.editor.state.clipboard[a]}},clipboardContainsComp:function(){return!!this.clipboard.getItem(d.constants.EDITOR_CLIPBOARD_TYPES.COMPONENT)},text:{startEditing:function(){if(CKEDITOR&&!CKEDITOR.wixDocumentServices&&(CKEDITOR.wixDocumentServices=this),!this.editor.state.isOpenTextEditor){var b=this.selection.getSelectedComponents();if(this._textCompForEdit=a.first(b),F.migrationUtils.isOldTextComponent(this._textCompForEdit,this)){this.bi.error(d.bi.errors.OLD_TEXT_MIGRATION),F.migrationUtils.migrateComponent(this._textCompForEdit,this);var c=this;this.waitForChangesApplied(function(){c.editor.setState({isOpenTextEditor:!0})})}else this.editor.setState({isOpenTextEditor:!0})}},stopEditing:function(){if(this.editor.state.isOpenTextEditor){var a=this;this.renderPlugins.setHideTextComponent(null),this.waitForChangesApplied(function(){a.editor.setState({isOpenTextEditor:!1}),delete a._textCompForEdit})}},setCurrentTextEditor:function(a){this._currentTextEditor=a},getEditor:function(){return this._currentTextEditor},getTextCompForEdit:function(){return this._textCompForEdit},isEditingText:function(){return!!this.editor.state.isOpenTextEditor},undo:function(){this._currentTextEditor.editor.undoManager.undo()},redo:function(){this._currentTextEditor.editor.undoManager.redo()}},account:{isUserOwner:function(){var a=!0;if(G){a=!1;var b=g.editorModel.permissionsInfo;if(b){var c=b.loggedInUserId,d=b.ownerId;a=c===d}}return a},isUserContributor:function(){return!this.account.isUserOwner()},openConnectDomain:function(b,c){var d=this.generalInfo.isFirstSave();c=a.isBoolean(c)?c:!this.generalInfo.isSitePublished();var e=this.site.isPremium();this.panelManager.openPanel("savePublish.panels.connectDomain",{isFirstSave:d,isFirstPublish:c,isPremium:e,title:"PREMIUM_PUBLISH_TITLE",subtitle:e?"PREMIUM_PUBLISH_SUBTITLE":"CONNECT_DOMAIN_DIALOG_FREE_SUBTITLE",flowId:b},!0)},openSettings:function(){this.panelManager.openPanel("rEditor.panels.siteSettingsPanel")},openRevisions:function(){var a=!!this.userPreferences.site.get(d.constants.USER_PREFS.SITE_REVISIONS.SITE_HISTORY_DONT_SHOW_AGAIN);if(a)this.account.openSiteHistory();else{var b=this;this.panelManager.openPanel("panels.messagePanels.siteRevisionsPanel",{onButtonClick:function(a){a&&b.account.openSiteHistory()}})}},manage:function(){var a=this.documentServices.generalInfo.getMetaSiteId();
window.open("http://www.wix.com/my-account/sites/"+a+"/?referralInfo=EDITOR")},openMySites:function(){window.open("http://www.wix.com/my-account/?referralInfo=EDITOR")},openSiteHistory:function(){var a=this.documentServices.generalInfo.getMetaSiteId();window.open("http://www.wix.com/my-account/history/"+a+"/?forceHttp&isEdited=true&referralInfo=EDITOR")},upgrade:function(a){var b=this.documentServices.generalInfo.getMetaSiteId(),c=a?"referralAdditionalInfo="+a:"",d="https://premium.wix.com/wix/api/premiumStart?"+c;d+="&siteGuid="+b,window.open(d)}},help:{openHelpCenter:function(a,b,c){console.error("editorAPI.help.openHelpCenter is deprecated. Use panelManager.openHelpCenter instead"),this.panelManager.openHelpCenter(a,b,c)}},mobile:{mobileOnlyComponents:{enableBackToTopButton:function(a){this.documentServices.mobile.mobileOnlyComponents.enableBackToTopButton(a)}},hiddenComponents:{get:function(b){var c=this.documentServices.mobile.hiddenComponents.get(b);return a.filter(c,function(a){var c=this.documentServices.components.get.byId(a,b,this.documentServices.viewMode.VIEW_MODES.DESKTOP);return this.documentServices.components.is.group(c)?!1:!0},this)}}},utils:{isSameRef:function(b,c){var d=this.components.asArray(b),e=this.components.asArray(c);if(this.multiselect.isMultiselect(d)||this.multiselect.isMultiselect(e)){if(d.length!==e.length)return!1;var f=a.sortBy(d,"id"),g=a.sortBy(e,"id"),h=a.every(f,function(a,b){return this.documentServices.utils.isSameRef(a,g[b])},this);return h}return this.documentServices.utils.isSameRef(a.first(d),a.first(e))},isPage:function(a){var b=this.components.asArray(a);return this.multiselect.isMultiselect(b)?!1:this.documentServices.utils.isPage(b[0])},getParentIfCompCanBeSelected:function(a){return this.components.is.selectable(a)?null:this.components.getContainer(a)}},siteName:{validate:function(a){var b=this.documentServices.siteName.validate(a),c={};return c[this.documentServices.siteName.ERRORS.SITE_NAME_IS_EMPTY]="SAVE_SITE_NAME_IS_EMPTY",c[this.documentServices.siteName.ERRORS.SITE_NAME_IS_NOT_STRING]="SITE_NAME_IS_NOT_STRING",c[this.documentServices.siteName.ERRORS.SITE_NAME_INVALID_CHARS]="SAVE_SITE_NAME_INVALID_CHARS",c[this.documentServices.siteName.ERRORS.SITE_NAME_ENDS_WITH_HYPHEN]="SAVE_SITE_NAME_ENDS_WITH_HYPHEN",c[this.documentServices.siteName.ERRORS.SITE_NAME_TOO_SHORT]="SAVE_SITE_NAME_TOO_SHORT",c[this.documentServices.siteName.ERRORS.SITE_NAME_TOO_LONG]="SAVE_SITE_NAME_TOO_LONG",c[this.documentServices.siteName.ERRORS.SITE_NAME_ALREADY_EXISTS]="SAVE_SITE_NAME_ALREADY_EXISTS",b.errorMessage=c[b.errorCode],b},set:function(a){this.documentServices.siteName.set(a),this.domain.isDomainConnected()||this.documentServices.generalInfo.setPublicUrl(this.domain.getFreeDomainPrefix()+a)},sanitize:function(a){return this.documentServices.siteName.sanitize(a)},rename:function(a,c,d){var e=g.serviceTopology.editorServerRoot||"//editor.wix.com/html/editor/web";e+="/meta-site-proxy/rename/"+this.documentServices.generalInfo.getMetaSiteId(),b.ajax(e,{type:"POST",data:{newName:a},success:function(b){return b.success?(this.documentServices.siteName.set(a),this.domain.isDomainConnected()||this.documentServices.generalInfo.setPublicUrl(this.domain.getFreeDomainPrefix()+a),void(c&&c())):void d(b)}.bind(this),error:function(){d&&d()}})}},updateEditorViewTools:function(b,c){var d=a.clone(this.editor.state.viewTools);d[b]=c,this.editor.setState({viewTools:d})},toolbar:{isToolbarEnabled:function(){return this.editor.state.viewTools.toolbarEnabled},toggleToolbar:function(){this.updateEditorViewTools("toolbarEnabled",!this.toolbar.isToolbarEnabled())}},grid:{guidelines:{isGuidelinesEnabled:function(){return this.editor.state.viewTools.guidelinesEnabled},toggleGuidelines:function(a,b){var c=!this.grid.guidelines.isGuidelinesEnabled();this.updateEditorViewTools("guidelinesEnabled",c),this.userPreferences.site.set(d.constants.USER_PREFS.VIEW_TOOLS.GUIDELINES_ENABLED,c,a,b)}},snapTo:{isSnapToEnabled:function(){return this.editor.state.viewTools.snapToEnabled},toggleSnapTo:function(a,b){var c=!this.grid.snapTo.isSnapToEnabled();this.updateEditorViewTools("snapToEnabled",c),this.userPreferences.site.set(d.constants.USER_PREFS.VIEW_TOOLS.SNAPTO_ENABLED,c,a,b)}}},pages:{navigateTo:function(a,b){this.selection.deselectComponent(),g.keyboardShortcuts.disable(),this.documentServices.pages.navigateTo(a,T.bind(this,a,b))},getCurrentPageTitle:function(){if(!this.documentServices)return null;var a=this.documentServices.pages.getCurrentPageId(),b=this.documentServices.pages.data.get(a);return b&&b.title||""},remove:function(a,b){this.selection.deselectComponents(),o.removePage(this,this.documentServices,this.removePlugins,a,b)},beforePageRemoveHook:function(a,b){var d,c=this.homePage.get();c===a&&(d=this.mainMenu.getFirstNonHomePageMenuItem(),d&&(this.homePage.set(d.link.pageId),c=d.link.pageId.replace(/^#/,""))),this.documentServices.pages.navigateTo(c,b)},isPageExist:function(b){return a.contains(this.pages.getPageIdList(),b)},serialize:function(a,b){var c=this.documentServices.pages.serialize(a,!0);return b&&Z(c,this),c},data:{update:function(a,b){b.isLandingPage&&(this.selection.deselectComponent(),this.editor.setState({hoveredComp:null})),b=d.utils.updateDataUtil.fixData(b),this.documentServices.pages.data.update(a,b),k.updatePagePlugins.run(this,a)}},background:{update:function(a,b,c){b=d.utils.updateDataUtil.fixData(b),this.documentServices.pages.background.update(a,b,c)}},transitions:{set:function(a){this.documentServices.pages.transitions.set(a),this.history.add("page transition")}}},siteSegments:{getRefs:function(){var a=this.documentServices.siteSegments;return[a.getFooter(),a.getHeader(),a.getPagesContainer(),a.getSiteStructure()]},getPagesContainerAbsLayout:function(){var a=this.siteSegments.getPagesContainer();return this.components.layout.getRelativeToScreen(a)}},pluginService:B,tooltipTextService:D,pasteLogic:E,homePage:{set:function(a){this.documentServices.homePage.set(a),k.setHomePagePlugins.run(this,a)}},openEditorVersionInfoPanel:function(){this.panelManager.openPanel("rEditor.panels.editorVersionInfoPanel")},styles:{openApplyStylePanel:function(a){this.panelManager.openPanel("rEditor.panels.applyStylePanel",{selectedComp:a,editorAPI:this})}},bi:{eventWithEditorPresets:function(b){var c=this;return function(){var d=arguments[0],e=arguments[1]||{},f=g.editorModel.permissionsInfo;if(f){var h=f.ownerId,i=a.pluck(f.loggedInUserRoles,"role").join(",");a.assign(e,{ownerId:h,roles:i})}b.call(c,d,e)}},getComponentsBIParams:function(b){return a.map(b,function(b){var c={};if(b){c.component_id=b.id;var d=this.components.getType(b);c.component_type=d,d&&this.isTpa(d)&&a.assign(c,this.bi.getTpaComponentBIParams(b))}return c},this)},getTpaComponentBIParams:function(a){var b={},c=this.components.data.get(a)||{},d=this.tpa.app.getData(c.applicationId);b.app_id=d.appDefinitionId,b.instance_id=a.id,b.app_site_id=d.instanceId;var e="TPAWidget"===c.type,f=this.tpa.app.isLastAppComp(c.applicationId),g=f||!(e||this.tpa.app.isMultiSectionInstalled(c.applicationId));return b.is_last_tpa=g?1:0,b},reportBI:function(b,c){var d=this;a.each(c,function(a){a.is_last=a.is_last||a===this,d.bi.event(b,a)},c[c.length-1])}},campaigns:{fetchCampaignInfo:function(){var a=this,c="http://"+window.location.host+"/_api/wix/salesSystemResolver";b.getJSON(c,function(b,c){"success"===c&&b&&(a.campaignInfo={id:b.data.campaignId,type:b.data.type})})},getActiveCampaignInfo:function(){return this.campaignInfo},isActiveCampaign:function(b){return this.campaigns.getActiveCampaignInfo()?a.contains(this.campaigns.getActiveCampaignInfo().id,b.id):!1},getDiscountValue:function(b){var c=this.campaigns.getActiveCampaignInfo(),d=c.id.split("_");return 1===d.length?b.defaultDiscount:a.last(d)},personalSale:{isActiveCampaign:function(){return this.campaigns.isActiveCampaign(d.constants.CAMPAIGNS.PERSONAL_SALE)||this.campaigns.isActiveCampaign(d.constants.CAMPAIGNS.SEASONAL_CAMPAIGN)},getDiscountValue:function(){return this.campaigns.getDiscountValue(d.constants.CAMPAIGNS.PERSONAL_SALE)},getAssetPath:function(){return d.constants.CAMPAIGNS.PERSONAL_SALE.assetPath}}},promotions:{initPromotions:function(){this.promotions.music.init()},music:{init:function(){var a=this.promotions.music;(J||K)&&(a.didUserRegisterWithMusicCategory(function(b){a.isMusicCategory=b,a.isActive()&&a.displayPopup()}),this.tpa.app.registerOnInstalled(d.constants.MUSIC_PROMO.APP_DEFINITION_ID,a.displayPopup))},isActive:function(){if(J||K){var b=this.generalInfo.getSiteOriginalTemplateId(),c=a.contains(d.constants.MUSIC_PROMO.TEMPLATE_IDS,b),e=this.tpa.app.isInstalled(d.constants.MUSIC_PROMO.APP_DEFINITION_ID);return c||e||this.promotions.music.isMusicCategory}return!1},displayPopup:function(){this.panelManager.openPanel("panels.focusPanels.musicPromotionPanel")},didUserRegisterWithMusicCategory:function(c){var d="http://editor.wix.com/_api/wix-bi-profile-server/userprofile?fields=post_reg_category,post_reg_sub_category&accept=json";b.ajax(d).complete(function(b,d){if("success"===d){var e=b.responseJSON,f=e.payload&&e.payload.fields,g=a.find(f,{name:"post_reg_category"});c(g&&"music"===g.value)}else c(!1)})}}},showFloatingBubble:function(b,c){var d=a.clone(this.editor.state.floatingBubble);d.value=b,d.targetLayout=c,this.editor.setState({floatingBubble:d})},hideFloatingBubble:function(){this.editor.setState({floatingBubble:{}}),clearTimeout(P)},showComponentPreviewRect:function(a){this.editor.setState({pinPreviewRectStyle:a})},hideComponentPreviewRect:function(){var b=this.editor.state.pinPreviewRectStyle;a.assign(b,{opacity:0}),this.editor.setState({pinPreviewRectStyle:b})},openPinMode:function(a){this.panelManager.openComponentPanel("compPanels.dynamicPanels.pinnedDockPanel",{origin:a}),U(this),W(this)},closePinMode:function(){V(this),this.hideComponentPreviewRect(),X(this)},getSiteScale:function(){return this.editor.state.siteScale},triggerMouseUp:function(a){this.editor.onMouseUp(a)}}),Y}),define("rEditor/rootComps/keyboard/config/topContextShortcuts",["lodash"],function(a){"use strict";var b=function(a){a.preventDefault()},c={esc:b,"ctrl + t, command + t":b,"ctrl + y, command + y":b,"ctrl + d, command + d":b,"ctrl + s, command + s":b,"ctrl + ], command + ]":b,"ctrl + [, command + [":b,"ctrl + shift + ], command + shift + ]":b,"ctrl + shift + [, command + shift + [":b,backspace:b,"ctrl + left, command + left":b,"ctrl + right, command + right":b,"ctrl + shift + left, command + shift + left":b,"ctrl + shift + right, command + shift + right":b,"ctrl + m, command + m":b,"ctrl + shift + m, command + shift + m":b};return{init:a.once(a.noop),shortcuts:c}}),define("rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap",["core"],function(a){"use strict";var b=a.constants.KEYBOARD_SPECIAL_KEY.value,c=a.constants.KEYBOARD_SPECIAL_KEY.label;return{editor:{SELECT_ALL:{key:b+" + a",label:""},GROUP_COMPONENTS:{key:b+" + g",label:""},UNGROUP_COMPONENTS:{key:b+" + shift + g",label:""},COPY:{key:b+" + c",label:c+" + C"},PASTE:{key:b+" + v",label:c+" + V"},CUT:{key:b+" + x",label:c+" + X"},DUPLICATE:{key:b+" + d",label:c+" + D"},UNDO:{key:b+" + z",label:c+" + Z"},REDO:{key:[b+" + y",b+" + shift + z"].join(","),label:c+" + Y"},DELETE:{key:["del","backspace"].join(","),label:"Del"},SAVE:{key:b+" + s",label:c+" + S"},SAVE_AS_TEMPLATE:{key:b+" + alt + t",label:""},SELECT_NEXT_COMP:{key:b+" + m",label:""},SELECT_PREV_COMP:{key:b+" + shift + m",label:""},CLOSE_PANELS:{key:"esc",label:""},MOVE_RIGHT:{key:"right",label:""},SHIFT_RIGHT:{key:"shift + right",label:""},MOVE_LEFT:{key:"left",label:""},SHIFT_LEFT:{key:"shift + left",label:""},MOVE_UP:{key:"up",label:""},SHIFT_UP:{key:"shift + up",label:""},MOVE_DOWN:{key:"down",label:""},SHIFT_DOWN:{key:"shift + down",label:""},SEND_FORWARD:{key:b+" + right",label:c+" + "},SEND_TO_FRONT:{key:b+" + shift + right",label:c+" + Shift + "},SEND_BACKWARD:{key:b+" + left",label:c+" + "},SEND_TO_BACK:{key:b+" + shift + left",label:c+" + Shift + "},TOGGLE_PREVIEW:{key:b+" + p",label:c+" + P"},PUBLISH_SITE:{key:b+" + shift + p",label:c+" + Shift + P"}},preview:{EXIT_PREVIEW:{key:"esc",label:""},TOGGLE_PREVIEW:{key:b+" + p",label:c+" + P"},PUBLISH_SITE:{key:b+" + shift + p",label:c+" + Shift + P"}},topBar:{CLOSE_DROP_PANEL:{key:"esc",label:""}}}}),define("rEditor/rootComps/topBar/menuBar/menuBarItemsDefinitions",["lodash","core","util","panels","savePublish","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","experiment!userRoles"],function(a,b,c,d,e,f,g){"use strict";function k(a,b,c){var f=h&&h.generalInfo&&h.generalInfo.isFirstSave();f?d.panelManager.openPanel(j,{saveMethod:e.save.bind(null,h),title:b,messageBody:c},!0):a()}function l(b,c,d,e){var f=e?a.cloneDeep(c):c;f.fields.status=b?1:0,e&&f.fields.category&&(f.fields.category+=e),h.bi.event(f.type,f.fields),d.call(h)}function m(){var a={SITE_BAR:{label:c.translate("TOPBAR_Site_Label"),bi:{type:b.bi.events.topbar.top_bar_click,fields:{category:"site"}}},EDIT_BAR:{label:c.translate("TOPBAR_Edit_Label"),bi:{type:b.bi.events.topbar.top_bar_click,fields:{category:"edit"}}},VIEW_BAR:{label:c.translate("Topbar_Tools_Label"),bi:{type:b.bi.events.topbar.top_bar_click,fields:{category:"view"}}},SETTINGS:{action:function(){k(function(){h.bi.event(b.bi.events.topbar.top_bar_open_settings_click),h.account.openSettings()},"TOPBAR_SITE_SETTINGS_SAVE_FIRST_MSG_TITLE","TOPBAR_SITE_SETTINGS_SAVE_FIRST_MSG_BODY")},label:c.translate("TOPBAR_Settings_Label"),bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"settings"}}},HELP_BAR:{label:c.translate("TOPBAR_HELP_TOOLTIP_TITLE"),bi:{type:b.bi.events.topbar.top_bar_click,fields:{category:"help"}}},HELP_CENTER:{label:c.translate("TOPBAR_HELP_EDITOR_HELP"),action:function(){var a=h.isDesktopEditor(),b=a?"58406e7a-1ad0-4105-8e37-c053b529f9d8":"f8b24a99-cefd-4c55-adda-aa66ec643259";d.panelManager.openHelpCenter(b)},bi:{type:b.bi.events.topbar.top_bar_HELP_menu_click,fields:{category:"help_center"}}},HELP_KB_SHORTCUTS:{separator:!0,label:c.translate("TOPBAR_HELP_KB_SHORTCUTS"),action:function(){d.panelManager.openHelpCenter("5a3238e6-ebe9-4aca-a7a2-1c717598e334")},bi:{type:b.bi.events.topbar.top_bar_HELP_menu_click,fields:{category:"help_kb_shortcuts"}}},HELP_CONNECT_DOMAIN:{label:c.translate("TOPBAR_HELP_CONNECT_DOMAIN"),action:function(){d.panelManager.openHelpCenter("a06941d9-7683-4ced-bce3-bd2cc3c7d6e9")},bi:{type:b.bi.events.topbar.top_bar_HELP_menu_click,fields:{category:"help_connect_domain"}}},HELP_SEO:{separator:!0,label:c.translate("TOPBAR_HELP_SEO"),action:function(){d.panelManager.openHelpCenter("ab2c2a83-5bc0-435e-ab82-f2c1036580a7")},bi:{type:b.bi.events.topbar.top_bar_HELP_menu_click,fields:{category:"help_seo"}}},HELP_FEEDBACK:{label:c.translate("Topbar_HELP_FEEDBACK"),action:function(){var a=h.getLanguageCode(),b=i.HELP_URLS.FEEDBACK;b=b.replace("{$lang}","en"===a?"www":a),window.open(b)},bi:{type:b.bi.events.topbar.top_bar_HELP_menu_click,fields:{category:"help_feedback"}}},SAVE:{label:c.translate("TOPBAR_Site_Save"),action:function(){e.save(h)},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"save"}}},VIEW_SITE:{label:c.translate("TOPBAR_SITE_VIEWSITE"),action:function(){var a=h.generalInfo&&h.generalInfo.isSitePublished()||!1;if(a){var b=h.site.getSitePublicUrl();window.open(b)}else e.saveAndPublish(h)},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"view_site"}}},PREVIEW:{label:c.translate("TOPBAR_PREVIEW_TOOLTIP_TITLE"),action:h.togglePreview,bi:[{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"preview"}},{type:b.bi.events.preview.PREVIEW_CLICK,fields:{origin:"menubar"}}]},PUBLISH:{label:c.translate("TOPBAR_Site_Publish"),action:function(){e.saveAndPublish(h)},bi:[{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"publish"}},{type:b.bi.events.publish.PUBLISH_CLICK,fields:{origin:"menubar"}}]},EDITOR_MODE_SWITCH:{separator:!0,labelFunc:function(){return h&&h.isMobileEditor()?c.translate("Topbar_Site_Desktop_Editor"):c.translate("Topbar_Site_Mobile_Editor")},action:function(){h.setEditorMode(!h.isMobileEditor())},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"editor_mode_switch"}}},REVISIONS:{label:c.translate("TOPBAR_Site_Site_Revisions"),action:function(){k(h.account.openRevisions,"TOPBAR_SITE_HISTORY_SAVE_FIRST_MSG_TITLE","TOPBAR_SITE_HISTORY_SAVE_FIRST_MSG_BODY")},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"revisions"}}},MANAGE:{label:c.translate("TOPBAR_Site_Manage_Site"),action:h.account.manage,disabledChecker:function(){return h.generalInfo.isFirstSave()},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"manage_site"}}},MY_SITES:{label:c.translate("TOPBAR_Site_My_Sites"),action:h.account.openMySites,bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"my_sites"}}},EXIT:{label:c.translate("TOPBAR_Site_Logout"),action:h.exitEditor,bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"logout"}}},UNDO:{label:c.translate("TOPBAR_Edit_Undo"),shortcutLabel:f.editor.UNDO.label,action:h.history.undo,bi:{type:b.bi.events.topbar.top_bar_EDIT_menu_click,fields:{category:"undo"}}},REDO:{label:c.translate("TOPBAR_Edit_Redo"),shortcutLabel:f.editor.REDO.label,action:h.history.redo,bi:{type:b.bi.events.topbar.top_bar_EDIT_menu_click,fields:{category:"redo"}}},CUT:{label:c.translate("TOPBAR_Edit_Cut"),shortcutLabel:f.editor.CUT.label,compActionRestrictionNames:["duplicatable","removable"],action:function(){h.selectedComponent.sendSelectedComponentBI(b.bi.events.topbar.top_bar_EDIT_menu_click,{category:"cut"}),h.selectedComponent.cut(),h.history.add("component - cut")}},COPY:{label:c.translate("TOPBAR_Edit_Copy"),shortcutLabel:f.editor.COPY.label,compActionRestrictionNames:["duplicatable"],action:function(){h.selectedComponent.sendSelectedComponentBI(b.bi.events.topbar.top_bar_EDIT_menu_click,{category:"copy"}),h.selectedComponent.copy()}},PASTE:{label:c.translate("TOPBAR_Edit_Paste"),shortcutLabel:f.editor.PASTE.label,compActionRestrictionNames:["duplicatable"],action:function(){h.components.paste(),h.history.add("component - paste")},bi:{type:b.bi.events.topbar.top_bar_EDIT_menu_click,fields:{category:"paste"}}},DUPLICATE:{label:c.translate("TOPBAR_Edit_Duplicate"),shortcutLabel:f.editor.DUPLICATE.label,compActionRestrictionNames:["duplicatable"],action:function(){h.selectedComponent.sendSelectedComponentBI(b.bi.events.topbar.top_bar_EDIT_menu_click,{category:"duplicate"}),h.selectedComponent.duplicate(),h.history.add("component - duplicate")}},DELETE:{labelFunc:function(){return h.isDesktopEditor()?c.translate("TOPBAR_Edit_Delete"):c.translate("TOPBAR_Edit_HIDE")},shortcutLabel:f.editor.DELETE.label,compActionRestrictionNames:["removable"],action:function(){h.selectedComponent.sendSelectedComponentBI(b.bi.events.topbar.top_bar_EDIT_menu_click,{category:"delete"}),h.selectedComponent.remove(),h.history.add("component - remove")}},TOOLBAR:{label:c.translate("TOPBAR_VIEW_TOOLBAR_TITLE"),isCheckbox:!0,menuPropsKey:"toolbarEnabled",action:function(b,c){l(!h.toolbar.isToolbarEnabled(),a.TOOLBAR.biData,h.toolbar.toggleToolbar,c?"(Image)":null)},biData:{type:b.bi.events.topbar.top_bar_VIEW_menu_click,fields:{category:"toolbar",status:null}}},GUIDELINES:{label:c.translate("TOPBAR_VIEW_GRIDLINES_TITLE"),isCheckbox:!0,menuPropsKey:"guidelinesEnabled",action:function(b,c){l(!h.grid.guidelines.isGuidelinesEnabled(),a.GUIDELINES.biData,h.grid.guidelines.toggleGuidelines,c?"(Image)":null)},biData:{type:b.bi.events.topbar.top_bar_VIEW_menu_click,fields:{category:"guidelines",status:null}}},SNAP:{label:c.translate("TOPBAR_VIEW_SNAP_TITLE"),isCheckbox:!0,menuPropsKey:"snapToEnabled",action:function(b,c){l(!h.grid.snapTo.isSnapToEnabled(),a.SNAP.biData,h.grid.snapTo.toggleSnapTo,c?"(Image)":null)},biData:{type:b.bi.events.topbar.top_bar_VIEW_menu_click,fields:{category:"snap",status:null}}}};return(!g||h.account.isUserOwner())&&(a.CONNECT_DOMAIN={label:c.translate("TOPBAR_SITE_CONNECT_DOMAIN"),action:function(){h.generalInfo.isFirstSave()?e.save(h):h.account.openConnectDomain(b.constants.CONNECT_DOMAIN.FLOWS.TOP_BAR)},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"connect_domain"}}},a.UPGRADE={label:c.translate("TOPBAR_Upgrade_Label"),bi:{type:b.bi.events.topbar.top_bar_click,fields:{category:"upgrade"}}},a.UPGRADE_ITEM={label:c.translate("TOPBAR_Upgrade_Label"),separator:!0,className:"menu-bar-item-upgrade",action:function(){k(h.account.upgrade.bind(h,"edhtml_TOP_BAR_SITE_MENU_UPGRADE"),"TOPBAR_SITE_UPGRADE_SAVE_FIRST_MSG_TITLE","TOPBAR_SITE_UPGRADE_SAVE_FIRST_MSG_BODY")},bi:{type:b.bi.events.topbar.top_bar_SITE_menu_click,fields:{category:"upgrade"}}}),a}var h=null,i=b.constants,j="panels.messagePanels.saveYourSitePanel",n={init:a.once(function(b){h=b;var c=m();a.merge(n,c)})};return n}),define("rEditor/rootComps/keyboard/config/topBarShortcuts",["lodash","util","rEditor/rootComps/topBar/menuBar/menuBarItemsDefinitions"],function(a,b,c){"use strict";function e(){a.forEach(c,function(a){a&&a.shortcut&&(d[a.shortcut]=a.action)})}var d={};return{init:a.once(function(a){c.init(a),e()}),shortcuts:d}}),define("rEditor/rootComps/keyboard/actions/selectComponentShortcutsActions",["lodash","core","uiAnimations","experiment!boxSlideShow"],function(a,b,c,d){"use strict";function f(a,b,c){return"x"===c&&a.components.is.horizontallyMovable(b)||"y"===c&&a.components.is.verticallyMovable(b)}function g(b){var c=b.pages.getCurrentPageId(),d=b.components.getAllComponents(c),f=a.filter(d,function(b){return!a.contains(e,b.id)});return f}function h(b,c,e){var f=a.findIndex(c,{id:e}),g=f+1===c.length,i=g?0:f+1;return d&&!b.components.is.selectable(c[i])?h(b,c,c[i].id):c[i]}function i(b,c,e){var f=a.findIndex(c,{id:e}),g=0===f?c.length-1:f-1;return d&&!b.components.is.selectable(c[g])?i(b,c,c[g].id):c[g]}function j(a,b){var c=a.height/2;return Math.max(b-c,0)}function k(a,d){var e=b.utils.stageUtils.getStageLayout(),f=a.components.layout.getRelativeToScreen(d);c.scrollTo({y:j(e,f.y)})}function l(a,b){a.selection.selectComponentByCompRef(b),k(a,b)}var e=["PAGES_CONTAINER","SITE_PAGES"];return{selectNextComponent:function(a){var b=a.selection.getSelectedComponentId();if(b){var c=h(a,g(a),b);l(a,c)}},selectPreviousComponent:function(a){var b=a.selection.getSelectedComponentId();if(b){var c=i(a,g(a),b);l(a,c)}},moveComponent:function(b,c,d){var e=b.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(b.selection.getSelectedComponents());return e&&f(b,e,c)&&b.waitForChangesApplied(function(){var f=b.components.layout.getRelativeToStructure(e),g=a.clone(f);g[c]+=d,10===d?g[c]=10*Math.floor(g[c]/10):-10===d&&(g[c]=10*Math.ceil(g[c]/10)),b.components.layout.updateRelativeToStructure(e,g)}),e}}}),define("rEditor/rootComps/keyboard/util/editorDebugShortcutsUtil",["core","lodash","savePublish"],function(a,b,c){"use strict";function e(a){var e={},f=b(window.editorModel.runningExperiments).pick(function(a){return"new"===a}).keys().value();e["ctrl + alt + shift + v"]=a.openEditorVersionInfoPanel.bind(a),e["ctrl + alt + shift + e"]=function(){window.alert("Active Experiments:\n"+f.join("\n"))};var g=window.location.search&&window.location.search.toLowerCase(),h=b.contains(g,"debug=all")||b.contains(g,"isqa=true");return h&&(e[d+" + shift + alt + s"]=c.configureSave,e[d+" + shift + alt + p"]=c.configurePublish.bind(c,a)),e}var d=a.constants.KEYBOARD_SPECIAL_KEY.value;return e}),define("rEditor/rootComps/keyboard/config/editorShortcuts",["lodash","core","util","panels","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","rEditor/rootComps/keyboard/actions/selectComponentShortcutsActions","rEditor/rootComps/keyboard/util/editorDebugShortcutsUtil"],function(a,b,c,d,e,f,g){"use strict";function j(c){var d=b.bi.events.rightClickMenu,e={};e[i.GROUP_COMPONENTS.key]=k.bind(null,c),e[i.UNGROUP_COMPONENTS.key]=l.bind(null,c),e[i.COPY.key]=p(c.selectedComponent.copy,c,d.COPY,{origin:"keyboard"}),e[i.CUT.key]=p(n.bind(null,c),c,d.CUT,{origin:"keyboard"}),e[i.DUPLICATE.key]=p(m.bind(null,c),c,d.DUPLICATE,{origin:"keyboard"}),e[i.MOVE_RIGHT.key]=o.bind(null,c,"x",1),e[i.MOVE_LEFT.key]=o.bind(null,c,"x",-1),e[i.MOVE_UP.key]=o.bind(null,c,"y",-1),e[i.MOVE_DOWN.key]=o.bind(null,c,"y",1),e[i.SHIFT_RIGHT.key]=o.bind(null,c,"x",10),e[i.SHIFT_LEFT.key]=o.bind(null,c,"x",-10),e[i.SHIFT_UP.key]=o.bind(null,c,"y",-10),e[i.SHIFT_DOWN.key]=o.bind(null,c,"y",10);var f=g(c);a.merge(e,f),a.merge(h,e)}function k(a,b){var c=a.selection.getSelectedComponents();a.components.is.groupable(c)&&a.multiselect.isMultiselect(c)&&a.groupComponents(c),b.preventDefault()}function l(a,b){var c=a.selection.getSelectedComponents();a.components.is.group(c)&&a.components.ungroup(c),b.preventDefault()}function m(a){a.selectedComponent.duplicate(),a.history.add("component - duplicate")}function n(a){a.selectedComponent.cut(),a.history.add("component - cut")}function o(a,b,c,d){d&&d.preventDefault(),f.moveComponent(a,b,c)}function p(b,c,d,e){return function(){if(c&&d){var f=c.selection.getSelectedComponents(),g=c.bi.getComponentsBIParams(f);a.forEach(g,q.bind(null,e)),a.isEmpty(g)&&e&&g.push(e),c.bi.reportBI(d,g)}return b()}}function q(b,c){a.assign(c,b)}var h={},i=e.editor;return{init:function(a){j(a)},shortcuts:h}}),define("rEditor/rootComps/keyboard/config/previewShortcuts",["util","lodash","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap"],function(a,b,c){"use strict";function e(a){a.preventDefault()}function f(a,b){b.preventDefault(),a.togglePreview()}var d={};return{init:b.once(function(a){d[c.preview.EXIT_PREVIEW.key]=a.togglePreview,d[c.preview.TOGGLE_PREVIEW.key]=f.bind(this,a),d[c.preview.PUBLISH_SITE.key]=e}),shortcuts:d}}),define("rEditor/rootComps/keyboard/config/pinModeShortcuts",["lodash","core","util","panels","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","rEditor/rootComps/keyboard/actions/selectComponentShortcutsActions","rEditor/rootComps/keyboard/util/editorDebugShortcutsUtil"],function(a,b,c,d,e,f,g){"use strict";function j(c){var d=b.bi.events.rightClickMenu,e={};e[i.COPY.key]=k.bind(null,c,d.COPY,{is_component_pinned:1}),e[i.CUT.key]=k.bind(null,c,d.CUT,{is_component_pinned:1}),e[i.DUPLICATE.key]=k.bind(null,c,d.DUPLICATE,{is_component_pinned:1});var f=g(c);a.merge(e,f),a.merge(h,e)}function k(b,c,d){if(b&&c){var e=b.selection.getSelectedComponents(),f=b.bi.getComponentsBIParams(e);a.forEach(f,l.bind(null,d)),a.isEmpty(f)&&d&&f.push(d),b.bi.reportBI(c,f)}}function l(b,c){a.assign(c,b)}var h={},i=e.editor;return{init:function(a){j(a)},shortcuts:h}}),define("rEditor/rootComps/keyboard/config/baseEditorShortcuts",["lodash","core","util","panels","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","rEditor/rootComps/keyboard/actions/selectComponentShortcutsActions","rEditor/rootComps/keyboard/util/editorDebugShortcutsUtil","savePublish"],function(a,b,c,d,e,f,g,h){"use strict";function k(c){var d=b.bi.events.rightClickMenu,e=b.bi.events.editor.undo_redo_component_change,f={};f[j.SELECT_ALL.key]=c.selection.selectAll,f[j.PASTE.key]=v(m.bind(null,c),c,d.PASTE,{origin:"keyboard"}),f[j.UNDO.key]=v(c.history.undo,c,e,{type:"undo",origin:"keyboard"}),f[j.REDO.key]=v(c.history.redo,c,e,{type:"redo",origin:"keyboard"}),f[j.DELETE.key]=v(r.bind(null,c),c,b.bi.events.editor.component_removed,{removal_method:"keyboard"}),f[j.SAVE.key]=n.bind(null,c),f[j.SAVE_AS_TEMPLATE.key]=o.bind(null,c),f[j.SELECT_NEXT_COMP.key]=s.bind(null,c),f[j.SELECT_PREV_COMP.key]=t.bind(null,c),f[j.CLOSE_PANELS.key]=u.bind(null,c),f[j.SEND_TO_FRONT.key]=l.toFront.bind(null,c),f[j.SEND_TO_BACK.key]=l.toBack.bind(null,c),f[j.SEND_FORWARD.key]=l.forward.bind(null,c),f[j.SEND_BACKWARD.key]=l.backward.bind(null,c),f[j.TOGGLE_PREVIEW.key]=q.bind(null,c),f[j.PUBLISH_SITE.key]=p.bind(null,c);var h=g(c);a.merge(f,h),a.merge(i,f)}function m(a){d.panelManager.closeAllPanels(),a.components.paste(),a.history.add("component - paste")}function n(a){h.save(a)}function o(a){h.saveAsTemplate(a,function(){console.log("Saved successfully as Template.")})}function p(a,c){c.preventDefault(),a.bi.event(b.bi.events.publish.PUBLISH_CLICK,{origin:"keyboard"}),h.saveAndPublish(a)}function q(a,c){c.preventDefault(),a.bi.event(b.bi.events.preview.PREVIEW_CLICK,{origin:"keyboard"}),a.togglePreview()}function r(a){a.closeRightClickMenu(),a.closeCompPanelIfExists(),a.selectedComponent.remove(),a.history.add("component - remove")}function s(a){f.selectNextComponent(a)}function t(a){f.selectPreviousComponent(a)}function u(a){var b=d.panelManager,c=b.getOpenPanels();c.length>0?b.closeAllPanelsOfType(["leftPanelFrame","compPanelFrame","focusPanelFrame","messagePanelFrame","pagesPanelFrame","toolPanelFrame","tpaSettingsPanelFrame"]):b.getHelpPanelProps()?b.closeHelpCenter():a.selection.deselectComponents()}function v(b,c,d,e){return function(){if(c&&d){var f=c.selection.getSelectedComponents(),g=c.bi.getComponentsBIParams(f);a.forEach(g,w.bind(null,e)),a.isEmpty(g)&&e&&g.push(e),c.bi.reportBI(d,g)}return b()}}function w(b,c){a.assign(c,b)}var i={},j=e.editor,l={toFront:function(a){var b=a.selection.getSelectedComponents();a.components.arrangement.moveToFront(b)},toBack:function(a){var b=a.selection.getSelectedComponents();a.components.arrangement.moveToBack(b)},forward:function(a){var b=a.selection.getSelectedComponents();a.components.arrangement.moveForward(b)},backward:function(a){var b=a.selection.getSelectedComponents();a.components.arrangement.moveBackward(b)}};return{init:function(a){k(a)},shortcuts:i}}),define("rEditor/rootComps/keyboard/config/shortcutsConfig",["util","lodash","rEditor/rootComps/keyboard/config/topContextShortcuts","rEditor/rootComps/keyboard/config/topBarShortcuts","rEditor/rootComps/keyboard/config/editorShortcuts","rEditor/rootComps/keyboard/config/previewShortcuts","rEditor/rootComps/keyboard/config/pinModeShortcuts","rEditor/rootComps/keyboard/config/baseEditorShortcuts"],function(a,b,c,d,e,f,g,h){"use strict";function j(a,b){return function(){return b(),a.apply(null,arguments)}}function k(a,c){return b.mapValues(a,function(a){return j(a,c)})}function l(a,b){i.registerContext(i.CONTEXTS.TOP_CONTEXT,k(c.shortcuts,b),a);var j=i.extendContext(i.CONTEXTS.TOP_CONTEXT,k(h.shortcuts,b));i.registerContext(i.CONTEXTS.BASE_EDITOR,j,a);var l=i.extendContext(i.CONTEXTS.TOP_CONTEXT,k(f.shortcuts,b));i.registerContext(i.CONTEXTS.PREVIEW,l,a);var m=i.extendContext(i.CONTEXTS.BASE_EDITOR,k(e.shortcuts,b));i.registerContext(i.CONTEXTS.EDITOR,m,a);var n=i.extendContext(i.CONTEXTS.BASE_EDITOR,k(g.shortcuts,b));i.registerContext(i.CONTEXTS.PIN_MODE,n,a);var o=i.extendContext(i.CONTEXTS.EDITOR,k(d.shortcuts,b));i.registerContext(i.CONTEXTS.TOP_BAR,o,a)}var i=a.keyboardShortcuts;return{init:b.once(function(a){c.init(a),f.init(a),h.init(a),g.init(a),e.init(a),d.init(a),l(a,a.closeRightClickMenu)})}}),define("rEditor/rootComps/topBar/config/topBarData.json",[],function(){return{EDIT:[{comp:"WIX_LOGO",orientation:"left"},{comp:"SEPARATOR",orientation:"left"},{comp:"PAGES_LIST",orientation:"left"},{comp:"SEPARATOR",orientation:"left"},{comp:"MENU",orientation:"left"},{comp:"SEPARATOR",orientation:"right"},{comp:"UNDO",orientation:"right"},{comp:"SEPARATOR",orientation:"right"},{comp:"REDO",orientation:"right"},{comp:"REDO_SEPARATOR",orientation:"right"},{comp:"EDITOR_MODE_SWITCH",orientation:"right"},{comp:"SEPARATOR",orientation:"right"},{comp:"SAVE",orientation:"right"},{comp:"SEPARATOR",orientation:"right"},{comp:"PREVIEW",orientation:"right"},{comp:"PUBLISH",orientation:"right"}],PREVIEW:[{comp:"WIX_LOGO",orientation:"left",experiment:"topBarNewPreviewButtons"},{comp:"SEPARATOR",orientation:"left"},{comp:"BIG_BACK_TO_EDITOR",orientation:"left",experiment:"topBarNewPreviewButtons",experimentHint:"remove"},{comp:"MOBILE_NON_OPTIMIZED_NOTIFICATION",orientation:"center"},{comp:"PREVIEW_NOTIFICATION",
orientation:"center"},{comp:"SEPARATOR",orientation:"right"},{comp:"EDITOR_MODE_SWITCH",orientation:"right"},{comp:"SEPARATOR",orientation:"right"},{comp:"PREVIEW_SAVE",orientation:"right"},{comp:"SEPARATOR",orientation:"right"},{comp:"BIG_BACK_TO_EDITOR2",orientation:"right",experiment:"topBarNewPreviewButtons"},{comp:"SMALL_BACK_TO_EDITOR",orientation:"right",experiment:"topBarNewPreviewButtons",experimentHint:"remove"}]}}),define("rEditor/rootComps/topBar/menuBar/config/topBarMenuData.json",[],function(){return[{key:"SITE_BAR",children:[{key:"SAVE",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SAVE",style:{width:192,"min-height":396},title:"TOPBAR_SITE_SAVE_PROMOTION_TITLE",message:"TOPBAR_SITE_SAVE_PROMOTION_TEXT",symbol:"menubarSaveSitePromotion"}}},{key:"PREVIEW",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"PREVIEW",style:{width:192,"min-height":396},title:"TOPBAR_SITE_PREVIEW_PROMOTION_TITLE",message:"TOPBAR_SITE_PREVIEW_PROMOTION_TEXT",symbol:"menubarPreviewSitePromotion"}}},{key:"PUBLISH",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"PUBLISH",style:{width:192,"min-height":396},title:"TOPBAR_SITE_PUBLISH_PROMOTION_TITLE",message:"TOPBAR_SITE_PUBLISH_PROMOTION_TEXT",symbol:"menubarPublishSitePromotion"}}},{key:"VIEW_SITE",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"VIEW-SITE",style:{width:192,"min-height":396},title:"TOPBAR_SITE_VIEW_SITE_PROMOTION_TITLE",message:"TOPBAR_SITE_VIEW_SITE_PROMOTION_TEXT",symbol:"menubarViewPublishedPromotion"}}},{key:"CONNECT_DOMAIN",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"CONNECT-DOMAIN",style:{width:192,"min-height":396},title:"TOPBAR_SITE_CONNECT_PROMOTION_TITLE",message:"TOPBAR_SITE_CONNECT_PROMOTION_TEXT",symbol:"menubarConnectDomainPromotion"}}},{key:"UPGRADE_ITEM",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"UPGRADE",style:{"background-color":"#ebdbf6",width:192,"min-height":396},title:"TOPBAR_SITE_UPGRADE_PROMOTION_TITLE",message:"TOPBAR_SITE_UPGRADE_PROMOTION_TEXT",symbol:"menubarUpgradePromotionLight"}}},{key:"EDITOR_MODE_SWITCH",rightPanel:{DESKTOP:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"MOBILE-SWITCH",style:{width:192,"min-height":396},title:"TOPBAR_SITE_MOBILE_PROMOTION_TITLE",message:"TOPBAR_SITE_MOBILE_PROMOTION_TEXT",symbol:"menubarSwitchToMobilePromotion"}},MOBILE:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"DESKTOP-SWITCH",style:{width:192,"min-height":396},title:"TOPBAR_SITE_DESKTOP_PROMOTION_TITLE",message:"TOPBAR_SITE_DESKTOP_PROMOTION_TEXT",symbol:"menubarSwitchToDesktopPromotion"}}}},{key:"SETTINGS",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SETTINGS",style:{width:192,"min-height":396},title:"TOPBAR_SITE_SETTINGS_PROMOTION_TITLE",message:"TOPBAR_SITE_SETTINGS_PROMOTION_TEXT",symbol:"menubarSiteSettingsPromotion"}}},{key:"REVISIONS",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"REVISIONS",style:{width:192,"min-height":396},title:"TOPBAR_SITE_HISTORY_PROMOTION_TITLE",message:"TOPBAR_SITE_HISTORY_PROMOTION_TEXT",symbol:"menubarSiteHistoryPromotion"}}},{key:"MY_SITES",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"MY-SITES",style:{width:192,"min-height":396},title:"TOPBAR_SITE_MY_SITES_PROMOTION_TITLE",message:"TOPBAR_SITE_MY_SITES_PROMOTION_TEXT",symbol:"menubarMySitesPromotion"}}},{key:"EXIT",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"EXIT-EDITOR",style:{width:192,"min-height":396},title:"TOPBAR_SITE_EXIT_PROMOTION_TITLE",message:"TOPBAR_SITE_EXIT_PROMOTION_TEXT",symbol:"menubarExitEditorPromotion"}}}],rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SAVE",style:{width:192,"min-height":396},title:"TOPBAR_SITE_SAVE_PROMOTION_TITLE",message:"TOPBAR_SITE_SAVE_PROMOTION_TEXT",symbol:"menubarSaveSitePromotion"}}},{key:"VIEW_BAR",children:[{key:"TOOLBAR",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"TOOLBAR",style:{width:192,"min-height":315},title:"TOPBAR_VIEW_TOOLBAR_TITLE",message:"TOPBAR_VIEW_TOOLBAR_BODY",symbol:"menubarToolbarPromotion"}}},{key:"GUIDELINES",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"GUIDELINES",style:{width:192,"min-height":315},title:"TOPBAR_VIEW_GRIDLINES_TITLE",message:"TOPBAR_VIEW_GRIDLINES_BODY",symbol:"menubarRulersPromotion"}}},{key:"SNAP",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SNAP",style:{width:192,"min-height":315},title:"TOPBAR_VIEW_SNAP_TITLE",message:"TOPBAR_VIEW_SNAP_BODY",symbol:"menubarSnapToObjectPromotion"}}}],rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"TOOLBAR",style:{width:192,"min-height":315},title:"TOPBAR_VIEW_TOOLBAR_TITLE",message:"TOPBAR_VIEW_TOOLBAR_BODY",symbol:"menubarToolbarPromotion"}}},{key:"HELP_BAR",children:[{key:"HELP_CENTER",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"HELP-CENTER",style:{width:192,"min-height":297},classes:{graphics:"graphics-help-center"},title:"TOPBAR_HELP_CENTER_PROMOTION_TITLE",message:"TOPBAR_HELP_CENTER_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}},{key:"HELP_KB_SHORTCUTS",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"KB-SHORTCUTS",style:{width:192,"min-height":297},classes:{graphics:"graphics-help-center"},title:"TOPBAR_HELP_QUESTION_PROMOTION_TITLE",message:"TOPBAR_HELP_QUESTION_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}},{key:"HELP_CONNECT_DOMAIN",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"CONNECT-DOMAIN",style:{width:192,"min-height":297},classes:{graphics:"graphics-help-center"},title:"TOPBAR_HELP_CONNECT_PROMOTION_TITLE",message:"TOPBAR_HELP_CONNECT_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}},{key:"HELP_SEO",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"SEO",style:{width:192,"min-height":297},classes:{graphics:"graphics-help-center"},title:"TOPBAR_HELP_SEO_PROMOTION_TITLE",message:"TOPBAR_HELP_SEO_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}},{key:"HELP_FEEDBACK",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"FEEDBACK",style:{width:192,"min-height":297},classes:{graphics:"graphics-help-center"},title:"Topbar_HELP_FEEDBACK_PROMOTION_TITLE",message:"Topbar_HELP_FEEDBACK_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}}],rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"HELP-CENTER",style:{width:192,"min-height":297},classes:{graphics:"graphics-help-center"},title:"TOPBAR_HELP_CENTER_PROMOTION_TITLE",message:"TOPBAR_HELP_CENTER_PROMOTION_TEXT",symbol:"menubarHelpCenterPromotion"}}},{category:"UPGRADE",upgradePanels:{DEFAULT:{key:"UPGRADE",rightPanel:{type:"rEditor.panels.topBar.promotionPanel",props:{menuKey:"UPGRADE-POPUP","class":"right-check-panel-upgrade",style:{"background-color":"transparent",width:131,padding:"25px 0"},symbol:"menubarUpgradePromotionDark"}}}}}]}),define("rEditor/rootComps/topBar/topBarExperimentHelper",["lodash"],function(a){"use strict";function b(d,e){if(a.isArray(d)){for(var f=[],g=0;g<d.length;g++){var h=b(d[g],e);h&&f.push(h)}return f}return a.isObject(d)?c(d,e)?null:(a.forEach(d,function(a,c){d[c]=b(a,e)}),d):d}function c(b,c){var d=!a.isEmpty(b.experiment),e=!!c[b.experiment],f=d&&!e&&"remove"!==b.experimentHint,g=d&&e&&"remove"===b.experimentHint;return g||f}return{fixJsonExperimentalEntries:b}}),define("rEditor/rootComps/topBar/buttons/mixins/topBarButtonProgressMixin",["savePublish"],function(a){"use strict";return{isInProgress:function(){return this.props.progressStatus===a.status.IN_PROGRESS},isProgressDone:function(){return this.isDoneSuccessfully()||this.isDoneUnSuccessfully()},isDoneSuccessfully:function(){return this.props.progressStatus===a.status.DONE_SUCCESS},isDoneUnSuccessfully:function(){return this.props.progressStatus===a.status.DONE_FAILED}}}),define("rEditor/rootComps/topBar/buttons/mixins/topBarTooltipMixin",["react","baseUI"],function(a,b){"use strict";var c=b.tooltipManager;return{getTooltipElement:function(){var b=this.props.tooltipData;return b&&b.presenter?a.createElement(b.presenter,b.props):b||!1},getTooltipInteractiveMode:function(){var a=this.props.tooltipData;return a&&a.interactive},hideTooltip:function(a){var b=a||this.props.tooltipData&&this.props.tooltipData.id;c.hide(b)}}}),define("rEditor/rootComps/topBar/dropPanels/topBarDropPanel.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{className:"top-bar-drop-panel "+(this.props.dropPanelClass||"")},a.createElement("div",{className:"drop-panel-left-side"},this.getLeftContent()),this.hasRightContent()?a.createElement("div",{className:"drop-panel-right-side",key:"rightContent"},this.getRightContent()):null,this.props.bottomContent?a.createElement("div",{className:"drop-panel-bottom-side",key:"bottomContent"},this.props.bottomContent):null)}}),define("rEditor/rootComps/topBar/dropPanels/topBarDropPanel",["react","jquery","lodash","util","rEditor/rootComps/topBar/dropPanels/topBarDropPanel.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"topBarDropPanel",propTypes:{leftContent:a.PropTypes.object.isRequired,bottomContent:a.PropTypes.object,rightContentOptions:a.PropTypes.object,dropPanelClass:a.PropTypes.string,closeHandle:a.PropTypes.func},getInitialState:function(){return{displayedRightContentKey:"main"}},componentWillReceiveProps:function(a){var b=c.keys(this.props.rightContentOptions),d=c.keys(a.rightContentOptions),e=c.intersection(d,b);e.length!==b.length&&this.setState({displayedRightContentKey:"main"})},getLeftContent:function(){return a.addons.cloneWithProps(this.props.leftContent,{onMenuItemHover:this.onSubMenuItemHover,closeDropDownHandle:this.props.closeHandle})},getRightContent:function(){return this.props.rightContentOptions[this.state.displayedRightContentKey]},hasRightContent:function(){return!!this.props.rightContentOptions},onSubMenuItemHover:function(a){a.rightPanel&&this.setState({displayedRightContentKey:a.key})},render:e})}),define("rEditor/rootComps/topBar/buttons/topBarButton/topBarButton.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(d){var e=this.isDoneSuccessfully();return a.createElement("div",{className:"wrapper-to-perserve-ref"},a.createElement(c.button2,{key:"buttonContent",label:this.props.label,style:this.props.buttonStyle,symbolName:this.props.iconSymbol,customLabelClass:"top-bar-button-label",className:b.keys(b.pick({"top-bar-button-content":!0,"icon-and-label":this.props.iconSymbol&&this.props.label,invisible:e},b.identity)).join(" "),onClick:this.onClick,onMouseOver:this.handleMouseOverButton,onMouseLeave:this.handleMouseLeftButton}),e?a.createElement(c.symbol,{key:"successSymbol",name:"topBarButtonVSign",className:"button-symbol vSign"}):null,this.isInProgress()?a.createElement("div",{key:"progressIndicator",className:"progress-indicator"}):null)}function e(){var b=this.getTooltipElement();return a.createElement(c.tooltip,{id:this.props.tooltipData&&this.props.tooltipData.id,value:b,interactive:this.getTooltipInteractiveMode(),disabled:!b},d.apply(this,[b]))}return function(){return a.createElement("div",{className:this.getClasses(),style:this.props.style},e.apply(this,[]),this.state.isDropDownDisplayed?a.createElement(c.bubble,b.assign({},{key:"topBarButtonDropDown"},this.getDropDownProps())):null)}}),define("rEditor/rootComps/topBar/buttons/topBarButton/topBarButton",["react","lodash","core","baseUI","rEditor/rootComps/topBar/buttons/mixins/topBarButtonProgressMixin","rEditor/rootComps/topBar/buttons/mixins/topBarTooltipMixin","rEditor/rootComps/topBar/dropPanels/topBarDropPanel","rEditor/rootComps/topBar/buttons/topBarButton/topBarButton.rt"],function(a,b,c,d,e,f,g,h){"use strict";return a.createClass({displayName:"topBarButton",mixins:[a.addons.PureRenderMixin,e,c.mixins.editorAPIMixin,c.mixins.biMixin,f],propTypes:{label:a.PropTypes.string,classes:a.PropTypes.string,iconSymbol:a.PropTypes.string,dropPanelProps:a.PropTypes.object,actions:a.PropTypes.array,bi:a.PropTypes.oneOfType([a.PropTypes.array,a.PropTypes.object]),biFunc:a.PropTypes.func,progressStatus:a.PropTypes.string,isDisabled:a.PropTypes.bool,onMenuOpened:a.PropTypes.func,onMenuClosed:a.PropTypes.func,buttonStyle:a.PropTypes.object},getInitialState:function(){return{isDropDownDisplayed:!1,isMouseOverButton:!1}},getDefaultProps:function(){return{buttonStyle:{}}},getClasses:function(){var a="top-bar-button "+this.props.classes;return this.state.isDropDownDisplayed&&(a+=" top-bar-button-selected"),(this.isInProgress()||this.props.isDisabled)&&(a+=" disabled-button"),a},onClick:function(){if(!this.props.isDisabled){this.props.dropPanelContent&&this.toggleDropDown(),this.hideTooltip();var a=this.getEditorAPI(),c=a.selection.getSelectedComponents(),d=a.bi.getComponentsBIParams(c);this.props.actions&&b.each([].concat(this.props.actions),function(a){a()}),this.sendButtonBI(d)}},handleMouseOverButton:function(){this.setState({isMouseOverButton:!0})},handleMouseLeftButton:function(){this.setState({isMouseOverButton:!1})},getDropDownId:function(){return"top-bar-dropdown-"+(this.props.label||this.props.iconSymbol)},getDropDownProps:function(){if(!this.isMounted())return{};var a=this.getDropDownContent();return{id:this.getDropDownId(),value:a,width:"1000px",interactive:!0,closeTriggers:[d.uiConstants.TOOLTIP.TRIGGERS.MOUSE_LEAVE],className:"top-bar-drop-down",overridePositionAdjustments:this.props.dropPanelProps&&this.props.dropPanelProps.overridePositionAdjustments,targetNode:this.getDOMNode(),hideMethod:this.handleDropDownWantsToClose,mouseLeftTargetNode:!this.state.isMouseOverButton,timeoutForMouseOverBubble:500}},getDropDownContent:function(){var b=this.getDropPanelLeftContent(),c={main:this.getDropPanelRightContent()};return b?a.createElement(g,{closeHandle:this.closeDropDown,leftContent:b,rightContentOptions:c}):null},getDropPanelLeftContent:function(){var b=this.props.dropPanelContent,c=this.props.dropPanelProps;return b?(c.closeHandle=this.closeDropDown,a.createElement(b,this.props.dropPanelProps)):null},getDropPanelRightContent:function(){var d=this.props.dropPanelProps&&this.props.dropPanelProps.dropPanelPromotion;if(d){var e=b.cloneDeep(d.props);return e=b.merge({moduleName:d.type},e),a.DOM.div({className:d.classes},[a.createElement(c.lazyComponent,e)])}return null},openDropDown:function(){this.setState({isDropDownDisplayed:!0,isMouseOverButton:!0}),this.props.onMenuOpened&&this.props.onMenuOpened()},closeDropDown:function(){this.setState({isDropDownDisplayed:!1}),this.props.onMenuClosed&&this.props.onMenuClosed()},toggleDropDown:function(){this.state.isDropDownDisplayed?this.closeDropDown():this.openDropDown()},handleDropDownWantsToClose:function(){this.isMounted()&&!this.state.isMouseOverButton&&this.closeDropDown()},sendButtonBI:function(a){if(this.props.bi){var c=[].concat(this.props.bi);b.forEach(c,function(a){a.type&&this.sendBI(a.type,a.fields)},this)}this.props.biFunc&&this.props.biFunc(a)},render:h})}),define("rEditor/utils/menuItemsRepository",["lodash","pagesMenu"],function(a,b){"use strict";function c(b,c,d,f){return c&&c.items&&c.items.length>0?c.items.map(a.partial(e,b),a.defaults({parent:f},d)):[]}function d(b){var c=b.pages.getPagesData(),d={},e=[];return a.forEach(c,function(a){var b=a.tpaApplicationId;return b?void(d[b]?1===d[b]&&(d[b]+=1,e.push(b)):d[b]=1):!0}),e}function e(d,e,f,g){var h=b.pageMenuItemHelpers.getPageMenuItemWithoutChildren(d,e,this);return a.extend(h,{position:f,previousMenuItem:g[f-1],previousVisibleMenuItem:a(g).slice(0,f).findLast(function(a){return a.isVisible===!0}),isCollapsed:n(e.id)}),h.items=c(d,e,this,h),h.isCollapsed&&h.items.length<1&&(h.isCollapsed=!1,o(h.id,!1)),h}function f(b){return b.type.isPage&&(b.pageData.isTpaSubPage||b.pageData.isBlogSubPage)?!1:(b.items&&b.items.length&&(b.items=a.filter(b.items,f)),b)}function g(a,b){return b.type.isPage&&b.pageData.isTpaSubPage&&b.pageData.tpaApplicationId===a?!0:!1}function h(a){return a.type.isPage&&a.pageData.isBlogSubPage?!0:!1}function i(a,b){return b.type.isPage&&b.pageData.isTpaSectionPage&&b.pageData.tpaApplicationId===a?!0:!1}function j(a){return a.type.isPage&&a.pageData.isBlogFeedPage?!0:!1}function k(b,c){if(!c)return void 0;c=c.toLowerCase();var d=function(a){return 0===a.label.toLowerCase().indexOf(c)},e=function(b){var c;return a.forEach(b,function(a){if(d(a))return c=a,!1;var b=e(a.items);return b?(c=b,!1):void 0}),c};return e(b)}function l(b,c){c=c.toLowerCase();var d=function(a){return-1!==a.label.toLowerCase().indexOf(c)},e=function(b){if(!b||0===b.length)return b;var c=[];return a.forEach(b,function(b){var f=d(b),g=e(b.items),h=g&&g.length>0;if(f||h){var i=a.clone(b,!1);i.items=g,c.push(i)}}),c};return e(b)}function n(a){return m.hasOwnProperty(a)?m[a]:!1}function o(a,b){m[a]=Boolean(b)}function p(b,c){var d=b.mainMenu.getMenu();return a.find(d,function(a){return a&&a.id===c})}function q(b){return b.concat(a.flattenDeep(a.pluck(b,"items")))}function r(b){return b.mainMenu.getMenu().map(a.partial(e,b),{parent:null,homePageId:b.homePage.get(),tpaSectionIds:d(b)})}var m={};return{getAllFlattenMenuItems:function(a){return q(r(a))},getDesktopMenuItems:function(b){return a.filter(r(b),f)},findFirstFilteredItem:k,filterItems:l,getMenuSubItems:function(a,b){var d=p(a,b.id);return c(a,d,{parent:d,homePageId:a.homePage.get()})},getMenuTpaSubItems:function(b,c){return a.filter(q(r(b)),a.partial(g,c))},getMenuBlogSubItems:function(b){return a.filter(q(r(b)),h)},getMenuTpaSectionItem:function(b,c){return a.find(q(r(b)),a.partial(i,c))},getMenuBlogFeedItem:function(b){return a.find(q(r(b)),j)},setMenuItemCollapsed:o}}),define("rEditor/rootComps/topBar/buttons/pagesNavButton/pagesNavButton.rt",["react/addons","lodash","util","baseUI"],function(a,b,c,d){"use strict";function e(){var b=this.getTooltipElement();return a.createElement(d.tooltip,{id:"pageNavButtonTooltip",value:b,interactive:this.getTooltipInteractiveMode(),disabled:!b||this.state.isFiltering},a.createElement("div",{className:this.props.classes+(this.state.isFiltering?"":" pages-nav-button-bg")+"\n                "+(this.props.isSmallVersion?"mini-":"")+"page-nav-with-label",onClick:this.onClick},this.state.isFiltering?null:a.createElement("div",{key:"page-name",className:"top-bar-page-navigation-select",style:{height:"100%"}},this.props.isSmallVersion?null:a.createElement("div",{key:"graphics",className:"page-navigation-button-graphics"},a.createElement(d.symbol,{name:"pages"})),a.createElement("span",{className:(this.props.isSmallVersion?"mini-":"")+"top-bar-page-navigation-pageName"},this.props.isSmallVersion?"":c.translate("Pages_Menu_Title_Title")+":"," ",this.getPageName()),this.props.isSmallVersion?null:a.createElement("span",{key:"arrow",className:"top-bar-page-navigation-arrow"},a.createElement(d.symbol,{name:"pagesArrow"}))),this.state.isFiltering?a.createElement("div",{key:"page-filter",className:"top-bar-page-navigation-select"},a.createElement("div",{className:"page-navigation-button-graphics"},a.createElement(d.symbol,{name:"pagesSearch"})),a.createElement(d.autoCompleteTextInput,{ref:"filterInput",className:"top-bar-page-filter",placeholder:c.translate("TOPBAR_FIND_PAGE"),cancelIcon:"topBarButtonCancel",complete:this.completePageName,onChange:this.filterChanged,onKeyDown:this.onKeyDown})):null))}return function(){return e.apply(this,[])}}),define("rEditor/rootComps/topBar/buttons/pagesNavButton/pagesNavButton",["lodash","react","core","panels","rEditor/rootComps/topBar/buttons/mixins/topBarTooltipMixin","rEditor/utils/menuItemsRepository","rEditor/rootComps/topBar/buttons/pagesNavButton/pagesNavButton.rt"],function(a,b,c,d,e,f,g){"use strict";function j(){return this.getEditorAPI().isDesktopEditor()?i:h}var h="rEditor.panels.pagesPanelMobile",i="rEditor.panels.pagesPanel";return b.createClass({displayName:"topBarPageNavButton",propTypes:{isSmallVersion:b.PropTypes.bool,bi:b.PropTypes.object,tooltipData:b.PropTypes.object,clickCallback:b.PropTypes.func},mixins:[c.mixins.editorAPIMixin,c.mixins.biMixin,e],keyCodes:{ENTER:13,ESC:27},getInitialState:function(){return{isFiltering:!1,filter:""}},completePageName:function(a){var b=f.getDesktopMenuItems(this.getEditorAPI()),c=f.findFirstFilteredItem(b,a);return c?c.label:null},getPageName:function(){return this.getEditorAPI().pages.getCurrentPageTitle()},onClick:function(){this.props.clickCallback&&this.props.clickCallback(),this.openFilteredPagesPanel()},openFilteredPagesPanel:function(){this.openWithFilter(this.state.filter),this.hideTooltip("pageNavButtonTooltip"),this.props.bi&&this.props.bi.type&&this.sendBI(this.props.bi.type,this.props.bi.fields)},filterChanged:function(a){this.openWithFilter(a)},openWithFilter:function(a){this.setState({isFiltering:!0,filter:a}),this.openPagesPanel(a)},navigateToFirst:function(){var a=f.getDesktopMenuItems(this.getEditorAPI()),b=f.findFirstFilteredItem(a,this.state.filter);b&&b.pageData&&(this.getEditorAPI().pages.navigateTo(b.pageData.id),this.closePagesPanel(),this.closeFiltering())},closeFiltering:function(){this.setState({isFiltering:!1,filter:""})},onKeyDown:function(a){a.keyCode===this.keyCodes.ENTER&&this.state.filter?this.navigateToFirst():a.keyCode===this.keyCodes.ESC&&(this.closePagesPanel(),this.closeFiltering())},componentWillReceiveProps:function(){this.isPagesPanelOpen()||this.closeFiltering()},componentDidUpdate:function(a,b){this.state.isFiltering&&!b.isFiltering&&this.refs.filterInput.focus()},isPagesPanelOpen:function(){var b=d.panelManager.getOpenPanels();return!!a.find(b,{name:j.call(this)})},openPagesPanel:function(b){var c=d.panelManager.getOpenPanels(),e=j.call(this),f={filter:b,pageAdded:function(){this.closeFiltering(),this.openPagesPanel("")}.bind(this),subpagesOpened:function(){this.closeFiltering()}.bind(this)};a.find(c,{name:e})?d.panelManager.updatePanelProps(e,f):d.panelManager.openPanel(e,f)},closePagesPanel:function(){var b=d.panelManager.getOpenPanels(),c=j.call(this);a.find(b,{name:c})&&d.panelManager.closePanelByName(c)},render:g})}),define("rEditor/rootComps/topBar/buttons/topBarButtonsCommons",["lodash"],function(a){"use strict";function b(b){b&&a.each([].concat(b),function(a){a()})}return{executeActions:b}}),define("rEditor/rootComps/topBar/buttons/topBarThumbButton/topBarThumbButton.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(d){var e=this.props.right;return a.createElement("div",{className:this.getClasses(),onClick:this.executeAction},a.createElement("span",{className:b.keys(b.pick({label:!0,"label-left-padding":!e,"label-right-padding":e},b.identity)).join(" "),style:{visibility:this.isDoneSuccessfully()?"hidden":"visible"}},"\n            ",this.props.label,"\n        "),this.isDoneSuccessfully()?a.createElement(c.symbol,{key:"successSymbol",name:"topBarButtonVSign",className:"button-symbol vSign"}):null,a.createElement("div",{className:b.keys(b.pick({thumb:!0,"thumb-left":!e,"thumb-right":e},b.identity)).join(" ")}),this.isInProgress()?a.createElement("div",{key:"progressIndicator",className:"progress-indicator"}):null)}function e(){var b=this.getTooltipElement();return a.createElement(c.tooltip,{value:b,interactive:this.getTooltipInteractiveMode(),disabled:!b},d.apply(this,[b]))}return function(){return e.apply(this,[])}}),define("rEditor/rootComps/topBar/buttons/topBarThumbButton/topBarThumbButton",["react","lodash","core","rEditor/rootComps/topBar/buttons/topBarButtonsCommons","rEditor/rootComps/topBar/buttons/mixins/topBarButtonProgressMixin","rEditor/rootComps/topBar/buttons/mixins/topBarTooltipMixin","rEditor/rootComps/topBar/buttons/topBarThumbButton/topBarThumbButton.rt"],function(a,b,c,d,e,f,g){"use strict";return a.createClass({displayName:"thumbButton",mixins:[e,c.mixins.editorAPIMixin,c.mixins.biMixin,f],propTypes:{progressStatus:a.PropTypes.string,isDisabled:a.PropTypes.bool},getClasses:function(){var a="thumb-button "+this.props.classes;return(this.isInProgress()||this.isProgressDone()||this.props.isDisabled)&&(a+=" disabled-button"),a},executeAction:function(){this.props.isDisabled||this.isInProgress()||(d.executeActions(this.props.actions),this.props.bi&&this.props.bi.type&&this.sendBI(this.props.bi.type,this.props.bi.fields))},render:g})}),define("rEditor/rootComps/topBar/buttons/backToEditorExButton/backToEditorExButton.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(){var b=this.getTooltipElement();return a.createElement(c.tooltip,{value:b,interactive:this.getTooltipInteractiveMode(),disabled:!b},a.createElement("div",{className:this.props.classes+" back-to-editor-ex-button",onClick:this.executeAction},a.createElement("div",{className:"button-line top-left-bottom-right"}),a.createElement("div",{className:"button-line top-right-bottom-left"})))}return function(){return d.apply(this,[])}}),define("rEditor/rootComps/topBar/buttons/backToEditorExButton/backToEditorExButton",["react","lodash","core","rEditor/rootComps/topBar/buttons/topBarButtonsCommons","rEditor/rootComps/topBar/buttons/mixins/topBarTooltipMixin","rEditor/rootComps/topBar/buttons/backToEditorExButton/backToEditorExButton.rt"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"backToEditorExButton",propType:{bi:a.PropTypes.object,tooltipData:a.PropTypes.object},mixins:[c.mixins.editorAPIMixin,c.mixins.biMixin,e],executeAction:function(){d.executeActions(this.props.actions),this.props.bi&&this.props.bi.type&&this.sendBI(this.props.bi.type,this.props.bi.fields)},render:f})}),define("rEditor/rootComps/topBar/buttons/topBarNotification/topBarNotification.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return this.props.isShown?a.createElement("div",{key:"topBarNotification",className:this.props.classes+" top-bar-notification"},a.createElement("div",{},this.getMessage())):null}}),define("rEditor/rootComps/topBar/buttons/topBarNotification/topBarNotification",["react","rEditor/rootComps/topBar/buttons/topBarNotification/topBarNotification.rt"],function(a,b){"use strict";return a.createClass({displayName:"topBarNotification",propTypes:{message:a.PropTypes.string},emptyMessage:["","",""],getMessage:function(){var b=this.getMessageParts(),c=this.getMessageLinkPart(b[1]);return a.createElement("div",{},[b[0],c,b[2]])},getMessageParts:function(){var a=this.props.message;if(a){var b=this.getAnchorIndexes(a),c=a.substring(0,b[0]),d=a.substring(b[1]+"</a>".length),e=a.substring(b[0]+"<a>".length,b[1]);return[c,e,d]}return this.emptyMessage},getAnchorIndexes:function(a){if(!a)return[0,0];var b=a.indexOf("<a>"),c=a.indexOf("</a>");return(0>b||0>c)&&(b=a.length,c=a.length),[b,c]},getMessageLinkPart:function(b){return b?a.DOM.a({onClick:this.linkAction},b):""},linkAction:function(){this.props.action()},render:b})}),define("rEditor/rootComps/topBar/menuBar/menuBarPanelsDefinitions",["lodash","core","util","savePublish"],function(a,b,c,d){"use strict";function h(b,d){var e=b.campaigns.personalSale.getDiscountValue(),f=a.template(c.translate(d));return f({discount:e})}function i(a){var b=null,c=o(a);return b=c?j(a):m(a)}function j(a){return null===e&&(e=[{buttonText:c.translate("TOPBAR_UPGRADE_BUTTON_SAVE_SITE"),action:function(){d.save(a)}}]),e}function k(a){var b="TOPBAR_UPGRADE_FREE_ROW_BUTTON_1",d="";return d=a.campaigns.personalSale.isActiveCampaign()?h(a,"TOPBAR_UPGRADE_POPUP_PERSONAL_SALE_BUTTON_DYNAMIC"):c.translate("TOPBAR_UPGRADE_FREE_ROW_BUTTON_2"),{offerButtonText:d,leftButtonText:c.translate(b)}}function l(a){var b="edhtml_TOP_BAR_UPGRADE_MENU_GET_YEARLY_UNLIMITED";return a.campaigns.personalSale.isActiveCampaign()&&(b="edhtml_TOP_BAR_UPGRADE_MENU_PERSONAL_SALE"),b}function m(a){if(null===f){var c=b.bi.events.topbar,d=k(a),e=l(a);f=[{buttonText:d.leftButtonText,action:n.bind(null,a,c.top_bar_compare_plans_click,"edhtml_TOP_BAR_UPGRADE_MENU_COMPARE_PLANS")},{buttonText:d.offerButtonText,action:n.bind(null,a,c.top_bar_get_yearly_unlimited_click,e)}]}return f}function n(a,b,c){a.bi.event(b),a.account.upgrade(c)}function o(a){return a&&a.generalInfo&&a.generalInfo.isFirstSave()}function p(a,b){b=b||"left",a=r(a);var c=g[a];return c&&c[b]?c[b].panel:null}function q(a,b,c){c=c||"left",a=r(a);var d=g[a];return d&&d[c]?d[c].propsGetter(b):null}function r(b){return a.contains(["SITE_BAR","EDIT_BAR","VIEW_BAR","HELP_BAR"],b)?"ACTIONS_PANEL":b}var e=null,f=null,g={ACTIONS_PANEL:{left:{panel:"rEditor.panels.topBar.menuActionsPanel",propsGetter:function(){return{}}}},UPGRADE:{left:{panel:"rEditor.panels.topBar.checkListPanel",propsGetter:function(b){var d=o(b),e="";return e=b.campaigns.personalSale.isActiveCampaign()?h(b,"TOPBAR_UPGRADE_POPUP_PERSONAL_SALE_LABEL_DYNAMIC"):c.translate("TOPBAR_UPGRADE_FREE_US_TITLE"),{type:"upgrade","class":"left-check-panel-upgrade",title:e,comment:d?c.translate("TOPBAR_UPGRADE_SAVE_FIRST_TEXT"):null,description:a.map(["TOPBAR_UPGRADE_FREE_US_LINE_1","TOPBAR_UPGRADE_FREE_US_LINE_2","TOPBAR_UPGRADE_FREE_US_LINE_3","TOPBAR_UPGRADE_FREE_US_LINE_4"],c.translate)}}},bottom:{panel:"rEditor.panels.topBar.checkListPanel",propsGetter:function(a){var b=i(a);return{type:"upgrade","class":"bottom-check-panel-upgrade",footerButtons:b}}}}};return{getMenuPanelProps:q,getMenuPanelType:p}}),define("rEditor/rootComps/topBar/dropPanels/content/menuBarContent.rt",["react/addons","lodash","core"],function(a,b,c){"use strict";function d(){var d=this.getPanelProps(),e=this.getPanelClass();return a.createElement("div",{},a.createElement(c.lazyComponent,b.assign({},{moduleName:e},d)))}return function(){return a.createElement("div",{},this.props.selectedMenu?a.createElement("div",{key:"menuActions"},d.apply(this,[])):null)}}),define("rEditor/rootComps/topBar/dropPanels/content/menuBarContent",["lodash","react","rEditor/rootComps/topBar/menuBar/menuBarPanelsDefinitions","rEditor/rootComps/topBar/dropPanels/content/menuBarContent.rt"],function(a,b,c,d){"use strict";return b.createClass({displayName:"menuBarContent",propTypes:{content:b.PropTypes.string.isRequired,editorAPI:b.PropTypes.object.isRequired,closeDropDownHandle:b.PropTypes.func},getPanelProps:function(){var b=null,d=this.props.selectedMenu.key;if(d){b=a.clone(this.props);var e=c.getMenuPanelProps(d,this.props.editorAPI,this.props.content);b=a.merge(b,e)}return b},getPanelClass:function(){var a=this.props.selectedMenu.key;return a?c.getMenuPanelType(a,this.props.content):null},render:d})}),define("rEditor/rootComps/topBar/dropPanels/content/menuBarRightContent.rt",["react/addons","lodash","core"],function(a,b,c){"use strict";return function(){return this.props.panel?a.createElement("div",{className:"promotion",key:"promotionPanel"},a.createElement(c.lazyComponent,b.assign({},{moduleName:this.props.panel.type},b.merge(this.props.panel.props,{editorAPI:this.props.editorAPI,action:this.props.action,bi:this.props.bi})))):null}}),define("rEditor/rootComps/topBar/dropPanels/content/menuBarRightContent",["react","rEditor/rootComps/topBar/dropPanels/content/menuBarRightContent.rt"],function(a,b){"use strict";return a.createClass({displayName:"menuBarRightContent",render:b})}),define("rEditor/rootComps/topBar/buttons/openClose/openCloseButton.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{className:"open-close-menu-button",onClick:this.props.action},a.createElement("div",{className:b.keys(b.pick({stripe:!0,topAnim:this.props.isOpen},b.identity)).join(" ")}),a.createElement("div",{className:b.keys(b.pick({stripe:!0,middleAnim:this.props.isOpen},b.identity)).join(" ")}),a.createElement("div",{className:b.keys(b.pick({stripe:!0,bottomAnim:this.props.isOpen},b.identity)).join(" ")}))}}),define("rEditor/rootComps/topBar/buttons/openClose/openCloseButton",["react","rEditor/rootComps/topBar/buttons/openClose/openCloseButton.rt"],function(a,b){
"use strict";return a.createClass({displayName:"openCloseButton",render:b})}),define("rEditor/rootComps/topBar/menuBar/menuBar.rt",["react/addons","lodash","rEditor/rootComps/topBar/buttons/openClose/openCloseButton","experiment!menuBarClosed","baseUI"],function(a,b,c,d,e){"use strict";function f(a,b){this.onMouseOverMenuItem(b)}function g(b,c){return a.createElement("li",{ref:"menuItem"+c,className:this.getMenuItemClasses(b.key,c),key:b.key,onMouseOver:f.bind(this,b,c)},a.createElement("a",{},this.getMenuItemLabel(b.key)))}return function(){return a.createElement("div",{ref:"menuBar",className:this.props.classes},a.createElement.apply(this,["ul",{className:b.keys(b.pick({"menubar-items":!0},b.identity)).join(" "),onMouseLeave:this.onMouseLeave},b.map(this.props.menuItems,g.bind(this))]),null!==this.state.indexOfOpenMenu?a.createElement(e.bubble,b.assign({},{key:"menuBarDropDown"},this.getDropDownProps())):null)}}),define("rEditor/rootComps/topBar/menuBar/menuBar",["react","lodash","core","util","baseUI","rEditor/rootComps/topBar/buttons/mixins/topBarTooltipMixin","rEditor/rootComps/topBar/menuBar/menuBarItemsDefinitions","rEditor/rootComps/topBar/dropPanels/content/menuBarContent","rEditor/rootComps/topBar/dropPanels/content/menuBarRightContent","rEditor/rootComps/topBar/dropPanels/topBarDropPanel","rEditor/rootComps/topBar/menuBar/menuBar.rt"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function n(c,d,e){var f;return f=d.isMobileEditor()?c.MOBILE||c:c.DESKTOP||c,a.createElement(i,b.assign({panel:f,editorAPI:d},e))}var l=100,m=500;return a.createClass({displayName:"menuBar",mixins:[c.mixins.editorAPIMixin],propTypes:{menuItems:a.PropTypes.array.isRequired,viewTools:a.PropTypes.object.isRequired,tooltipData:a.PropTypes.object,isMenuBarClosedExperiment:a.PropTypes.bool,onMenuOpened:a.PropTypes.func,onMenuClosed:a.PropTypes.func},getInitialState:function(){return{indexOfOpenMenu:null,mouseOverMenu:!1}},componentDidMount:function(){this.registerKeyboardShortcuts()},componentWillUnmount:function(){d.keyboardShortcuts.unregisterContext(d.keyboardShortcuts.CONTEXTS.MENU_BAR),this.isMenuBarKeyboardContextActive()&&d.keyboardShortcuts.setContext(this.lastKeyboardContext)},componentDidUpdate:function(a,b){var c=this.state.indexOfOpenMenu!==b.indexOfOpenMenu&&null===this.state.indexOfOpenMenu,e=this.state.indexOfOpenMenu!==b.indexOfOpenMenu&&null===b.indexOfOpenMenu;c?(d.keyboardShortcuts.getContext()===d.keyboardShortcuts.CONTEXTS.MENU_BAR&&d.keyboardShortcuts.setContext(this.lastKeyboardContext),this.props.onMenuClosed&&this.props.onMenuClosed()):e&&this.props.onMenuOpened&&this.props.onMenuOpened()},isMenuBarKeyboardContextActive:function(){return d.keyboardShortcuts.getContext()===d.keyboardShortcuts.CONTEXTS.MENU_BAR},getMenuItemClasses:function(a,b){var c=[];return a=a&&a.toLowerCase()||"",c.push("upgrade"!==a?"menu-bar-title":"menu-bar-upgrade-title"),"help"===a&&c.push("top-bar-help-title"),b===this.state.indexOfOpenMenu&&c.push("menu-bar-selected-item"),c.join(" ")},getMenuItemLabel:function(a){return g[a].label},getNumberOfMenuItems:function(){return this.props.menuItems.length},getDropDownProps:function(){var a=this.state.indexOfOpenMenu;return this.isMounted()?{value:this.getDropDownContent(a),width:"1000px",closeTriggers:this.getDropDownTooltipCloseTriggers(),className:"top-bar-drop-down",overridePositionAdjustments:{type:e.uiConstants.TOOLTIP.ALIGNMENT.LEFT,value:70},targetNode:this.refs["menuItem"+a].getDOMNode(),hideMethod:this.handleDropDownWantsToClose,mouseLeftTargetNode:!this.state.mouseOverMenu,timeoutForMouseOverBubble:m}:{}},handleDropDownWantsToClose:function(){this.isMounted()&&!this.state.mouseOverMenu&&this.setState({indexOfOpenMenu:null})},getDropDownTooltipCloseTriggers:function(){return[e.uiConstants.TOOLTIP.TRIGGERS.MOUSE_LEAVE]},getDropDownContent:function(b){var c=this.getDropDownBottomContent(b),d=this.getDropDownLeftContent(b,this.props.viewTools),e=this.getMenuRightContentOptions(b);return a.createElement(j,{closeHandle:this.closeDropDown,bottomContent:c,leftContent:d,rightContentOptions:e,dropPanelClass:"menubar-drop-panel"})},getDropDownBottomContent:function(b){var c=this.props.menuItems[b];return a.createElement(h,{content:"bottom",selectedMenu:c,closeDropDownHandle:this.closeDropDown,editorAPI:this.getEditorAPI()})},getDropDownLeftContent:function(b,c){var d=this.props.menuItems[b];return a.createElement(h,{content:"left",selectedMenu:d,action:g[d.key].action,viewTools:c,closeDropDownHandle:this.closeDropDown,editorAPI:this.getEditorAPI()})},getMenuRightContentOptions:function(a){var c=this.getEditorAPI(),d=this.props.menuItems[a],e={};return e.main=n(d.rightPanel,c),b.forEach(d.children,function(a){if(a&&g[a.key]&&a.rightPanel){var b=this.handleClickOnRightPanel.bind(this,a),d=g[a.key].bi,f={action:b,bi:d};e[a.key]=n(a.rightPanel,c,f)}},this),e},handleClickOnRightPanel:function(a){var c=g[a.key],d=c.action;d&&(d.apply(null,b.rest(arguments)),c.isCheckbox||this.closeDropDown())},openDropDown:function(a){null===this.state.indexOfOpenMenu&&(this.lastKeyboardContext=d.keyboardShortcuts.getContext(),d.keyboardShortcuts.setContext(d.keyboardShortcuts.CONTEXTS.MENU_BAR)),this.setState({indexOfOpenMenu:a})},closeDropDown:function(){this.setState({indexOfOpenMenu:null})},onMouseOverMenuItem:function(a){var b=this,c=!this.state.mouseOverMenu,d=null!==this.state.indexOfOpenMenu,e=c&&!d,f=!c&&d;c&&this.setState({mouseOverMenu:!0}),e?setTimeout(function(){b.isMounted()&&b.openDropDown(a)},l):f&&b.openDropDown(a)},onMouseLeave:function(){this.setState({mouseOverMenu:!1})},registerKeyboardShortcuts:function(){var a=this,b=d.keyboardShortcuts.CONTEXTS.TOP_BAR,c=d.keyboardShortcuts.extendContext(b,{esc:function(){null!==a.state.indexOfOpenMenu&&a.closeDropDown()},left:function(){var c,b=a.state.indexOfOpenMenu;c=0===b?a.getNumberOfMenuItems()-1:a.state.indexOfOpenMenu-1,a.openDropDown(c)},right:function(){var b=a.state.indexOfOpenMenu,c=(b+1)%a.getNumberOfMenuItems();a.openDropDown(c)}});d.keyboardShortcuts.registerContext(d.keyboardShortcuts.CONTEXTS.MENU_BAR,c)},render:k})}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/checkListPanel.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(d,e,f){return a.createElement("li",{key:f},a.createElement("div",{className:b.keys(b.pick({check:!d,"check-purple":d},b.identity)).join(" ")},a.createElement(c.symbol,{name:"check"})),a.createElement("div",{className:"text"},e))}function e(a,b,c){this.onClick(b.action)}function f(d,f,g){return a.createElement(c.button,{className:b.keys(b.pick({"action-button":!d,"action-button-purple1":d&&g%2===0,"action-button-purple2":d&&g%2!==0},b.identity)).join(" "),label:f.buttonText,shouldTranslate:!1,key:"key-"+f.buttonText,onClick:e.bind(this,d,f,g)})}function g(){var c="upgrade"===this.props.type;return a.createElement.apply(this,["div",{className:this.props["class"]},this.props.title?a.createElement("div",{key:"title",className:"title"},this.props.title):null,1===b.size(this.props.description)?a.createElement("div",{key:"single",className:"description"},this.props.description):null,b.size(this.props.description)>1?a.createElement("div",{key:"multiple",className:"description"},a.createElement.apply(this,["ul",{},b.map(this.props.description,d.bind(this,c)),this.props.comment?a.createElement("li",{key:"comment",className:"comment"},this.props.comment):null])):null,b.map(this.props.footerButtons,f.bind(this,c))])}return function(){return g.apply(this,[])}}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/checkListPanel",["react","rEditor/rootComps/topBar/dropPanels/menuPanels/checkListPanel.rt"],function(a,b){"use strict";return a.createClass({displayName:"checkListPanel",propTypes:{editorAPI:a.PropTypes.object.isRequired,closeDropDownHandle:a.PropTypes.func.isRequired},onClick:function(a){a&&a(this.props.editorAPI),this.props.closeDropDownHandle()},render:b})}),define("rEditor/rootComps/topBar/dropPanels/editorModesPanel.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement("div",{className:"editor-modes-panel"},a.createElement("div",{className:"editor-modes-panel-top-part"},a.createElement("div",{},a.createElement(c.radioList,{options:[{label:"TOPBAR_MobileDesktop_Desktopview",symbolName:"desktop",className:"editor-mode-option-desktop",symbolClass:"editor-mode-option-symbol",value:"desktop"},{label:"TOPBAR_MobileDesktop_MobileView",symbolName:"mobile",className:"editor-mode-option-mobile",symbolClass:"editor-mode-option-symbol",value:"mobile"}],value:this.props.desktopModeSelected?"desktop":"mobile",onChange:this.setEditorMode}))),a.createElement("div",{className:"optimized-view-row"},a.createElement(c.toggle,{label:"TOPBAR_MobileDesktop_MobileOptimized",labelAfterSymbol:!0,value:this.props.isMobileOptimized,onChange:this.toggleOptimized})))}}),define("rEditor/rootComps/topBar/dropPanels/editorModesPanel",["react","lodash","core","util","rEditor/rootComps/topBar/dropPanels/editorModesPanel.rt"],function(a,b,c,d,e){"use strict";var f="EDITOR_MODES_SWITCH";return a.createClass({displayName:"editorModesPanel",propTypes:{editorAPI:a.PropTypes.object.isRequired,isMobileOptimized:a.PropTypes.bool.isRequired,desktopModeSelected:a.PropTypes.bool.isRequired,closeHandle:a.PropTypes.func},biData:{desktop:{editor_view_mode:"desktop"},mobile:{editor_view_mode:"mobile"}},getDefaultProps:function(){return{closeHandle:b.noop}},componentDidMount:function(){this.registerKeyboardShortcuts(),this.lastKeyboardContext=d.keyboardShortcuts.getContext(),d.keyboardShortcuts.setContext(f)},componentWillUnmount:function(){d.keyboardShortcuts.setContext(this.lastKeyboardContext)},setEditorMode:function(a){var b=this.props.editorAPI;"desktop"===a?(this.sendModeChangeBI(b,this.biData.desktop),b.setDesktopEditor()):(this.sendModeChangeBI(b,this.biData.mobile),b.setMobileEditor()),this.props.closeHandle&&this.props.closeHandle()},toggleOptimized:function(){var a=this.props.isMobileOptimized,b=!a;this.sendToggleBI(this.props.editorAPI.getPreviewMode(),b),this.props.editorAPI.setMobileOptimizedSite(b)},sendToggleBI:function(a,b){var d=c.bi.events.topbar.mobile_view_mode_toggle,e=a?"top bar preview":"top bar editor",f={origin:e,status:b?1:0};this.props.editorAPI.bi.event(d,f)},sendModeChangeBI:function(a,b){if(a){var d=c.bi.events.topbar.top_bar_editor_view_mode_click;a.getPreviewMode()&&(d=c.bi.events.topbar.top_bar_preview_page_editor_view_mode_click),a.bi.event(d,b)}},registerKeyboardShortcuts:function(){var a=this,b={esc:function(){a.props.closeHandle()}};d.keyboardShortcuts.registerContext(f,b)},render:e})}),define("rEditor/rootComps/topBar/topBarWidgetsDefinitions",["jquery","react","lodash","util","core","rEditor/rootComps/topBar/config/topBarData.json","rEditor/rootComps/topBar/menuBar/config/topBarMenuData.json","rEditor/rootComps/topBar/topBarExperimentHelper","rEditor/rootComps/topBar/buttons/topBarButton/topBarButton","rEditor/rootComps/topBar/buttons/pagesNavButton/pagesNavButton","rEditor/rootComps/topBar/buttons/topBarThumbButton/topBarThumbButton","rEditor/rootComps/topBar/buttons/backToEditorExButton/backToEditorExButton","rEditor/rootComps/topBar/buttons/topBarNotification/topBarNotification","rEditor/rootComps/topBar/menuBar/menuBar","rEditor/rootComps/topBar/menuBar/menuBarPanelsDefinitions","rEditor/rootComps/topBar/dropPanels/menuPanels/checkListPanel","rEditor/rootComps/topBar/dropPanels/editorModesPanel","baseUI","panels","savePublish","experiment!menuBarClosed","experiment!topBarNewPreviewButtons"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";function y(a){return d.media.getMediaUrl("rEditor/topBar/"+a)}function z(a){return!a||a.generalInfo&&a.generalInfo.isFirstSave()}function A(){g=h.fixJsonExperimentalEntries(g,w),f=h.fixJsonExperimentalEntries(f,w)}function B(b){var c=a(b.refs.topBarSideWrapperCenter.getDOMNode()),d=a(b.refs.topBarSideWrapperLeft.getDOMNode()),e=a(b.refs.topBarSideWrapperRight.getDOMNode());c.css({left:d.width(),right:e.width(),width:"auto"})}function C(b){var c=b.refs.topBarPreviewButton,d=b.refs.topBarPublishButton,e=b.refs.topBarBackToEditorButton,f=17;return e?a(e.getDOMNode()).width():a(c.getDOMNode()).outerWidth()+a(d.getDOMNode()).outerWidth()+f}function G(a){var b="save-button-tooltip";return{compClass:i,actions:null,compProps:function(c,d,f,g){var h=c.state.appearance>=c.APPEARANCE.SAVE_AND_MOBILE_CHANGE_ICONS,i=c.getEditorAPI(),j=g&&"PREVIEW"===g.toUpperCase(),k=j?e.bi.events.topbar.top_bar_Preview_Page_Save_click:E("save"),l=z(i),m=l?"-notSaved":"";return I.SAVE.actions=I.SAVE.actions||[t.save.bind(t,i)],{label:h?null:"TOPBAR_Site_Save",iconSymbol:h?"save":null,classes:["top-bar-menu-item","top-bar-save",K(d),L(d,f)].join(" "),actions:I.SAVE.actions,isDisabled:t.isPublishInProgress()||t.isSaveInProgress(),progressStatus:c.props.savingStatus,tooltipData:F((a?b:b)+m,!0,"TOPBAR_SAVE_TOOLTIP_TITLE","TOPBAR_SAVE_TOOLTIP_BODY",l?null:"TOPBAR_SAVE_TOOLTIP_LINK",l?null:function(){i.account.openRevisions()}),bi:k}}}}function H(a){return{compClass:"div",compProps:function(b,c){var d=!a||a(b,c);return{className:["top-bar-separator","top-bar-menu-item",K(c),d?"":"hidden"].join(" ")}}}}function J(a,b,d){var f={type:b,origin:"topbar"};c.isEmpty(d)?d=[f]:c.each(d,function(a){c.assign(a,f)}),a.bi.reportBI(e.bi.events.editor.undo_redo_component_change,d)}function K(a){var b="top-bar-menu-item-";return a&&a===x.RIGHT?b+"right":b+"left"}function L(a,b){var c=[];return a===x.LEFT&&0===b?c.push("top-bar-item-right-margin"):a===x.RIGHT&&0===b?c.push("top-bar-item-left-margin"):c.push("top-bar-item-margin"),c}var w={menuBarClosed:u,topBarNewPreviewButtons:v},x={LEFT:"left",RIGHT:"right"},D=function(){var a=null;return function(b){return null===a&&(a={onMenuOpened:b.onMenuOpened,onMenuClosed:b.onMenuClosed}),a}}(),E=function(){var a={};return function(b){return a[b]||(a[b]={type:e.bi.events.topbar.top_bar_click,fields:{category:b}}),a[b]}}(),F=function(){var a={};return function(b,c,d,e,f,g){var h=a[b];return h||(h={presenter:r.popoverTemplates.titleBodyAndLinkTooltip,id:b,interactive:c,props:{title:d,text:e,link:f,linkAction:g}},a[b]=h),h}}();A();var I={WIX_LOGO:{compClass:i,compProps:function(a,b){return{iconSymbol:"wixLogo",classes:["top-bar-wix-logo",K(b)].join(" "),bi:E("wix_logo")}}},PAGES_LIST:{compClass:j,compProps:function(a,b,d){var e=a.state.appearance>=a.APPEARANCE.TRIM_PAGES_NAV_BUTTON,f=D(a);return c.assign({},f,{label:"pages",isSmallVersion:e,classes:["top-bar-menu-item",L(b,d),K(b)].join(" "),tooltipData:F("pagesTooltipID",!1,null,"TOPBAR_PAGES_TOOLTIP_TITLE"),bi:E("pages")})}},REDO_SEPARATOR:H(function(a){return a.state.appearance<a.APPEARANCE.HIDE_REDO}),SEPARATOR:H(),UNDO:{compClass:i,actions:null,biFunc:null,classes:null,compProps:function(a,b,c){var d=a.getEditorAPI(),e=I.UNDO;return e.actions=e.actions||[d.history.undo],e.biFunc=e.biFunc||J.bind(null,d,"undo"),e.classes=e.classes||["top-bar-undo",L(b,c),K(b)].join(" "),{iconSymbol:"undo2",classes:I.UNDO.classes,actions:I.UNDO.actions,tooltipData:F("topBarUndoTooltipID",!1,null,"TOPBAR_UNDO_TOOLTIP_TITLE"),biFunc:I.UNDO.biFunc}}},REDO:{compClass:i,actions:null,biFunc:null,compProps:function(a,b,d){var e=a.getEditorAPI();I.REDO.actions=I.REDO.actions||[e.history.redo],I.REDO.biFunc=I.REDO.biFunc||J.bind(null,e,"redo");var f=a.state.appearance>=a.APPEARANCE.HIDE_REDO;return{iconSymbol:"redo2",classes:c.compact(["top-bar-redo","top-bar-responsive-1024",L(b,d),K(b)],f?"hidden":"").join(" "),actions:I.REDO.actions,tooltipData:F("topBarRedoTooltipID",!1,null,"TOPBAR_REDO_TOOLTIP_TITLE"),biFunc:I.REDO.biFunc}}},HELP:{compClass:i,compProps:function(a,b,c){return{label:null,iconSymbol:"help",classes:["top-bar-help",L(b,c),K(b)].join(" "),actions:[function(){var b=a.getEditorAPI(),c=b.isDesktopEditor(),d=c?"58406e7a-1ad0-4105-8e37-c053b529f9d8":"f8b24a99-cefd-4c55-adda-aa66ec643259";s.panelManager.openHelpCenter(d)}],tooltipData:F("topBarHelpTooltipID",!1,null,"TOPBAR_HELP_TOOLTIP_TITLE"),bi:E("help")}}},PREVIEW:{compClass:i,actions:null,bi:[E("preview"),{type:e.bi.events.preview.PREVIEW_CLICK,fields:{origin:"topbar"}}],compProps:function(a,b,c){var d=a.state.appearance>=a.APPEARANCE.PREVIEW_CHANGE_TO_ICON;return I.PREVIEW.actions=I.PREVIEW.actions||[a.getEditorAPI().togglePreview],I.PREVIEW.classes=I.PREVIEW.classes||["top-bar-menu-item","top-bar-preview-icon",L(b,c),K(b)].join(" "),{label:d?null:"TOPBAR_PREVIEW_TOOLTIP_TITLE",iconSymbol:d?"preview":null,actions:I.PREVIEW.actions,classes:I.PREVIEW.classes,tooltipData:F("topBarPreviewTooltipID",!1,"TOPBAR_PREVIEW_TOOLTIP_TITLE","TOPBAR_PREVIEW_TOOLTIP_BODY"),bi:I.PREVIEW.bi,ref:"topBarPreviewButton"}}},EDITOR_MODE_SWITCH:{compClass:i,getDropPanelProps:function(){var a={};return function(b,c,d,e){var f=(b?"mobile-":"desktop-")+(c?"optimized-":"non-optimized-")+d,g=a[f];return g||(g={overridePositionAdjustments:{type:r.uiConstants.TOOLTIP.ALIGNMENT.RIGHT,value:70},desktopModeSelected:!b,isMobileOptimized:c,editorAPI:e,dropPanelPromotion:{type:"rEditor.panels.topBar.promotionPanel",classes:"promotion editor-mode-switch-promotion",props:{menuKey:"editor-mode-switch",key:"editor-mode-switch",title:"TOPBAR_MOBILE_PROMOTION_TITLE",message:"TOPBAR_MOBILE_PROMOTION_BODY",image:y(d>=2?"mobileDesktopIllustration@x2.png":"mobileDesktopIllustration.png"),classes:{graphics:"editor-mode-switch-graphics",title:"editor-mode-switch-title",message:"editor-mode-switch-message"}}}},a[f]=g),g}}(),compProps:function(a,b,e,f){var g=d.browserUtil.getDevicePixelRatio(),h=a.props.isMobileEditor?"desktop":"mobile",i=a.state.appearance>=a.APPEARANCE.SAVE_AND_MOBILE_CHANGE_ICONS,j=D(a);return c.assign({},j,{iconSymbol:h,classes:[i?"mini-editor-mode-switch":"editor-mode-switch",L(b,e),K(b)].join(" "),dropPanelContent:q,dropPanelProps:I.EDITOR_MODE_SWITCH.getDropPanelProps(a.props.isMobileEditor,a.props.isMobileOptimized,g,a.getEditorAPI()),tooltipData:F("editorModeSwitchTooltipId-"+f,!1,"TOPBAR_MOBILE_TOOLTIP_TITLE","TOPBAR_MOBILE_TOOLTIP_BODY"),bi:E("editor_view_mode")})}},PUBLISH:{compClass:i,label:"TOPBAR_Site_Publish",actions:null,bi:[E("publish"),{type:e.bi.events.publish.PUBLISH_CLICK,fields:{origin:"topbar"}}],classes:null,compProps:function(a,b){var c=a.getEditorAPI(),d=c.generalInfo&&c.generalInfo.isSitePublished()||!1,e="publish-button-tooltip-id-"+(d?"published":"notPublished");return I.PUBLISH.actions=I.PUBLISH.actions||[t.saveAndPublish.bind(t,c)],I.PUBLISH.classes=I.PUBLISH.classes||[K(b),"top-bar-item-margin","top-bar-textual-button"].join(" "),{label:I.PUBLISH.label,right:!1,classes:I.PUBLISH.classes,actions:I.PUBLISH.actions,isDisabled:t.isPublishInProgress()||t.isSaveInProgress(),progressStatus:a.props.publishingStatus,tooltipData:F(e,!0,d?"TOPBAR_POSTPUBLISH_TOOLTIP_TITLE":"TOPBAR_PREPUBLISH_TOOLTIP_TITLE",d?"TOPBAR_POSTPUBLISH_TOOLTIP_BODY":"TOPBAR_PREPUBLISH_TOOLTIP_BODY",d?"SAVE_PUBLISH_BUTTON_VIEW":null,d?function(){var a=c.site.getSitePublicUrl();window.open(a)}:null),bi:I.PUBLISH.bi,ref:"topBarPublishButton"}}},SAVE:G(!1),PREVIEW_SAVE:G(!0),MENU:{compClass:n,compProps:function(a){var b=D(a);return c.assign({},b,{menuItems:a.getMenuBarItems(g),viewTools:a.props.viewTools,classes:"top-bar-menu-item-left menu-bar",isMenuBarClosedExperiment:u,onMenuOpened:a.onMenuOpened,onMenuClosed:a.onMenuClosed,tooltipData:F("topBarMenuTooltipId",!1,null,"TOPBAR_MENU_TOOLTIP_TITLE"),bi:E("menu")})}},BIG_BACK_TO_EDITOR:{compClass:k,actions:null,bi:{type:e.bi.events.topbar.top_bar_Preview_Page_Back_to_Editor_click,fields:{origin:"thumb"}},compProps:function(a,b){return I.BIG_BACK_TO_EDITOR.actions=I.BIG_BACK_TO_EDITOR.actions||[a.getEditorAPI().togglePreview],{label:d.translate("TOPBAR_BACK_TO_EDITOR"),right:!0,classes:K(b),actions:I.BIG_BACK_TO_EDITOR.actions,bi:I.BIG_BACK_TO_EDITOR.bi}}},BIG_BACK_TO_EDITOR2:{compClass:i,actions:null,bi:{type:e.bi.events.topbar.top_bar_Preview_Page_Back_to_Editor_click,fields:{origin:"thumb"}},compProps:function(a,b){return I.BIG_BACK_TO_EDITOR2.actions=I.BIG_BACK_TO_EDITOR2.actions||[a.getEditorAPI().togglePreview],{label:"TOPBAR_BACK_TO_EDITOR",right:!0,classes:[K(b),"top-bar-item-back-to-editor"].join(" "),actions:I.BIG_BACK_TO_EDITOR2.actions,buttonStyle:{width:C(a)},bi:I.BIG_BACK_TO_EDITOR2.bi,ref:"topBarBackToEditorButton"}}},SMALL_BACK_TO_EDITOR:{compClass:l,actions:null,bi:{type:e.bi.events.topbar.top_bar_Preview_Page_Back_to_Editor_click,fields:{origin:"ex-button"}},compProps:function(a,b){return I.SMALL_BACK_TO_EDITOR.actions=I.SMALL_BACK_TO_EDITOR.actions||[a.getEditorAPI().togglePreview],{classes:["top-bar-menu-item",L(b),K(b)].join(" "),actions:I.SMALL_BACK_TO_EDITOR.actions,tooltipData:F("topBarSmallBackToEditorTooltipId",!1,null,"Topbar_PREVIEW_BACK_EDITOR_TOOLTIP"),bi:I.SMALL_BACK_TO_EDITOR.bi}}},MOBILE_NON_OPTIMIZED_NOTIFICATION:{compClass:m,action:null,compProps:function(a,b){var c=I.MOBILE_NON_OPTIMIZED_NOTIFICATION;return c.action=c.action||function(){var b=a.getEditorAPI();b.togglePreview(),b.openMobileElementsPanel({mobileElementId:"mobileView"})},{classes:[L(b),K(b)].join(" "),isShown:a.props.isMobileEditor&&!a.props.isMobileOptimized,message:d.translate("mobile_preview_notification_text1")+" <a>"+d.translate("mobile_preview_notification_link")+"</a> "+d.translate("mobile_preview_notification_text2"),action:c.action}}},PREVIEW_NOTIFICATION:{compClass:m,compProps:function(a,b,c,e){B(a);var f=a.props.isMobileEditor&&!a.props.isMobileOptimized,g="PREVIEW"===e.toUpperCase();return{classes:[L(b),K(b)].join(" "),isShown:g&&!f,message:d.translate("Topbar_PREVIEW_TITLE")}}},UPGRADE:{compClass:i,compProps:function(a,b){return{label:d.translate("TOPBAR_Upgrade _Label"),classes:["top-bar-item-margin","top-bar-upgrade",K(b)].join(" "),dropPanelContent:p,dropPanelProps:c.merge(o.getMenuPanelProps("UPGRADE",a.getEditorAPI()),{editorAPI:a.getEditorAPI(),optionalData:{dropPanelClass:"upgrade-button-panel"},dropPanelPromotion:{type:"rEditor.panels.topBar.promotionPanel",classes:"promotion upgrade-button-promotion",props:{menuKey:"UPGRADE",style:{"background-color":"transparent",width:131,padding:"25px 0"},symbol:"menuBarUpgradePromotion"}}}),bi:E("upgrade")}}}};return{ORIENTATION:x,TOP_BARS:f,widgetMapping:I}}),define("rEditor/rootComps/topBar/util/campaignUtil",["lodash","core","util"],function(a,b,c){"use strict";function d(b){return a.find(a.find(b,{key:"SITE_BAR"}).children,{key:"UPGRADE_ITEM"})}function e(b){return a.find(b,{key:"UPGRADE"})}function f(b){var d=b.campaigns.personalSale.getAssetPath(),e=b.campaigns.personalSale.getDiscountValue(),f=[d,"menubarSitePanel_"+e+".svg"].join("/"),g=a.template(c.translate("TOPBAR_UPGRADE_POPUP_PERSONAL_SALE_LABEL_DYNAMIC"));return{symbol:"",image:c.media.getAssetUrl(f),message:g({discount:e}),title:c.translate("TOPBAR_SITE_UPGRADE_PROMOTION_TITLE"),shouldTranslate:!1}}function g(a){var b=a.campaigns.personalSale.getAssetPath(),d=a.campaigns.personalSale.getDiscountValue(),e=[b,"menubarUpgradePanel_"+d+".svg"].join("/");return{symbol:"",image:c.media.getAssetUrl(e)}}function h(b,c){var h=d(c),i=e(c);a.assign(h.rightPanel.props,f(b)),a.assign(i.rightPanel.props,g(b))}return{updateMenuBarItemsAccordingToPersonalSaleCampaign:h}}),define("rEditor/rootComps/topBar/topBar.rt",["react/addons","lodash","experiment!topBarB"],function(a,b,c){"use strict";return function(){return a.createElement("div",{className:this.topBarClassName+" "+(c?"top-bar-b":""),onClick:this.handleTopBarClick,onContextMenu:this.props.onContextMenu},a.createElement("div",{className:b.keys(b.pick({"top-bar-editor":!0,"top-bar-preview-show":this.props.previewMode},b.identity)).join(" "),style:{zIndex:this.state.zIndex}},this.props.previewMode?a.createElement("div",{"data-target":this.topBarClassName,key:"top-bar-preview",className:"top-bar-container top-bar-preview"},this.getTopBarByMode("PREVIEW")):null,this.props.previewMode?null:a.createElement("div",{"data-target":this.topBarClassName,key:"top-bar-edit",className:"top-bar-container top-bar-edit"},this.getTopBarByMode("EDIT")),this.props.isEnabled?null:a.createElement("div",{className:"top-bar-overlay",key:"overlay"})))}}),define("rEditor/rootComps/topBar/topBar",["jquery","react","lodash","core","util","rEditor/rootComps/topBar/topBarWidgetsDefinitions","rEditor/rootComps/topBar/util/campaignUtil","rEditor/rootComps/topBar/topBar.rt","experiment!userRoles"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a){return a>0?1:0>a?-1:0}var k=null;return b.createClass({displayName:"topBar",topBarClassName:"top-bar",mixins:[d.mixins.editorAPIMixin,e.outerClickMixin,e.singlePassDOMReadWriteMixin],propTypes:{height:b.PropTypes.number.isRequired,isEnabled:b.PropTypes.bool,isMobileEditor:b.PropTypes.bool.isRequired,isMobileOptimized:b.PropTypes.bool.isRequired,previewMode:b.PropTypes.bool.isRequired,viewTools:b.PropTypes.object.isRequired,savingStatus:b.PropTypes.string.isRequired,publishingStatus:b.PropTypes.string.isRequired,onTopBarClicked:b.PropTypes.func},TOP_BAR_REFS:{LEFT_SIDE:"topBarSideWrapperLeft",RIGHT_SIDE:"topBarSideWrapperRight",CENTER:"topBarSideWrapperCenter"},MIN_GAP_BETWEEN_LEFT_AND_RIGHT_CONTAINERS:30,APPEARANCE:{FULL:0,SAVE_AND_MOBILE_CHANGE_ICONS:1,PREVIEW_CHANGE_TO_ICON:2,HIDE_REDO:3,TRIM_PAGES_NAV_BUTTON:4,HIDE_UPGRADE_IN_MENU:5},MINIMAL_APPEARANCE_INDEX:5,getInitialState:function(){return{appearance:this.APPEARANCE.FULL,zIndex:void 0}},shouldComponentUpdate:function(a){return!a.performingMouseMoveAction},measurePhase:function(){var b=this.didWindowSizeChange();return k=a(window).width(),b},patchPhase:function(a){0!==a&&this.updateTopBarWidth(a)},componentDidUpdate:function(a,b){var c=j(b.appearance-this.state.appearance);0!==c&&this.updateTopBarWidth(c)},updateTopBarWidth:function(a){var b=this.state.appearance;a>0&&(b=this.APPEARANCE.FULL);var c=this.getNonOverlappingAppearanceIndex(b);c!==this.state.appearance&&this.setState({appearance:c})},didWindowSizeChange:function(){var b=a(window).width();return j(b-k)},getNonOverlappingAppearanceIndex:function(a){if(!this.props.previewMode){var b=this.getGapBetweenLeftAndRightContainers(),c=b<this.MIN_GAP_BETWEEN_LEFT_AND_RIGHT_CONTAINERS;c&&(a=Math.min(a+1,this.MINIMAL_APPEARANCE_INDEX))}return a},getGapBetweenLeftAndRightContainers:function(){var b=a(this.refs[this.TOP_BAR_REFS.LEFT_SIDE].getDOMNode()),c=a(this.refs[this.TOP_BAR_REFS.RIGHT_SIDE].getDOMNode()),d=c.offset().left,e=b.offset().left+b.width();return d-e},onOuterClick:function(){if(e.keyboardShortcuts.getContext()===e.keyboardShortcuts.CONTEXTS.TOP_BAR){var a=e.keyboardShortcuts.CONTEXTS;e.keyboardShortcuts.setContext(this.props.previewMode?a.PREVIEW:a.EDITOR)}},handleTopBarClick:function(a){this.isClickOnTopBarEmptySpace(a)&&this.setTopBarKeyboardContext(),this.props.onTopBarClicked&&this.props.onTopBarClicked()},isClickOnTopBarEmptySpace:function(a){var b=a.target.dataset;return b&&b.target===this.topBarClassName},setTopBarKeyboardContext:function(){e.keyboardShortcuts.setContext(e.keyboardShortcuts.CONTEXTS.TOP_BAR)},getTopBarByMode:function(a){var b=f.TOP_BARS[a],c=this.sortTopBarItemsByOrientation(b),d=this.createTopBarItems(c.left,this.createLeftTopBarItem,a,"left"),e=this.createTopBarItems(c.center,this.createLeftTopBarItem,a,"center"),g=this.createTopBarItems(c.right.reverse(),this.createRightTopBarItem,a,"right");return[].concat(e,d,g)},sortTopBarItemsByOrientation:function(a){var b={left:[],right:[],center:[]};return c.forEach(a,function(a){var c=this.getWidgetDefinitionByKey(a);c&&(a.orientation===f.ORIENTATION.LEFT?b.left.push(c):a.orientation===f.ORIENTATION.RIGHT?b.right.push(c):b.center.push(c))},this),b},getWidgetDefinitionByKey:function(a){return f.widgetMapping[a.comp]},createTopBarItems:function(a,b,d,e){var f=c.map(a,function(a,c){return b(a,c,d)});return this.createElementsWrapper(f,d,e)},createElementsWrapper:function(a,c,d){var e="topbar-side-"+c+"-"+d,f={displayName:"topBarSideWrapper",className:"top-bar-side-wrapper",key:e};return"right"===d?(f.style={right:0},f.ref=this.TOP_BAR_REFS.RIGHT_SIDE):"left"===d?(f.style={left:0},f.ref=this.TOP_BAR_REFS.LEFT_SIDE):"center"===d&&(f.style={width:"100%",textAlign:"center"},f.ref=this.TOP_BAR_REFS.CENTER),b.createElement("div",f,a)},createLeftTopBarItem:function(a,b,c){return this.createDynamicMenuItem(a,f.ORIENTATION.LEFT,b,c)},createRightTopBarItem:function(a,b,c){return this.createDynamicMenuItem(a,f.ORIENTATION.RIGHT,b,c)},createDynamicMenuItem:function(a,d,e,g){return a&&a.compClass?(d=d||f.ORIENTATION.LEFT,b.createElement(a.compClass,c.assign(a.compProps(this,d,e,g),{key:this.createTopBarWidgetKey(d,g,e)}))):null},createTopBarWidgetKey:function(a,b,c){return["topbar-w",a,b,c].join("-")},getMenuBarItems:function(a){var b=c.cloneDeep(a),d=this.popUpgradePackagesEntry(b),e=this.getEditorAPI();if(d&&this.isUpgradeShowing()){var f=d.upgradePanels.DEFAULT;f&&b.push(f)}return e.campaigns.personalSale.isActiveCampaign()&&this.isUpgradeShowing()&&g.updateMenuBarItemsAccordingToPersonalSaleCampaign(e,b),b},isUpgradeShowing:function(){if(i){var a=this.isUserPermittedToUpgrade();if(!a)return!1}return this.isUpgradeSupportedInAppearanceState()},isUserPermittedToUpgrade:function(){return this.getEditorAPI().account.isUserOwner()},isUpgradeSupportedInAppearanceState:function(){return this.state.appearance<this.APPEARANCE.HIDE_UPGRADE_IN_MENU},onMenuOpened:function(){this.setState({zIndex:1750})},onMenuClosed:function(){this.setState({zIndex:void 0})},popUpgradePackagesEntry:function(a){return c.first(c.remove(a,function(a){return a&&"UPGRADE"===a.category}))},render:h})}),define("rEditor/rootComps/leftBar/leftBarButton/leftBarButton.rt",["react/addons","lodash","symbols"],function(a,b,c){"use strict";return function(){return a.createElement("li",{className:this.getButtonClasses(),onClick:this.handleOnClick},this.shouldShowSelectedSvg()?a.createElement(c.symbol,b.assign({},{key:"selectedSvg"},this.getSelectedButtonSvgProps())):null,a.createElement(c.symbol,{name:this.props.symbolName,className:"icon"}),a.createElement("span",{className:"mask"}),a.createElement("span",{className:"text"},this.props.label),this.props.notificationCount>0?a.createElement("span",{key:"notificationCount",className:"notifications"},this.props.notificationCount):null)}}),define("rEditor/rootComps/leftBar/leftBarButton/leftBarButton",["lodash","react","rEditor/rootComps/leftBar/leftBarButton/leftBarButton.rt","symbols"],function(a,b,c){"use strict";return b.createClass({displayName:"leftBarButton",propTypes:{className:b.PropTypes.string.isRequired,symbolName:b.PropTypes.string.isRequired,label:b.PropTypes.string.isRequired,isSelected:b.PropTypes.bool.isRequired,isMobileEditor:b.PropTypes.bool.isRequired,onClick:b.PropTypes.func.isRequired,isMenuCollapsed:b.PropTypes.bool,notificationCount:b.PropTypes.number.isRequired,isFirstPanel:b.PropTypes.bool},getButtonClasses:function(){var a=[];return a.push("left-bar-item"),a.push(this.props.className),this.props.isSelected&&a.push("selected"),this.props.isFirstPanel&&a.push("first-panel"),a.join(" ")},handleOnClick:function(){this.props.onClick&&this.props.onClick()},getSelectedButtonSvgProps:function(){var a,b;return this.props.isFirstPanel?(a="leftBarButtonEarTop",b="ear-top"):(a="leftBarButtonEarMiddle",b="ear-middle"),{name:a,className:"ear "+b}},shouldShowSelectedSvg:function(){return this.props.isMenuCollapsed&&this.props.isSelected},render:c})}),define("rEditor/rootComps/leftBar/leftBar.rt",["react/addons","lodash","rEditor/rootComps/leftBar/leftBarButton/leftBarButton","util"],function(a,b,c,d){"use strict";function e(a,b,c){this.handleOnClick(a.panelName,a.panelProps)}function f(b,f){return a.createElement(c,{key:b.panelName,label:d.translate(b.label),isMenuCollapsed:this.isMenuCollapsed(),className:b.className,symbolName:b.symbolName,isMobileEditor:this.props.isMobileEditor,isSelected:this.state.activePanelName===b.panelName,onClick:e.bind(this,b,f),isFirstPanel:0===f,notificationCount:this.getNotificationCount(b.panelName)
})}return function(){return a.createElement("div",{className:"left-bar",onContextMenu:this.props.onContextMenu},a.createElement.apply(this,["ul",{ref:"buttons",className:b.keys(b.pick({"left-bar-items":!0,"menu-collapsed":this.isMenuCollapsed(),"menu-opened":this.isMenuOpened()},b.identity)).join(" ")},b.map(this.getMenuItems(),f.bind(this))]))}}),define("rEditor/rootComps/leftBar/config/leftBarData",["util"],function(a){"use strict";return{desktop:[{panelName:"rEditor.panels.backgroundPanel",panelProps:{},label:"LEFTBAR_BACKGROUND_LABEL",className:"bg-panel",symbolName:"leftBarBackgroundPanel"},{panelName:"addPanelInfra.addPanel",panelProps:{},label:"LEFTBAR_ADD_LABEL",className:"add-panel",symbolName:"leftBarAddPanel"},{panelName:"tpa.compPanels.appMarketPanel",panelProps:{urlParams:{openMarketOrigin:"market_button"},openPanelBiEvent:a.bi.events.OPEN_MARKET_CLICK,openPanelBiParams:{referral_info:"market_button"}},label:"app_market_button_text",className:"app-market-panel",symbolName:"leftBarAppMarketPanel"},{panelName:"rEditor.panels.myMediaPanel",panelProps:{},label:"LEFTBAR_MY_UPLOADS_LABEL",className:"my-uploads-panel",symbolName:"leftBarMyUploadsPanel"}],mobile:[{panelName:"rEditor.panels.backgroundPanel",panelProps:{},label:"LEFTBAR_BACKGROUND_LABEL",className:"bg-panel",symbolName:"leftBarBackgroundPanel"},{panelName:"mobileEditor.mobileElementsPanel",panelProps:{},label:"mobile_elements_panel_title",className:"mobile-elements-panel",symbolName:"mobileView"},{panelName:"mobileEditor.hiddenItemsPanel",panelProps:{},label:"mobile_hidden_items_panel_title",className:"hidden-items-panel",symbolName:"hiddenComp"}]}}),define("rEditor/rootComps/leftBar/leftBar",["lodash","react","core","panels","baseUI","rEditor/rootComps/leftBar/leftBar.rt","rEditor/rootComps/leftBar/config/leftBarData","experiment!enableMyUploadsButton"],function(a,b,c,d,e,f,g,h){"use strict";var i={panelName:"rEditor.panels.myMediaPanel",panelProps:{},label:"LEFTBAR_MY_UPLOADS_LABEL",className:"my-uploads-panel",symbolName:"leftBarMyUploadsPanel"};return b.createClass({displayName:"leftBar",mixins:[c.mixins.editorAPIMixin],propTypes:{leftBarState:b.PropTypes.object.isRequired,isMobileEditor:b.PropTypes.bool.isRequired,openPanels:b.PropTypes.array.isRequired,isEnabled:b.PropTypes.bool.isRequired},getInitialState:function(){return{activePanelName:void 0}},shouldComponentUpdate:function(b,c){return!a.isEqual(this.props,b)||!a.isEqual(this.state,c)},getMenuItems:function(){var b=[],c=this.props.leftBarState.superApps,d=[];return h&&d.push(i),b=this.props.isMobileEditor?g.mobile.concat(d,a.sortBy(c.mobile,"order")):g.desktop.concat(d,a.sortBy(c.desktop,"order")),b.forEach(function(a,b){a.panelProps=a.panelProps||{},a.panelProps.panelIndex=b}),a.compact(b)},getNotificationCount:function(a){return this.props.leftBarState.notifications[a]||0},componentWillReceiveProps:function(b){var c=a.find(b.openPanels,{frameType:"leftPanelFrame"});c?(this.setState({activePanelName:c.name}),this.props.leftBarState.isCollapsed||this.getEditorAPI().leftBar.collapseMenu()):this.setState({activePanelName:void 0})},handleOnClick:function(a,b){this.props.isEnabled&&a!==this.state.activePanelName&&(this.getEditorAPI().leftBar.collapseMenu(),d.panelManager.openPanel(a,b),b.openPanelBiEvent&&this.getEditorAPI().bi.event(b.openPanelBiEvent,b.openPanelBiParams))},isMenuCollapsed:function(){return this.props.leftBarState.isCollapsed},isMenuOpened:function(){return!!this.state.activePanelName},getButtonsBoundingRect:function(){return this.isMenuCollapsed()?e.uiConstants.LEFTBAR_BTN_WIDTH_COLLAPSED:this.refs.buttons.getDOMNode().getBoundingClientRect()},render:f})}),define("rEditor/rootComps/toolBar/toolSelector.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement("div",{className:b.keys(b.pick(this.getClasses(),b.identity)).join(" "),style:{position:"relative"}},this.state.isMenuDisplayed?a.createElement("div",{className:b.keys(b.pick(this.getDropDownClasses(),b.identity)).join(" "),key:"menuDropDown",onMouseLeave:this.hideMenu},this.props.children):null,a.createElement(c.tooltip,{disabled:!this.props.tooltip,value:this.props.tooltip,className:this.props.tooltipClass,delay:"600"},a.createElement("span",{className:"button",onClick:this.displayMenu},a.createElement(c.symbol,{name:this.props.symbol}))),this.props.children&&this.props.children.length>1?a.createElement("div",{key:"smallIndicator",className:"small-indicator"}):null)}}),define("rEditor/rootComps/toolBar/toolSelector",["react","lodash","rEditor/rootComps/toolBar/toolSelector.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"toolSelector",propTypes:{symbol:a.PropTypes.string,columns:a.PropTypes.number,onShow:a.PropTypes.func,tooltipClass:a.PropTypes.string,disabled:a.PropTypes.bool},getInitialState:function(){return{isMenuDisplayed:!1}},getDefaultProps:function(){return{columns:3,disable:!1}},displayMenu:function(){this.props.disabled||(this.setState({isMenuDisplayed:!0}),b.isFunction(this.props.onShow)&&this.props.onShow())},hideMenu:function(){var a=this;setTimeout(function(){a.setState({isMenuDisplayed:!1})},300)},getDropDownClasses:function(){var a={"drop-down":!0,disabled:this.props.disabled};return a["grid-"+this.props.columns+"-col"]=!0,a},getClasses:function(){var a={"tool-selector":!0};if(this.props.className){var c=this.props.className.split(" ");b.each(c,function(b){a[b]=!0})}return this.props.disabled&&(a.disabled=!0),a},render:c})}),define("rEditor/rootComps/toolBar/toolbarTop.rt",["react/addons","lodash","baseUI","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","core","rEditor/rootComps/toolBar/toolSelector"],function(a,b,c,d,e,f){"use strict";function g(a,b,c){this.moveForward()}function h(a,b,c){this.moveBackward()}function i(a,b,c){this.moveToFront()}function j(a,b,c){this.moveToBack()}function k(a,b,c){this.align("left")}function l(a,b,c){this.align("center")}function m(a,b,c){this.align("right")}function n(a,b,c){this.align("top")}function o(a,b,c){this.align("middle")}function p(a,b,c){this.align("bottom")}function q(){var q=this.props.restrictions,r=e.bi,s=d.editor;return a.createElement("div",{},a.createElement("div",{className:"inner button-grid"},a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_copy",s.COPY.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!q.duplicatable},b.identity)).join(" "),onClick:this.handleCopy},a.createElement(c.symbol,{name:"toolbarCopy"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_paste",s.PASTE.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!this.props.pasteEnabled},b.identity)).join(" "),onClick:this.handlePaste},a.createElement(c.symbol,{name:"toolbarPaste"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_duplicate",s.DUPLICATE.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!q.duplicatable},b.identity)).join(" "),onClick:this.handleDuplicate},a.createElement(c.symbol,{name:"toolbarDuplicate"}))),a.createElement(c.tooltip,{value:this.getDeleteTooltipText(),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!q.removable},b.identity)).join(" "),onClick:this.handleDelete},this.isMobileEditor()?null:a.createElement(c.symbol,{key:"deleteSymbol",name:"toolbarDelete"}),this.isMobileEditor()?a.createElement(c.symbol,{key:"hideSymbol",name:"gfpp_hide"}):null))),a.createElement("div",{className:"seperator"}),a.createElement("div",{className:"inner button-grid"},a.createElement(f,{disabled:!(q.canMoveForward||q.canMoveBackward),symbol:"toolbarMoveForward",columns:2,tooltip:this.getInfoTooltip("toolbar_tooltip_arrange","toolbar_tooltip_arrange_info"),tooltipClass:"control-tooltip-small"},a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_arrange_move_forward",s.SEND_FORWARD.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!q.canMoveForward},b.identity)).join(" "),onClick:g.bind(this,q,r,s)},a.createElement(c.symbol,{name:"toolbarMoveForward"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_arrange_move_backward",s.SEND_BACKWARD.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!q.canMoveBackward},b.identity)).join(" "),onClick:h.bind(this,q,r,s)},a.createElement(c.symbol,{name:"toolbarMoveBackward"}))),a.createElement(c.tooltip,{alignment:"bottom",value:this.getShortcutTooltip("toolbar_tooltip_arrange_bring_to_front",s.SEND_TO_FRONT.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!q.canMoveForward},b.identity)).join(" "),onClick:i.bind(this,q,r,s)},a.createElement(c.symbol,{name:"toolbarMoveToFront"}))),a.createElement(c.tooltip,{alignment:"bottom",value:this.getShortcutTooltip("toolbar_tooltip_arrange_send_to_back",s.SEND_TO_BACK.label),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:b.keys(b.pick({button:!0,disabled:!q.canMoveBackward},b.identity)).join(" "),onClick:j.bind(this,q,r,s)},a.createElement(c.symbol,{name:"toolbarMoveToBack"})))),a.createElement(f,{disabled:!q.alignable,symbol:"toolbarAlignRight",columns:3,onShow:this.reportBI.bind(this,r.events.toolbar.TOOL_BAR_ALIGNMENT_CLICK,{}),tooltip:this.getInfoTooltip("toolbar_tooltip_align","toolbar_tooltip_align_info"),tooltipClass:"control-tooltip-small"},a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_align_left"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:k.bind(this,q,r,s)},a.createElement(c.symbol,{name:"toolbarAlignLeft"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_align_center"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:l.bind(this,q,r,s)},a.createElement(c.symbol,{name:"toolbarAlignCenter"}))),a.createElement(c.tooltip,{value:this.getShortcutTooltip("toolbar_tooltip_align_right"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:m.bind(this,q,r,s)},a.createElement(c.symbol,{name:"toolbarAlignRight"}))),a.createElement(c.tooltip,{alignment:"bottom",value:this.getShortcutTooltip("toolbar_tooltip_align_top"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:n.bind(this,q,r,s)},a.createElement(c.symbol,{name:"toolbarAlignTop"}))),a.createElement(c.tooltip,{alignment:"bottom",value:this.getShortcutTooltip("toolbar_tooltip_align_middle"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:o.bind(this,q,r,s)},a.createElement(c.symbol,{name:"toolbarAlignMiddle"}))),a.createElement(c.tooltip,{alignment:"bottom",value:this.getShortcutTooltip("toolbar_tooltip_align_bottom"),styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"button",onClick:p.bind(this,q,r,s)},a.createElement(c.symbol,{name:"toolbarAlignBottom"}))))))}return function(){return q.apply(this,[])}}),define("rEditor/rootComps/toolBar/toolbarTop",["react","lodash","baseUI","panels","core","util","rEditor/rootComps/toolBar/toolbarTop.rt"],function(a,b,c,d,e,f,g){"use strict";var h=e.bi;return a.createClass({displayName:"toolbarTop",mixins:[e.mixins.editorAPIMixin],propTyeps:{restrictions:a.PropTypes.object,selectedComponent:a.PropTypes.arrayOf(a.PropTypes.object)},shouldComponentUpdate:function(a){return!b.isEqual(a,this.props)},getShortcutTooltip:function(b,d){return a.createElement(c.popoverTemplates.keyboardShortcutTooltip,{label:b,shortcut:d})},getDeleteTooltipText:function(){var a=this.isMobileEditor()?"toolbar_tooltip_hide":"toolbar_tooltip_delete";return this.props.restrictions.removable?this.getShortcutTooltip(a,f.translate("toolbar_tooltip_delete_shortcut")):this.getDisabledDeleteTooltipText(a,f.translate("toolbar_tooltip_delete_shortcut"))},getDisabledDeleteTooltipText:function(a,b){var c=this.getEditorAPI(),d=c.tooltipTextService.getComponentTooltipText(this.props.selectedComponent,"DELETE");return d?d:this.getShortcutTooltip(a,b)},getInfoTooltip:function(b,d){return a.createElement(c.popoverTemplates.titleBodyAndLinkTooltip,{title:b,text:d})},handleCopy:function(){if(this.props.restrictions.duplicatable){var a=this.getEditorAPI(),c=a.bi.getComponentsBIParams(this.props.selectedComponent);b.forEach(c,this.assignToolbarSpecificBI.bind(null,"origin")),this.getEditorAPI().components.copy(this.props.selectedComponent)}},handlePaste:function(){if(this.props.pasteEnabled){var a=this.getEditorAPI(),c=a.bi.getComponentsBIParams(this.props.selectedComponent);b.forEach(c,this.assignToolbarSpecificBI.bind(null,"origin")),d.panelManager.closeAllPanels(),a.components.paste(),a.history.add("component - paste")}},handleDuplicate:function(){if(this.props.restrictions.duplicatable){var a=this.getEditorAPI(),c=a.selection.getSelectedComponents(),d=a.bi.getComponentsBIParams(c);b.forEach(d,this.assignToolbarSpecificBI.bind(null,"origin")),a.components.duplicate(c),a.history.add("component - duplicate")}},handleDelete:function(){if(this.props.restrictions.removable){var a=this.getEditorAPI(),c=a.bi.getComponentsBIParams(this.props.selectedComponent);b.forEach(c,this.assignToolbarSpecificBI.bind(null,"removal_method")),a.components.remove(this.props.selectedComponent),a.history.add("component - remove"),a.bi.reportBI(h.events.editor.component_removed,c)}},isMobileEditor:function(){return this.getEditorAPI().isMobileEditor()},moveToFront:function(){var a=this.getEditorAPI();a.components.arrangement.moveToFront(this.props.selectedComponent)},moveForward:function(){var a=this.getEditorAPI();a.components.arrangement.moveForward(this.props.selectedComponent)},moveToBack:function(){var a=this.getEditorAPI();a.components.arrangement.moveToBack(this.props.selectedComponent)},moveBackward:function(){var a=this.getEditorAPI();a.components.arrangement.moveBackward(this.props.selectedComponent)},align:function(a){var b=this.getEditorAPI();b.components.alignment.align(this.props.selectedComponent,a),b.bi.event(h.events.toolbar.TOOL_BAR_ALIGNMENT_MENU_CLICK,{category:a})},assignToolbarSpecificBI:function(a,c){var d={};d[a]="toolbar",b.assign(c,d)},reportBI:function(a,b){this.getEditorAPI().bi.event(a,b)},render:g})}),define("rEditor/rootComps/toolBar/toolBar.rt",["react/addons","lodash","baseUI","util","rEditor/rootComps/toolBar/toolbarTop","experiment!boxSlideShow"],function(a,b,c,d,e,f){"use strict";function g(a,b){this.startDrag(b,this.getDragLimits())}function h(a,b){this.rotateComponent("rotationInDegrees",b)}function i(a,b){this.resizeComponent("width",b)}function j(a,b){this.resizeComponent("height",b)}function k(a,b){this.moveComponent("x",b)}function l(a,b){this.moveComponent("y",b)}function m(b){var e=f&&this.restrictions.canBeShownOnAllStates;return a.createElement("div",{className:"inner form",key:"inner-form"},this.restrictions.canBeFixed||e?null:a.createElement("div",{key:"containable"},a.createElement("span",{className:"layout-title show-on-all-pages-title"},d.translate("toolbar_show_on_all_pages")),a.createElement("label",{className:"row show-on-all-pages-row"},a.createElement(c.toggle,{name:"switch",className:"show-on-all-pages",key:"showOnAllPages",disabled:null===this.props.selectedComponent||!this.restrictions.canToggleShowOnAllPages,value:this.isShowOnAllPages(),onChange:this.handleShowOnAllPages}))),e?a.createElement("div",{key:"canBeShowOnAllStates"},a.createElement("span",{className:"layout-title show-on-all-slides-title"},d.translate("toolbar_show_on_all_slides")),a.createElement("label",{className:"row show-on-all-pages-row"},a.createElement(c.toggle,{name:"switch",className:"show-on-all-pages",key:"showOnAllStates",disabled:null===this.props.selectedComponent,value:this.isShownOnAllStates(),onChange:this.handleShowOnAllStatesChange}))):null,this.restrictions.canBeFixed?a.createElement("div",{key:"canBeFixed"},a.createElement("span",{className:"layout-title show-on-all-pages-title"},d.translate("toolbar_fixed_position")),a.createElement("label",{className:"row show-on-all-pages-row"},a.createElement(c.toggle,{name:"switch",className:"show-on-all-pages",key:"fixedPosition",value:this.restrictions.isFixed,onChange:this.handleFixed}))):null)}function n(){var f=this.compLayout;return a.createElement("div",{className:b.keys(b.pick({"rootcomp-toolbar":!0,hidden:this.props.hidden},b.identity)).join(" "),onContextMenu:this.props.onContextMenu},a.createElement("div",{className:"header"},a.createElement("div",{className:"drag-zone",onMouseDown:g.bind(this,f)},a.createElement("span",{className:"drag-handle"},a.createElement(c.symbol,{name:"toolbarDragHandle"}))),a.createElement("button",{className:"help",onClick:this.onHelp},"?"),a.createElement("span",{className:"close",onClick:this.onClose},a.createElement(c.symbol,{name:"toolbarClose"}))),a.createElement("div",{className:"header-seperator"}),a.createElement(e,{restrictions:this.restrictions,selectedComponent:this.props.selectedComponent,pasteEnabled:this.isPasteEnabled()}),a.createElement("div",{className:"seperator"}),a.createElement("div",{className:"inner form"},a.createElement("label",{"data-input-title":"input_rotation",className:"row"},a.createElement(c.tooltip,{value:"toolbar_tooltip_rotation",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{},a.createElement(c.symbol,{name:"toolbarRotation"}))),a.createElement(c.stepper,{className:"small degrees",disabled:!this.restrictions.rotatable,min:-(1/0),max:1/0,value:parseInt(f.rotationInDegrees,10),units:"",onChange:h.bind(this,f)}))),a.createElement("div",{className:"seperator"}),a.createElement("div",{className:"inner form"},a.createElement("span",{className:"layout-title"},d.translate("toolbar_size")),a.createElement("label",{className:"row"},a.createElement(c.tooltip,{value:"toolbar_tooltip_width",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"label",style:{paddingRight:"4px"}},d.translate("toolbar_width")+":")),a.createElement(c.stepper,{disabled:!this.restrictions.horizontallyResizable,className:"small",value:parseInt(f.width,10),min:-(1/0),max:1/0,onChange:i.bind(this,f)})),a.createElement("label",{className:"row"},a.createElement(c.tooltip,{value:"toolbar_tooltip_height",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"label"},d.translate("toolbar_height")+":")),a.createElement(c.stepper,{disabled:!this.restrictions.verticallyResizable,className:"small",min:-(1/0),max:1/0,value:parseInt(f.height,10),onChange:j.bind(this,f)}))),a.createElement("div",{className:"seperator"}),a.createElement("div",{className:"inner form"},a.createElement("span",{className:"layout-title"},d.translate("toolbar_position")),a.createElement("label",{"data-input-title":"input_x",className:"row"},a.createElement(c.tooltip,{value:"toolbar_tooltip_x_position",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"label"},d.translate("toolbar_x")+":")),a.createElement(c.stepper,{disabled:!this.restrictions.horizontallyMovable,className:"small",min:-(1/0),max:1/0,value:parseInt(f.bounding.x,10),onChange:k.bind(this,f)})),a.createElement("label",{"data-input-title":"input_y",className:"row"},a.createElement(c.tooltip,{value:"toolbar_tooltip_y_position",styleType:c.uiConstants.TOOLTIP.STYLE_TYPE.SMALL,delay:"600"},a.createElement("span",{className:"label"},d.translate("toolbar_y")+":")),a.createElement(c.stepper,{disabled:!this.restrictions.verticallyMovable,className:"small",min:-(1/0),max:1/0,value:parseInt(f.bounding.y,10),onChange:l.bind(this,f)}))),a.createElement("div",{className:"seperator",key:"seperator-inner-form"}),m.apply(this,[f]))}return function(){return n.apply(this,[])}}),define("rEditor/rootComps/toolBar/toolBar",["react","lodash","jquery","util","panels","core","baseUI","rEditor/rootComps/toolBar/toolBar.rt","experiment!sectionsReorganizeExp"],function(a,b,c,d,e,f,g,h,i){"use strict";function m(a,b,c){return a[b]+c-a.bounding[b]}var j=d.singlePassDOMReadWriteMixin,k=f.bi,l={rotationInDegrees:0,width:0,height:0,x:0,y:0,bounding:{x:0,y:0}};return a.createClass({displayName:"toolBar",mixins:[f.mixins.editorAPIMixin,d.draggableMixin,j],propTypes:{selectedComponent:a.PropTypes.arrayOf(a.PropTypes.object)},getInitialState:function(){var a=this.getEditorAPI();this.props.selectedComponent?(this.compLayout=a.components.layout.get(this.props.selectedComponent),this.restrictions=a.getCompRestrictions(this.props.selectedComponent)):this.updateNoSelectedComponent()},componentWillReceiveProps:function(a){var b=a.selectedComponent,c=this.getEditorAPI();b?(this.compLayout=c.components.layout.getRelativeToStructure(b),this.restrictions=c.getCompRestrictions(b)):this.updateNoSelectedComponent()},measurePhase:function(){return this.calculatePosition()},patchPhase:function(a){this.props.hidden||c(this.getDOMNode()).css(a)},updateNoSelectedComponent:function(){this.compLayout=l,this.restrictions={}},resizeComponent:function(a,b){this.getEditorAPI().bi.event(k.events.editBox.RESIZE,{origin:"toolbar"}),this.setComponentLayoutChange(a,b)},moveComponent:function(a,b){this.getEditorAPI().bi.event(k.events.editBox.MOVE_COMPONENT,{origin:"toolbar"}),this.setComponentLayoutChange(a,b)},rotateComponent:function(a,b){var c=parseInt(b,10);0===c?this.getEditorAPI().bi.event(k.events.editBox.CANCEL_ROTATE_COMPONENT):this.getEditorAPI().bi.event(k.events.editBox.ROTATE_COMPONENT,{origin:"toolbar",value:c}),this.setComponentLayoutChange(a,b)},setComponentLayoutChange:function(a,c){var d=this.getEditorAPI();if(c=parseInt(c,10),isNaN(c))return void this.forceUpdate();("y"===a||"x"===a)&&(c=m(this.compLayout,a,c));var e=d.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(this.props.selectedComponent),f=d.components.layout.getRelativeToStructure(e);if(f[a]!==c){var g={};if(g[a]=c,d.multiselect.isMultiselect(e)){var h=f.width/f.height,i=d.components.layout.getProportionStructure(e);"height"===a?g.width=c*h:"width"===a&&(g.height=c/h),g=b.mapValues(g,b.round),d.components.layout.updateAndPreserveProportions(e,g,i,!0)}else d.components.layout.updateRelativeToStructure(e,g,!0);d.history.add("toolbar - set selected component layout - "+a)}},calculatePosition:function(){return this.state.isCustomPosition?this.fitCustomPositionToScreen():this.getInitialPosition()},fitCustomPositionToScreen:function(){var a=this.getDragLimits(),b=this.getDOMNode(),c=b.getBoundingClientRect(),e=c.top,f=c.left,g=d.math.ensureWithinLimits(f,a.x[0],a.x[1]-c.width),h=d.math.ensureWithinLimits(e,a.y[0],a.y[1]);return{left:g,top:h}},getInitialPosition:function(){var a=f.utils.stageUtils.getStageLayout(),b=c(this.getDOMNode()).height(),d=(a.bottom-b)/2;return{right:i?60:10,top:d}},onClose:function(){this.getEditorAPI().toolbar.toggleToolbar()},onHelp:function(){e.panelManager.openHelpCenter("4ab49cd7-2ea4-4873-904e-f65d17d2f1dd")},handleShowOnAllPages:function(){this.props.selectedComponent&&this.restrictions.canShowOnAllPages&&this.getEditorAPI().components.toggleShowOnAllPages(this.props.selectedComponent)},handleShowOnAllStatesChange:function(){this.props.selectedComponent&&this.restrictions.canBeMasterChild&&this.getEditorAPI().components.toggleShowOnAllStates(this.props.selectedComponent,"wysiwyg.viewer.components.BoxSlideShow")},isShowOnAllPages:function(){if(null===this.props.selectedComponent||void 0===this.props.selectedComponent)return!1;var a=this.getEditorAPI();return a.components.isShowOnAllPages(this.props.selectedComponent)},isShownOnAllStates:function(){if(null===this.props.selectedComponent||void 0===this.props.selectedComponent)return!1;var a=this.getEditorAPI();return a.components.isShownOnAllStates(this.props.selectedComponent,"wysiwyg.viewer.components.BoxSlideShow")},handleFixed:function(){this.getEditorAPI().selectedComponent.toggleFixedPosition()},isPasteEnabled:function(){var a=this.getEditorAPI();return a.clipboardContainsComp()&&a.isDesktopEditor()&&!a.components.layout.isPinned(this.props.selectedComponent)},getDragLimits:function(){var a=f.utils.stageUtils.getStageLayout(),b=f.constants.PANELS.PANEL_SIZE_TO_KEEP_IN_VIEW,c=this.getDOMNode(),d=c.clientHeight,e=10;return{x:[a.left+e,a.right-e],y:[a.top+e,a.bottom+d-b]}},render:h})}),define("rEditor/rootComps/gfpp/gfppModel",["lodash","gfppData"],function(a,b){"use strict";function h(b,c,d){return a.isFunction(b)?b(c,d):b}function i(b,c,e){return b?(b=a.cloneDeep(b),a.each(b,function(b){a.each(b,function(f,g){a.contains(d,g)||(b[g]=h(f,c,e))})}),b):null}function j(a,b,c){var d=b.isMobileEditor(),e=d?a.mobileMainActions:a.mainActions;return e=h(e,b,c),i(e,b,c)}function k(b,c,d){var e=c.isMobileEditor(),f=e?b.mobileEnabledActions:b.enabledActions;f=h(f,c,d)||[],!a.contains(f,"pinMode")&&c.components.layout.isPinned(d)?f.push("pinMode"):a.contains(f,"pinMode")&&!c.components.layout.isPinned(d)&&a.remove(f,function(a){return"pinMode"===a});var j=h(b.presetActions,c,d);return j=a.merge({},a.pick(g,f),a.pick(j,f)),i(j,c,d)}function l(c,d){var e=c.isMobileEditor();return d.helpId=e?d.mobileHelpId:d.helpId,d.isSelected=a.isUndefined(d.isSelected)?b.utils.isHelpPanelOpen(d.helpId):d.isSelected,d}function m(b,c){return a.last(b.components.getType(c).split("."))}function n(a,c){var d=m(a,c),e=b.getComponentData(d)||f,g=j(e,a,c),h=k(e,a,c);return h.help&&(h.help=l(a,h.help)),h=o(h,a,c),{mainActions:g,presetActions:h}}function o(b,d,e){var f=[];return b[c.ACTIONS.HIDE]&&(d.components.is.removable(e)||f.push(c.ACTIONS.HIDE)),b[c.ACTIONS.ANIMATION]&&(d.components.is.animatable(e)&&d.multiselect.areComponentsOfSamePage(e)||f.push(c.ACTIONS.ANIMATION)),f.length?a.omit(b,f):b}var c=b.consts,d=["onClick"],e=[c.ACTIONS.SETTINGS,c.ACTIONS.LAYOUT,c.ACTIONS.ANIMATION,c.ACTIONS.HELP],f={enabledActions:e},g={settings:{isSelected:b.utils.getPanelStateFn("settings"),tooltip:"gfpp_tooltip_settings",icon:"settings",onClick:b.utils.getTogglePanelFn("settings")},design:{isSelected:b.utils.getPanelStateFn("design"),tooltip:"gfpp_tooltip_design",icon:"design",onClick:b.utils.getTogglePanelFn("design")},layout:{isSelected:b.utils.getPanelStateFn("layout"),tooltip:"gfpp_tooltip_layout",icon:"layout",onClick:b.utils.getTogglePanelFn("layout")},upgrade:{isSelected:!1,tooltip:"gfpp_tooltip_upgrade",icon:"",onClick:b.utils.getTogglePanelFn("upgrade")},aviary:{isSelected:!1,tooltip:"gfpp_tooltip_imageeffects",icon:"effects",onClick:b.utils.openAviaryPanel},animation:{isSelected:b.utils.getPanelStateFn("animation"),isApplied:!1,tooltip:"gfpp_tooltip_animation",tooltip_active:"gfpp_tooltip_applied_animation",icon:"animation",onClick:b.utils.getTogglePanelFn("animation")},link:{isSelected:b.utils.getPanelStateFn("link"),isApplied:b.utils.getDataDefinedFn("link"),tooltip:"gfpp_tooltip_linkto",tooltip_active:"gfpp_tooltip_applied_linkto",icon:"link",onClick:b.utils.openLinkPanel},hide:{isSelected:!1,tooltip:"gfpp_tooltip_mobile_hide",icon:"gfpp_hide",onClick:function(a){a.selectedComponent.remove(),a.history.add("component - remove")}},help:{tooltip:"gfpp_tooltip_help",icon:"gfpp_help",mobileHelpId:"b6d9a270-f9c5-4837-995b-c3818b13a643"},pinMode:{isSelected:b.utils.getPanelStateFn("panels.pinnedDockPanel"),tooltip:"gfpp_tooltip_PinToScreen",icon:"gfpp_pin",className:"gfpp-pin",onClick:function(a){a.openPinMode("gfpp")}}};return{getData:n}}),define("rEditor/rootComps/rightClickMenu/util/rcmDataParser",["lodash","rEditor/rootComps/gfpp/gfppModel","experiment!boxSlideShow","experiment!pinToScreen"],function(a,b,c,d){"use strict";function f(){return{enabled:!0}}function g(a){return e.components.is.duplicatable(a)&&!e.components.layout.isPinned(a)}function h(a){return g(a)?{enabled:!0}:null}function i(a){return g(a)?{enabled:!0}:null}function j(a){if(a)return null;var b=!!e.clipboard.getItem(e.clipboard.types.COMPONENT);return{enabled:b}}function k(a){return g(a)?{enabled:!0}:null}function l(a){var b=e.components.is.styleCanBeApplied(a);return b?{enabled:!0}:null}function m(a){var b=e.hasExternalDesign(a);return b?null:{enabled:!0}}function n(a){var b=e.hasExternalDesign(a);if(b)return null;var c=!!e.clipboard.getItem(e.clipboard.types.COMPONENT_DESIGN);return{enabled:c}}function p(b){var c=e.components.arrangement.canMoveBackward(b)||e.components.arrangement.canMoveForward(b),d=e.components.is.fixed(b)&&a.contains(o,e.components.getType(b));return!c||d?null:{type:"subItems",enabled:!0,subItems:q(b)}}function q(a){return{moveToFront:{icon:{svgName:"bringToFront"},enabled:e.components.arrangement.canMoveForward(a)},moveToBack:{icon:{svgName:"sendToBack"},enabled:e.components.arrangement.canMoveBackward(a)},moveForward:{icon:{svgName:"moveForward"},enabled:e.components.arrangement.canMoveForward(a)},moveBackward:{icon:{svgName:"moveBackward"},enabled:e.components.arrangement.canMoveBackward(a)}}}function r(a,b){var c=s(a);return!c.length||1===c.length&&c[0].component.id===b.id?null:{type:"subItems",shouldShowCount:!0,enabled:!0,subItems:c}}function s(b){return a.chain(b).filter(function(b){return!a.contains(["SITE_PAGES","PAGES_CONTAINER"],b.id)&&!e.utils.isPage(b)}).transform(function(a,b){a.push({component:b,key:"overlappingSubItem_"+b.id,icon:e.components.getIconInfo(b),label:e.components.getDisplayName(b),enabled:!0})}).value()}function t(a){return{enabled:e.components.is.removable(a),operationKey:"DELETE"}}function u(a){return{value:c?e.components.isShownOnAllStates(a,"wysiwyg.viewer.components.BoxSlideShow"):!1,enabled:c?e.components.canBeShownOnAllStates(a,"wysiwyg.viewer.components.BoxSlideShow"):!1,operationKey:"SHOW_ON_ALL_SLIDES"}}function v(a){var b=e.components.is.fixed(a),c=e.tpa.isTpaByCompType(e.components.getType(a)),d=c&&b;return e.components.canToggleShowOnAllPages(a)||d?{value:d||e.components.isShowOnAllPages(a),enabled:!d,operationKey:"SHOW_ON_ALL_PAGES"}:null}function w(a){return e.components.layout.canBeFixedPosition(a)?{value:e.components.is.fixed(a),enabled:!0}:null}function x(a,b){return!b&&d&&e.components.is.pinnable(a)?{value:e.components.is.fixed(a),enabled:!0}:null}function y(c){var d=b.getData(e,c),f=["settings","design","layout","upgrade","aviary","animation","link"],g=(d.mainActions||[]).concat(a(d.presetActions).pick(f).toArray().value());return a.transform(g,function(b,d){b.push({shouldTranslate:a.isBoolean(d.shouldTranslate)?d.shouldTranslate:!0,item:{enabled:!0,label:d.label||d.tooltip},onClick:function(){d.onClick(e,c),e.closeRightClickMenu()}})},[])}function z(a,b,c){return a?{undo:f(),copy:i(a),paste:j(c),cut:h(a),duplicate:k(a),copyDesign:m(a),pasteDesign:n(a),arrange:p(a),overlappingItems:r(b,a),remove:t(a),showOnAllPages:v(a),showOnAllStates:u(a),fixedPosition:w(a),gfppItems:y(a),styleCanBeApplied:l(a),pin:x(a,c)}:{paste:j(c),undo:f()}}var e,o=["wysiwyg.viewer.components.tpapps.TPAGluedWidget"],A={buildMenuItems:function(a,b,c){return e=c,z(b,a,e.isMobileEditor())},rebuildArrangeMenu:function(a,b){return e=b,p(a)}};return A}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemBasic.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement("li",{className:b.keys(b.pick({"item-basic":!0,disabled:!this.props.item.enabled,hoverable:this.props.item.enabled},b.identity)).join(" "),onClick:this.props.item.enabled?this.props.onClick:function(){},
onContextMenu:this.props.item.enabled?this.props.onClick:function(){},onMouseEnter:this.props.onMouseEnter||b.noop,onMouseLeave:this.props.onMouseLeave||b.noop},this.props.item.icon?a.createElement("span",{className:"icon",key:"icon"},this.props.item.icon.svgName?a.createElement(c.symbol,{name:this.props.item.icon.svgName,key:"svg"}):null,this.props.item.icon.css?a.createElement("span",{style:this.getImageIconStyle(),key:"style"}):null):null,a.createElement("span",{className:"label"},this.translateIfNeeded(this.props.item.label)))}}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemBasic",["react","lodash","util","rEditor/rootComps/rightClickMenu/menuItems/rcmItemBasic.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"rcmItemBasic",mixins:[c.translationMixin],getImageIconStyle:function(){return b.merge({},this.props.item.icon.css,{backgroundImage:"url("+this.props.item.icon.src+")"})},render:d})}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement(c.tooltip,{value:this.getTooltipText(),alignment:"right",disabled:!this.getTooltipText()},a.createElement("li",{className:b.keys(b.pick({"item-shortcut":!0,disabled:!this.props.item.enabled,hoverable:this.props.item.enabled},b.identity)).join(" "),onClick:this.props.item.enabled?this.props.onClick:function(){},onContextMenu:this.props.item.enabled?this.props.onClick:function(){}},this.props.item.icon?a.createElement("span",{className:"icon",key:"icon"},this.props.item.icon.svgName?a.createElement(c.symbol,{name:this.props.item.icon.svgName,key:"svg"}):null):null,a.createElement("span",{className:"label label-shortcut"},this.translateIfNeeded(this.props.label)),a.createElement("span",{className:"action action-shortcut"},this.props.shortcut)))}}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut",["react","core","lodash","util","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"rcmItemWithShortcut",mixins:[d.translationMixin,b.mixins.editorAPIMixin],getTooltipText:function(){var a=this.getEditorAPI(),b=a.tooltipTextService.getSelectedComponentTooltipText(this.props.item.operationKey);return b},render:e})}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItems.rt",["react/addons","lodash","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut"],function(a,b,c){"use strict";return function(){return a.createElement("li",{className:b.keys(b.pick({disabled:!this.props.item.enabled,hoverable:this.props.item.enabled},b.identity)).join(" ")},a.createElement("span",{className:"label label-sub-item"},a.createElement("span",{},this.translateIfNeeded(this.props.label)),this.props.item.shouldShowCount?a.createElement("span",{key:"count"}," ("+a.Children.count(this.props.children)+")"):null),a.createElement("span",{className:"action action-expand"}),a.createElement("div",{className:"rightClickMenu subMenu"},a.createElement("ul",{},this.props.children)))}}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItems",["react","lodash","util","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItems.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"rcmItemWithSubItems",mixins:[c.translationMixin],render:d})}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItemsRecursive.rt",["react/addons","lodash","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut"],function(a,b,c){"use strict";return function(){return a.createElement("li",{className:b.keys(b.pick({disabled:!this.props.item.enabled,hoverable:this.props.item.enabled},b.identity)).join(" "),onClick:this.props.onClick},a.createElement("span",{className:"label label-sub-item"},a.createElement("span",{},this.translateIfNeeded(this.props.label)),this.props.item.shouldShowCount?a.createElement("span",{key:"count"}," ("+a.Children.count(this.props.children)+")"):null),a.createElement("span",{className:b.keys(b.pick({action:!0,"action-expand":this.props.items.length>0},b.identity)).join(" ")}),a.createElement("div",{className:"rightClickMenu subMenu"},a.createElement("ul",{},this.getChildren())))}}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItemsRecursive",["react","lodash","util","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItemsRecursive.rt"],function(a,b,c,d){"use strict";var e=a.createClass({displayName:"rcmItemWithSubItems",mixins:[c.translationMixin],getChildren:function(){return b.map(this.props.items,function(b){return a.createElement(e,b)})},render:d});return e}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithToggle.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement(c.tooltip,{value:this.getTooltipText(),alignment:"right",disabled:!this.getTooltipText()},a.createElement("li",{className:b.keys(b.pick({disabled:!this.props.item.enabled},b.identity)).join(" ")},a.createElement("span",{className:"label label-toggle"},this.translateIfNeeded(this.props.label)),a.createElement(c.toggle,b.assign({},{className:this.props.className+" action",value:this.props.value,onChange:this.props.item.enabled?this.props.onChange:b.noop},{disabled:!this.props.item.enabled}))))}}),define("rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithToggle",["react","core","lodash","util","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithToggle.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"rcmItemWithToggle",mixins:[d.translationMixin,b.mixins.editorAPIMixin],getTooltipText:function(){var a=this.getEditorAPI(),b=a.tooltipTextService.getSelectedComponentTooltipText(this.props.item.operationKey);return b},render:e})}),define("rEditor/rootComps/rightClickMenu/rightClickMenu.rt",["react/addons","lodash","rEditor/rootComps/rightClickMenu/menuItems/rcmItemBasic","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithShortcut","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItems","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithSubItemsRecursive","rEditor/rootComps/rightClickMenu/menuItems/rcmItemWithToggle","rEditor/rootComps/keyboard/config/keyboardShortcutsActionMap","experiment!rightClickDebug","experiment!applyStyle","experiment!boxSlideShow"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(b,d,e,f,g){return a.createElement(c,{shouldTranslate:f.shouldTranslate,item:f.item,label:f.item.label,key:f.item.label,onClick:f.onClick})}function m(a,b,c,d,e){this.openApplyToDialog(d)}function n(b,d,e,f,g){return a.createElement(c,{key:"rcmApplyStyle",label:"RightClick_Menu_Copy_Design_Label",item:this.getApplyToInfoItem(),onClick:m.bind(this,b,d,e,f,g)})}function o(b,d,e,f,g){return a.createElement(c,{item:f,label:f.label,key:f.key,onClick:this.onOverlappingItemClick.bind(this,f),shouldTranslate:!1,onMouseEnter:this.onOverlappingItemMouseEnter.bind(this,f),onMouseLeave:this.onOverlappingItemMouseLeave})}function p(b,c,d){var e=k&&b.showOnAllStates&&b.showOnAllStates.enabled;return b.showOnAllPages||b.fixedPosition||e?a.createElement("ul",{key:"rcmShowOnAllPagesFixPosition"},b.showOnAllPages&&!e?a.createElement(g,{item:b.showOnAllPages,className:"show-on-all-pages",label:"RightClick_Menu_Show_On_All_Pages_Label",value:b.showOnAllPages.value,onChange:this.toggleShowOnAllPages,key:"rcmShowOnAllPages"}):null,e?a.createElement(g,{item:b.showOnAllStates,className:"show-on-all-pages",label:"RightClick_Menu_Show_On_All_Slides_Label",value:b.showOnAllStates.value,onChange:this.toggleShowOnAllStates,key:"rcmShowOnAllStates"}):null,b.fixedPosition?a.createElement(g,{item:b.fixedPosition,label:"RightClick_Menu_Fixed_Position_Label",value:b.fixedPosition.value,onChange:this.toggleFixedPosition,key:"rcmFixPosition"}):null):null}function q(b,c,d,e,g){return a.createElement(f,{shouldTranslate:!1,key:e.id,label:"Debug - "+c.components.getDisplayName(e)+" - "+e.id,item:{enabled:!0},items:this.getDebugItems(e)})}function r(a,b,c,d,e){this.exportDebugInfo(d)}function s(b,d,e,f,g){return a.createElement(c,{shouldTranslate:!1,item:this.getExportDebugInfoItem(f),key:f.id+".debugInfo",onClick:r.bind(this,b,d,e,f,g)})}function t(){var c=this.state.menuItems,f=this.getEditorAPI(),g=h.editor;return this.state.menuItems?a.createElement("div",{style:{top:this.state.position.y,left:this.state.position.x},className:b.keys(b.pick(this.getClasses(),b.identity)).join(" "),onContextMenu:this.onRightClick,key:"rcm"},this.props.selectedComponents?null:a.createElement("ul",{key:"noCompSelectedItems"},c.paste?a.createElement(d,{item:c.paste,label:"RightClick_Menu_Paste_Label",shortcut:g.PASTE.label,onClick:this.pasteComponent,key:"noCompSelectedPaste"}):null),this.props.selectedComponents?a.createElement("div",{key:"selectedCompItems"},b.isEmpty(c.gfppItems)?null:a.createElement.apply(this,["ul",{key:"gfppItems"},b.map(c.gfppItems,l.bind(this,c,f,g))]),a.createElement.apply(this,["ul",{},a.createElement(d,{item:c.undo,label:"TOPBAR_Edit_Undo",shortcut:g.UNDO.label,onClick:this.undo}),c.cut?a.createElement(d,{item:c.cut,label:"RightClick_Menu_Cut_Label",shortcut:g.CUT.label,onClick:this.cutComponent,key:"rcmCut"}):null,c.copy?a.createElement(d,{item:c.copy,label:"RightClick_Menu_Copy_Label",shortcut:g.COPY.label,onClick:this.copyComponent,key:"rcmCopy"}):null,j&&c.styleCanBeApplied?b.map(this.props.selectedComponents,n.bind(this,c,f,g)):null,c.paste?a.createElement(d,{item:c.paste,label:"RightClick_Menu_Paste_Label",shortcut:g.PASTE.label,onClick:this.pasteComponent,key:"rcmPaste"}):null,c.duplicate?a.createElement(d,{item:c.duplicate,label:"RightClick_Menu_Duplicate_Label",shortcut:g.DUPLICATE.label,onClick:this.duplicateComponent,key:"rcmDuplicate"}):null]),c.arrange||c.overlappingItems?a.createElement("ul",{key:"rcmArrangeOverlapping"},c.overlappingItems?a.createElement.apply(this,[e,{label:"RightClick_Menu_Overlapping_Items_Label",item:c.overlappingItems,key:"rcmOverlapping"},b.map(c.overlappingItems.subItems,o.bind(this,c,f,g))]):null,c.arrange?a.createElement(e,{item:c.arrange,label:"RightClick_Menu_Arrange_Label",key:"rcmArrange",onMouseOver:this.onArrangeHover},a.createElement(d,{item:c.arrange.subItems.moveToFront,label:"RightClick_Menu_Bring_to_Front_Label",shortcut:g.SEND_TO_FRONT.label,onClick:this.moveToFront}),a.createElement(d,{item:c.arrange.subItems.moveToBack,label:"RightClick_Menu_Send_to_Back_Label",shortcut:g.SEND_TO_BACK.label,onClick:this.moveToBack}),a.createElement(d,{item:c.arrange.subItems.moveForward,label:"RightClick_Menu_Move_Forward_Label",shortcut:g.SEND_FORWARD.label,onClick:this.moveForward}),a.createElement(d,{item:c.arrange.subItems.moveBackward,label:"RightClick_Menu_Move_Backward_Label",shortcut:g.SEND_BACKWARD.label,onClick:this.moveBackward})):null):null,c.remove?a.createElement("ul",{key:"rcmRemove"},a.createElement(d,{item:c.remove,label:this.getEditorAPI().isMobileEditor()?"RightClick_Menu_Mobile_Hide_Label":"RightClick_Menu_Delete_Label",shortcut:"Del",onClick:this.removeComponent})):null,c.pin?a.createElement("ul",{key:"rcmPin"},c.pin?a.createElement(d,{item:c.pin,label:this.getPinLabel(),value:c.pin.value,onClick:this.openPinMode,key:"rcmPin"}):null):null,p.apply(this,[c,f,g]),i?a.createElement.apply(this,["ul",{key:"debug"},b.map(this.props.selectedComponents,q.bind(this,c,f,g)),b.map(this.props.selectedComponents,s.bind(this,c,f,g))]):null):null):null}return function(){return t.apply(this,[])}}),define("rEditor/rootComps/rightClickMenu/rightClickMenu",["react","lodash","jquery","core","rEditor/rootComps/rightClickMenu/util/rcmDataParser","util","experiment!boxSlideShow","rEditor/rootComps/rightClickMenu/rightClickMenu.rt"],function(a,b,c,d,e,f,g,h){"use strict";function l(a){var c=i.selection.getComponentsUnderClick(a.x,a.y-window.pageYOffset);return g?b.reject(c,function(a){return!i.components.is.selectable(a)}):c}function m(a,c,d){return b.map(b.keys(c),function(e){var f=c[e],g=d.concat(e);return{key:e,label:e,onClick:function(b){console.log(a,g.join("."),f),b.stopPropagation()},items:b.isString(f)||b.isNumber(f)?[]:m(a,f,g),item:{enabled:!0}}})}function n(a,c){return!b.isEqual(a.position,c.position)}function o(a,b,c){var d=c,e=b.outerHeight(),f=d+e;if(f>a.bottomY){var g=d-e;return g<a.y?a.y:g}return d}function p(a,b,c){var d=c,e=b.outerWidth(),f=d+e;if(f-window.pageXOffset>a.rightX){var g=d-e;return g<a.x?d+a.x:g}return d}function q(a,b){var c=d.utils.stageUtils.getViewPort(!0),e=p(c,a,b.x),f=o(c,a,b.y);return{x:e,y:f}}function r(a,e){var f=d.utils.stageUtils.getViewPort(),g=a.find(".subMenu");if(0===g.length)return!1;var h=c(b.max(g,function(a){return c(a).outerWidth()}));return e.x+a.outerWidth()+h.outerWidth()>f.rightX}function s(a){var b=this.state.menuItems;b.arrange=e.rebuildArrangeMenu(a,this.getEditorAPI()),this.setState({menuItems:b})}var i,j=d.bi,k="rcm";return a.createClass({displayName:"rightClickMenu",mixins:[d.mixins.editorAPIMixin,f.outerClickMixin],propTypes:{selectedComponents:a.PropTypes.array},onOuterClick:function(){i.closeRightClickMenu()},getInitialState:function(){i=this.getEditorAPI();var a=this.props.position,b=l(a);return{position:this.props.position,openSubMenuToLeft:!1,menuItems:e.buildMenuItems(b,this.props.selectedComponents,i)}},componentDidMount:function(){var a=q(c(this.getDOMNode()),this.state.position),b=r(c(this.getDOMNode()),a);if(this.setState({position:a,openSubMenuToLeft:b}),this.props.selectedComponents){var d=i.components.getType(this.props.selectedComponents[0]),e=d?d.split(".").pop():"";i.bi.event(j.events.rightClickMenu.RIGHT_CLICK_MENU_OPEN,{component:e})}},componentWillReceiveProps:function(a){var c=a.position,d=l(c),f={menuItems:e.buildMenuItems(d,a.selectedComponents,this.getEditorAPI())};n(this.props,a)&&b.assign(f,{position:a.position}),this.setState(f);var g=i.components.getType(this.props.selectedComponents);g&&i.bi.event(j.events.rightClickMenu.OVERLAPPING_ITEM_CLICK,{component:g})},onOverlappingItemMouseEnter:function(a){i.bi.event(j.events.rightClickMenu.OVERLAPPING_ITEMS_HOVER,{origin:k}),i.hoverBox.set(a.component,!0)},onOverlappingItemMouseLeave:function(){i.hoverBox.clear()},getClasses:function(){return{rightClickMenu:!0,"open-sub-menu-left":this.state.openSubMenuToLeft}},onRightClick:function(a){a.preventDefault()},undo:function(){this.getEditorAPI().history.undo(),i.closeRightClickMenu()},cutComponent:function(){var a=i.bi.getComponentsBIParams(this.props.selectedComponents);b.forEach(a,this.assignRCMSpecificBI.bind(null,"origin")),i.selectedComponent.cut(),i.closeRightClickMenu(),i.history.add("cut component via rightClickMenu"),i.bi.reportBI(j.events.rightClickMenu.CUT,a)},copyComponent:function(){var a=i.bi.getComponentsBIParams(this.props.selectedComponents);b.forEach(a,this.assignRCMSpecificBI.bind(null,"origin")),i.selectedComponent.copy(),i.closeRightClickMenu(),i.bi.reportBI(j.events.rightClickMenu.COPY,a)},pasteComponent:function(){var a=i.bi.getComponentsBIParams(this.props.selectedComponents);b.forEach(a,this.assignRCMSpecificBI.bind(null,"origin"));var c=this.props.position;c.x-=i.site.getXPos(),c.y=c.y-i.components.layout.get(i.siteSegments.getPagesContainer()).y-this.props.previewTop,i.components.paste(c,!0),i.closeRightClickMenu(),i.history.add("paste component via rightClickMenu"),i.bi.reportBI(j.events.rightClickMenu.PASTE,a)},duplicateComponent:function(){var a=i.bi.getComponentsBIParams(this.props.selectedComponents);b.forEach(a,this.assignRCMSpecificBI.bind(null,"origin")),i.selectedComponent.duplicate(),i.closeRightClickMenu(),i.history.add("duplicate component via rightClickMenu"),i.bi.reportBI(j.events.rightClickMenu.DUPLICATE,a)},copyDesign:function(){i.selectedComponent.copyStyle(),i.bi.event(j.events.rightClickMenu.COPY_DESIGN,{category:"",component:""})},pasteDesign:function(){i.selectedComponent.pasteStyle(),i.bi.event(j.events.rightClickMenu.PASTE_DESIGN,{category:"",component:""})},lockComponent:function(){i.selectedComponent.lock(),i.closeRightClickMenu(),i.bi.event(j.events.rightClickMenu.LOCK,{category:"",component:""})},removeComponent:function(){var a=i.bi.getComponentsBIParams(this.props.selectedComponents);b.forEach(a,this.assignRCMSpecificBI.bind(null,"removal_method")),i.selectedComponent.remove(function(){i.history.add("removed component via rightClickMenu")}),i.closeRightClickMenu(),i.bi.reportBI(j.events.editor.component_removed,a)},assignRCMSpecificBI:function(a,c){var d={};d[a]=k,b.assign(c,d)},toggleShowOnAllPages:function(){var a=i.components.toggleShowOnAllPages(this.props.selectedComponents),b=this.state.menuItems;b.showOnAllPages.value=a,this.setState({menuItems:b}),i.bi.event(j.events.rightClickMenu.SHOW_ON_ALL_PAGES,{new_status:a,origin:k})},toggleShowOnAllStates:function(){i.components.toggleShowOnAllStates(this.props.selectedComponents,"wysiwyg.viewer.components.BoxSlideShow");var a=this.state.menuItems;a.showOnAllStates.value=!a.showOnAllStates.value,this.setState({menuItems:a})},toggleFixedPosition:function(){var a=i.selectedComponent.toggleFixedPosition(),b=this.state.menuItems;b.fixedPosition.value=a,this.setState({menuItems:b});var c=i.components.getType(this.props.selectedComponents[0]);i.bi.event(j.events.rightClickMenu.FIXED_POSITION,{origin:k,new_status:a,component:c})},openPinMode:function(){i.closeRightClickMenu();var a=i.components.layout.isPinned(this.props.selectedComponents);a?(i.components.layout.unDock(this.props.selectedComponents[0]),i.components.layout.setFixed(this.props.selectedComponents,!1),i.bi.event(j.events.rightClickMenu.FIXED_POSITION,{origin:"rcm",component:i.getComponentType(this.props.selectedComponents)}),f.keyboardShortcuts.setContext(f.keyboardShortcuts.CONTEXTS.EDITOR)):i.openPinMode("rcm")},moveForward:function(){i.components.arrangement.moveForward(this.props.selectedComponents),s.call(this,this.props.selectedComponents),i.bi.event(j.events.rightClickMenu.MOVE_FORWARD,{origin:k})},moveBackward:function(){i.components.arrangement.moveBackward(this.props.selectedComponents),s.call(this,this.props.selectedComponents),i.bi.event(j.events.rightClickMenu.MOVE_BACKWARDS,{origin:k})},moveToFront:function(){i.components.arrangement.moveToFront(this.props.selectedComponents),s.call(this,this.props.selectedComponents),i.bi.event(j.events.rightClickMenu.BRING_TO_FRONT,{origin:k})},moveToBack:function(){i.components.arrangement.moveToBack(this.props.selectedComponents),s.call(this,this.props.selectedComponents),i.history.add("component - move to back"),i.bi.event(j.events.rightClickMenu.SEND_TO_BACK,{origin:k})},onArrangeHover:function(){i.bi.event(j.events.rightClickMenu.ARRANGE_HOVER,{origin:k})},onOverlappingItemClick:function(a){i.selection.selectComponentByCompRef(a.component),i.selection.setIsHiddenComponentDraggedNext(!0)},getDebugItems:function(a){var b=i.components.serialize(a);return m(a.id,b,["structure"])},getExportDebugInfoItem:function(a){return{label:"Debug - export ["+a.id+"] to console",enabled:!0}},exportDebugInfo:function(a){var c=i.components.serialize(a);window.selectedComp=b.cloneDeep(c),console.log("Exported ["+a.id+"] to window.selectedComp"),i.closeRightClickMenu()},getApplyToInfoItem:function(){return{label:"RightClick_Menu_Copy_Design_Label",enabled:!0}},openApplyToDialog:function(a){i.bi.event(d.bi.events.applyStyle.COPY_STYLE_RCM_CLICK,{component_id:a.id,component_type:i.components.getType(a)}),i.styles.openApplyStylePanel(a)},getPinLabel:function(){var a=i.components.layout.isPinned(i.selection.getSelectedComponents());return a?"RightClick_Menu_UnPinElement":"RightClick_Menu_PinToScreen"},render:h})}),define("rEditor/rootComps/panels/openedPanels.rt",["react/addons","lodash","core","uiAnimations","panels"],function(a,b,c,d,e){"use strict";function f(d,e){return a.createElement(c.lazyComponent,b.assign({},{moduleName:d.name,onLoad:this.forceUpdate.bind(this)},this.getPanelProps(d)))}return function(){return a.createElement("div",{className:"opened-panels"},a.createElement.apply(this,[d.panelsAnimation,{},this.props.editorState.helpProps?a.createElement(e.frames.helpPanelFrame,b.assign({},{key:"helpPanel",isMobileEditor:this.props.editorState.isMobileEditor},this.props.editorState.helpProps)):null,b.map(this.props.openPanels,f.bind(this))]))}}),define("rEditor/rootComps/panels/openedPanels",["react","core","lodash","rEditor/rootComps/panels/openedPanels.rt"],function(a,b,c,d){"use strict";function e(a){var c=a.key;return b.lazyComponent.isLoaded(a.name)&&(c+="-loading"),c}return a.createClass({displayName:"openedPanels",propTypes:{editorState:a.PropTypes.object.isRequired,openPanels:a.PropTypes.array},getPanelProps:function(a){return c.assign({},a.props,{editorState:this.props.editorState,key:e(a.props)})},render:d})}),define("rEditor/rootComps/portal/portal.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{id:"portal"},this.getChildren())}}),define("rEditor/rootComps/portal/portal",["react","lodash","rEditor/rootComps/portal/portal.rt"],function(a,b,c){"use strict";function d(c,d){return b.map(c,function(c){return a.createElement(c.reactClass,b.assign(c.props,{origin:d}))})}return a.createClass({displayName:"Portal (AKA Comps Day-Care)",propTypes:{comps:a.PropTypes.object},getChildren:function(){return b.reduce(this.props.comps,function(a,b,c){return a.concat(d(b,c))},[])},render:c})}),define("rEditor/utils/mouseMoveActions/mouseMoveActionTypes",[],function(){"use strict";return{DRAG:"DRAG",ROTATE:"ROTATE",RESIZE:"RESIZE",SECTION_DRAG:"SECTION_DRAG",LASSO:"LASSO"}}),define("rEditor/utils/mouseMoveActions/baseResize",["lodash","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes","experiment!useProportionalResize","util"],function(a,b,c,d,e){"use strict";function u(a){return t[a]}function v(a){return s[a]}function w(a){return{x:a.pageX,y:a.pageY}}function x(){if(d)return j||o.components.is.group(h)||o.multiselect.isMultiselect(h);var b=o.components.getType(h),c=r[b],e=a.isFunction(c)?c(h):!!c;return e&&!j}function y(a){var b=w(a),c=u(k),e=o.components.layout.getRelativeToScreen(h);n=x(),i=new g.Resize(e,b,c,n),d&&(p=o.components.layout.getProportionStructure(h))}function z(a){var b=l.getClosestLayoutDistance(o,a,m);Math.abs(b.x)<5&&(m.right?(x()&&a.height&&(a.height+=b.x),a.width+=b.x):m.left&&(x()&&a.height&&(a.height-=b.x),a.x+=b.x,a.width-=b.x)),Math.abs(b.y)<5&&(m.top?(x()&&a.width&&(a.width-=b.y),a.y+=b.y,a.height-=b.y):m.bottom&&(x()&&a.width&&(a.width+=b.y),a.height+=b.y))}function A(a){if(m.right)a.width-=a.width%5;else if(m.left){var b=a.x%5;a.x-=b,a.width+=b}if(m.top){var c=a.y%5;a.y-=c,a.height+=c}else m.bottom&&(a.height-=a.height%5)}function B(a){var b=l.getSnapLines(a,m);o.snapLines.set(b)}function C(b,c){o=b,h=o.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(c.comps);var d=a.map(h,"id");o.renderPlugins.setCompsToShowOnTop(d),j=c.evt.shiftKey,k=c.directionName,l=new f(o,c.comps),m=v(c.directionName),y(c.evt)}function D(a){var b=w(a);j!==a.shiftKey&&(j=a.shiftKey,y(a));var c=i.getLayout(b);o.getViewTools().snapToEnabled&&0===c.rotationInDegrees&&z(c),n&&d?o.components.layout.updateRelativeToScreenAndPreserveProportions(h,c,p,!0):o.components.layout.applyPositionAndSizeRelativeToScreen(h,c,!0),o.waitForChangesApplied(function(){if(l){var b=o.components.layout.getRelativeToScreen(h);a.altKey?A(b):o.getViewTools().snapToEnabled&&0===b.rotationInDegrees&&B(b)}})}function E(){if(l=null,o.snapLines.clear(),o.renderPlugins.setCompsToShowOnTop(null),o.history.add("Resize component"),o.components.layout.isPinned(h)){var a=o.components.layout.get(h),b=e.pinModeUtils.convertLayoutToDockValue(a);e.pinModeUtils.checkSizeRestrictions(b,a)&&o.openPinModeSizeRestrictionPanel({state:"on resize",title:"Notification_Box_PinToScreen_ElementTooLarge_postPin_Title",content:"Notification_Box_PinToScreen_ElementTooLarge_postPin_Message"})}}var h,i,j,k,l,m,n,o,p,f=b.utils.SnapToHandler,g=b.utils.layoutTransitionsUtil,q=["fill","fitWidth"],r={"wysiwyg.viewer.components.WPhoto":function(b){var c=o.components.properties.get(b);return a.contains(q,c.displayMode)},"wysiwyg.viewer.components.SiteButton":!0,"wysiwyg.common.components.imagebutton.viewer.ImageButton":!0,"wysiwyg.viewer.components.ClipArt":!0,"wysiwyg.viewer.components.svgshape.SvgShape":!0,"wysiwyg.viewer.components.MatrixGallery":!0,"tpa.viewer.components.Thumbnails":!0,"wysiwyg.viewer.components.PaginatedGridGallery":!0,"wysiwyg.viewer.components.SlideShowGallery":!0,"wysiwyg.viewer.components.Video":!0},s={right:{right:!0},left:{left:!0},top:{top:!0},bottom:{bottom:!0},topRight:{top:!0,right:!0},topLeft:{top:!0,left:!0},bottomRight:{bottom:!0,right:!0},bottomLeft:{bottom:!0,left:!0}},t={right:{x:1,y:0},left:{x:-1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},topRight:{x:1,y:-1},topLeft:{x:-1,y:-1},bottomRight:{x:1,y:1},bottomLeft:{x:-1,y:1}};return{start:C,on:D,end:E,type:c.RESIZE}}),define("rEditor/utils/mouseMoveActions/baseResizeAndPush",["lodash","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes"],function(a,b,c){"use strict";function h(a){return{x:a.pageX,y:a.pageY}}function i(b,c){f=b,e=c.comps,f.selection.setIsMouseUpSelectionEnabled(!1);var i=a.map(e,"id");f.renderPlugins.setCompsToShowOnTop(i);var j=h(c.evt),k=f.components.layout.getRelativeToScreen(e);g=new d.Resize(k,j,{x:0,y:1},!1)}function j(b){var c=h(b),d=g.getLayout(c),i=f.components.layout.getMinDimensions(e);d.bounding=f.utils.getBoundingLayout(d),d.height>=i.height&&f.components.layout.updateRelativeToScreenAndAdjustLayout(e,a.pick(d,["height","width"]),!0)}function k(){f.renderPlugins.setCompsToShowOnTop(null),f.history.add("Resize component")}var e,f,g,d=b.utils.layoutTransitionsUtil;return{start:i,on:j,end:k,type:c.RESIZE}}),define("rEditor/utils/mouseMoveActions/baseRotate",["lodash","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes"],function(a,b,c){"use strict";function m(a){n(a),i.components.layout.updateRelativeToScreen(h,a,!0)}function n(a){a.rotationInDegrees<0&&(a.rotationInDegrees+=360);var b=a.rotationInDegrees%k;j>=b?a.rotationInDegrees-=b:b>=k-j&&(a.rotationInDegrees+=k-b)}function o(a){var b=Math.floor(0>f?f+360:f),c=Math.floor(a.rotationInDegrees<0?a.rotationInDegrees+360:a.rotationInDegrees),d=c-b,e=Math.floor(d/l);a.rotationInDegrees=f+e*l,i.components.layout.updateRelativeToScreen(h,a,!0)}function p(b,c){h=c.comps,i=b,i.selection.setIsMouseUpSelectionEnabled(!1);var e=a.map(h,"id");i.renderPlugins.setCompsToShowOnTop(e);var f=i.components.layout.getRelativeToScreen(h),j=a.defaults({y:f.y+i.editorConfig.previewTop},f),k={x:c.evt.pageX,y:c.evt.pageY};g=new d.Rotate(f,k,j)}function q(a){var b={x:a.pageX,y:a.pageY},c=g.getLayout(b);a.shiftKey?(e||(f=i.components.layout.getRelativeToScreen(h).rotationInDegrees),o(c)):m(c),e=a.shiftKey}function r(){i.waitForChangesApplied(function(){var a=i.components.layout.get(h).rotationInDegrees;i.bi.event(b.bi.events.editBox.ROTATE_COMPONENT,{value:parseInt(a,10),origin:"editBox"})}),i.renderPlugins.setCompsToShowOnTop(null),i.history.add("Rotate component")}var f,g,h,i,d=b.utils.layoutTransitionsUtil,e=!1,j=3,k=90,l=15;return{start:p,on:q,end:r,type:c.ROTATE}}),define("rEditor/utils/mouseMoveActions/baseDoubleClick",["lodash","core","gfppData"],function(a,b,c){"use strict";function d(d,e){var f=d.components.getType(e.comp),g=d.pluginService.getPlugin(d.pluginService.pluginConstants.DOUBLE_CLICK,f);if(a.isFunction(g))g(d,e);else{var h=c.getComponentMainActionClick(d,e.comp);a.isFunction(h)&&h(d,e.comp,b.constants.USER_ACTIONS.ORIGIN.DOUBLE_CLICK)}}return d}),define("rEditor/utils/mouseMoveActions/baseDragAndPush",["lodash","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes"],function(a,b,c){"use strict";function k(a,b){var c=b.x+b.width<=a.x,d=b.x>=a.x+a.width,e=!(c||d);return e&&b.y+b.height<=a.y}function l(b){var c=g.components.getSiblings(f),d=a(c).map(function(a){return g.components.layout.getRelativeToScreen(a)}).filter(function(a){return k(b,a)}).value();if(0===d.length)return 0;var e=a.max(d,function(a){return a.y+a.height});return e.y+e.height}function m(a){var b=g.components.getContainer(f),c=g.components.layout.getRelativeToScreen(b),d=l(a);return Math.max(d,c.y)}function n(b,c){g=b,f=c.comps,j=c.onDragAndPushEnd;var h=a.map(f,"id");g.renderPlugins.setCompsToShowOnTop(h);var k=a.omit(g.components.layout.getRelativeToScreen(f),"bounding"),l=a.map(f,function(b){return a.omit(g.components.layout.getRelativeToScreen(b),"bounding")});i=m(k);var n={x:c.evt.pageX,y:c.evt.pageY};e=new d.Drag(k,n,l)}function o(b){var c={x:b.pageX,y:b.pageY},d=e.getLayout(c);d.y=Math.max(d.y,i),h=e.getBoundComponentLayouts(d);for(var j=0;j<f.length;j++)g.components.layout.updateRelativeToScreenAndAdjustLayout(f[j],a.pick(h[j],"y"))}function p(){if(h){for(var b=0;b<f.length;b++)g.components.layout.updateRelativeToScreen(f[b],a.pick(h[b],"y"));h=null}g.renderPlugins.setCompsToShowOnTop(null),a.isFunction(j)&&j()}var e,f,g,h,j,d=b.utils.layoutTransitionsUtil,i=0;return{start:n,on:o,end:p,type:c.DRAG}}),define("rEditor/rootComps/selectionBox/editBox.rt",["react/addons","lodash","core","baseUI","util"],function(a,b,c,d,e){"use strict";function f(c,d,e,f,g,h){return a.createElement("div",{className:b.keys(b.pick({layout:!0,"secondary-component":e,"show-on-all-pages":this.isCompShowOnAllPages(g)},b.identity)).join(" "),key:h,style:this.getSubComponentStyle(g)})}function g(){var c=this.getAllowedKnobsMap(),g=this.isMultiselect(),h=this.getEditorAPI().components.is.group(this.props.selectedComponents),i=e.translate;return a.createElement.apply(this,["div",{className:b.keys(b.pick(this.getEditBoxClasses(),b.identity)).join(" "),onContextMenu:this.props.onContextMenu,onDoubleClick:this.onDoubleClick},this.hasSubComponents()?b.map(this.getSubComponents(),f.bind(this,c,g,h,i)):null,this.shouldMarkParent()?a.createElement("div",{key:"markParent",className:b.keys(b.pick({layout:!0,"secondary-component":!0,"show-solid-border-on-parent":this.shouldShowSolidBorderOnParent()},b.identity)).join(" "),style:this.getMarkParentStyle()}):null,a.createElement("div",{className:b.keys(b.pick({bounding:!0,"show-on-all-pages":this.isCompShowOnAllPages(this.props.selectedComponents)},b.identity)).join(" "),style:this.getBoundingStyle()},this.possibleLayoutActionsMap.movable?a.createElement("span",{className:"indicator dragging",key:"dragBoundingStyle"}," x: ",parseInt(this.relativeToStructureLayout.bounding.x,10),", y: ",parseInt(this.relativeToStructureLayout.bounding.y,10),"\n        "):null,this.possibleLayoutActionsMap.resizable?a.createElement("span",{className:"indicator resizing",key:"resizeBoundingStyle"}," W: ",parseInt(this.relativeToStructureLayout.bounding.width,10),", H: ",parseInt(this.relativeToStructureLayout.bounding.height,10),"\n        "):null),a.createElement("div",{className:b.keys(b.pick({layout:!0,"secondary-component":g,"show-on-all-pages":this.isCompShowOnAllPages(this.props.selectedComponents)},b.identity)).join(" "),style:g?this.getBoundingStyle():this.getLayoutStyle()},c.top&&c.left?a.createElement("span",{className:this.getResizeHandleCursorClass("TOP_LEFT")+" handle handle-resize-corner top left","data-direction-name":"topLeft",onMouseDown:this.startResize,key:"resizeTopLeft"}):null,c.top?a.createElement("span",{className:this.getResizeHandleCursorClass("TOP")+" handle handle-resize-side top","data-direction-name":"top",onMouseDown:this.startResize,key:"resizeTopCenter"}):null,c.top&&c.right?a.createElement("span",{className:this.getResizeHandleCursorClass("TOP_RIGHT")+" handle handle-resize-corner top right","data-direction-name":"topRight",onMouseDown:this.startResize,key:"resizeTopRight"}):null,c.right?a.createElement("span",{className:this.getResizeHandleCursorClass("RIGHT")+" handle handle-resize-side right","data-direction-name":"right",onMouseDown:this.startResize,key:"resizeMiddleRight"}):null,c.bottom&&c.right?a.createElement("span",{
className:this.getResizeHandleCursorClass("BOTTOM_RIGHT")+" handle handle-resize-corner bottom right","data-direction-name":"bottomRight",onMouseDown:this.startResize,key:"resizeBottomRight"}):null,c.bottom?a.createElement("span",{className:this.getResizeHandleCursorClass("BOTTOM")+" handle handle-resize-side bottom","data-direction-name":"bottom",onMouseDown:this.startResize,key:"resizeBottomCenter"}):null,c.bottom&&c.left?a.createElement("span",{className:this.getResizeHandleCursorClass("BOTTOM_LEFT")+" handle handle-resize-corner bottom left","data-direction-name":"bottomLeft",onMouseDown:this.startResize,key:"resizeBottomLeft"}):null,c.left?a.createElement("span",{className:this.getResizeHandleCursorClass("LEFT")+" handle handle-resize-side left","data-direction-name":"left",onMouseDown:this.startResize,key:"resizeMiddleLeft"}):null,c.rotate?a.createElement("span",{className:"handle handle-rotate",onMouseDown:this.startRotate,key:"rotate",ref:"rotate"},a.createElement(d.symbol,{name:"rotate"})):null,c.rotate&&this.isComponentRotated()?a.createElement("span",{className:"handle handle-rotate-cancel",onMouseDown:this.cancelRotation,style:{transform:"rotate("+(360-this.layout.rotationInDegrees)+"deg) translate3d(0,0,0)"},key:"cancelRotate",ref:"cancelRotate"},a.createElement(d.symbol,{name:"rotateCancel"})):null,c.dragAndPush&&!this.isComponentRotated()?a.createElement(d.tooltip,{id:"dragWithAnchorsVerticalTooltip",key:"dragWithAnchorsVerticalTooltip",value:"ONSTAGE_DragHandle_Tooltip",alignment:"top",openTriggers:[],closeTriggers:[]},a.createElement("span",{className:"handle handle-push handle-drag-with-anchors",onMouseEnter:this.showDragWithAnchorsKnobTooltip,onMouseLeave:this.hideDragWithAnchorsKnobTooltip,onMouseDown:this.startDragAndPush,key:"dragWithAnchorsVertical"},a.createElement(d.symbol,{name:"pushAndEnforceAnchors"}))):null,c.resizeAndPush&&!this.isComponentRotated()?a.createElement(d.tooltip,{id:"resizeWithAnchorsBottomTooltip",key:"resizeWithAnchorsBottomTooltip",value:"OnStage_StretchHandle_Tooltip",alignment:"bottom",openTriggers:[],closeTriggers:[]},a.createElement("span",{className:"handle handle-push handle-resize-with-anchors",onMouseEnter:this.showResizeWithAnchorsKnobTooltip,onMouseLeave:this.hideResizeWithAnchorsKnobTooltip,onMouseDown:this.startResizeAndPush,key:"resizeWithAnchorsBottom"},a.createElement(d.symbol,{name:"resizeAndEnforceAnchors"}))):null,this.possibleLayoutActionsMap.rotatable?a.createElement("span",{className:"indicator",style:{transform:"rotate("+(360-this.layout.rotationInDegrees)+"deg) translate3d(0,0,0)"},key:"rotationIndicator"},Math.floor(this.layout.rotationInDegrees),"\n        "):null),this.canBeMovedToFooter()?a.createElement("span",{className:"move-to-footer",key:"moveToFooter",style:this.getMoveToFooterStyle(),onMouseDown:this.moveToFooter},i("OnStage_MoveToFooter_Button"),"\n\n            ",a.createElement(d.symbol,{name:"moveToFooterArrow"})):null])}return function(){return g.apply(this,[])}}),define("rEditor/rootComps/selectionBox/editBox",["react","lodash","core","baseUI","rEditor/utils/mouseMoveActions/baseResize","rEditor/utils/mouseMoveActions/baseResizeAndPush","rEditor/utils/mouseMoveActions/baseRotate","rEditor/utils/mouseMoveActions/baseDoubleClick","rEditor/utils/mouseMoveActions/baseDragAndPush","util","rEditor/utils/mouseMoveActions/mouseMoveActionTypes","rEditor/rootComps/selectionBox/editBox.rt","experiment!sectionsReorganizeExp","experiment!boxSlideShow"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){"use strict";function t(a){return b.any(a,function(a){return b.contains(p,a.id)})}function u(a,b,c){m&&j.mouseScaleHandler.fitMouseCoordinatesToScale(a,b,c)}function v(a,b){var c=a.components.layout.getRelativeToScreen(b);return a.components.layout.isShowOnFixedPosition(b)&&(c.y+=a.editorConfig.previewTop,c.bounding.y+=a.editorConfig.previewTop),c}function w(a,b,c,d){if(a.isMobileEditor()||a.isCurrentPageLandingPage()||a.components.layout.isShowOnFixedPosition(b))return!1;var e=a.siteSegments.getPagesContainer(),f=a.components.layout.getRelativeToScreen(e),g=f.y+f.height-(c.bounding.y+c.bounding.height),h=g>=0&&o>=g,i=!a.multiselect.isMultiselect(b),j=a.components.getType(b),k=!1;return"wixapps.integration.components.AppPart"===j&&i&&(k=a.wixapps.classics.isAppPartPageFixed(b[0])),h&&!d&&a.components.canShowOnAllPages(b)&&!a.text.isEditingText()&&!k}function x(a){var b=j.pinModeUtils,c=b.convertLayoutToDockValue(a);return c?c.indexOf("TOP")>-1:!1}var o=21,p=["SITE_HEADER","SITE_FOOTER"],q=800,r=["TOP_LEFT","TOP","TOP_RIGHT","RIGHT","BOTTOM_RIGHT","BOTTOM","BOTTOM_LEFT","LEFT"],s=["top-left-resize-cursor","top-resize-cursor","top-right-resize-cursor","right-resize-cursor","bottom-right-resize-cursor","bottom-resize-cursor","bottom-left-resize-cursor","left-resize-cursor"];return a.createClass({displayName:"editBox",mixins:[c.mixins.editorAPIMixin],propTypes:{selectedComponents:a.PropTypes.oneOfType([a.PropTypes.object,a.PropTypes.arrayOf(a.PropTypes.object)]),isDim:a.PropTypes.bool,isResizing:a.PropTypes.bool,isDragging:a.PropTypes.bool,isRotating:a.PropTypes.bool},componentWillMount:function(){this.layout=v.call(this,this.getEditorAPI(),this.props.selectedComponents),this.relativeToStructureLayout=this.getEditorAPI().components.layout.getRelativeToStructure(this.props.selectedComponents),this.isShowOnAllPages=this.getEditorAPI().components.isShowOnAllPages(this.props.selectedComponents),this.possibleLayoutActionsMap=this.getEditorAPI().getCompRestrictions(this.props.selectedComponents)},getEditBoxClasses:function(){return{"edit-box":!0,"edit-box-dim":this.props.isDim,movable:this.possibleLayoutActionsMap.horizontallyMovable||this.possibleLayoutActionsMap.verticallyMovable,"show-move-to-footer-button":this.shouldShowMoveToFooterButton,dragging:this.props.isDragging,resizing:this.props.isResizing,rotating:this.props.isRotating,"small-width-component":this.layout.width<=50,"multi-select":this.getEditorAPI().multiselect.isMultiselect(this.props.selectedComponents)}},getLayoutStyle:function(a){a=a||this.layout;var b="rotate("+a.rotationInDegrees+"deg)";return{top:a.y-1,left:a.x-1,width:a.width,height:a.height,WebkitTransform:b,transform:b,position:this.getEditorAPI().components.layout.isShowOnFixedPosition(this.props.selectedComponents)?"fixed":"absolute"}},isComponentRotated:function(){return 0!==this.layout.rotationInDegrees},getMoveToFooterStyle:function(a){a=a||this.layout;var b=a.bounding.y+a.bounding.height,c=a.bounding.x+a.bounding.width/2;return{top:b-14,left:c}},getBoundingStyle:function(a){a=a||this.layout;var b=0;return n&&(b=this.shouldShowSolidBorderOnParent()?3:1),{top:x(a)?a.bounding.height+a.bounding.y+40:a.bounding.y-1,left:a.bounding.x-1,width:a.bounding.width-b,height:a.bounding.height-b,position:this.getEditorAPI().components.layout.isShowOnFixedPosition(this.props.selectedComponents)?"fixed":"absolute"}},componentWillReceiveProps:function(a){var b=this.getEditorAPI();this.layout=v.call(this,b,a.selectedComponents),this.relativeToStructureLayout=b.components.layout.getRelativeToStructure(a.selectedComponents),this.isShowOnAllPages=b.components.isShowOnAllPages(a.selectedComponents),this.possibleLayoutActionsMap=this.getEditorAPI().getCompRestrictions(a.selectedComponents),this.props.isResizing||this.props.isRotating||!b.utils.isSameRef(this.props.selectedComponents,a.selectedComponents)?this.shouldShowMoveToFooterButton=!1:this.props.isDragging&&(this.shouldShowMoveToFooterButton=w(b,a.selectedComponents,this.layout,this.isShowOnAllPages))},getResizeHandleCursorClass:function(a){var c=b.indexOf(r,a),d=this.layout.rotationInDegrees+22.5;d>=360&&(d-=360);var e=Math.floor(d/45),f=c+e;f>=s.length&&(f-=s.length);var g=s[f];return g},getAllowedKnobsMap:function(){var a=this.getEditorAPI(),c=this.props.selectedComponents,d=a.getCompRestrictions(c),e=a.components.layout.RESIZE_SIDES;return{top:b.contains(d.resizeableSides,e.TOP)&&!t(c),bottom:b.contains(d.resizeableSides,e.BOTTOM)&&!t(c),left:b.contains(d.resizeableSides,e.LEFT),right:b.contains(d.resizeableSides,e.RIGHT),dragAndPush:a.multiselect.containsSiblingsOnly(c)&&(d.verticallyMovable||d.canMoveUp)&&!a.components.layout.isPinned(c),resizeAndPush:!a.multiselect.isMultiselect(c)&&d.verticallyResizable&&!a.components.layout.isPinned(c),rotate:d.rotatable&&!a.components.layout.isPinned(c)}},startResize:function(a){var d=this.getEditorAPI();u(d,a,this.props.siteScale);var f=a.target.getAttribute("data-direction-name");d.registerMouseMoveAction(e,{evt:b.clone(a),directionName:f,comps:this.props.selectedComponents}),d.bi.event(c.bi.events.editBox.RESIZE,{origin:"editBox",handle_value:f}),a.stopPropagation()},startRotate:function(a){var c=this.getEditorAPI();u(c,a,this.props.siteScale),this.getEditorAPI().registerMouseMoveAction(g,{evt:b.clone(a),comps:this.props.selectedComponents}),a.stopPropagation()},cancelRotation:function(a){var b=this.getEditorAPI();u(b,a,this.props.siteScale),b.selection.setIsMouseUpSelectionEnabled(!1),b.components.layout.update(this.props.selectedComponents,{rotationInDegrees:0}),b.bi.event(c.bi.events.editBox.CANCEL_ROTATE_COMPONENT),b.history.add("Rotation canceled"),a.stopPropagation()},canBeMovedToFooter:function(){var a=this.getEditorAPI(),b=!a.components.is.groupedComponent(this.props.selectedComponents),c=a.multiselect.areComponentsOfSamePage(this.props.selectedComponents);return b&&c},startDragAndPush:function(a){var d=this.getEditorAPI();u(d,a,this.props.siteScale),d.registerMouseMoveAction(i,{evt:b.clone(a),comps:d.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(this.props.selectedComponents)}),d.bi.event(c.bi.events.editBox.DRAG_BY_HANDLE,{component_type:d.getComponentType(this.props.selectedComponents)}),this.hideKnobTooltip("dragWithAnchorsVerticalTooltip"),a.stopPropagation()},startResizeAndPush:function(a){var d=this.getEditorAPI();u(d,a,this.props.siteScale),d.registerMouseMoveAction(f,{evt:b.clone(a),comps:this.props.selectedComponents}),d.bi.event(c.bi.events.editBox.RESIZE_BY_HANDLE,{component_type:d.getComponentType(this.props.selectedComponents)}),this.hideKnobTooltip("resizeWithAnchorsBottomTooltip"),a.stopPropagation()},onDoubleClick:function(a){var b=this.getEditorAPI();if(u(b,a),!b.selection.isMultiSelectKeyPressed(a)){var c={evt:a,comp:this.props.selectedComponents};h(b,c)}},showKnobTooltip:function(a){this.props.isResizing||this.props.isDragging||(this.showTooltipTimeout=setTimeout(function(){d.tooltipManager.show(a)},q))},hideKnobTooltip:function(a){this.showTooltipTimeout&&(clearTimeout(this.showTooltipTimeout),this.showTooltipTimeout=null),d.tooltipManager.hide(a)},showDragWithAnchorsKnobTooltip:function(){this.showKnobTooltip("dragWithAnchorsVerticalTooltip")},showResizeWithAnchorsKnobTooltip:function(){this.showKnobTooltip("resizeWithAnchorsBottomTooltip")},hideDragWithAnchorsKnobTooltip:function(){this.hideKnobTooltip("dragWithAnchorsVerticalTooltip")},hideResizeWithAnchorsKnobTooltip:function(){this.hideKnobTooltip("resizeWithAnchorsBottomTooltip")},moveToFooter:function(a){var b=this.getEditorAPI();u(b,a,this.props.siteScale);var c=b.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(this.props.selectedComponents);b.components.moveToFooter(c),this.shouldShowMoveToFooterButton=!1,a.stopPropagation()},hasSubComponents:function(){return this.getEditorAPI().components.is.group(this.props.selectedComponents)||this.getEditorAPI().multiselect.isMultiselect(this.props.selectedComponents)},findAncestorMatchesCondition:function(a,c){for(var d=this.getEditorAPI(),e=b.first(a),f=d.components.getContainer(e);f&&!c(f);)f=d.components.getContainer(f);return f},shouldMarkParent:function(){var a=this.getEditorAPI(),b=a.multiselect.isMultiselect(this.props.selectedComponents),c=n?!!this.findAncestorMatchesCondition(this.props.selectedComponents,a.components.is.slidesContainer):null;return c||!b&&a.components.is.groupedComponent(this.props.selectedComponents)},shouldShowSolidBorderOnParent:function(){if(n){var a=this.getEditorAPI();return this.findAncestorMatchesCondition(this.props.selectedComponents,a.components.is.slidesContainer)}return!1},getSubComponentStyle:function(a){var b=v.call(this,this.getEditorAPI(),a);return this.getLayoutStyle(b)},getSubComponents:function(){var a=this.getEditorAPI();return a.multiselect.isMultiselect(this.props.selectedComponents)?this.props.selectedComponents:a.components.getChildren(this.props.selectedComponents)},isCompShowOnAllPages:function(a){return this.getEditorAPI().components.isShowOnAllPages(a)},isMultiselect:function(){return this.getEditorAPI().multiselect.isMultiselect(this.props.selectedComponents)},getRotateKnobRect:function(){return this.layout.rotationInDegrees?this.refs.cancelRotate&&this.refs.cancelRotate.getDOMNode().getBoundingClientRect():this.refs.rotate&&this.refs.rotate.getDOMNode().getBoundingClientRect()},getMarkParentStyle:function(){var a=this.getEditorAPI(),b=n?this.findAncestorMatchesCondition(this.props.selectedComponents,a.components.is.slidesContainer):void 0,c=b||a.components.getContainer(this.props.selectedComponents),d=a.components.layout.getRelativeToScreen(c);return this.getBoundingStyle(d)},render:l})}),define("rEditor/rootComps/attachHighlight/attachHighlight.rt",["react/addons","lodash","experiment!attachImprovements"],function(a,b,c){"use strict";return function(){return a.createElement("div",{},c?a.createElement("div",{key:"attach-highlight",className:"attach-highlight"},a.createElement("div",{className:b.keys(b.pick({"highlight-container-exp":!0,master:this.isShowOnAllPages(),box:this.isBoxContainer()},b.identity)).join(" "),style:this.getBoxPosition()},a.createElement("label",{},this.translateIfNeeded(this.getAttachTranslationKey(this.state.compLabel)))),a.createElement("div",{style:this.getAttachOverlayLayoutStyle(),className:"attach-overlay"})):null,c?null:a.createElement("div",{key:"attachImprovements",className:b.keys(b.pick({"highlight-container":!0,master:this.isShowOnAllPages()},b.identity)).join(" "),style:this.getPosition()},a.createElement("label",{},this.translateIfNeeded(this.getAttachTranslationKey(this.state.compLabel)))))}}),define("rEditor/rootComps/attachHighlight/attachHighlight",["react","core","lodash","rEditor/rootComps/attachHighlight/attachHighlight.rt","util","experiment!attachImprovements"],function(a,b,c,d,e,f){"use strict";function h(a,b){return a.components.layout.getRelativeToScreen(b)}function i(a){var b=a.selection.getSelectedComponents()[0];return h(a,b)}function j(a,b){var c=a.components.layout.getRelativeToScreen(b);return a.components.layout.isShowOnFixedPosition(b)&&(c.y+=a.editorConfig.previewTop,c.bounding.y+=a.editorConfig.previewTop),c}var g={HeaderContainer:"OnStage_AttachTo_Header",Page:"OnStage_AttachTo_Page",FooterContainer:"OnStage_AttachTo_Footer",Container:"OnStage_AttachTo_Box",BoxSlideShowSlide:"OnStage_AttachTo_Slide",StripContainer:"OnStage_AttachTo_Strip"},k={displayName:"attachHighlight",mixins:[b.mixins.editorAPIMixin,e.translationMixin],getInitialState:function(){var a=c.last(this.getEditorAPI().components.getType(this.props.comp).split("."));return{compLabel:this.props.comp&&g[a]}},componentWillReceiveProps:function(a){this.setState({compLabel:a.comp&&g[c.last(this.getEditorAPI().components.getType(this.props.comp).split("."))]})},isShowOnAllPages:function(){return this.getEditorAPI().components.isShowOnAllPages(this.props.comp)},getAttachTranslationKey:function(){var a=c.last(this.getEditorAPI().components.getType(this.props.comp).split("."));return g[a]},getPosition:function(){var a=this.getEditorAPI(),b=j(a,this.props.comp),c=a.components.layout.isShowOnFixedPosition(this.props.comp)?"fixed":"absolute";return{top:b.y,left:b.x,height:b.height,width:b.width,position:c}},render:d};return f&&c.assign(k,{getBoxPosition:function(){var a=h(this.getEditorAPI(),this.props.comp);return{top:a.y,left:a.x,height:a.height,width:a.width}},getAttachOverlayLayoutStyle:function(){var a=i(this.getEditorAPI());return{top:a.y,left:a.x,width:a.width,height:a.height}},isBoxContainer:function(){return"mobile.core.components.Container"===this.getEditorAPI().components.getType(this.props.comp)}}),a.createClass(k)}),define("rEditor/rootComps/constraintArea/constraintArea.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{className:"constraint-area",style:this.getPosition()},a.createElement("div",{className:"box"},a.createElement("label",{},this.translateIfNeeded("mobilemenu_Settings_fixed_area_label"))))}}),define("rEditor/rootComps/constraintArea/constraintArea",["react","core","lodash","util","rEditor/rootComps/constraintArea/constraintArea.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"constraintArea",mixins:[b.mixins.editorAPIMixin,d.translationMixin],getPosition:function(){var a=this.props.area;return{top:a.top,left:a.left,height:a.height,width:a.width}},render:e})}),define("rEditor/rootComps/snapLayer/snapLayer.rt",["react/addons","lodash"],function(a,b){"use strict";function c(b,c){return a.createElement("rect",{x:b.x,y:b.y,height:b.height,width:b.width,key:"snapRect"+c})}function d(b,c){return a.createElement("line",{x1:b[0].x,y1:b[0].y,x2:b[1].x,y2:b[1].y,key:"snapLine"+c})}return function(){return this.props.snapLines?a.createElement("div",{className:"snap-layer",key:"layer"},a.createElement.apply(this,["svg",{},b.map(this.props.snapLines.rectangles,c.bind(this)),b.map(this.props.snapLines.lines,d.bind(this))])):null}}),define("rEditor/rootComps/snapLayer/snapLayer",["react","lodash","rEditor/rootComps/snapLayer/snapLayer.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"snapLayer",propTypes:{snapLines:a.PropTypes.shape({lines:a.PropTypes.array,rectangles:a.PropTypes.array})},render:c})}),define("rEditor/rootComps/anchor/anchor.rt",["react/addons","lodash","baseUI","experiment!sectionsReorganizeExp"],function(a,b,c,d){"use strict";return function(){return a.createElement("div",{className:"anchorWrapper",style:{top:this.getTopPosition()}},a.createElement("div",{className:"anchor-line before"}),a.createElement("div",{className:"anchor "+(this.props.isSelected?"anchor-selected":"")},a.createElement("div",{className:"anchorContent",onMouseDown:this.onMouseDown,onContextMenu:this.props.onContextMenu,onDoubleClick:this.onDoubleClick},a.createElement(c.symbol,{className:"anchorIcon",name:"anchor"}),a.createElement("div",{className:"anchorName"},this.getAnchorName()),a.createElement(c.symbol,{className:"rightIcon",name:this.isLocked()?"anchorLock":"anchorDragHandle"}))),a.createElement("div",{className:b.keys(b.pick({"anchor-line":!0,after:!d,"after-with-sections-reorganize":d},b.identity)).join(" ")}))}}),define("rEditor/rootComps/anchor/anchor",["react","lodash","core","rEditor/utils/mouseMoveActions/baseDoubleClick","rEditor/rootComps/anchor/anchor.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"anchor",propTypes:{compRef:a.PropTypes.object.isRequired,isSelected:a.PropTypes.bool.isRequired},mixins:[c.mixins.editorAPIMixin],getInitialState:function(){return this.editorAPI=this.getEditorAPI(),{}},getAnchorName:function(){var a=this.editorAPI.components.data.get(this.props.compRef);return a.name},onDoubleClick:function(a){var b={evt:a,comp:[this.props.compRef]};d(this.getEditorAPI(),b)},getTopPosition:function(){return this.editorAPI.components.layout.getRelativeToStructure(this.props.compRef).y},isLocked:function(){return!1},render:e})}),define("rEditor/rootComps/anchor/anchorsContainer.rt",["react/addons","lodash","rEditor/rootComps/anchor/anchor"],function(a,b,c){"use strict";function d(b,d){return a.createElement(c,{key:"anchor"+d,compRef:b,onContextMenu:this.props.onContextMenu,isSelected:this.isSelectedComp(b)})}return function(){return a.createElement.apply(this,["div",{className:b.keys(b.pick({"anchors-container":!0,"mobile-editor":this.editorAPI.isMobileEditor()},b.identity)).join(" ")},b.map(this.getAnchors(),d.bind(this))])}}),define("rEditor/rootComps/anchor/anchorsContainer",["react","lodash","core","rEditor/rootComps/anchor/anchorsContainer.rt"],function(a,b,c,d){"use strict";var e="wysiwyg.common.components.anchor.viewer.Anchor";return a.createClass({displayName:"stageComps",mixins:[c.mixins.editorAPIMixin],getInitialState:function(){return this.editorAPI=this.getEditorAPI(),{}},getAnchors:function(){var a=this.editorAPI.pages.getReference(this.editorAPI.pages.getCurrentPageId());return this.editorAPI.components.get.byType(e,a)},isSelectedComp:function(a){return this.editorAPI.selection.isComponentSelected(a)},render:d})}),define("rEditor/rootComps/selectionBox/hoverBox.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{style:this.getHoverBoxStyles(),className:b.keys(b.pick(this.getClasses(),b.identity)).join(" ")},a.createElement("span",{ref:"label",className:b.keys(b.pick(this.getLabelClasses(),b.identity)).join(" "),style:this.getHoverBoxLabelStyles()},this.getComponentLabel()))}}),define("rEditor/rootComps/selectionBox/hoverBox",["lodash","react","jquery","core","rEditor/rootComps/selectionBox/hoverBox.rt"],function(a,b,c,d,e){"use strict";function f(a,b){var c=a.components.layout.getRelativeToScreen(b);return a.components.layout.isShowOnFixedPosition(b)&&(c.y+=a.editorConfig.previewTop,c.bounding.y+=a.editorConfig.previewTop),c}function g(a,b){return a.outerWidth()/b.outerWidth()<2}function h(a,b){var c=d.utils.stageUtils.getViewPort();return a.offset().left-b.width()>c.x}function i(a,b){return"SITE_FOOTER"===b.id||"SITE_HEADER"===b.id||b.id===a.pages.getCurrentPageId()}function j(a,b){return g(a,b)?h(a,b)?k.LEFT:k.RIGHT:k.INNER}var k={INNER:"inner",LEFT:"left",RIGHT:"right"},l=2;return b.createClass({displayName:"hoverBox",mixins:[d.mixins.editorAPIMixin],getInitialState:function(){return{labelPosition:k.INNER,shouldCalculateLabelPosition:!0}},componentWillMount:function(){this.isMovable=this.getEditorAPI().components.is.verticallyMovable(this.props.hoveredComp)||this.getEditorAPI().components.is.horizontallyMovable(this.props.hoveredComp)},componentDidMount:function(){if(this.state.shouldCalculateLabelPosition){var a=c(this.getDOMNode()),b=c(this.refs.label.getDOMNode());this.setState({labelPosition:j(a,b),shouldCalculateLabelPosition:!1})}},componentDidUpdate:function(){if(this.state.shouldCalculateLabelPosition){var a=c(this.getDOMNode()),b=c(this.refs.label.getDOMNode());this.setState({labelPosition:j(a,b),shouldCalculateLabelPosition:!1})}},componentWillReceiveProps:function(a){a.hoveredComp.id!==this.props.hoveredComp.id&&(this.isMovable=this.getEditorAPI().components.is.verticallyMovable(a.hoveredComp)||this.getEditorAPI().components.is.horizontallyMovable(a.hoveredComp),this.setState({shouldCalculateLabelPosition:!0}))},getComponentLabel:function(){var a=this.getEditorAPI(),b=a.selection.getSelectedComponents(),c=a.utils.isSameRef(b,this.props.hoveredComp);return c?"":a.components.getDisplayName(this.props.hoveredComp)},getHoverBoxStyles:function(){var b=f(this.getEditorAPI(),this.props.hoveredComp),c={top:b.y-1,left:b.x-1,width:b.width,height:b.height};if(b.rotationInDegrees){var d="rotate("+b.rotationInDegrees+"deg)";a.assign(c,{transform:d,WebkitTransform:d})}var e=this.getEditorAPI().components.is.fullWidth(this.props.hoveredComp);return e&&a.assign(c,{borderLeft:0,borderRight:0}),c},getClasses:function(){var a=this.getEditorAPI(),b=this.props.hoveredComp;return{"hover-box":!0,"show-on-all-pages":a.components.isShowOnAllPages(b),movable:this.isMovable,"fixed-position":a.components.layout.isShowOnFixedPosition(b),overlay:this.props.overlay}},getHoverBoxLabelStyles:function(){var a=this.getEditorAPI();if(a.components.is.fullWidth(this.props.hoveredComp)){var b=a.isMobileEditor()?0:a.siteSegments.getPagesContainerAbsLayout().x+l;return{left:b}}},getLabelClasses:function(){var a=i(this.getEditorAPI(),this.props.hoveredComp);return{"comp-label":!0,"label-large":a,"label-inner":!a&&this.state.labelPosition===k.INNER,"label-left":!a&&this.state.labelPosition===k.LEFT,"label-right":!a&&this.state.labelPosition===k.RIGHT}},render:e})}),define("rEditor/rootComps/lasso/lasso.rt",["react/addons","lodash"],function(a,b){"use strict";function c(c,d){return a.createElement("rect",b.assign({},{className:b.keys(b.pick({"lasso-candidate":!0,"show-on-all-pages":this.getEditorAPI().components.isShowOnAllPages(c.component)},b.identity)).join(" "),key:d},c.layout.bounding))}return function(){return a.createElement("div",{className:"lasso-layer"},a.createElement.apply(this,["svg",{className:"lasso-highlights"},a.createElement("rect",b.assign({},{className:"lasso-rect"},this.props.lassoLayout)),b.map(this.props.candidates,c.bind(this))]))}}),define("rEditor/rootComps/lasso/lasso",["react","lodash","core","rEditor/rootComps/lasso/lasso.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"lasso",mixins:[c.mixins.editorAPIMixin],propTypes:{lassoLayout:a.PropTypes.shape({x:a.PropTypes.number,y:a.PropTypes.number,width:a.PropTypes.number,height:a.PropTypes.number}),candidates:a.PropTypes.arrayOf(a.PropTypes.shape({component:a.PropTypes.object,layout:a.PropTypes.object}))},render:d})}),define("rEditor/rootComps/mouseCatcher.rt",["react/addons","lodash","rEditor/rootComps/selectionBox/editBox","rEditor/rootComps/attachHighlight/attachHighlight","rEditor/rootComps/constraintArea/constraintArea","rEditor/rootComps/snapLayer/snapLayer","rEditor/rootComps/anchor/anchorsContainer","rEditor/rootComps/selectionBox/hoverBox","rEditor/rootComps/lasso/lasso"],function(a,b,c,d,e,f,g,h,i){"use strict";return function(){return a.createElement("div",{className:"parentSizeAbs mouseCatcher",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onDoubleClick:this.onDoubleClick,onContextMenu:this.props.onContextMenu,onMouseMove:this.onMouseMove,onMouseLeave:this.clearHoverBox},this.props.editorState.constraintArea?a.createElement(e,{key:"constraintArea",area:this.props.editorState.constraintArea}):null,this.props.editorState.attachCandidate?a.createElement(d,{key:"attachHighlight",comp:this.props.editorState.attachCandidate}):null,this.props.editorState.lassoLayout?a.createElement(i,{key:"lassoLayout",lassoLayout:this.props.editorState.lassoLayout,candidates:this.props.editorState.lassoCandidates}):null,this.props.hoveredComp&&this.getEditorAPI().components.is.exist(this.props.hoveredComp)&&!this.props.editorState.pinMode?a.createElement(h,{overlay:this.props.hoverBoxOverlay,hoveredComp:this.props.hoveredComp,key:"hoverBox"}):null,this.shouldRenderEditBox()&&!this.props.editorState.pinMode?a.createElement(c,{ref:"editBox",key:"editBox",isDragging:this.props.isDragging,isResizing:this.props.isResizing,isRotating:this.props.isRotating,isDim:this.isDesignPanelOpen(),selectedComponents:this.props.selectedComponents,performingMouseMoveAction:this.props.performingMouseMoveAction,onContextMenu:this.props.onContextMenu,siteScale:this.props.siteScale}):null,a.createElement(f,{key:"snapLayer",snapLines:this.props.editorState.snapLines}),this.props.editorState.previewMode||!this.props.editorIsInit||this.props.editorState.pinMode?null:a.createElement(g,{key:"anchorsContainer",onContextMenu:this.props.onContextMenu}))}}),define("rEditor/utils/mouseMoveActions/baseDrag",["core","lodash","rEditor/utils/mouseMoveActions/mouseMoveActionTypes","experiment!attachImprovements"],function(a,b,c,d){"use strict";function v(a){return q=s&&(q||Math.abs(a.pageX-p.x)>2||Math.abs(a.pageY-p.y)>2)}function w(a){if(u){var b=u.getClosestLayoutDistance(o,a.bounding,n);Math.abs(b.x)<5&&(a.x+=b.x),Math.abs(b.y)<5&&(a.y+=b.y)}}function x(a){a.x-=a.x%5,a.y-=a.y%5}function y(a){if(u){var b=u.getSnapLines(a.bounding,n);o.snapLines.set(b)}}function z(a){var c=b.some(a,function(a){return o.components.is.groupedComponent(a)},this);return!c&&o.multiselect.containsSiblingsOnly(a)}function A(a,c){if(o=o||a,q=!1,k=c.selectedComp,p=c.initMousePosition,!c.initMousePosition||!B(p,k))return void(s=!1);s=!0;var n=o.components.layout.getRelativeToScreen(k),r=b.map(k,function(a){return o.components.layout.getRelativeToScreen(a)});l=z(k),m=d?new f(o,{layout:n,comp:k},e.TYPES.COMP):new e(o,{layout:n,comp:k},e.TYPES.COMP),t=new i(o,k),u=new g(o,k);var v=o.components.layout.getRelativeToScreen(k);j=new h.Drag(v,p,r)}function B(a,c){if(a&&!a.isShiftPressed)return!0;var d=!1;if(a&&a.isShiftPressed&&!b.isEmpty(c))for(var e=C(c),f=a.x,g=a.y-o.editorConfig.previewTop,h=0;h<e.length&&!d;h++){var i=e[h];d=d||D(f,g,i)}return d}function C(a){return b.map(a,function(a){return o.components.layout.getRelativeToScreen(a)})}function D(a,b,c){return c&&a>=c.x&&a<=c.x+c.width&&b>=c.y&&b<=c.y+c.height}function E(c){if(v(c)){if(o.selection.setIsMouseUpSelectionEnabled(!1),!r){var d=b.map(k,"id");o.renderPlugins.setCompsToShowOnTop(d),r=!0}var e={x:c.pageX,y:c.pageY,isShiftPressed:c.shiftKey},f=j.getLayout(e);if(o.multiselect.isMultiselect(k)){var g=o.components.layout.getRelativeToScreen(k);f=a.utils.updateLayoutUtil.getLayoutAfterConstraints(o,k,f,g,!0)}c.altKey?x(f):o.getViewTools().snapToEnabled&&(f.bounding=o.utils.getBoundingLayout(f),w(f),f.bounding=o.utils.getBoundingLayout(f),y(f));var h;if(l){var i={x:c.clientX,y:c.clientY};h=m.getCurrentAttachCandidate(null,i),m.highlightAttachCandidate(h),t.highlightDragConstraints()}for(var n=j.getBoundComponentLayouts(f),p=0;p<k.length;p++)o.components.layout.updateRelativeToScreen(k[p],n[p],!0)}}function F(b){if(v(b)){var c;if(l){var d={x:b.clientX,y:b.clientY};c=m.getCurrentAttachCandidate(null,d)}if(c){var e=o.components.setContainer(k,c);o.selection.selectComponentByCompRef(e);var f=o.getComponentType(k),g=o.getComponentType(c);o.bi.event(a.bi.events.editBox.ATTACH_TO,{component_type:f,target_component:g})}m.highlightAttachCandidate(null),t.removeHighlightDragConstraints(),u=null,o.snapLines.clear(),o.history.add("Dragged component"),o.openCompOutOfGridPanelIfNeeded(k),o.bi.event(a.bi.events.editBox.MOVE_COMPONENT,{origin:"editBox"})}o.renderPlugins.setCompsToShowOnTop(null),r=!1,p=null}var j,k,l,m,o,p,t,u,e=a.utils.AttachHandler,f=a.utils.AttachHandlerExperimentAttachImprovements,g=a.utils.SnapToHandler,h=a.utils.layoutTransitionsUtil,i=a.utils.DragConstraintsHandler,n={top:!0,right:!0,bottom:!0,left:!0,centerX:!0,centerY:!0},q=!1,r=!1,s=!1;return{start:A,on:E,end:F,type:c.DRAG}}),define("rEditor/utils/mouseMoveActions/baseDragExperiment",["core","lodash","rEditor/utils/mouseMoveActions/mouseMoveActionTypes"],function(a,b,c){"use strict";function r(a){return n=p&&(n||Math.abs(a.pageX-m.x)>2||Math.abs(a.pageY-m.y)>2)}function s(a){if(q){var b=q.getClosestLayoutDistance(l,a.bounding,k);Math.abs(b.x)<5&&(a.x+=b.x),Math.abs(b.y)<5&&(a.y+=b.y)}}function t(a){a.x-=a.x%5,a.y-=a.y%5}function u(a){if(q){var b=q.getSnapLines(a.bounding,k);l.snapLines.set(b)}}function v(a){var c=b.some(a,function(a){return l.components.is.groupedComponent(a)},this);return!c}function w(a,c){if(l=l||a,n=!1,h=c.selectedComp,m=c.initMousePosition,!c.initMousePosition||!x(m,h))return void(p=!1);p=!0;var k=b.map(h,function(a){return l.components.layout.getRelativeToScreen(a)});i=v(h),j=b.map(h,function(a){var b=l.components.layout.getRelativeToScreen(a);return new d(l,{layout:b,comp:a},d.TYPES.COMP)},this),q=new e(l,h);var o=l.components.layout.getRelativeToScreen(h);g=new f.Drag(o,m,k)}function x(a,c){if(a&&!a.isShiftPressed)return!0;var d=!1;if(a&&a.isShiftPressed&&!b.isEmpty(c))for(var e=y(c),f=a.x,g=a.y-l.editorConfig.previewTop,h=0;h<e.length&&!d;h++){var i=e[h];d=d||z(f,g,i)}return d}function y(a){return b.map(a,function(a){return l.components.layout.getRelativeToScreen(a)})}function z(a,b,c){return c&&a>=c.x&&a<=c.x+c.width&&b>=c.y&&b<=c.y+c.height}function A(c){if(r(c)){if(l.selection.setIsMouseUpSelectionEnabled(!1),!o){var d=b.map(h,"id");l.renderPlugins.setCompsToShowOnTop(d),o=!0}var e={x:c.pageX,y:c.pageY,isShiftPressed:c.shiftKey},f=g.getLayout(e);if(l.multiselect.isMultiselect(h)){
var i=l.components.layout.getRelativeToScreen(h);f=a.utils.updateLayoutUtil.getLayoutAfterConstraints(l,h,f,i,!0)}c.altKey?t(f):l.getViewTools().snapToEnabled&&(f.bounding=l.utils.getBoundingLayout(f),s(f),f.bounding=l.utils.getBoundingLayout(f),u(f));for(var j=g.getBoundComponentLayouts(f),k=0;k<h.length;k++)l.components.layout.updateRelativeToScreen(h[k],j[k],!0)}}function B(c){if(r(c)){var d,e=h;i&&(d=b.map(j,function(a){return a.getCurrentAttachCandidate()},this)),b.forEach(d,function(b,c){if(b){var d=l.components.setContainer(h[c],b);e.splice(c,1,d);var f=l.getComponentType(h[c]),g=l.getComponentType(b);l.bi.event(a.bi.events.editBox.ATTACH_TO,{component_type:f,target_component:g})}},this),l.selection.selectComponentByCompRef(e),q=null,l.snapLines.clear(),l.history.add("Dragged component"),l.openCompOutOfGridPanelIfNeeded(h),l.bi.event(a.bi.events.editBox.MOVE_COMPONENT,{origin:"editBox"})}l.renderPlugins.setCompsToShowOnTop(null),o=!1,m=null}var g,h,i,j,l,m,q,d=a.utils.AttachHandler,e=a.utils.SnapToHandler,f=a.utils.layoutTransitionsUtil,k={top:!0,right:!0,bottom:!0,left:!0,centerX:!0,centerY:!0},n=!1,o=!1,p=!1;return{start:w,on:A,end:B,type:c.DRAG}}),define("rEditor/utils/lassoMouseMoveActions/lassoDrag",["core","lodash","util","rEditor/utils/mouseMoveActions/mouseMoveActionTypes"],function(a,b,c,d){"use strict";function m(a){if(k)return!0;var b=a.pageY-l.editorConfig.previewTop,c=Math.abs(a.pageX-j.x),d=Math.abs(b-j.y);return k=c>f&&d>f}function n(a){var b=a.pageY-l.editorConfig.previewTop,c=Math.min(a.pageX,j.x),d=Math.min(b,j.y),e=Math.max(a.pageX,j.x),f=Math.max(b,j.y);return{x:c,y:d,width:e-c,height:f-d}}function o(a){var b=l.components.layout.getRelativeToScreen(a);return{component:a,layout:b}}function p(a){return l.components.is.fullWidth(a.component)?"fullWidth":"standard"}function q(a,b){return b.y<=a.bounding.y&&b.y+b.height>=a.bounding.y+a.bounding.height}function r(a,c){l=a;var d=l.pages.getCurrentPageId(),f=l.components.getAllComponents(d,function(a){return!b.contains(e,a.id)&&!l.components.is.page(a)});j=b.clone(c.initMousePosition),j.y-=l.editorConfig.previewTop,k=!1,h=[],i=b.pick(j,["x","y"]),g=b(f).map(o).groupBy(p).value()}function s(a){if(m(a)){b.isEmpty(l.selection.getSelectedComponents())||l.selection.deselectComponent(),i=n(a),h=b.filter(g.standard,function(a){return c.layoutUtils.isLayoutContainedWithinRect(a.layout.bounding,i)},this);var d=b.filter(g.fullWidth,function(a){return q(a.layout,i)},this);h=h.concat(d),l.lasso.setCandidates(h),l.lasso.setLayout(i)}}function t(){if(!b.isEmpty(h)){var c=b.map(h,"component");c.length>1&&l.bi.event(a.bi.events.selection.MULTISELECT,{num_of_elements_selected:c.length,selection_method:"lasso"}),l.selection.selectComponentByCompRef(c)}l.lasso.clear()}var g,h,i,j,k,l,e=["SITE_PAGES","PAGES_CONTAINER","SITE_HEADER","SITE_FOOTER"],f=4;return{start:r,on:s,end:t,type:d.LASSO}}),define("rEditor/rootComps/mouseCatcher",["react","jquery","lodash","rEditor/rootComps/mouseCatcher.rt","core","panels","util","rEditor/utils/mouseMoveActions/baseDrag","rEditor/utils/mouseMoveActions/baseDragExperiment","rEditor/utils/lassoMouseMoveActions/lassoDrag","experiment!useExperimentalLasso","experiment!activateLassoWithAltKey","experiment!attachMultiSelect","experiment!sectionsReorganizeExp","experiment!stripContainer"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){"use strict";function t(a,b){if(a.selection.isHiddenComponentDraggedNext())return!1;if(a.components.is.siteSegment(b)||a.components.is.page(b))return!0;if(k){var c=!a.selection.isComponentSelected(b)&&a.components.is.container(b);return c}return o?!a.selection.isComponentSelected(b)&&a.components.is.container(b)&&a.components.is.fullWidth(b):!1}function u(a,b){var c=a.getCompRestrictions(b),d=a.components.layout.isDocked(b);return(c.horizontallyMovable||c.verticallyMovable)&&!d}function v(a,b,c){var d=a.selection.getComponentUnderClickToBeSelected(b.clientX,b.clientY,!1,c);return a.selection.isComponentSelected(d)}function w(a,b,c){var d,e;return d=a.selection.getComponentUnderClickToBeSelected(b.clientX,b.clientY,!1,c),e=l&&b.altKey,e||t(a,d)}function x(a,b){var d=a.selection.getSelectedComponents(),e=a.components.getType(b);return(!a.selection.isComponentSelected(b)||a.multiselect.isMultiselect(d))&&!c.contains(r,e)}function y(a){return!!a.editor.state.lassoLayout}var p=m?i:h,q=["wysiwyg.common.components.anchor.viewer.Anchor"],r=["wysiwyg.viewer.components.PagesContainer","wysiwyg.viewer.components.PageGroup","wysiwyg.common.components.anchor.viewer.Anchor"],s=1;return a.createClass({displayName:"mouseCatcher",mixins:[e.mixins.editorAPIMixin],componentWillMount:function(){this.compsBeforeSelection=null,this.shouldStartDragging=!1,this.shouldStartLasso=!1,this.initMousePosition=null},componentDidMount:function(){n&&b(this.getDOMNode()).on("mouseenter",this.onMouseEnter)},componentWillUnmount:function(){n&&b(this.getDOMNode()).off("mouseenter",this.onMouseEnter)},componentWillReceiveProps:function(a){var b=this.getEditorAPI();this.shouldStartDragging&&u(b,a.selectedComponents)?b.registerMouseMoveAction(p,{initMousePosition:this.initMousePosition,selectedComp:b.multiselect.getComponentsWhichDontHaveAncestorsInTheArray(a.selectedComponents)}):this.shouldStartLasso&&b.registerMouseMoveAction(j,{initMousePosition:this.initMousePosition}),this.shouldStartDragging=!1,this.shouldStartLasso=!1},onMouseDown:function(a){var b=this.getEditorAPI();n&&g.mouseScaleHandler.fitMouseCoordinatesToScale(b,a,this.props.siteScale),this.initMousePosition={x:a.pageX,y:a.pageY,isShiftPressed:a.shiftKey,isAltKeyPressed:a.altKey},this.shouldStartLasso=w(b,a,this.props.siteScale),this.shouldStartDragging=!this.shouldStartLasso&&(!b.selection.isMultiSelectKeyPressed(a)||v(b,a,this.props.siteScale)),b.selection.isHiddenComponentDraggedNext()?b.selection.setIsHiddenComponentDraggedNext(!1):y(b)||(this.compsBeforeSelection=b.selection.getSelectedComponents(),b.selection.selectComponentByClick(a,this.props.siteScale)),b.closeRightClickMenu(),f.panelManager.notifyMouseDown(a)},onMouseUp:function(a){var b=this.getEditorAPI();n&&g.mouseScaleHandler.fitMouseCoordinatesToScale(b,a,this.props.siteScale);var c=2===a.button;c||(this.deselectClickedCompIfNeeded(a),b.selection.getIsMouseUpSelectionEnabled()&&!y(b)&&b.selection.selectNonGroupCompUnderCursor(a,this.props.siteScale),b.selection.setIsMouseUpSelectionEnabled(!1)),this.initMousePosition=null},onMouseMove:function(a){this.props.registeredMouseMoveAction||this.updateHoverBox(a),n&&this.props.mouseMoveCallback(a,a.pageX,a.pageY)},onMouseEnter:function(a){a.which!==s&&this.getEditorAPI().triggerMouseUp(c.clone(a))},updateHoverBox:function(a){var b=this.getEditorAPI(),d=c.clone(a);n&&g.mouseScaleHandler.fitMouseCoordinatesToScale(b,d,this.props.siteScale),b.waitForChangesApplied(function(){var a=b.selection.getComponentToBeMarkedByHoverBox(d.clientX,d.clientY,this.props.siteScale),c=this.props.hoverBoxOverlay;!this.props.hoveredComp&&a?x(b,a)&&b.hoverBox.set(a,c):this.props.hoveredComp&&!a?b.hoverBox.clear():this.props.hoveredComp&&a&&(x(b,a)?this.props.hoveredComp.id!==a.id&&b.hoverBox.set(a,c):b.hoverBox.clear())}.bind(this))},clearHoverBox:function(){var a=this.getEditorAPI();a.hoverBox.clear()},deselectClickedCompIfNeeded:function(a){var b=this.getEditorAPI();if(b.selection.isMultiSelectKeyPressed(a)&&this.initMousePosition){var d=b.selection.getComponentUnderClickToBeSelected(a.clientX,a.clientY,!1,this.props.siteScale),e=!!c.find(this.compsBeforeSelection,d),f=!this.isPointsDistanceBiggerThan(this.initMousePosition,{x:a.pageX,y:a.pageY},2);e&&f&&(b.selection.setIsMouseUpSelectionEnabled(!1),b.selection.deselectComponents(d))}},isPointsDistanceBiggerThan:function(a,b,c){var d=Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2);return Math.sqrt(d)>c},isComponentSelected:function(){return this.getEditorAPI().selection.isComponentSelected()},getComponentLabel:function(){return this.getEditorAPI().getComponentType(this.props.selectedComponents)},getRotateKnobRect:function(){return this.refs.editBox&&this.refs.editBox.getRotateKnobRect()},shouldRenderEditBox:function(){if(!this.props.selectedComponents||this.props.isSectionDragging)return!1;var a=this.getEditorAPI().components.getType(this.props.selectedComponents);return!c.contains(q,a)},isDesignPanelOpen:function(){var a=this.getEditorAPI().panelManager.getOpenPanels();return!!c.find(a,{name:"designPanel.designPanel"})},render:d})}),define("rEditor/rootComps/compControls/compControlsMeasurer",["lodash","jquery","core","baseUI"],function(a,b,c,d){"use strict";function h(a){var b=a.x+d.uiConstants.CUSTOM_GFPP_POS.X_OFFSET_FROM_CLICK,c=a.y;return{y:c,x:b,width:0,height:0,bottomY:c,rightX:b}}function i(a){return{y:a.y,x:a.x,width:a.width,height:a.height,bottomY:a.y+a.height,rightX:a.x+a.width}}function j(a,b){return a.y>=b.y?g.COMP_TOP:a.bottomY<=b.bottomY?g.COMP_BOTTOM:g.VIEWPORT_TOP}function k(a,c,d){var e=c.bottomY-a.y,f=a.bottomY-c.y,h=d?b(d).height():0,i=a.y<c.y,j=e>=h,k=a.bottomY>c.bottomY,l=f>=h,m=h<=c.bottomY-c.y;return i||!m?g.VIEWPORT_TOP:j?g.COMP_TOP:k?g.VIEWPORT_BOTTOM:l?g.COMP_BOTTOM:g.VIEWPORT_TOP}function l(a,b,c){return{gfpp:j(a,b),compPanel:k(a,b,c)}}function m(a,b,c,d,f){var h=Math.max(e,f&&f.top||0)+d,i=d+e,j=Math.max(e,f&&f.bottom||0);switch(a){case g.COMP_TOP:return Math.max(b.y-h,c.y-i);case g.COMP_BOTTOM:return b.bottomY+j;case g.VIEWPORT_TOP:return c.y-i}}function n(a,b,c,d){switch(a){case g.COMP_BOTTOM:return b.bottomY-d;case g.COMP_TOP:return b.y;case g.VIEWPORT_BOTTOM:return c.bottomY-d}return c.y}function o(a,b,c,d){switch(a){case g.COMP_LEFT:return b.x;case g.VIEWPORT_LEFT:return c.x;case g.VIEWPORT_RIGHT:return c.rightX-d}}function p(a,b,c,d,e,h,i){var j=b.rightX-b.x;switch(a){case g.COMP_LEFT:return b.x-d-Math.max(f,i&&i.left||0);case g.COMP_RIGHT:return b.x+j+Math.max(f,i&&i.right||0);case g.VIEWPORT_LEFT:return c.x;case g.VIEWPORT_RIGHT:return c.rightX-d-f;case g.GFPP_LEFT:return h-d-f;case g.GFPP_RIGHT:return h+e+f}}function q(a,c,d,e,f,g,h){var i={gfpp:{top:0,left:0},compPanel:{top:0,left:0}},j=f.height,k=f.width,l=g?b(g).height():0,q=g?b(g).width():0;return i.gfpp.top=m(a.gfpp,d,e,j,h),i.compPanel.top=n(a.compPanel,d,e,l),i.gfpp.left=o(c.gfpp,d,e,k),i.compPanel.left=p(c.compPanel,d,e,q,k,i.gfpp.left,h),i}function r(a,b,c){var d;return d=a.x>=b.x?c+a.x<=b.rightX?g.COMP_LEFT:g.VIEWPORT_RIGHT:g.VIEWPORT_LEFT}function s(a,b,c){var d={},e=h(a),f=l(e,b).gfpp,g=r(e,b,c.width);return d.top=m(f,e,b,c.height),d.left=o(g,e,b,c.width),d}function t(a,c,d,e,h){var m,n,i=e.width,j=h?b(h).width():0,k=a.rightX-a.x,l={};return l.gfpp=r(a,c,i),d.gfpp===d.compPanel?(m=a.rightX+j+f<=c.rightX,n=a.x-j-f>=c.x,a.rightX<c.x?l.compPanel=g.VIEWPORT_LEFT:m?l.compPanel=g.COMP_RIGHT:n?l.compPanel=g.COMP_LEFT:l.compPanel=g.VIEWPORT_RIGHT):l.gfpp===g.COMP_LEFT?k>=i?(m=a.x+k+f+j<c.rightX,n=a.x-f-j>=c.x,m?l.compPanel=g.COMP_RIGHT:n?l.compPanel=g.COMP_LEFT:l.compPanel=g.VIEWPORT_RIGHT):(n=a.x-f-j>=c.x,n?l.compPanel=g.COMP_LEFT:l.compPanel=g.GFPP_RIGHT):l.gfpp===g.VIEWPORT_RIGHT?l.compPanel=g.GFPP_LEFT:l.gfpp===g.VIEWPORT_LEFT&&(m=Math.max(c.x+i,a.x+k)+j<=c.rightX,m?c.x+i>a.x+k?l.compPanel=g.GFPP_RIGHT:l.compPanel=g.COMP_RIGHT:l.compPanel=g.VIEWPORT_RIGHT),l}function u(a){var b=c.utils.stageUtils.getStageLayout();return a.x<=0&&a.width>=b.width}function v(a,c,d,h,i,j,l){var m={left:0,top:0},o=d?b(d).height():0,p=d?b(d).width():0;if(0===p||0===o)return{left:0,top:0};var q=k(a,c,d),r=n(q,a,c,o),s=p<=i-c.x,t=o<=c.bottomY-l,u=j===g.COMP_TOP&&o<=l-c.y-f,v=j===g.COMP_BOTTOM&&o<=c.bottomY-(l+h)-f;return s?(m.left=i-(p+f/2),m.top=t?l:c.bottomY-o):u?(m.left=i,m.top=l-(o+e)):v?(m.left=i,m.top=l+h+e):(m.left=c.rightX-p,m.top=r),m}function w(a,b,c,d,e){var f=Math.max(e,b.x),g=j(a,b),h=m(g,a,b,d),i=v(a,b,c,d,f,g,h);return{gfppStyle:{left:f,top:h},compPanelStyle:i}}function x(a){var b=a.siteSegments.getPagesContainer();return a.components.layout.getRelativeToScreen(b).x}var e=d.uiConstants.gfppMargins,f=d.uiConstants.compPanelMargins,g={COMP_TOP:"compTop",COMP_BOTTOM:"compBottom",COMP_LEFT:"compLeft",COMP_RIGHT:"compRight",VIEWPORT_TOP:"viewPortTop",VIEWPORT_BOTTOM:"viewPortBottom",VIEWPORT_LEFT:"viewPortLeft",VIEWPORT_RIGHT:"viewPortRight",GFPP_LEFT:"gfppLeft",GFPP_RIGHT:"gfppRight"};return{getCompControlsPositions:function(a,b,d,e,f,g){var h,j=e.getLeftBarButtonsBoundingRect().right+10,k=x(e),m=i(d),n=!d.fixedPosition,o=c.utils.stageUtils.getViewPort(n);if(j&&j>o.x){var p=j-o.x;o.x=j,o.width-=p}if(f=f||{},u(m))h=w(m,o,b,a.height,k);else{var r=l(m,o,b),v=t(m,o,r,a,b),y=q(r,v,m,o,a,b,f);h={gfppStyle:y.gfpp,compPanelStyle:y.compPanel}}return g&&(h.gfppStyle=s(g,o,a)),h}}}),define("rEditor/rootComps/gfpp/gfppButton.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(){var b=this.translateIfNeeded;return a.createElement("li",{className:"gfpp-btn "+this.props.className,onClick:this.onClick},this.props.icon?a.createElement(c.symbol,{key:"gfppButtonIcon",name:this.props.icon}):null,this.props.label?a.createElement("span",{key:"gfppButtonLabel",className:"gfpp-label"},b(this.props.label)):null)}return function(){return a.createElement(c.tooltip,{value:this.props.tooltip,styleType:"small",disabled:!this.props.tooltip,shouldTranslate:this.props.shouldTranslate},d.apply(this,[]))}}),define("rEditor/rootComps/gfpp/gfppButton",["react","lodash","core","util","rEditor/rootComps/gfpp/gfppButton.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"GFPP Button",propTypes:{selectedComponent:a.PropTypes.arrayOf(a.PropTypes.object).isRequired},mixins:[c.mixins.editorAPIMixin],translateIfNeeded:function(a){return b.isBoolean(this.props.shouldTranslate)&&!this.props.shouldTranslate?a:d.translate(a)},onClick:function(){var a=this.getEditorAPI(),d=this.props.selectedComponent;if(a.components.is.exist(d)){var e=(d.length?b.first(d):d).id,f=a.components.getType(d);this.props.onClick(a,d,c.constants.USER_ACTIONS.ORIGIN.GFPP),a.bi.event(c.bi.events.gfpp.GFPP_BUTTON_CLICK,{action_name:this.props.label,component_id:e,component_type:f,icon:this.props.tooltip})}},render:e})}),define("rEditor/rootComps/gfpp/gfpp.rt",["react/addons","lodash","uiAnimations","baseUI","rEditor/rootComps/gfpp/gfppButton"],function(a,b,c,d,e){"use strict";function f(a){a.stopPropagation()}function g(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function h(c,d){return a.createElement(e,b.assign({},{key:c.icon||c.label||c.tooltip,className:b.keys(b.pick({selected:c.isSelected},b.identity)).join(" ")},this.getButtonProps(c)))}return function(){return a.createElement(c.gfppAnimation,{},a.createElement.apply(this,["ul",g({id:"gfpp",ref:"gfpp",className:"gfpp",key:this.getKey(),onClick:f.bind(this)},this.getTopLevelProps()),b.map(this.state.mainButtons,h.bind(this))]))}}),define("rEditor/rootComps/gfpp/gfpp",["lodash","react","core","panels","pLoader!santa:utils","rEditor/rootComps/gfpp/gfppModel","rEditor/rootComps/gfpp/gfpp.rt","jquery","experiment!switchLayoutDesignOrder"],function(a,b,c,d,e,f,g,h,i){"use strict";function k(b,c){var d=a.map(c,function(a){return b[a]});return a.compact(d)}function l(a,b){var c=f.getData(a,b),d=c.mainActions||[],e=k(c.presetActions,j),g=d.concat(e);return{mainButtons:g}}function m(a,b){return function(){d.panelManager.openHelpCenter(b)}}var j=["settings","layout","design","upgrade","aviary","animation","link","hide","help","pinMode"];return i&&(j=["settings","design","layout","upgrade","aviary","animation","link","hide","help","pinMode"]),b.createClass({displayName:"GFPP",mixins:[c.mixins.editorAPIMixin],propTypes:{selectedComponent:b.PropTypes.arrayOf(b.PropTypes.object).isRequired},getInitialState:function(){return l(this.getEditorAPI(),this.props.selectedComponent)},componentWillReceiveProps:function(a){this.setState(l(this.getEditorAPI(),a.selectedComponent))},getTopLevelProps:function(){return a.pick(this.props,["style"])},getButtonProps:function(b){return b.isApplied&&a.assign(b,{label:b.label_active||b.label,icon:b.icon_active||b.icon,tooltip:b.tooltip_active||b.tooltip}),b.helpId&&a.isUndefined(b.onClick)&&(b.onClick=m(this.getEditorAPI(),b.helpId)),b.selectedComponent=this.props.selectedComponent,b},getSize:function(){if(this.refs.gfpp){var b=e.domMeasurements.getBoundingRect(this.refs.gfpp.getDOMNode());return a.pick(b,["width","height"])}},getKey:function(){return a.first(this.props.selectedComponent).id+"_"+a.size(this.props.selectedComponent)},render:g})}),define("rEditor/rootComps/compControls/compControls.rt",["react/addons","lodash","rEditor/rootComps/gfpp/gfpp","core","uiAnimations","experiment!sectionsReorganizeExp"],function(a,b,c,d,e,f){"use strict";function g(){this.props.selectedComponents.length?this.props.selectedComponents[0].id:this.props.selectedComponents;return a.createElement("div",{className:"comp-controls",style:{visibility:f&&1!==this.props.siteScale?"hidden":"visible"}},this.shouldShowGfpp()?a.createElement(c,{key:"gfpp",ref:"gfpp",style:this.state.gfppStyle,selectedComponent:this.props.selectedComponents}):null,this.props.panel?a.createElement(d.lazyComponent,b.assign({},{ref:"compPanel",moduleName:this.props.panel.name,key:d.lazyComponent.isLoaded(this.props.panel.name)?this.props.panel.name:"loading",onLoad:this.forceUpdate.bind(this)},this.getPanelProps())):null)}return function(){return g.apply(this,[])}}),define("rEditor/rootComps/compControls/compControls",["react","lodash","baseUI","core","jquery","rEditor/rootComps/compControls/compControlsMeasurer","rEditor/rootComps/compControls/compControls.rt","experiment!customGfppPosition"],function(a,b,c,d,e,f,g,h){"use strict";function k(a,b,c){return c=c||0,Math.abs(a-b)<=c}function l(a,b){return Math.ceil(a-b+i)}function m(a,b){if(!b)return j;var c={top:l(a.y,b.top),bottom:l(b.bottom,a.y+a.height),left:l(a.x,b.left),right:l(b.right,a.x+a.width)};return c}function n(a,b){return a?{y:a.y-b,x:a.x}:void 0}var i=3,j={top:0,bottom:0,left:0,right:0};return a.createClass({displayName:"compControls",mixins:[d.mixins.editorAPIMixin],propTypes:{panel:a.PropTypes.shape({name:a.PropTypes.string,props:a.PropTypes.object}),selectedComponents:a.PropTypes.arrayOf(a.PropTypes.object),performingMouseMoveAction:a.PropTypes.bool,getRotateKnobRect:a.PropTypes.func,selectionClickEvent:a.PropTypes.object,hoveredComp:a.PropTypes.object},getDefaultProps:function(){return{getRotateKnobRect:b.noop}},getInitialState:function(){return this.panelReady=!1,this.lastMeasuredPanelHeight=0,this.throttledSetCompsStyle=b.throttle(this.setCompsStyle,50,{leading:!1,trailing:!0}),{gfppStyle:{top:0,left:0,visibility:"hidden"},compPanelStyle:{top:0,left:0,opacity:0,visibility:"hidden"}}},shouldComponentUpdate:function(a){if(h){var c=!b.isEqual(this.props.hoveredComp,a.hoveredComp),d=!b.isEqual(this.props.selectedComponents,a.selectedComponents),e=!a.performingMouseMoveAction||this.props.performingMouseMoveAction!==a.performingMouseMoveAction;return e&&(!c||d)}return!a.performingMouseMoveAction||this.props.performingMouseMoveAction!==a.performingMouseMoveAction},isCompsStyleSet:function(){return!this.props.panel||"hidden"!==this.state.compPanelStyle.visibility&&!!this.lastMeasuredPanelHeight&&0!==this.state.compPanelStyle.left&&0!==this.state.compPanelStyle.top},shouldShowGfpp:function(){return!this.props.isDragging&&!this.props.isResizing&&!this.props.isRotating},getBoundingLayoutRelativeToScreen:function(){var a=this.getEditorAPI(),c=a.components.layout.getRelativeToScreen(this.props.selectedComponents);return b.assign(c.bounding,{fixedPosition:a.components.layout.isShowOnFixedPosition(this.props.selectedComponents),rotationInDegrees:c.rotationInDegrees})},getCompControlsStyles:function(a,c,d,g,i){var l,j=this.getEditorAPI(),k=this.props.panel&&(a||!this.isCompsStyleSet());h&&this.isCompRequiresCustomGfppPos(g,this.props.selectedComponents)&&(l=n(this.props.lastSelectionClickPos,this.props.previewTop));var m=f.getCompControlsPositions(c,d,g,j,i,l);return m.gfppStyle.visibility="inherit",k?(m.compPanelStyle.top+=this.props.previewTop,g.fixedPosition||(m.compPanelStyle.top-=e(window).scrollTop()),b.assign(m.compPanelStyle,this.getPanelStyle())):m=b.pick(m,"gfppStyle"),g.fixedPosition?(m.gfppStyle.top+=this.props.previewTop,m.gfppStyle.position="fixed"):m.gfppStyle.position="absolute",this.props.pinMode&&(m.gfppStyle.visibility="hidden"),m},getPanelStyle:function(){var a={};return this.panelReady?(a.visibility="inherit",a.opacity=1):(a.visibility="hidden",a.opacity=0),a},isCompRequiresCustomGfppPos:function(a){var b=this.getEditorAPI(),d="wysiwyg.viewer.components.WRichText"===b.components.getType(this.props.selectedComponents);if(d)return!1;var e=c.uiConstants.CUSTOM_GFPP_POS.HEIGHT_TO_APPLY;return a.height>=e},getRotateKnobMargins:function(a){if(!a.rotationInDegrees)return j;var c=b.isFunction(this.props.getRotateKnobRect)&&this.props.getRotateKnobRect();if(!c)return j;var d=window.pageYOffset-this.props.previewTop,e=window.pageXOffset;return c={top:c.top+d,bottom:c.bottom+d,left:c.left+e,right:c.right+e},m(a,c)},setCompsStyle:function(a){var c=this.refs.gfpp?this.refs.gfpp.getSize():null;if(this.props.pinMode&&(c={width:0,height:0}),c){var d=this.refs.compPanel?this.refs.compPanel.getDOMNode():null;this.lastMeasuredPanelHeight=d?e(d).height():0;var f=this.getBoundingLayoutRelativeToScreen(),g=this.getRotateKnobMargins(f),h=this.getCompControlsStyles(a,c,d,f,g);this.lastMeasuredPanelHeight||(h.compPanelStyle={top:0,left:0,opacity:0,visibility:"hidden"});var i=b.pick(this.state,b.keys(h)),j=b.every(h,function(a,b){return k(i[b].top,a.top,2)&&k(i[b].left,a.left,2)&&i[b].visibility===a.visibility&&i[b].position===a.position});j||this.setState(h)}},onWindowScroll:function(){this.setCompsStyle()},onWindowResize:function(){this.debouncedSetCompsStyle||(this.debouncedSetCompsStyle=b.debounce(this.setCompsStyle,200)),this.debouncedSetCompsStyle(!0)},componentDidMount:function(){this.throttledSetCompsStyle(),e(window).on("scroll",this.onWindowScroll).on("resize",this.onWindowResize)},componentWillUnmount:function(){e(window).off("scroll",this.onWindowScroll).off("resize",this.onWindowResize)},componentWillReceiveProps:function(a){var c={};b.isEqual(this.props.panel,a.panel)||(c.compPanelStyle={top:0,left:0,opacity:0,visibility:"hidden"},a.panel||(this.panelReady=!1));var d=!this.getEditorAPI().utils.isSameRef(this.props.selectedComponents,a.selectedComponents),e=!this.props.performingMouseMoveAction&&a.performingMouseMoveAction;(d||e)&&(c.gfppStyle={top:0,left:0,visibility:"hidden"},c.compPanelStyle={top:0,left:0,opacity:0,visibility:"hidden"}),b.isEmpty(c)||this.setState(c)},componentDidUpdate:function(){this.throttledSetCompsStyle()},onCompPanelLoaded:function(){this.panelReady=!0,this.throttledSetCompsStyle()},getPanelProps:function(){return b.assign({onCompPanelLoaded:this.onCompPanelLoaded,style:this.state.compPanelStyle,selectedComponent:this.props.selectedComponents},this.props.panel.props)},render:g})}),define("rEditor/rootComps/textEditor.rt",["react/addons","lodash","textControls"],function(a,b,c){"use strict";return function(){return a.createElement(c.richTextInput,{ref:"richTextInput",valueLink:{value:this.state.textData,requestChange:this.handleTextChange},themeColors:this.getThemeColors(),themeFonts:this.getThemeFonts(),documentType:this.getDocumentType(),languages:this.getLanguages(),layout:this.getTextEditorLayout(),onHeightChange:this.handleTextHeightChange,fonts:this.getCurrentSelectableFontsWithParams(),hideToolbar:!0,className:"text-editor",onShow:this.handleShowTextEditor,openLinkDialog:this.openLinkDialog,openColorPicker:this.openTextColorPicker,openLanguageSupport:this.openLanguageSupport,selectAllOnInit:!0,isResizing:this.props.isResizing,panelManager:this.getPanelManager()})}}),define("rEditor/rootComps/textEditor",["react","lodash","rEditor/rootComps/textEditor.rt","core","textControls","panelUtils","panels"],function(a,b,c,d,e,f,g){"use strict";return a.createClass({displayName:"textEditor",render:c,mixins:[d.mixins.editorAPIMixin,f.linkColorPickerMixin,g.mixins.disableKeyboardShortcutsMixin],getComponentData:function(){return this.getEditorAPI().components.data.get(this._textComponent)},setComponentData:function(a){var c=this.getComponentData();b.forOwn(a,function(a,b){c[b]=a}),this.getEditorAPI().components.data.update(this._textComponent,c,!0)},setComponentLayout:function(a){this.getEditorAPI().components.layout.updateRelativeToScreenAndAdjustLayout(this._textComponent,a)},_cacheSelectedComponent:function(){this._textComponent=this.getEditorAPI().text.getTextCompForEdit()},getInitialState:function(){return this._cacheSelectedComponent(),{textData:{text:this.getComponentData().text,linkList:this.getComponentData().linkList}}},getThemeColors:function(){return this.getEditorAPI().theme.colors.getAll()},getThemeFonts:function(){return this.getEditorAPI().theme.fonts.getAll()},getDocumentType:function(){return this.getEditorAPI().generalInfo.getDocumentType()},getLanguages:function(){return this.getEditorAPI().theme.fonts.getCharacterSet()},getTextEditorLayout:function(){var a=this.getEditorAPI(),b=a.components.layout.getRelativeToScreen(this._textComponent),c=a.components.layout.isShowOnFixedPosition(this._textComponent),d={top:b.y,left:b.x,width:b.width,height:b.height,position:c?"fixed":"absolute"};return c&&(d.top+=a.editorConfig.previewTop),d},takeSnapshot:function(){this.snapshotTimeoutHandle&&clearTimeout(this.snapshotTimeoutHandle);var a=this;this.snapshotTimeoutHandle=setTimeout(function(){a.getEditorAPI().history.add("RT:Change"),delete a.snapshotTimeoutHandle},1e3)},handleTextChange:function(a){var b=this.getEditorAPI();this.setComponentData(a),b.waitForChangesApplied(this.takeSnapshot),this.setState({textData:a})},handleTextHeightChange:function(a){this.setComponentLayout({height:a})},getCurrentSelectableFontsWithParams:function(){return e.fontUtils.getCurrentSelectableFontsWithParams(this.getEditorAPI())},handleShowTextEditor:function(a){this._cacheSelectedComponent();var c=this.getEditorAPI(),d=b.first(c.selection.getSelectedComponents());c.renderPlugins.setHideTextComponent(this._textComponent.id);var e=this._textComponent;c.waitForChangesApplied(function(){e===d?(a&&a(),c.openComponentPanel("textSettingsPanel")):c.text.stopEditing()})},_deleteTextEditorComponentIfEmpty:function(){var a=this.getComponentData(),b=this.getEditorAPI();if(a){var c=a.text;e.dataUtils.isEmptyHtmlText(c)&&(b.utils.isSameRef(this._textComponent,b.selection.getSelectedComponents())&&b.selection.deselectComponent(),b.components.remove(this._textComponent))}},componentDidMount:function(){this.getEditorAPI().text.setCurrentTextEditor(this.refs.richTextInput)},componentWillUnmount:function(){clearTimeout(this.panelTimeout),this.snapshotTimeoutHandle&&(clearTimeout(this.snapshotTimeoutHandle),this.getEditorAPI().history.add("RT:Change")),this._textComponent&&(this._deleteTextEditorComponentIfEmpty(),delete this._textComponent),this.getEditorAPI().text.setCurrentTextEditor(null)},getLinkToProps:function(){var a=this.getEditorAPI();return{pages:a.pages.getPagesData(),currentPageId:a.pages.getCurrentPageId(),anchors:a.getAnchors(),menuItems:a.mainMenu.getMenu(),showButton:!0}},openLinkDialog:function(a,b){var c=this.getEditorAPI();g.panelManager.openPanel("panels.toolPanels.linkPanel",{data:this.getLinkToProps(),createDefaultData:c.data.createItem,link:a,callback:b},!0)},openTextColorPicker:function(a,b,c){this.openColorPicker(b,a,!0,c)},openLanguageSupport:function(){g.panelManager.openPanel("panels.toolPanels.languageSupport",{},!0)},getPanelManager:function(){return this.getEditorAPI().panelManager}})}),define("rEditor/rootComps/gridLines/gridLines.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("svg",{className:"gridLines"},a.createElement("line",{x1:this.pagesContainerLayout.x,y1:"0",x2:this.pagesContainerLayout.x,y2:"100%",className:"backLine"}),a.createElement("line",{x1:this.pagesContainerLayout.x,y1:"0",x2:this.pagesContainerLayout.x,y2:"100%",className:"frontLine"}),a.createElement("line",{x1:this.pagesContainerLayout.x+this.pagesContainerLayout.width,y1:"0",x2:this.pagesContainerLayout.x+this.pagesContainerLayout.width,y2:"100%",className:"backLine"}),a.createElement("line",{x1:this.pagesContainerLayout.x+this.pagesContainerLayout.width,y1:"0",x2:this.pagesContainerLayout.x+this.pagesContainerLayout.width,y2:"100%",className:"frontLine"}),this.props.showTopBottom?a.createElement("line",{key:"topA",x1:"0",y1:this.pagesContainerLayout.y,x2:"100%",y2:this.pagesContainerLayout.y,className:"backLine"}):null,this.props.showTopBottom?a.createElement("line",{key:"topB",x1:"0",y1:this.pagesContainerLayout.y,x2:"100%",y2:this.pagesContainerLayout.y,className:"frontLine"}):null,this.props.showTopBottom?a.createElement("line",{key:"bottomA",x1:"0",y1:this.pagesContainerLayout.y+this.pagesContainerLayout.height,x2:"100%",y2:this.pagesContainerLayout.y+this.pagesContainerLayout.height,className:"backLine"}):null,this.props.showTopBottom?a.createElement("line",{key:"bottomb",x1:"0",y1:this.pagesContainerLayout.y+this.pagesContainerLayout.height,x2:"100%",y2:this.pagesContainerLayout.y+this.pagesContainerLayout.height,className:"frontLine"}):null)}}),define("rEditor/rootComps/gridLines/gridLines",["react","lodash","core","rEditor/rootComps/gridLines/gridLines.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"gridLines",mixins:[c.mixins.editorAPIMixin],componentWillMount:function(){this.pagesContainerLayout=this.getEditorAPI().siteSegments.getPagesContainerAbsLayout()},componentWillReceiveProps:function(){this.pagesContainerLayout=this.getEditorAPI().siteSegments.getPagesContainerAbsLayout()},render:d})}),define("rEditor/rootComps/mobileFrame/mobileFrame.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("div",{className:b.keys(b.pick({"mobile-frame":!0,previewMode:this.props.previewMode},b.identity)).join(" "),style:{left:this.getMobilePreviewLeft()+"px"}},a.createElement("div",{className:"block-layer top"}),a.createElement("div",{className:"block-layer bottom"}),a.createElement("div",{className:"mobile-frame-top"}),a.createElement("div",{className:"site-shadow"}),a.createElement("div",{className:"mobile-frame-bottom"}))}}),define("rEditor/rootComps/mobileFrame/mobileFrame",["react","core","rEditor/rootComps/mobileFrame/mobileFrame.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"mobileFrame",propTypes:{previewMode:a.PropTypes.bool.isRequired},mixins:[b.mixins.editorAPIMixin],getMobilePreviewLeft:function(){return this.getEditorAPI().site.getXPos()},render:c})}),define("rEditor/utils/mouseMoveActions/baseSpace",["lodash","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes"],function(a,b,c){"use strict";function l(a,b){var c=b.x+b.width<=a.x,d=b.x>=a.x+a.width,e=!(c||d);return e&&b.y+b.height<=a.y}function m(b){var c=g.components.getSiblings(f),d=a(c).map(function(a){return g.components.layout.getRelativeToScreen(a)}).filter(function(a){return l(b,a)}).value();if(0===d.length)return 0;var e=a.max(d,function(a){return a.y+a.height});return e.y+e.height}function n(a){var b=g.components.getContainer(f),c=g.components.layout.getRelativeToScreen(b),d=m(a);return Math.max(d,c.y)}function o(b,c){g=b,f=c.compsToPush;var h=a.pluck(f,"id");g.renderPlugins.setCompsToShowOnTop(h);var l=a.omit(g.components.layout.getRelativeToScreen(f),"bounding"),m=a.map(f,function(b){return a.omit(g.components.layout.getRelativeToScreen(b),"bounding")});i=n(l),j=c.onSpaceEnd,k=c.onSpace;var o={x:c.evt.pageX,y:c.evt.pageY};e=new d.Drag(l,o,m)}function p(b){var c={x:b.pageX,y:b.pageY},d=e.getLayout(c);d.y=Math.max(d.y,i),h=e.getBoundComponentLayouts(d);for(var j=0;j<f.length;j++)g.components.layout.updateRelativeToScreenAndAdjustLayout(f[j],a.pick(h[j],"y"));
a.isFunction(k)&&k(c.x,c.y)}function q(){if(h){for(var b=0;b<f.length;b++)g.components.layout.updateRelativeToScreen(f[b],a.pick(h[b],"y"));h=null}g.renderPlugins.setCompsToShowOnTop(null),a.isFunction(j)&&j()}var e,f,g,h,i,j,k,d=b.utils.layoutTransitionsUtil;return{start:o,on:p,end:q,type:c.DRAG}}),define("rEditor/rootComps/sectionsReorganize/reorganizeSection.rt",["react/addons","lodash","baseUI","core"],function(a,b,c,d){"use strict";return function(){return a.createElement("div",{className:b.keys(b.pick(this.getClass(),b.identity)).join(" "),style:this.getStyle(),onMouseDown:this.onMainActionClick,onClick:this.onClick},a.createElement(c.tooltip,{id:this.props.tooltipId,value:"ONSTAGE_DRAG_STRIP_TOOLTIP",alignment:c.uiConstants.TOOLTIP.ALIGNMENT.LEFT,delay:"500",disabled:this.props.dragging},a.createElement("div",{className:"handle-wrapper",onMouseEnter:this.onMouseEnterHandle,onMouseLeave:this.onMouseLeaveHandle},a.createElement("div",{className:"handle"},a.createElement("div",{className:"graphic"},this.showFullHandleGraphic()?a.createElement(c.symbol,{name:"handle-arrow",className:"top",key:"handleArrowTop"}):null,a.createElement(c.symbol,{name:"handle-dots",className:this.showFullHandleGraphic()?"light":"dark",customDimensions:this.getHandleDimension()}),this.showFullHandleGraphic()?a.createElement(c.symbol,{name:"handle-arrow",className:"bottom",key:"handleArrowBottom"}):null),1===this.props.siteScale?a.createElement("div",{className:"half top",key:"halfTop"},a.createElement("div",{className:"action",onMouseDown:this.onTopActionClick})):null,1===this.props.siteScale?a.createElement("div",{className:"half bottom",key:"halfBottom"},a.createElement("div",{className:"action",onMouseDown:this.onBottomActionClick})):null))),a.createElement("div",{className:"block"},a.createElement("div",{className:"lines left",style:{width:"calc("+100*(1-this.props.siteScale)/2+"vw - 5px)"}}),a.createElement("div",{className:"lines right",style:{width:"calc("+100*(1-this.props.siteScale)/2+"vw - "+d.constants.SECTIONS_REORGANIZE.STRIP_WIDTH+"px - 5px)"}})),this.props.selected&&this.props.spacing&&this.props.mousePositionY>0?a.createElement("div",{key:"spaceBox",className:"space-box",style:this.getSpaceBoxStyle()}):null)}}),define("rEditor/rootComps/sectionsReorganize/reorganizeSection",["react","core","lodash","baseUI","rEditor/rootComps/sectionsReorganize/reorganizeSection.rt"],function(a,b,c,d,e){"use strict";function i(a){return a>500?"large":a>61?"medium":"small"}function j(a){return a>60?6:a>50?5:a>45?4:a>40?3:a>35?2:1}function k(a){return 4*j(a)-2}var f=200,g=3e3,h=b.bi.events.sectionReorganize;return a.createClass({displayName:"reorganizeSection",mixins:[b.mixins.editorAPIMixin],getInitialState:function(){return{handleHovered:!1}},componentWillReceiveProps:function(a){this.props.dragging&&!a.dragging&&this.setState({handleHovered:!1})},getClass:function(){return{section:!0,selected:this.isSelected(),hovered:this.isHovered(),scaled:1!==this.props.siteScale}},getStyle:function(){return{top:this.props.layout.y*this.props.siteScale,height:this.props.layout.height*this.props.siteScale}},onClick:function(){window.clearTimeout(this.timeout),this.timeout=null},onMainActionClick:function(a){this.timeout=window.setTimeout(this.props.onMainActionClick.bind(this,c.clone(a)),f),this.reportBI(h.REORDER_SECTION),this.hideTooltip(),a.stopPropagation()},onTopActionClick:function(a){this.props.onTopActionClick(a),this.reportBI(h.SPACE_TOP_DRAG),this.hideTooltip(),a.stopPropagation()},onBottomActionClick:function(a){this.props.onBottomActionClick(a),this.reportBI(h.SPACE_BOTTOM_DRAG),this.hideTooltip(),a.stopPropagation()},onMouseEnterHandle:function(){this.setState({handleHovered:!0}),setTimeout(this.hideTooltip,g),this.reportBI(h.HOVER_SECTION_HANDLE)},onMouseLeaveHandle:function(){this.setState({handleHovered:!1}),this.hideTooltip()},hideTooltip:function(){d.tooltipManager.hide(this.props.tooltipId)},isSelected:function(){return this.props.spacing||this.props.draggingAndPushing||this.props.dragging?this.props.selected:this.state.handleHovered},isHovered:function(){return this.props.spacing||this.props.draggingAndPushing||this.props.dragging?this.props.selected:this.props.hovered},showFullHandleGraphic:function(){return this.isSelected()||this.isHovered()},getHandleDimension:function(){var a=k(this.props.layout.height);return{height:a+"px",viewBox:"0 0 10 "+a}},getSpaceBoxStyle:function(){var a=this.props.layout.y+this.props.layout.height,b=this.props.mousePositionY-a;return{bottom:Math.min(0,-1*b),height:Math.abs(b)}},reportBI:function(a){var b=this.getEditorAPI();b.bi.event(a,{page_id:b.pages.getCurrentPageId(),section_size:i(this.props.layout.height)})},render:e})}),define("rEditor/rootComps/sectionsReorganize/sectionsReorganize.rt",["react/addons","lodash","baseUI","rEditor/rootComps/sectionsReorganize/reorganizeSection"],function(a,b,c,d){"use strict";function e(a,b,c,d){this.startSectionDrag(d,a,b)}function f(a,b,c,d){this.startDragAndPush(d,a,b)}function g(a,b,c,d){this.startSpacing(d,a,b)}function h(b,c,h){return a.createElement(d,{key:"section"+h,section:c,selected:this.isSectionSelected(c),hovered:this.isSectionHovered(c),layout:this.getSectionLayout(c),dragging:this.props.isSectionDragging,spacing:this.state.isSpacing,draggingAndPushing:this.state.isDraggingAndPushing,siteScale:this.props.siteScale,onMainActionClick:e.bind(this,b,c,h),onTopActionClick:f.bind(this,b,c,h),onBottomActionClick:g.bind(this,b,c,h),tooltipId:"reorganize-section-tooltip-"+h,mousePositionY:this.state.spaceY-this.editorAPI.editorConfig.previewTop})}function i(){var c=this.getSections();return c.length>1?a.createElement.apply(this,["div",{className:"sections-reorganize",key:"sectionsReorganizeWrapper"},c&&c.length?a.createElement("div",{key:"strip",className:"reorganize-strip"}):null,b.map(c,h.bind(this,c))]):null}return function(){return i.apply(this,[])}}),define("rEditor/rootComps/sectionsReorganize/sectionsReorganize",["react","lodash","core","rEditor/utils/mouseMoveActions/baseSpace","rEditor/utils/mouseMoveActions/baseDragAndPush","rEditor/rootComps/sectionsReorganize/sectionsReorganize.rt"],function(a,b,c,d,e,f){"use strict";function j(a){return a.height>=g?a:{y:a.y-g/2,height:30}}var g=30,h=c.utils.sectionDrag,i=c.bi.events.sectionReorganize;return a.createClass({displayName:"sectionsReorganize",mixins:[c.mixins.editorAPIMixin],propTypes:{isSectionDragging:a.PropTypes.bool,sections:a.PropTypes.array,selectedSection:a.PropTypes.object,draggedAddPanelComp:a.PropTypes.array},getInitialState:function(){return this.editorAPI=this.getEditorAPI(),this.sectionsCount=0,{isDraggingAndPushing:!1,isSpacing:!1,spaceY:0}},getSections:function(){var a;return this.props.sections?this.props.sections:(a=c.utils.sectionsReorganizeUtil.getPageSections(this.editorAPI),this.sectionsCount<=1&&a.length>1&&this.reportBI(i.SECTION_APPEARANCE),this.sectionsCount=a.length,a)},startDragAndPush:function(a,c,d){this.setState({isDraggingAndPushing:!0}),this.editorAPI.registerMouseMoveAction(e,{evt:b.clone(a),comps:d.comps,onDragAndPushEnd:this.onDragAndPushEndCallback}),this.editorAPI.setPageSections(c,d)},startSpacing:function(a,c,e){var f=this.editorAPI,g=e.comps,h=f.components.layout.getRelativeToStructure(g).y+f.components.layout.get(g).height,i=f.components.getSiblings(g[0]),j=b.filter(i,function(a){var b=f.components.layout.getRelativeToStructure(a);return b.y>=h});b.isEmpty(j)||(f.registerMouseMoveAction(d,{evt:b.clone(a),compsToPush:j,onSpace:this.onSpaceCallback,onSpaceEnd:this.onSpaceEndCallback}),a.stopPropagation(),this.setState({isSpacing:!0}),this.editorAPI.setPageSections(c,e))},onSpaceCallback:function(a,b){this.setState({spaceY:b})},onSpaceEndCallback:function(){this.editorAPI.clearPageSections(),this.setState({isSpacing:!1,spaceY:0})},onDragAndPushEndCallback:function(){this.editorAPI.clearPageSections(),this.setState({isDraggingAndPushing:!1})},startSectionDrag:function(a,b,d){this.props.setSiteScale(c.constants.SECTIONS_REORGANIZE.ZOOM_OUT_SCALE,window.pageYOffset*c.constants.SECTIONS_REORGANIZE.ZOOM_OUT_SCALE),this.reportBI(i.SECTION_ZOOM_OUT,c.constants.SECTIONS_REORGANIZE.ZOOM_OUT_SCALE),this.editorAPI.registerMouseMoveAction(h,{sections:b,evt:a,draggedSection:d,onDragEnd:this.onSectionDragEnd,onDragStart:this.onSectionDragStart.bind(this,a,d,b)})},onSectionDragStart:function(a,b,c){this.editorAPI.documentMode.allowShowingFixedComponents(!1),this.editorAPI.setPageSections(c,b)},onSectionDragEnd:function(){var a=this.props.selectedSection.position,b=a.bottom-a.top,d=a.top-(window.innerHeight-b)/2+this.editorAPI.editorConfig.previewTop;this.editorAPI.documentMode.allowShowingFixedComponents(!0),this.editorAPI.clearPageSections(),setTimeout(function(){this.reportBI(i.SECTION_ZOOM_IN,c.constants.SECTIONS_REORGANIZE.ZOOM_IN_SCALE),this.props.setSiteScale(c.constants.SECTIONS_REORGANIZE.ZOOM_IN_SCALE,d)}.bind(this),c.constants.SECTIONS_REORGANIZE.ZOOM_IN_DELAY_MS)},isSectionSelected:function(a){return this.props.selectedSection&&b.isEqual(a.comps,this.props.selectedSection.comps)},isSectionHovered:function(a){var b=this.props.mousePosition.y-this.editorAPI.editorConfig.previewTop;return b>=a.position.top&&b<=a.position.bottom},getSectionLayout:function(a){if(a.layout)return a.layout;if((this.props.isSectionDragging||this.state.isSpacing||this.state.isDraggingAndPushing)&&!b.isEmpty(a.comps)){var c=this.getEditorAPI().components.layout.getRelativeToScreen(a.comps);return c.bounding||c}return j({y:a.position.top,height:a.position.bottom-a.position.top})},reportBI:function(a,c){var d={page_id:this.editorAPI.pages.getCurrentPageId()};b.isUndefined(c)||(d.scale=c),this.editorAPI.bi.event(a,d)},render:f})}),define("rEditor/rootComps/stage/editorStage.rt",["react/addons","lodash","rEditor/rootComps/mouseCatcher","rEditor/rootComps/compControls/compControls","rEditor/rootComps/textEditor","util","uiAnimations","rEditor/rootComps/gridLines/gridLines","rEditor/rootComps/mobileFrame/mobileFrame","rEditor/rootComps/sectionsReorganize/sectionsReorganize","experiment!sectionsReorganizeExp"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function l(){var b=f.translate;return this.shouldDisplayMobileOptimizedTeaser()?a.createElement("div",{key:"teaser",className:"mobile-optimized-teaser"},a.createElement("h1",{},b("mobile_view_notification_title")),"\n                ",b("mobile_view_notification_text"),"\n                ",a.createElement("a",{onClick:this.openEditorModePanel},b("mobile_view_notification_text_link")),"\n                ",b("mobile_view_notification_text2"),"\n            "):null}return function(){return a.createElement("div",{className:"editor-stage",id:this.props.id,style:this.getEditorStageStyleProps()},a.createElement("div",{className:"scalable",style:this.getScalableAreaStyle()},this.getEditorAPI().isDesktopEditor()&&this.props.editorState.viewTools.guidelinesEnabled&&!this.props.editorState.pinMode?a.createElement(h,{key:"gridlines",showTopBottom:!this.isLandingPage()}):null,!this.props.editorState.previewMode&&this.props.editorIsInit?a.createElement(c,{ref:"mouseCatcher",key:"mouseCatcher",config:this.props.config,editorState:this.props.editorState,currentUserAction:this.props.currentUserAction,onContextMenu:this.props.onContextMenu,editorIsInit:this.props.editorIsInit,isSectionDragging:this.isSectionDragging(),isDragging:this.isDragging(),isResizing:this.isResizing(),isRotating:this.isRotating(),performingMouseMoveAction:this.props.performingMouseMoveAction,registeredMouseMoveAction:this.props.registeredMouseMoveAction,hoveredComp:this.props.hoveredComp,hoverBoxOverlay:this.props.hoverBoxOverlay,selectedComponents:this.props.selectedComponents,mouseMoveCallback:k&&this.props.mouseMoveCallback,siteScale:this.props.siteScale}):null,this.getEditorAPI().isMobileEditor()?a.createElement("div",{key:"mobileOpacityLatyer",className:"mobile-frame-opacity-layer"}):null,this.getEditorAPI().isMobileEditor()?a.createElement(i,{key:"mobileFrame",previewMode:!1}):null,a.createElement(g.panelsAnimation,{},l.apply(this,[])),this.props.selectedComponents?a.createElement(d,{key:"compControls",isDragging:this.isDragging(),isResizing:this.isResizing(),isRotating:this.isRotating(),performingMouseMoveAction:this.props.performingMouseMoveAction,selectedComponents:this.props.selectedComponents,hoveredComp:this.props.editorState.hoveredComp,lastSelectionClickPos:this.props.editorState.lastSelectionClickPos,panel:this.props.panel,previewTop:this.props.previewTop,getRotateKnobRect:this.refs.mouseCatcher&&this.refs.mouseCatcher.getRotateKnobRect,siteScale:this.props.siteScale,pinMode:this.props.editorState.pinMode}):null,this.props.editorState.isOpenTextEditor&&this.props.selectedComponents?a.createElement(e,{key:"textEditor",isResizing:this.isResizing()}):null),k?a.createElement("div",{className:"non-scalable",key:"nonScalable"},a.createElement("div",{className:"block-layer"},a.createElement("div",{className:"side left transition",style:{width:this.getSideBlockLayerWidth()+"%"}}),a.createElement("div",{className:"side right transition",style:{width:this.getSideBlockLayerWidth()+"%"}}),a.createElement("div",{className:"side bottom",style:{height:"calc(100% - "+this.getSideBlockLayerHeight()+"px)"}}),a.createElement("div",{className:"shadow",style:this.getBlockShadowStyle()})),this.props.editorIsInit&&!this.getEditorAPI().isMobileEditor()?a.createElement(j,{key:"sectionsReorganize",isSectionDragging:this.isSectionDragging(),sections:this.props.pageSections.sections,selectedSection:this.props.pageSections.selectedSection,mousePosition:this.props.mousePosition,siteScale:this.props.siteScale,setSiteScale:this.props.setSiteScale,draggedAddPanelComp:this.props.portalComps.addPanel}):null):null,this.props.editorState.pinMode?a.createElement("div",{className:"pinPreviewRect",ref:"pinPreviewRect",key:"pinPreviewRect",style:this.props.editorState.pinPreviewRectStyle}):null)}}),define("rEditor/rootComps/stage/editorStage",["lodash","react","core","rEditor/utils/mouseMoveActions/mouseMoveActionTypes","experiment!sectionsReorganizeExp","rEditor/rootComps/stage/editorStage.rt"],function(a,b,c,d,e,f){"use strict";return b.createClass({displayName:"EditorStage",mixins:[c.mixins.editorAPIMixin],shouldDisplayMobileOptimizedTeaser:function(){var a=this.getEditorAPI();return a.isMobileEditor()&&!a.getPreviewMode()&&!a.isMobileOptimizedSite()},componentDidMount:function(){document.addEventListener("scroll",this.onScroll)},componentWillUnmount:function(){document.removeEventListener("scroll",this.onScroll)},onScroll:function(){this.getEditorAPI().site.setScroll(window.pageXOffset,window.pageYOffset)},openEditorModePanel:function(){this.getEditorAPI().openMobileElementsPanel({mobileElementId:"mobileView"})},getStageHeight:function(){return Math.max(this.props.height,window.document.documentElement.clientHeight-this.props.top)},isLandingPage:function(){var a=this.getEditorAPI(),b=a.pages.getCurrentPageId();return a.pages.data.get(b).isLandingPage},isSectionDragging:function(){return this.props.registeredMouseMoveAction&&this.props.registeredMouseMoveAction.type===d.SECTION_DRAG&&this.props.performingMouseMoveAction||!1},isDragging:function(){return this.props.registeredMouseMoveAction&&this.props.registeredMouseMoveAction.type===d.DRAG&&this.props.performingMouseMoveAction},isResizing:function(){return this.props.registeredMouseMoveAction&&this.props.registeredMouseMoveAction.type===d.RESIZE},isRotating:function(){return this.props.registeredMouseMoveAction&&this.props.registeredMouseMoveAction.type===d.ROTATE},getEditorStageStyleProps:function(){var a={top:this.props.top};return e?a.overflow="hidden":a.height=this.getStageHeight(),a},getScalableAreaStyle:function(){if(e){var a=this.props.siteScale;if(1!==a)return{height:this.getStageHeight(),transform:"scale("+a+")",transformOrigin:"center 0"}}return{}},getSideBlockLayerWidth:function(){return 100*(1-this.props.siteScale)/2},getSideBlockLayerHeight:function(){return Math.max(0,this.getStageHeight()*this.props.siteScale)},getBlockShadowStyle:function(){var a=this.getSideBlockLayerWidth();return{left:a+"%",right:a+"%",height:this.getSideBlockLayerHeight()+"px"}},render:f})}),define("rEditor/rootComps/prefetch/prefetch.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("link",{rel:"prefetch prerender",href:this.getHref()})}}),define("rEditor/rootComps/prefetch/prefetch",["react","rEditor/rootComps/prefetch/prefetch.rt"],function(a,b){"use strict";return a.createClass({displayName:"prefetch",render:b,getHref:function(){return this.props.base?this.props.base.replace(/\/$/,"")+"/"+this.props.href.replace(/^\//,""):this.props.href}})}),define("rEditor/rootComps/external/qualarooFeedback/qualarooFeedback.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement(c.iframe,{ref:"iframe",className:b.keys(b.pick({hidden:this.props.inPreview||!this.state.shouldShowIframe,minimized:this.state.minimized},b.identity)).join(" "),src:this.state.shouldShowIframe?this.iframeURL:"",id:"qualarooFeedbackIframe"})}}),define("rEditor/bi/events.json",[],function(){return{QUALAROO_DUMMY_EVENT:{evid:9,src:38,fields:{testField:"testValue"}}}}),define("rEditor/bi/errors.json",[],function(){return{QUALAROO_SURVEY_TIMEOUT_NOT_SENT:{errorCode:8,errorName:"QUALAROO_SURVEY_TIMEOUT_NOT_SENT",desc:"qualaroo component was added without a timeout prop",severity:"error"}}}),define("rEditor/bi/bi",["rEditor/bi/events.json","rEditor/bi/errors.json"],function(a,b){"use strict";var c=function(b){b.bi.register("rEditor","event",a)};return{events:a,errors:b,registerEvents:c}}),define("rEditor/rootComps/external/qualarooFeedback/qualarooFeedback",["lodash","react","core","util","rEditor/rootComps/external/qualarooFeedback/qualarooFeedback.rt","rEditor/bi/bi"],function(a,b,c,d,e,f){"use strict";var g=1e3,h=60*g,i="/app/external/qualarooFeedback/survey.html";return b.createClass({displayName:"qualarooFeedback",mixins:[c.mixins.editorAPIMixin,d.postMessageMixin],propTypes:{timeoutInMinutes:b.PropTypes.number.isRequired,inPreview:b.PropTypes.bool.isRequired},getInitialState:function(){var a=d.editorModel.userInfo&&d.editorModel.userInfo.email,b=d.editorModel.editorBase||"/editor-base";return this.iframeURL=b+i+"?email="+a,{shouldShowIframe:!1,minimized:!1}},componentWillMount:function(){if(this.props.timeoutInMinutes){var a=this;this.timeoutHandle=setTimeout(function(){a.setState({shouldShowIframe:!0})},this.props.timeoutInMinutes*h)}else{var b=this.getEditorAPI();b.bi.error(f.errors.QUALAROO_SURVEY_TIMEOUT_NOT_SENT)}},componentDidMount:function(){this.setPostMessageHandlerNamed("qualaroo","qualaroo",this.onMessageFromSurvey)},componentWillUnmount:function(){clearTimeout(this.timeoutHandle)},onMessageFromSurvey:function(a){this.setState({minimized:a.minimized,shouldShowIframe:a.shouldShowIframe})},render:e})}),define("rEditor/rootComps/editor.rt",["react/addons","lodash","rEditor/rootComps/topBar/topBar","rEditor/rootComps/leftBar/leftBar","rEditor/rootComps/toolBar/toolBar","rEditor/rootComps/rightClickMenu/rightClickMenu","rEditor/rootComps/panels/openedPanels","rEditor/rootComps/portal/portal","baseUI","uiAnimations","rEditor/rootComps/stage/editorStage","textControls","rEditor/rootComps/mobileFrame/mobileFrame","rEditor/rootComps/prefetch/prefetch","rEditor/rootComps/external/qualarooFeedback/qualarooFeedback","experiment!QualarooNewEditorSurvey","experiment!sectionsReorganizeExp"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";function r(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}return function(){return a.createElement("div",r({className:"editor-animation-manager-wrapper",id:"editor",tabIndex:"0",style:this.getEditorWrapperStyle()},this.getAnimationsEventListeners()),a.createElement("div",{className:"editor-wrapper",onMouseMove:this.state.registeredMouseMoveAction?this.onMouseMove:b.noop,onMouseUp:this.state.registeredMouseMoveAction?this.onMouseUp:b.noop,onMouseDownCapture:this.onMouseDownCapture,style:{position:"static",height:"100%"}},this.isPreloaderVisible()?a.createElement("div",{key:"init",className:"preloader"}):null,this.editorAPI.isMobileEditor()?a.createElement("div",{key:"mobileBackground",className:"mobile-background "+(this.editorAPI.getPreviewMode()?"previewMode":"")}):null,a.createElement("iframe",{ref:"preview",id:"preview",src:this.getPreviewSource(),style:this.getPreviewFrameStyle()}),this.editorAPI.isMobileEditor()&&this.editorAPI.getPreviewMode()?a.createElement(m,{key:"mobileFrame",previewMode:!0}):null,this.state.previewMode?null:a.createElement(k,{id:"stageContainer",ref:"editorStage",key:"editorStage",height:this.getStageHeight(),top:this.state.editorConfig.previewTop,config:this.state.editorConfig,editorState:this.state,currentUserAction:this.state.currentUserAction,editorIsInit:this.state.editorIsInit,onContextMenu:this.onContextMenu,hoveredComp:this.state.hoveredComp,hoverBoxOverlay:this.state.hoverBoxOverlay,registeredMouseMoveAction:this.state.registeredMouseMoveAction,performingMouseMoveAction:this.state.performingMouseMoveAction,selectedComponents:this.state.selectedComponents,panel:this.getCompPanel(),previewTop:this.state.editorConfig.previewTop,mouseMoveCallback:q&&this.updateMousePosition,mousePosition:q&&this.state.mousePosition,siteScale:this.state.siteScale,setSiteScale:this.setSiteScale,portalComps:this.state.portalComps,pageSections:this.state.pageSections}),a.createElement("div",{className:"editor-controls"},a.createElement(c,{ref:"topbar",previewMode:this.state.previewMode,isMobileEditor:this.state.isMobileEditor,isMobileOptimized:this.editorAPI.isMobileOptimizedSite(),viewTools:this.state.viewTools,savingStatus:this.state.savingStatus,publishingStatus:this.state.publishingStatus,performingMouseMoveAction:this.state.performingMouseMoveAction,isEnabled:this.state.editorIsInit,height:this.state.editorConfig.topBarHeight,onTopBarClicked:this.editorAPI.onTopBarClicked,onContextMenu:this.onContextMenuPreventDefault}),a.createElement(j.leftBarAnimation,{},this.state.previewMode||this.state.pinMode?null:a.createElement(d,{leftBarState:this.state.leftBar,ref:"leftBar",openPanels:this.state.openPanels,isMobileEditor:this.state.isMobileEditor,isEnabled:this.state.editorIsInit,key:"leftBar",onContextMenu:this.onContextMenuPreventDefault})),this.state.viewTools.toolbarEnabled&&!this.state.previewMode?a.createElement(e,{hidden:this.state.pinMode,key:"toolBar",selectedComponent:this.state.selectedComponents,isEnabled:this.state.editorIsInit,onContextMenu:this.onContextMenuPreventDefault}):null,a.createElement(g,{openPanels:this.getNonCompPanels(),editorState:this.state}),a.createElement(i.tooltipsRenderer,{key:"tooltipsRenderer"}),a.createElement("div",{ref:"floatingBubbleTarget",style:this.getFloatingBubbleTargetStyle(),onMouseLeave:this.editorAPI.hideFloatingBubble}),this.state.floatingBubble.value&&!this.state.pinMode?a.createElement(i.bubble,{key:"floatingBubble",value:this.state.floatingBubble.value,targetNode:this.getFloatingBubbleTarget(),hideMethod:this.editorAPI.hideFloatingBubble}):null,a.createElement(i.dropDown.options,{})),this.state.editorIsInit?null:a.createElement("div",{className:"preloader-overlap",key:"preloader-overlap"}),a.createElement(j.rightClickAppearance,{direction:"top",key:"rightClick"},this.state.contextMenu?a.createElement(f,{key:this.state.contextMenu.position.x+""+this.state.contextMenu.position.y,clipboard:this.state.clipboard,position:this.state.contextMenu.position,previewTop:this.state.editorConfig.previewTop,selectedComponents:this.state.selectedComponents}):null),b.isEmpty(this.state.portalComps)?null:a.createElement(h,{key:"portalComps",comps:this.state.portalComps}),a.createElement(l.themeFontsLoader,{themeFonts:this.getThemeFonts(),documentType:this.getDocumentType,languages:this.getLanguages()}),a.createElement(n,{href:"app/external/OrganizeImages/index.html",base:this.getEditorBase()}),a.createElement(n,{href:"app/external/VideoSearch/index.html",base:this.getEditorBase()}),p?a.createElement(o,{id:"qualarooFeedback",key:"qualaroo",inPreview:this.state.previewMode,timeoutInMinutes:.1}):null))}}),define("rEditor/rootComps/editor",["lodash","core","panels","react","jquery","util","baseUI","rEditor/app/EditorAPI","rEditor/rootComps/keyboard/config/shortcutsConfig","uiAnimations","tpa","blog","wixStore","savePublish","rEditor/rootComps/editor.rt","experiment!wixstaff","experiment!sectionsReorganizeExp"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){"use strict";function z(a,b){var c=Math.pow(10,b||0);return Math.round(c*a)/c}function A(a,b,c){return Math.min(c,Math.max(b,a))}function B(){(new Image).src="http://fast.fonts.com/t/1.css?apiType=css&projectid=33bd0973-5b82-45be-bb77-837225874dfe"}function D(a){var b=a.match(C);return b&&b.length&&b[1]}function E(a){return a.petri_ovr&&(-1!==a.petri_ovr.indexOf("specs.DisableNewRelicScripts:true")&&"specs.DisableNewRelicScripts:true"||-1!==a.petri_ovr.indexOf("specs.DisableNewRelicScriptsSantaEditor:true")&&"specs.DisableNewRelicScriptsSantaEditor:true")}function F(b){var c=G(b.href)?w:v,d=f.url.parseUrl(b.href).query,e=E(d),g=new f.UrlBuilder(c+(d.siteId||D(b.href))).param("isEdited","true").param("isSantaEditor","true").param("dsOrigin","Editor1.4").ifParam(e,"petri_ovr",e).ifParam(p,"iswixsite","true").param("lang",f.editorModel.languageCode).paramsObj(a.pick(d,["metaSiteId","ReactSource","SantaVersions","baseVersion","isqa","debug","editorSessionId","experiments"]));return g.url()}function G(a){return 0===a.indexOf(x)}function H(a){var b=f.translate("GENERAL_Close_Warning_Message");return(a||window.event).returnValue=b,b}function I(a){var b=f.url.parseUrlParams(location);return a.ctrlKey&&"all"===b.debug}var r=.5;window.bi&&window.bi.event(459),f.newrelic.addPageAction("editor loaded");var y,s=!0,t=f.serviceTopology.editorServerRoot||"http://editor.wix.com/html/editor/web",u=t+"/renderer/render/",v=u+"document/",w=u+"template/",x=t+"/renderer/new?",C=/\/([a-zA-Z0-9]{8}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{4}-[a-zA-Z0-9]{12})/;return d.createClass({displayName:"editor",mixins:[j.animationManager],propTypes:{},getInitialState:function(){return this.editorAPI=new h(this),this.notifyEditorInit(),{editorIsInit:!1,editorConfig:this.editorAPI.editorConfig,contextMenu:null,hoveredComp:null,hoverBoxOverlay:!1,registeredMouseMoveAction:null,performingMouseMoveAction:!1,selectedComponents:null,lastSelectionClickPos:null,previewMode:!1,isMobileEditor:!1,snapLines:null,lassoLayout:null,candidates:null,clipboard:{},site:{premiumPackage:void 0},viewTools:{toolbarEnabled:void 0,rulersEnabled:void 0,guidelinesEnabled:void 0,snapToEnabled:void 0},helpProps:null,attachCandidate:null,constraintArea:null,openPanels:[],savingStatus:n.status.IDLE,publishingStatus:n.status.IDLE,portalComps:{},floatingBubble:{},leftBar:{isCollapsed:!1,notifications:{},superApps:{desktop:[],mobile:[]}},mousePosition:{x:0,y:0},pageSections:{sections:null,selectedSection:null},siteScale:1,pinPreviewERectStyle:{opacity:0}}},childContextTypes:{editorAPI:d.PropTypes.object,mediaServices:d.PropTypes.object},getChildContext:function(){return{editorAPI:this.editorAPI,mediaServices:this.editorAPI.mediaServices}},notifyEditorInit:function(){this.editorAPI.initPanelManager(),k.initEditor(this.editorAPI),i.init(this.editorAPI)},notifyPreviewReady:function(a){this.editorAPI.onPreviewReady(a),k.onPreviewReady(this.editorAPI),l.onPreviewReady(this.editorAPI),m.onPreviewReady(this.editorAPI),f.automationUtil.onPreviewReady(this.editorAPI),f.translate.init(this.editorAPI),this.setState({editorIsInit:!0}),s&&(s=!1,this.editorAPI.bi.event(b.bi.events.editor.EDITOR_READY),f.newrelic.finished()),B()},getPreviewSource:function(){return y=y||F(document.location)},componentDidMount:function(){this.updateKeyboardShortcutContext();var a=this.refs.preview.getDOMNode();try{a.contentWindow&&a.contentWindow.documentServices&&this.notifyPreviewReady(a.contentWindow.documentServices)}catch(b){console.error("can not access preview iframe")}window.addEventListener("message",this.previewMessageHandler);var c=f.url.getParameterByName("leavePagePopUp");"false"!==c&&window.addEventListener("beforeunload",H),history&&(history.replaceState({preview:!1},"edit mode"),window.onpopstate=this.onHistoryPopState)},componentDidUpdate:function(a,b){if(!b.editorIsInit&&this.state.editorIsInit){var c=document.getElementById("video-preloader");c&&c.parentNode.removeChild(c)}b.previewMode!==this.state.previewMode&&(history.state&&this.state.previewMode&&!history.state.preview?this.onEnterPreview():history.state&&!this.state.previewMode&&history.state.preview&&this.onExitPreview(),this.updateKeyboardShortcutContext(),e(document.body).toggleClass("previewMode",this.state.previewMode))},onExitPreview:function(){history.replaceState({preview:!1},"edit mode")},onEnterPreview:function(){history.pushState({preview:!0},"site preview")},onHistoryPopState:function(a){if(a.state){var b=a.state.preview&&!this.state.previewMode,c=!a.state.preview&&this.state.previewMode;(b||c)&&this.editorAPI.togglePreview()}},updateKeyboardShortcutContext:function(){var a=f.keyboardShortcuts.CONTEXTS;f.keyboardShortcuts.setContext(this.state.previewMode?a.PREVIEW:a.EDITOR)},previewMessageHandler:function(a){if(0===this.getPreviewSource().indexOf(a.origin)&&"documentServicesLoaded"===a.data){var b=this.refs.preview.getDOMNode();this.notifyPreviewReady(b.contentWindow.documentServices)}},getCompPanel:function(){return a.find(this.state.openPanels,{frameType:"compPanelFrame"})},getNonCompPanels:function(){return a.reject(this.state.openPanels,{frameType:"compPanelFrame"})},registerMouseMoveAction:function(b,c){a.isFunction(b.start)&&b.start(this.editorAPI,c),this.setState({registeredMouseMoveAction:b})},onMouseMove:function(b){q&&f.mouseScaleHandler.fitMouseCoordinatesToScale(this.editorAPI,b,this.state.siteScale);var c=!this.state.performingMouseMoveAction;c&&(f.keyboardShortcuts.disable(),this.setState({performingMouseMoveAction:!0,lastSelectionClickPos:null})),a.isFunction(this.state.registeredMouseMoveAction.on)&&this.state.registeredMouseMoveAction.on(b)},onMouseUp:function(b){q&&f.mouseScaleHandler.fitMouseCoordinatesToScale(this.editorAPI,b,this.state.siteScale),this.state.registeredMouseMoveAction&&a.isFunction(this.state.registeredMouseMoveAction.end)&&this.state.registeredMouseMoveAction.end(b),f.keyboardShortcuts.enable(),this.setState({registeredMouseMoveAction:null,performingMouseMoveAction:!1})},onMouseDownCapture:function(a){2===a.button&&a.stopPropagation()},onContextMenu:function(a){I(a)||(a.preventDefault(),c.panelManager.closeAllPanels(),this.editorAPI.selection.selectComponentByClick(a),this.editorAPI.openRightClickMenu(a.clientX,a.clientY+window.pageYOffset))},onContextMenuPreventDefault:function(a){I(a)||a.preventDefault()},getPreviewFrameStyle:function(){var a={top:this.state.editorConfig.previewTop,height:"calc(100% - "+this.state.editorConfig.previewTop+"px)"};return this.editorAPI.isMobileEditor()&&(a.height="calc(100% - "+(this.state.editorConfig.previewTop+g.uiConstants.MOBILE_PREVIEW_BOTTOM)+"px)",this.editorAPI.getPreviewMode()&&(a.maxHeight=512)),a},getStageHeight:function(){var a=this.state.editorConfig.previewHeight;if(this.editorAPI.isMobileEditor())if(this.editorAPI.getPreviewMode()){var b=e(window).height()-(this.state.editorConfig.previewTop+e(this.refs.preview.getDOMNode()).height());a+=b}else a+=g.uiConstants.MOBILE_PREVIEW_BOTTOM;return a},getDocumentType:function(){return this.editorAPI.generalInfo&&this.editorAPI.generalInfo.getDocumentType()},getLanguages:function(){return this.editorAPI.theme&&this.editorAPI.theme.fonts&&this.editorAPI.theme.fonts.getCharacterSet()},
getThemeFonts:function(){return this.editorAPI.theme.fonts&&this.editorAPI.theme.fonts.getAll()},getEditorBase:function(){return f.editorModel.editorBase},isPreloaderVisible:function(){var a=document.getElementById("video-preloader");return!a&&!this.state.editorIsInit},getFloatingBubbleTargetStyle:function(){if(!this.state.floatingBubble.targetLayout)return{display:"none"};var b=this.state.floatingBubble.targetLayout,c=a(b).pick(["width","height","top","left"]).assign({position:"fixed"}).value();return c},getFloatingBubbleTarget:function(){return this.isMounted()&&this.refs.floatingBubbleTarget?this.refs.floatingBubbleTarget.getDOMNode():null},getEditorWrapperStyle:function(){var a=this.getStageHeight();return q?{height:Math.max(window.innerHeight-this.state.editorConfig.previewTop,a*this.state.siteScale)}:{height:a}},updateMousePosition:function(a,b,c){this.setState({mousePosition:{x:b,y:c}})},setSiteScale:function(a,b){var c=window.innerHeight-this.state.editorConfig.previewTop,d=c/this.getStageHeight(),e=z(A(d,a,1),2);e!==this.state.siteScale&&this.setState({siteScale:e}),this.editorAPI.documentServices.site.setScrollAndScale(0,b,e,r),j.scrollTo({x:0,y:b},r,0,window)},render:o})}),define("rEditor/utils/newPagesData",[],function(){"use strict";return{createBlankPageData:function(a){return{componentType:"mobile.core.components.Page",type:"Page",id:"mainPage",styleId:"p2",skin:"skins.core.InlineSkin",layout:{x:0,y:0,width:980,height:500,anchors:[]},data:{type:"Page",metaData:{isPreset:!1,schemaVersion:1,isHidden:!1},title:"Blank",hideTitle:!0,icon:"",descriptionSEO:"",metaKeywordsSEO:"",pageTitleSEO:"",pageUriSEO:"blank",hidePage:!1,underConstruction:!1,pageBackgrounds:a.pages.serialize(a.pages.getCurrentPageId()).data.pageBackgrounds},components:[]}}}}),define("rEditor/pagesMenu/addPageMenuPanel/addPageMenuPanel.rt",["react/addons","lodash","symbols","baseUI","util"],function(a,b,c,d,e){"use strict";function f(){var b=e.translate;return a.createElement("ul",{className:"tooltip-pages-add-menu"},a.createElement("li",{},a.createElement("div",{onClick:this.props.addPage},a.createElement("span",{className:"icon"},a.createElement(c.symbol,{name:"addPagePanelPage"})),a.createElement("div",{},a.createElement("span",{className:"title"},b("Pages_Menu_Add_Page_Title")),a.createElement("span",{className:"description"},b("Pages_Menu_Add_Page_Text")))),a.createElement("li",{},a.createElement("div",{onClick:this.props.addLink},a.createElement("span",{className:"icon"},a.createElement(c.symbol,{name:"addPagePanelLink"})),a.createElement("div",{},a.createElement("span",{className:"title"},"\n                    ",b("Pages_Menu_Add_Link_Title"),"\n                    ",a.createElement(d.tooltip,{value:"Pages_Menu_Add_Link_Tooltip",width:"228",alignment:d.uiConstants.TOOLTIP.ALIGNMENT.TOP},a.createElement("div",{className:"title-help-icon"},a.createElement(c.symbol,{name:"infoSmall"})))),a.createElement("span",{className:"description"},b("Pages_Menu_Add_Link_Text"))))),a.createElement("li",{},a.createElement("div",{onClick:this.props.addDropdown},a.createElement("span",{className:"icon"},a.createElement(c.symbol,{name:"addPagePanelDropDown"})),a.createElement("div",{},a.createElement("span",{className:"title"},"\n                    ",b("Pages_Menu_Add_Dropdown_Title"),"\n                    ",a.createElement(d.tooltip,{value:this.getTooltipValue(),width:"240px",alignment:d.uiConstants.TOOLTIP.ALIGNMENT.TOP},a.createElement("div",{className:"title-help-icon"},a.createElement(c.symbol,{name:"infoSmall"})))),a.createElement("span",{className:"description"},b("Pages_Menu_Add_Dropdown_Text")))))))}return function(){return f.apply(this,[])}}),define("rEditor/pagesMenu/addPageMenuPanel/addPageMenuPanel",["react","lodash","baseUI","rEditor/pagesMenu/addPageMenuPanel/addPageMenuPanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"addPageMenuPanel",mixins:[],propTypes:{addPage:a.PropTypes.func,addLink:a.PropTypes.func,addDropdown:a.PropTypes.func},getTooltipValue:function(){return{classPath:"baseUI.popoverTemplates.imageAndTextTooltip",props:{image:"addDropDownHint",imageContainerStyle:{backgroundColor:"#17a8a4"},text:"Pages_Menu_Add_Dropdown_Tooltip"}}},render:d})}),define("rEditor/pagesMenu/menuLogic",[],function(){"use strict";return{isInMainMenuPage:function(a){return a},isSubPagesMenuPage:function(a){return a},isSection:function(a){return a.isWixAppsPage&&!a.isWixAppsSubPage&&(a.isBlogFeedPage||a.isTpaSectionPage)}}}),define("rEditor/pagesMenu/pageNode/pageInfoTextHelper",[],function(){"use strict";return{getInfoTextByDataType:function(a){return a.isLink?"Pages_Menu_Link_Tooltip":a.isDropdown?"Pages_Menu_Dropdown_Tooltip":void 0},getInfoTextByPageData:function(a){if(a.isBlogPage){if(a.isBlogFeedPage)return"Pages_Menu_Blog_Tooltip";if(a.isBlogSubPage)return"Pages_Blog_Post_Info_WhatisText"}else if(a.isTpaPage){if("wixStore"!==a.pageType)return"TPA pages";if(a.isTpaSubPage){if(a.isTpaProductPage)return"Pages_Store_Product_Info_WhatisText";if(a.isTpaCartPage)return"Pages_Store_Cart_Info_WhatisText";if(a.isTpaThankYouPage)return"Pages_Store_Thankyou_Info_WhatisText"}else if(a.isTpaSectionPage)return"Pages_Store_Panel_Title"}}}}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell.rt",["react/addons","lodash","pagesMenu","baseUI","core","symbols","util","rEditor/pagesMenu/pageNode/pageInfoTextHelper"],function(a,b,c,d,e,f,g,h){"use strict";function i(){this.props.actions.openSettingsPanel(this.props.dataSource.id)}return function(){return a.createElement(c.nodeContentCommon,b.assign({},{isVisible:void 0===this.props.isVisible?this.props.dataSource.isVisibleMobile:this.props.isVisible},this.props),a.createElement("a",{href:"javascript://settings",className:"action-button action-settings",onClick:i.bind(this)},a.createElement(f.symbol,{name:"quickActionsSettings"})),"\n\n    ",this.props.children,"\n")}}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell",["react","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell.rt"],function(a,b){"use strict";return a.createClass({displayName:"nodeContentMobileShell",render:b})}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileSimplePage.rt",["react/addons","lodash","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell"],function(a,b,c){"use strict";return function(){return a.createElement(c,this.props)}}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileNotPage.rt",["react/addons","lodash","baseUI","symbols","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell","rEditor/pagesMenu/pageNode/pageInfoTextHelper"],function(a,b,c,d,e,f){"use strict";function g(){var b=f.getInfoTextByDataType(this.props.dataSource.type)||f.getInfoTextByPageData(this.props.dataSource.pageData);return a.createElement(e,this.props,a.createElement("a",{href:"#",key:"action-button-info-subpage",className:"action-button"},a.createElement(c.infoIcon,{symbolName:"actionButtonInfo",text:b})))}return function(){return g.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileSectionPage.rt",["react/addons","lodash","pagesMenu","baseUI","core","symbols","util","rEditor/pagesMenu/pageNode/pageInfoTextHelper","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileShell"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a,b,c){this.props.actions.openSubPagesMenu(a)}function k(){var b=this.props.dataSource,c=this.props.dataSource.pageData,e=h.getInfoTextByDataType(this.props.dataSource.type)||h.getInfoTextByPageData(this.props.dataSource.pageData);return a.createElement(i,this.props,a.createElement("a",{className:"action-button action-button-special-pages-mobile",onClick:j.bind(this,b,c,e)},c.isTpaPage?a.createElement(d.infoIcon,{key:"action-button-special-pages-tpa-mobile",symbolName:"actionButtonSpecialPages",propagate:!0,text:e}):null,c.isBlogPage?a.createElement(d.infoIcon,{key:"action-button-special-pages-blog-mobile",symbolName:"actionButtonBlogPages",propagate:!0,text:e}):null))}return function(){return k.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/common/nodeContentSubPage.rt",["react/addons","lodash","baseUI","rEditor/pagesMenu/pageNode/pageInfoTextHelper","pagesMenu","symbols"],function(a,b,c,d,e,f){"use strict";function g(a){this.props.actions.openSettingsPanel(this.props.dataSource.id)}function h(){var h=d.getInfoTextByDataType(this.props.dataSource.type)||d.getInfoTextByPageData(this.props.dataSource.pageData);return a.createElement(e.nodeContentCommon,b.assign({},{isVisible:!0},this.props),a.createElement("a",{href:"javascript://settings",className:"action-button action-settings",onClick:g.bind(this,h)},a.createElement(f.symbol,{name:"quickActionsSettings"})),a.createElement("a",{href:"#",className:"action-button"},a.createElement(c.infoIcon,{symbolName:"actionButtonInfo",text:h})))}return function(){return h.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon.rt",["react/addons","lodash","pagesMenu"],function(a,b,c){"use strict";return function(){return a.createElement(c.nodeContentCommon,b.assign({},{isVisible:void 0===this.props.isVisible?this.props.dataSource.isVisible:this.props.isVisible},this.props),"\n\n    ",this.props.children,"\n\n")}}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon",["react","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon.rt"],function(a,b){"use strict";return a.createClass({displayName:"nodeContentDesktopCommon",render:b})}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuCommon.rt",["react/addons","lodash","baseUI","symbols","util","pagesMenu"],function(a,b,c,d,e,f){"use strict";function g(){var b=this.props.dataSource,g=e.translate,h=f.pageMenuItemHelpers,i=this.props.editorAPI;return a.createElement(c.dropDown.contextMenu,{shouldTranslate:!1,icon:"moreRegular",className:"quick-actions action-button",onChange:this.actionSelectedHandler},"\n\n    ",this.props.children,"\n\n    ",a.createElement(c.dropDown.option,{value:"rename"},a.createElement(d.symbol,{name:"quickActionsRename"}),"\n        ",g("Pages_Actions_Page_Rename"),"\n    "),h.canDuplicate(i,b)?a.createElement(c.dropDown.option,{key:"quick-actions-duplicate",value:"duplicate"},a.createElement(d.symbol,{name:"qaDuplicate"}),"\n        ",g("Pages_Actions_Page_Duplicate"),"\n    "):null,h.canUnhide(i,b)?a.createElement(c.dropDown.option,{key:"quick-actions-unhide",value:"unhide"},a.createElement(d.symbol,{name:"quickActionsShow"}),"\n        ",g("Pages_Actions_Page_Unhide"),"\n    "):null,h.canHide(i,b)?a.createElement(c.dropDown.option,{key:"quick-actions-hide",value:"hide"},a.createElement(d.symbol,{name:"quickActionsHide"}),"\n        ",g("Pages_Actions_Page_Hide"),"\n    "):null,h.canSubpage(b)?a.createElement(c.dropDown.option,{key:"quick-actions-subpage",value:"subpage"},a.createElement(d.symbol,{name:"quickActionsSubpage"}),"\n        ",g("Pages_Actions_Page_Subpage"),"\n    "):null,h.canMoveUp(b)?a.createElement(c.dropDown.option,{key:"quick-actions-moveup",value:"moveup"},a.createElement(d.symbol,{name:"quickActionsMainPage"}),"\n        ",g("Pages_Actions_Page_MoveUp"),"\n    "):null,h.canRemove(i,b)?a.createElement(c.dropDown.option,{key:"quick-actions-remove",value:"remove"},a.createElement(d.symbol,{name:"qaDelete"}),"\n        ",g("Pages_Actions_Page_Delete"),"\n    "):null)}return function(){return g.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuCommon",["react","pagesMenu","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuCommon.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"quickActionsMenuCommon",mixins:[b.mixins.quickActionRenameMixin],propTypes:{dataSource:a.PropTypes.object.isRequired,editorAPI:a.PropTypes.object.isRequired,editedPageIdLink:a.PropTypes.object.isRequired,onActionSelected:a.PropTypes.func.isRequired},render:c})}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuPage.rt",["react/addons","lodash","baseUI","symbols","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuCommon","experiment!pageSettingsTabs","util"],function(a,b,c,d,e,f,g){"use strict";function h(){var b=g.translate;return a.createElement(e,this.props,f?a.createElement(c.dropDown.option,{key:"quick-action-tab-page-info",value:"tabPageInfo",className:"primary"},a.createElement(d.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),"\n        ",b("Pages_Actions_Page_Info"),"\n    "):null,f?a.createElement(c.dropDown.option,{key:"quick-action-tab-layout",value:"tabLayout",className:"primary"},a.createElement(d.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),"\n        ",b("Pages_Actions_Page_Layouts"),"\n    "):null,f?a.createElement(c.dropDown.option,{key:"quick-action-tab-permissions",value:"tabPermissions",className:"primary"},a.createElement(d.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),"\n        ",b("Pages_Actions_Page_Permissions"),"\n    "):null,f?a.createElement(c.dropDown.option,{key:"quick-action-tab-seo",value:"tabSEO",className:"primary"},a.createElement(d.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),"\n        ",b("Pages_Actions_Page_SEO"),"\n    "):null,f?a.createElement(c.dropDown.option,{key:"quick-action-separator",className:"separator"},a.createElement("hr",{className:"divider-long"})):null,f?null:a.createElement(c.dropDown.option,{key:"quick-action-settings",value:"settings",className:"primary"},a.createElement(d.symbol,{name:"quickActionsSettings",style:{position:"relative",top:"4px",left:"-1px"}}),"\n        ",b("Pages_Actions_Page_Settings"),"\n    "))}return function(){return h.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuPage",["react","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuPage.rt"],function(a,b){"use strict";return a.createClass({displayName:"quickActionsMenuPage",render:b})}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopSimplePage.rt",["react/addons","lodash","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuPage"],function(a,b,c,d){"use strict";return function(){return a.createElement(c,this.props,a.createElement(d,this.props))}}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopSectionPage.rt",["react/addons","lodash","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuPage","rEditor/pagesMenu/pageNode/pageInfoTextHelper","baseUI"],function(a,b,c,d,e,f){"use strict";function g(a,b){this.props.actions.openSubPagesMenu(a)}function h(){var b=this.props.dataSource,h=e.getInfoTextByDataType(this.props.dataSource.type)||e.getInfoTextByPageData(this.props.dataSource.pageData);return a.createElement(c,this.props,a.createElement(d,this.props),a.createElement("a",{href:"#",className:"action-button",onClick:g.bind(this,b,h)},a.createElement(f.infoIcon,{symbolName:"actionButtonSpecialPages",propagate:!0,text:h})))}return function(){return h.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuNotPage.rt",["react/addons","lodash","baseUI","symbols","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuCommon","rEditor/pagesMenu/pageNode/pageInfoTextHelper","util"],function(a,b,c,d,e,f,g){"use strict";function h(){var b=this.props.dataSource,f=g.translate;return a.createElement(e,this.props,b.type.isLink?a.createElement(c.dropDown.option,{key:"quick-actions-rename-link",value:"changeLink"},a.createElement(d.symbol,{name:"quickActionsLink"}),"\n        ",f("Pages_Actions_Link_Change"),"\n    "):null)}return function(){return h.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuNotPage",["react","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuNotPage.rt"],function(a,b){"use strict";return a.createClass({displayName:"quickActionsMenuNotPage",render:b})}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopNotPage.rt",["react/addons","lodash","baseUI","rEditor/pagesMenu/pageNode/pageInfoTextHelper","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopCommon","rEditor/pagesMenu/pageNode/desktop/quickActionsMenu/quickActionsMenuNotPage"],function(a,b,c,d,e,f){"use strict";function g(){var b=d.getInfoTextByDataType(this.props.dataSource.type)||d.getInfoTextByPageData(this.props.dataSource.pageData);return a.createElement(e,this.props,a.createElement(f,this.props),a.createElement("a",{href:"#",key:"action-button-info-subpage",className:"action-button"},a.createElement(c.infoIcon,{symbolName:"actionButtonInfo",text:b})))}return function(){return g.apply(this,[])}}),define("rEditor/pagesMenu/pageNodeRenderers",["rEditor/pagesMenu/menuLogic","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileSimplePage.rt","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileNotPage.rt","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileSectionPage.rt","rEditor/pagesMenu/pageNode/common/nodeContentSubPage.rt","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopSimplePage.rt","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopSectionPage.rt","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopNotPage.rt"],function(a,b,c,d,e,f,g,h){"use strict";function i(e){return e.type.isPage?a.isSection(e.pageData)?d:b:e.type.isLink||e.type.isDropdown?c:void 0}function j(b){return b.type.isPage?a.isSection(b.pageData)?g:f:b.type.isLink||b.type.isDropdown?h:void 0}return{mobile:{mainMenu:i},desktop:{mainMenu:j},common:{subPages:function(){return e}}}}),define("rEditor/pagesMenu/pageNode/common/nodeContentSubPage",["react","rEditor/pagesMenu/pageNodeRenderers"],function(a,b){"use strict";return a.createClass({displayName:"nodeContentMobileSubPage",render:function(){return b.common.subPages(this.props.dataSource).call(this)}})}),define("rEditor/pagesMenu/subPages/subPages.rt",["react/addons","lodash","baseUI","core","symbols","util","rEditor/pagesMenu/pageNode/common/nodeContentSubPage"],function(a,b,c,d,e,f,g){"use strict";function h(a){a.preventDefault(),this.props.actions.closeSubPagesMenu()}return function(){return a.createElement("div",{className:"wixapps-tree pages-tree-container"},a.createElement("div",{className:"pages-tree-controls"},a.createElement("a",{href:"#",className:"panel-header-close",onClick:h.bind(this)},a.createElement("button",{className:"button-control back-to-pages"},a.createElement(e.symbol,{name:"arrowLeft"})),a.createElement("span",{},f.translate("pages_blog_panel_back")))),this.state.selectedSubPageMenuItem.isBlogPage?a.createElement(c.firstTimeInfoBox,{context:"pages-panel",key:"subpages-firsttime-for-blog",id:"blog-pages-menu",icon:"firstTimeBlogPages",title:"Here are your Post pages!",text:"Navigate to see how your blog posts appears when users view them.",hide:!1,userPrefs:this.props.userPrefs,biLearnMore:this.getEditorAPI().bi.event.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.LEARN_MORE),biClose:this.getEditorAPI().bi.event.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.CLOSE)}):null,this.state.selectedSubPageMenuItem.isTpaPage?a.createElement(c.firstTimeInfoBox,{key:"subpages-firsttime-for-tpa",id:"store-pages-menu",icon:"firstTimeStorePages",title:"Here are your Store pages!",text:"These pages are templates. Their content can change due to... Click to navigate and edit.",hide:!1,userPrefs:this.props.userPrefs,biLearnMore:this.getEditorAPI().bi.event.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.LEARN_MORE),biClose:this.getEditorAPI().bi.event.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.CLOSE)}):null,a.createElement(c.customScroll,{},a.createElement(c.treeView,{className:"pages-tree ",dataSource:this.getWixAppsPagesList(),nodeContent:g,valueProperty:"id",editorAPI:this.getEditorAPI(),actions:{openSettingsPanel:this.props.actions.openSettingsPanel,closeSettingsPanel:this.props.actions.closeSettingsPanel},valueLink:this.linkPage(),isRoot:!0})))}}),define("rEditor/pagesMenu/subPages/subPages",["react","lodash","core","rEditor/utils/menuItemsRepository","rEditor/pagesMenu/subPages/subPages.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"subPages",mixins:[a.addons.LinkedStateMixin,c.mixins.editorAPIMixin],getInitialState:function(){return{selectedSubPageMenuItem:this.props.selectedMenuItem}},linkPage:function(){return{value:this.state.selectedSubPageMenuItem,requestChange:function(a){var b=this.getEditorAPI();this.props.actions.updateMenuItemIdToShowSettingsFor(a.pageData.id),this.setState({selectedSubPageMenuItem:a}),a&&a.pageData&&b.pages.navigateTo(a.pageData.id)}.bind(this)}},componentWillReceiveProps:function(a){this.setState({selectedSubPageMenuItem:a.selectedMenuItem})},getWixAppsPagesList:function(){var a=this.state.selectedSubPageMenuItem&&this.state.selectedSubPageMenuItem.pageData;if(a){if(a.isBlogPage)return this.getBlogSubPagesList();if(a.isTpaPage||a.isTpaSubPage)return this.getTpaSubPagesList(a.tpaApplicationId)}return[]},getTpaSubPagesList:function(a){return d.getMenuTpaSubItems(this.getEditorAPI(),a)},getBlogSubPagesList:function(){return d.getMenuBlogSubItems(this.getEditorAPI())},render:e})}),define("rEditor/pagesMenu/pagesTree/pagesTree.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";return function(){return a.createElement(c.customScroll,{ref:"customScroll"},a.createElement(c.treeView,b.assign({},{className:this.getTreeViewClasses(),dataSource:this.props.pagesList,collapsedSelector:"isCollapsed",editorAPI:this.getEditorAPI(),valueProperty:"id",isRoot:!0},this.filteredProps())))}}),define("rEditor/pagesMenu/pagesTree/pagesTree",["lodash","react","core","rEditor/pagesMenu/pagesTree/pagesTree.rt"],function(a,b,c,d){"use strict";return b.createClass({displayName:"pagesTree",mixins:[c.mixins.editorAPIMixin],propTypes:{pagesList:b.PropTypes.any.isRequired},filteredProps:function(){return a.omit(this.props,["pagesList","dataSource","className","nodeTemplate","collapsedSelector","editorAPI","valueProperty"])},getScrollTop:function(){return this.refs.customScroll.getScrollTop()},scrollToSelectedNode:function(){this._scrollToSelectedNode=!0},componentDidUpdate:function(){var a,b,c,d,e=NaN;this._scrollToSelectedNode&&(this._scrollToSelectedNode=!1,a=this.getDOMNode(),b=a.querySelector(".pages-tree-item.selected"),b&&(c=a.getBoundingClientRect(),d=b.getBoundingClientRect(),d.top<c.top?e=this.getScrollTop()+(d.top-c.top):d.bottom>c.bottom&&(e=this.getScrollTop()+(d.bottom-c.bottom)),isNaN(e)||this.refs.customScroll.updateScrollPosition(Math.max(0,e))))},getTreeViewClasses:function(){return"pages-tree "},render:d})}),define("rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsUtils",["util"],function(a){"use strict";var b={none:"Pages_Menu_Transitions_None",swipeHorizontalFullScreen:"Pages_Menu_Transitions_SwipeH_Selected",swipeVerticalFullScreen:"Pages_Menu_Transitions_SwipeV_Popup",crossfade:"Pages_Menu_Transitions_CrossFade",outIn:"Pages_Menu_Transitions_OutIn"},c={outIn:"outIn",crossfade:"crossfade",shrinkfade:"crossfade",swipeHorizontal:"swipeHorizontalFullScreen",swipeHorizontalFullScreen:"swipeHorizontalFullScreen",swipeVertical:"swipeVerticalFullScreen",swipeVerticalFullScreen:"swipeVerticalFullScreen",none:"none"};return{calcNewIdFromLegacy:function(a){return c[a]?c[a]:c.none},getTransitionLabelKey:function(a){var c=this.calcNewIdFromLegacy(a);return b[c]},getTransitionLabelTranslated:function(b){return a.translate(this.getTransitionLabelKey(b))}}}),define("rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsPanel.rt",["react/addons","lodash","baseUI","core","symbols","util","rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsUtils"],function(a,b,c,d,e,f,g){"use strict";return function(){return a.createElement("section",{className:"page-transitions",tabIndex:"0"},a.createElement("header",{className:"panel-header dark"},a.createElement("h1",{},f.translate("Pages_Menu_Transitions_Title")),a.createElement("div",{className:"buttons"},a.createElement("button",{className:"help",onClick:this.helpClicked},"?"),a.createElement("button",{className:"close",onClick:this.close},a.createElement(e.symbol,{name:"headerCloseButton"})))),a.createElement("div",{className:"content"},a.createElement(c.firstTimeInfoBox,{id:"page-transitions-panel",icon:"pageTransitions",title:"Pages_Menu_Transitions_FirstTime_Title",text:"Pages_Menu_Transitions_FirstTime_Text",hide:!0,userPrefs:this.props.userPrefs,biLearnMore:this.props.biEvent.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.LEARN_MORE),biClose:this.props.biEvent.bind(null,d.bi.events.commonControls.FIRST_TIME_INFO_BOX.CLOSE)}),a.createElement(c.thumbnails,{className:"with-labels",maxThumbsPerRow:"3",options:this.props.transitionsToShow,value:g.calcNewIdFromLegacy(this.getEditorAPI().pages.transitions.get()),onChange:this.onTransitionChange})),a.createElement("i",{className:"triangle"}))}}),define("rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsPanel",["react","lodash","panels","rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsPanel.rt","rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsUtils","core","util"],function(a,b,c,d,e,f,g){"use strict";var h=[{id:"none",symbolName:"transition-none"},{id:"swipeHorizontalFullScreen",symbolName:"transition-pages-horizontal"},{id:"swipeVerticalFullScreen",symbolName:"transition-pages-vertical"},{id:"crossfade",symbolName:"transition-pages-crossfade"},{id:"outIn",symbolName:"transition-pages-inout"}];return a.createClass({displayName:"pageTransitionsPanel",mixins:[f.mixins.editorAPIMixin,g.outerClickMixin],render:d,propTypes:{onClose:a.PropTypes.func},getDefaultProps:function(){return{transitionsToShow:b.map(h,function(a){return{value:a.id,label:e.getTransitionLabelKey(a.id),symbolName:a.symbolName}})}},componentDidMount:function(){this.getDOMNode().focus()},onTransitionChange:function(a){this.getEditorAPI().pages.transitions.set(a),this.getEditorAPI().bi.event(f.bi.events.topbar.pages.top_bar_PAGES_page_transition_selected_click,{category:a}),this.performAnimationSimulation()},flattenMenuData:function(a){var c=[];return b.forEach(a.mainMenu.getMenu(),function(a){c.push(a),a.items&&b.forEach(a.items,function(a){c.push(a)})}),c},performAnimationSimulation:function(){var a=this.getEditorAPI(),c=a.pages.getCurrentPage().id,d=b.filter(this.flattenMenuData(a),function(a){return a.link?"PageLink"===a.link.type:!1}),e=b.pluck(b.pluck(d,"link"),"pageId"),f=e.indexOf("#"+c),g=f+1;f===e.length-1&&(g=0),g!==f&&a.pages.navigateTo(e[g].slice(1))},helpClicked:function(){c.panelManager.openHelpCenter("dfc95824-954a-4d20-aad2-7971d3fbdb98")},close:function(){this.props.onClose&&this.props.onClose()},onOuterClick:function(){this.close()}})}),define("rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopMainMenu",["react","rEditor/pagesMenu/pageNodeRenderers"],function(a,b){"use strict";return a.createClass({displayName:"nodeContentDesktopMainMenu",render:function(){return b.desktop.mainMenu(this.props.dataSource).call(this)}})}),define("rEditor/rootComps/panels/pagesPanel.rt",["react/addons","lodash","baseUI","rEditor/pagesMenu/subPages/subPages","rEditor/pagesMenu/pagesTree/pagesTree","rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsPanel","panels","symbols","util","rEditor/pagesMenu/pageTransitionsPanel/pageTransitionsUtils","rEditor/pagesMenu/pageNode/desktop/nodeContentDesktopMainMenu","pagesMenu"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(a,b,c,d,e,f,g,h){this.movePage(h,g)}function n(f,g,i,l,n,o){var p=this.state.pagesList;return a.createElement("div",{className:b.keys(b.pick({"pages-menu":!0,wixapps:g,"pages-panel-settings-opened":!!this.state.menuItemIdToShowSettingsFor},b.identity)).join(" ")},a.createElement("div",{className:b.keys(b.pick({"pages-tree-container":!0,"disable-drag":this.hasEditedPages()},b.identity)).join(" ")},p.length>0?a.createElement(c.treeDocker,{className:b.keys(b.pick({"pages-tree-docker":!0,"pages-tree-shrinked":p.totalVisible>17},b.identity)).join(" "),key:"pages-tree-docker",onNodeMoved:m.bind(this,f,g,i,l,n,o,p),treeClass:"pages-tree",",":!0,treeNodeClass:"pages-tree-node",treeNodeLabelClass:"pages-tree-item",draggedClass:"rotated",previewClass:"shadow",cantBeChildClass:"cant-be-child",isDragAvailable:!this.hasEditedPages(),scrollTopGetter:this.getTreeDockerScrollTop,collapsedClass:"tree-collapsed"},a.createElement(e,{ref:"pagesTree",nodeContent:k,pagesList:p,onNodeToggled:this.onPageToggled,actions:{openSettingsPanel:this.openSettingsPanel,openSubPagesMenu:this.openSubPagesMenu},onActionSelected:this.onActionSelected,editedPageIdLink:this.getEditedPageIdLink(),valueLink:this.linkPage()})):null,0===p.length?a.createElement("div",{key:"noPagesFoundSymbolContainer",className:"no-pages"},a.createElement(h.symbol,{name:"noPagesFound"}),a.createElement("div",{},o("Pages_Menu_Empty_Title")),a.createElement("div",{},o("Pages_Menu_Empty_Text"))):null),g?null:a.createElement("footer",{key:"pages-panel-footer"},a.createElement(c.tooltip,{value:this.getAddPageMenu(),alignment:"right",width:"296",marginsFromWindow:"75",openTriggers:[c.uiConstants.TOOLTIP.TRIGGERS.CLICK],closeTriggers:[c.uiConstants.TOOLTIP.TRIGGERS.OUTER_CLICK],onClose:this.onAddPageMenuClose,id:"addPageMenuPopoverId",className:"popover-add-page-menu"},a.createElement(c.button,{label:"Pages_Menu_Add_Button",icon:"addPage",onClick:this.reportAddClicked})),a.createElement("div",{className:"page-transition",onClick:this.togglePageTransitionsPanel},a.createElement("div",{className:"icon"},a.createElement(h.symbol,{name:"truck"})),a.createElement("div",{},a.createElement("span",{},o("Pages_Menu_Transitions_Caption")),a.createElement(c.button,{className:"btn-text",label:j.getTransitionLabelKey(f.pages.transitions.get())})))),g?a.createElement(d,{key:"subpages-menu",selectedMenuItem:this.state.selectedPageMenuItem,isSubPagesMenuOpenedByButton:this.state.isSubPagesMenuOpenedByButton,userPrefs:l,actions:{openSettingsPanel:this.openSettingsPanel,closeSettingsPanel:this.closeSettingsPanel,updateMenuItemIdToShowSettingsFor:this.updateMenuItemIdToShowSettingsFor,closeSubPagesMenu:this.closeSubPagesMenu}}):null)}function o(){var c=this.getEditorAPI(),d=this.getIsSubPagesMenuActive(),e=this.state.selectedPageMenuItem&&this.state.selectedPageMenuItem.pageData,h=this.getEditorAPI().getUserPreferences(),j=this.state.menuItemIdToShowSettingsFor&&this.getMenuItemToShowSettingsFor(),k=i.translate;return a.createElement(g.frames.pagesPanelFrame,{ref:"frame",className:b.keys(b.pick({"in-transition":this.state.isPageTransitionPanelOpened},b.identity)).join(" "),panelName:this.props.panelName,title:i.translate(this.getCurrentTitle()),helpId:"280e7ca3-cf44-452f-a2a6-6709aa42dcb6"},a.createElement("div",{className:"pages-panel-shadow"}),!d&&this.state.menuItemIdToShowSettingsFor&&j?a.createElement(l.settingsPanels.desktop.mainMenu,{key:"page-settings-panel",ref:"pageSettingsPanel",menuItem:j,helpId:"2f65df85-2eba-4b41-a9bf-2a841a5e5a53",closeSettingsPanel:this.closeSettingsPanel,actions:{duplicate:this.onActionSelected.bind(this,"duplicate")}}):null,d&&this.state.menuItemIdToShowSettingsFor&&j?a.createElement(l.settingsPanels.desktop.subpage,{key:"page-settings-panel-subpages",ref:"pageSettingsPanelSubpages",menuItem:j,closeSettingsPanel:this.closeSettingsPanel,actions:{openBlogManager:this.openBlogManager,openStoreManager:this.openStoreManager}}):null,this.state.isPageTransitionPanelOpened?a.createElement(f,{key:"page-transition-panel",userPrefs:h,biEvent:c.bi.event,onClose:this.closePageTransitionsPanel}):null,n.apply(this,[c,d,e,h,j,k]))}return function(){return o.apply(this,[])}}),define("rEditor/rootComps/panels/pagesPanelMixin",["react","lodash","core","blog","tpa","rEditor/utils/menuItemsRepository"],function(a,b,c,d,e,f){
"use strict";function g(a){return(a||[]).reduce(function(a,b){return b.isCollapsed||(a+=g(b.items)),a+1},0)}function h(a){a=a||this.props;var b=f.getDesktopMenuItems(this.getEditorAPI()),c=a.filter?f.filterItems(b,a.filter):b;return c.totalVisible=g(c),c}function i(){var a=f.getAllFlattenMenuItems(this.getEditorAPI());return a.totalVisible=g(a),a}function j(a,c,d){if(!a||0===a.length)return null;var e=null;return b.some(a,function(a){if(d(a,c))return e=a,!0;var b=j(a.items,c,d);return b?(e=b,!0):!1}),e}function k(){return this.getEditorAPI().viewMode.get()===this.getEditorAPI().viewMode.VIEW_MODES.MOBILE}function l(){var a=this.getParentItem(this.state.selectedPageMenuItem),b=a&&a.pageData;b&&b.id&&this.getEditorAPI().pages.navigateTo(b.id),this.setState({menuItemIdToShowSettingsFor:null,selectedPageMenuItem:a,isSubPagesMenuOpenedByButton:null})}return{mixins:[c.mixins.editorAPIMixin],propTypes:{filter:a.PropTypes.any,subpagesOpened:a.PropTypes.func},getInitialState:function(){var a=this.getEditorAPI().pages.getCurrentPageId(),b=h.call(this,this.props);return this._allPagesList=i.call(this),{currentPageId:a,pagesList:b,selectedPageMenuItem:this.findMenuItemByPageId(this._allPagesList,a),menuItemIdToShowSettingsFor:null}},componentWillReceiveProps:function(a){var b={currentPageId:this.getEditorAPI().pages.getCurrentPageId(),pagesList:h.call(this,a)},c=this.state.selectedPageMenuItem,d=c&&c.type&&c.type.isPage,e=d&&c.pageData.id;this._allPagesList=i.call(this),d&&e!==b.currentPageId&&(b.selectedPageMenuItem=this.findMenuItemByPageId(this._allPagesList,b.currentPageId)),this.props.filter!==a.filter&&this.getIsSubPagesMenuActive()&&l.call(this),this.setState(b)},onPageToggled:function(a,b){var c=a.props.dataSource.id;f.setMenuItemCollapsed(c,b);var d=h.call(this,this.props);this.setState({pagesList:d})},linkPage:function(){return{value:this.state.selectedPageMenuItem,requestChange:function(a){var b={selectedPageMenuItem:a};this.state.menuItemIdToShowSettingsFor&&(b.menuItemIdToShowSettingsFor=this.hasSettingsPanel(a)?a.id:null),this.setState(b),a&&a.pageData&&this.navigateToPageById(a.pageData.id)}.bind(this)}},closeSettingsPanel:function(a){this.setState({menuItemIdToShowSettingsFor:null}),this.getEditorAPI().bi.event(c.bi.events.topbar.pages.top_bar_PAGES_settings_close,{origin:a})},openSettingsPanel:function(a,b){this.setState({menuItemIdToShowSettingsFor:a},function(){b&&this.refs.pageSettingsPanel.setSettingsTab(b)}.bind(this))},closePanel:function(){this.props.onClose()},findMenuItemByMenuItemId:function(a,b){return j(a,b,function(a,b){return a.id===b})},findMenuItemByPageId:function(a,b){return j(a,b,function(a,b){return a.pageData&&a.pageData.id===b})},hasSettingsPanel:function(a){return k.call(this)||a.type.isPage},navigateToPageById:function(a){var b=this.getEditorAPI(),d=b.pages.getCurrentPageId();d!==a&&(b.pages.navigateTo(a),this.getEditorAPI().bi.event(c.bi.events.topbar.pages.top_bar_PAGES_navigate_to_page,{page_id:a}))},openSubPagesMenu:function(a){this.setState({isSubPagesMenuOpenedByButton:!0,selectedPageMenuItem:a},function(){this.closeSettingsPanel.call(this,"openSpecialPages"),this.props.subpagesOpened&&this.props.subpagesOpened()}.bind(this));var b=a.pageData.isTpaPage?"tpa":"blog";this.getEditorAPI().bi.event(c.bi.events.topbar.pages.top_bar_PAGES_special_pages_icon_click,{type:b})},getCurrentTitle:function(){var a=this.state.selectedPageMenuItem,b=a&&a.pageData;return b&&(b.isWixAppsSubPage||this.state.isSubPagesMenuOpenedByButton)?"blog"===b.pageType?"SiteApp_Blog_PagesPanel_Panel_PanelHeader":"wixStore"===b.pageType?"SiteApp_WixStores_PagesPanel_Panel_PanelHeader":void 0:"Pages_Menu_Title_Title"},closeSubPagesMenu:function(){l.call(this),this.getEditorAPI().bi.event(c.bi.events.topbar.pages.top_bar_PAGES_special_pages_back_click)},getIsSubPagesMenuActive:function(){var a=this.state.selectedPageMenuItem&&this.state.selectedPageMenuItem.pageData;return a&&(this.state.isSubPagesMenuOpenedByButton&&a.isWixAppsPage||a.isWixAppsSubPage)},updateMenuItemIdToShowSettingsFor:function(a){var b;this.state.menuItemIdToShowSettingsFor&&(b=this.getMenuItemToShowSettingsFor({pageId:a}),this.setState({menuItemIdToShowSettingsFor:b&&b.id}))},getMenuItemToShowSettingsFor:function(a){var b=this._allPagesList;return a?a.pageId?this.findMenuItemByPageId(b,a.pageId):a.menuItemId?this.findMenuItemByMenuItemId(b,a.menuItemId):void 0:this.findMenuItemByMenuItemId(b,this.state.menuItemIdToShowSettingsFor)},getParentItem:function(a){var b=this.getEditorAPI(),c=a&&a.pageData;return c.isBlogSubPage?f.getMenuBlogFeedItem(b):c.isTpaSubPage?f.getMenuTpaSectionItem(b,c.tpaApplicationId):c.isWixAppsSubPage?void 0:a},openBlogManager:function(){d.openBlogManagerFrame(this.getEditorAPI(),"allPosts")},openStoreManager:function(){e.superApps.openDashboardUrl(e.superApps.superAppsConstants.ECOM_APP_DEF_ID,"90%","100%"),this.getEditorAPI().bi.event(c.bi.events.topbar.pages.top_bar_PAGES_store_pages_store_manager_click)}}}),define("rEditor/rootComps/panels/pagesPanel",["react","core","lodash","baseUI","util","pagesMenu","panels","rEditor/utils/menuItemsRepository","rEditor/utils/newPagesData","rEditor/pagesMenu/addPageMenuPanel/addPageMenuPanel","rEditor/rootComps/panels/pagesPanel.rt","rEditor/rootComps/panels/pagesPanelMixin"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function q(a,b,c,d){var e=a.viewMode.get();e===a.viewMode.VIEW_MODES.DESKTOP&&m.setHidden(a,b,d),e===a.viewMode.VIEW_MODES.MOBILE&&m.setHidden(a,b,void 0,d)}function s(a,b,d){g.panelManager.openPanel("panels.toolPanels.linkPanel",{data:{pages:a.pages.getPagesData(),menuItems:a.mainMenu.getMenu(),anchors:a.getAnchors(),currentPageId:a.pages.getCurrentPageId()},visibleSections:{NoLink:!1},hidePageLinks:!0,link:d,pageTabTitle:"LINK_PANEL_TAB_ANCHOR",pageTabPageDropDownTitle:"LINK_PANEL_PAGE_DROP_DOWN_PAGELINK_LABEL",title:"What do you want to link to?",callback:c.once(b),createDefaultData:a.data.createItem},!0)}var m=f.pageMenuItemHelpers,n="Pages_Menu_Add_New_Page",o="Pages_Menu_Add_New_Link",p="Pages_Menu_Add_New_Category",r={settings:function(a,b){this.openSettingsPanel(b.id)},rename:function(a,b,c){m.rename(a,b,c)},duplicate:function(a,b){m.duplicate(a,b,function(a){var b=this.findMenuItemByMenuItemId(this.state.pagesList,a);this.renameMenuItemById(a),this.setState({selectedPageMenuItem:b})}.bind(this))},unhide:c.partialRight(q,!1),hide:c.partialRight(q,!0),subpage:m.subpage,moveup:m.moveUp,remove:function(a,b){m.remove(a,b)},changeLink:function(a,b){var d=function(d){var e=a.data.createItem(d.type);c.assign(e,c.omit(d,["type"])),m.updateLink(a,b.id,e)};s(a,d,a.data.getById(b.id).link)}};return a.createClass({displayName:"pagesPanel",mixins:[a.addons.LinkedStateMixin,l],propTypes:{pageAdded:a.PropTypes.func,filter:a.PropTypes.any},biData:{page:{category:"page"},link:{category:"link"},dropdown:{category:"dropdown menu"}},getInitialState:function(){return{isPageTransitionPanelOpened:!1,editedMenuItemId:null,isSubPagesMenuOpenedByButton:null}},movePage:function(a,c){var d={items:c},e=a.from.findIn(d,"items"),f=e.id,g=a.to.parent().findIn(d,"items").id||null,i=a.to.findIn(d,"items"),j=i?i.position:a.to.atRight(),k=this.getEditorAPI();f&&(g&&h.setMenuItemCollapsed(g,!1),k.mainMenu.moveItem(f,g,j),k.history.add("moving a page"),k.waitForChangesApplied(function(a){g&&this.refs.pagesTree.scrollToSelectedNode(),this.refs.pagesTree.props.valueLink.requestChange(a)}.bind(this,e)),k.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_menu_drag),g&&1===a.from.length()?k.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_menu_sub_page_created,{category:"drag"}):!g&&a.from.length()>1&&k.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_menu_user_reverted_to_main_page,{category:"drag"}))},getTreeDockerScrollTop:function(){return this.refs.pagesTree.getScrollTop()},togglePageTransitionsPanel:function(){this.setState({isPageTransitionPanelOpened:!this.state.isPageTransitionPanelOpened}),this.getEditorAPI().bi.event(b.bi.events.topbar.pages.top_bar_PAGES_page_transition_click)},onActionSelected:function(a,c,d){switch(a){case"tabPageInfo":this.openSettingsPanel(c.id,"page");break;case"tabLayout":this.openSettingsPanel(c.id,"layout");break;case"tabPermissions":this.openSettingsPanel(c.id,"privacy");break;case"tabSEO":this.openSettingsPanel(c.id,"seo")}r[a]&&r[a].call(this,this.getEditorAPI(),c,d),this.getEditorAPI().bi.event(b.bi.events.topbar.pages.top_bar_PAGES_quick_actions_menu_select_click,{category:a})},closePageTransitionsPanel:function(){this.setState({isPageTransitionPanelOpened:!1})},_onAddPageMenuCloseHandler:c.noop,onAddPageMenuClose:function(){this._onAddPageMenuCloseHandler(this.props.pageAdded||c.noop),this._onAddPageMenuCloseHandler=c.noop},addPage:function(a){var c=this.getEditorAPI(),d=i.createBlankPageData(c);m.addPage(c,e.translate(n),d,this.state.selectedPageMenuItem.id,function(b){var c=this.findMenuItemByPageId(this._allPagesList,b);this.setState({editedMenuItemId:c.id,menuItemIdToShowSettingsFor:null},a)}.bind(this)),c.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_Add_pages_expand_menu_selection_click,this.biData.page)},addLink:function(a){var d=this.getEditorAPI(),f=function(b){var f=d.data.createItem(b.type);c.assign(f,c.omit(b,["type"])),m.addLink(d,f,e.translate(o),this.state.selectedPageMenuItem.id,function(b){var c=this.findMenuItemByMenuItemId(this._allPagesList,b);this.setState({editedMenuItemId:b,selectedPageMenuItem:c,menuItemIdToShowSettingsFor:null},a)}.bind(this))}.bind(this);s(d,f),d.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_Add_pages_expand_menu_selection_click,this.biData.link)},addDropdown:function(a){var c=this.getEditorAPI();m.addDropdown(c,e.translate(p),this.state.selectedPageMenuItem.id,function(b){var c=this.findMenuItemByMenuItemId(this._allPagesList,b);this.setState({editedMenuItemId:b,selectedPageMenuItem:c,menuItemIdToShowSettingsFor:null},a)}.bind(this)),c.bi.event(b.bi.events.topbar.pages.top_bar_PAGES_Add_pages_expand_menu_selection_click,this.biData.dropdown)},_setAddPageHandlerAndHideTooltip:function(){this._onAddPageMenuCloseHandler=this.addPage,d.tooltipManager.hide("addPageMenuPopoverId",!0)},_setAddLinkHandlerAndHideTooltip:function(){this._onAddPageMenuCloseHandler=this.addLink,d.tooltipManager.hide("addPageMenuPopoverId",!0)},_setAddDropdownHandlerAndHideTooltip:function(){this._onAddPageMenuCloseHandler=this.addDropdown,d.tooltipManager.hide("addPageMenuPopoverId",!0)},getAddPageMenu:function(){return a.createElement(j,{addPage:this._setAddPageHandlerAndHideTooltip,addLink:this._setAddLinkHandlerAndHideTooltip,addDropdown:this._setAddDropdownHandlerAndHideTooltip})},getEditedPageIdLink:function(){return{value:this.state.editedMenuItemId,requestChange:function(a){a!==this.state.editedMenuItemId&&this.setState({editedMenuItemId:a})}.bind(this)}},hasEditedPages:function(){return Boolean(this.state.editedMenuItemId)},renameMenuItemById:function(a){this.setState({editedMenuItemId:a,menuItemIdToShowSettingsFor:null})},reportAddClicked:function(){this.getEditorAPI().bi.event(b.bi.events.topbar.pages.top_bar_PAGES_Add_pages_click)},render:k})}),define("rEditor/pagesMenu/pageNode/pageNode.rt",["react/addons","lodash","pagesMenu","baseUI","core","symbols","util","rEditor/pagesMenu/pageNode/pageInfoTextHelper","experiment!pageSettingsTabs"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a,b,c,d,e,f,g,h,i,j,k,l){this.props.onActionSelected("rename",c,l),this.props.editedPageIdLink.requestChange(null)}function k(a,b,c,d,e,f,g,h,i,j,k){this.props.actions.openSettingsPanel(c.id)}function l(a,b,c,d,e,f,g,h,i,j,k,l){this.props.quickActionsSelect(l,c)}function m(a,b,c,d,e,f,g,h,i,j,k){this.props.actions.openSubPagesMenu(c)}function n(a,b,c,d,e,f,g,h,i,j,k){this.props.actions.openSettingsPanel(c.id)}function o(a,b,c,d,e,f,g,h,i,j,k){this.props.actions.openSubPagesMenu(c)}function p(e,g,p,q,r,s,t,u,v){var w=h.getInfoTextByDataType(p.type)||h.getInfoTextByPageData(r),x=r.isWixAppsPage&&!r.isWixAppsSubPage&&(r.isBlogFeedPage||r.isTpaSectionPage);return a.createElement(c.pageItem,b.assign({},{ref:"pageItem",value:p.label,onChange:j.bind(this,e,g,p,q,r,s,t,u,v,w,x),onClick:this.setSelected},{label:p.label,isVisible:r.isWixAppsSubPage||p.isVisible,isMobileVisible:r.isWixAppsSubPage||p.isVisibleMobile,isSelected:this.isSelected(),isHome:r.isHome,isPage:p.type.isPage,isLink:p.type.isLink,isDropdown:p.type.isDropdown,isMobile:v,depth:this.props.nodePath.length-1,quickActionButtons:u?r.isWixAppsSubPage?1:x||!p.type.isPage?2:1:1,editModeLink:{value:this.props.editedPageIdLink&&this.props.editedPageIdLink.value===p.id,requestChange:function(a){this.props.editedPageIdLink.requestChange(a?p.id:null)}.bind(this)}}),u?a.createElement("div",{key:"action-buttons-desktop"},r.isWixAppsSubPage?a.createElement("a",{href:"#",key:"action-button-settings",className:"action-button action-settings",onClick:k.bind(this,e,g,p,q,r,s,t,u,v,w,x)},a.createElement(d.infoIcon,{symbolName:"quickActionsSettings",text:"Pages_Blog_Tooltip_Settings",propagate:!0})):null,p.type&&!r.isWixAppsSubPage?a.createElement(d.dropDown.contextMenu,{key:"quick-actions",shouldTranslate:!1,icon:"moreRegular",className:"quick-actions action-button",onChange:l.bind(this,e,g,p,q,r,s,t,u,v,w,x)},i&&p.type.isPage?a.createElement(d.dropDown.option,{key:"quick-action-tab-page-info",value:"tabPageInfo",className:"primary pages-menu-quick-action"},a.createElement(f.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),"\n                    ",q("Pages_Actions_Page_Info"),"\n                "):null,i&&p.type.isPage?a.createElement(d.dropDown.option,{key:"quick-action-tab-layout",value:"tabLayout",className:"primary pages-menu-quick-action"},a.createElement(f.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),"\n                    ",q("Pages_Actions_Page_Layouts"),"\n                "):null,i&&p.type.isPage?a.createElement(d.dropDown.option,{key:"quick-action-tab-permissions",value:"tabPermissions",className:"primary pages-menu-quick-action"},a.createElement(f.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),"\n                    ",q("Pages_Actions_Page_Permissions"),"\n                "):null,i&&p.type.isPage?a.createElement(d.dropDown.option,{key:"quick-action-tab-seo",value:"tabSEO",className:"primary pages-menu-quick-action"},a.createElement(f.symbol,{name:"quickActionsLinkArrow",style:{position:"relative",margin:"0 7px 0 5px"}}),"\n                    ",q("Pages_Actions_Page_SEO"),"\n                "):null,i&&p.type.isPage?a.createElement(d.dropDown.option,{key:"quick-action-separator",className:"separator"},a.createElement("hr",{className:"divider-long"})):null,!i&&p.type.isPage?a.createElement(d.dropDown.option,{key:"quick-action-settings-mobile",value:"settings",className:"primary pages-menu-quick-action"},a.createElement(f.symbol,{name:"quickActionsSettings",style:{position:"relative",top:"4px",left:"-1px"}}),"\n                    ",q("Pages_Actions_Page_Settings"),"\n                "):null,p.type.isLink?a.createElement(d.dropDown.option,{key:"quick-actions-rename-link",value:"changeLink",className:"pages-menu-quick-action"},a.createElement(f.symbol,{name:"quickActionsLink"}),"\n                    ",q("Pages_Actions_Link_Change"),"\n                "):null,a.createElement(d.dropDown.option,{value:"rename",className:"pages-menu-quick-action"},a.createElement(f.symbol,{name:"quickActionsRename"}),"\n                    ",q("Pages_Actions_Page_Rename"),"\n                "),s.canDuplicate(t,p)?a.createElement(d.dropDown.option,{key:"quick-actions-duplicate",value:"duplicate",className:"pages-menu-quick-action"},a.createElement(f.symbol,{name:"qaDuplicate"}),"\n                    ",q("Pages_Actions_Page_Duplicate"),"\n                "):null,s.canUnhide(t,p)?a.createElement(d.dropDown.option,{key:"quick-actions-unhide",value:"unhide",className:"pages-menu-quick-action"},a.createElement(f.symbol,{name:"quickActionsShow"}),"\n                    ",q("Pages_Actions_Page_Unhide"),"\n                "):null,s.canHide(t,p)?a.createElement(d.dropDown.option,{key:"quick-actions-hide",value:"hide",className:"pages-menu-quick-action"},a.createElement(f.symbol,{name:"quickActionsHide"}),"\n                    ",q("Pages_Actions_Page_Hide"),"\n                "):null,s.canSubpage(p)?a.createElement(d.dropDown.option,{key:"quick-actions-subpage",value:"subpage",className:"pages-menu-quick-action"},a.createElement(f.symbol,{name:"quickActionsSubpage"}),"\n                    ",q("Pages_Actions_Page_Subpage"),"\n                "):null,s.canMoveUp(p)?a.createElement(d.dropDown.option,{key:"quick-actions-moveup",value:"moveup",className:"pages-menu-quick-action"},a.createElement(f.symbol,{name:"quickActionsMainPage"}),"\n                    ",q("Pages_Actions_Page_MoveUp"),"\n                "):null,s.canRemove(t,p)?a.createElement(d.dropDown.option,{key:"quick-actions-remove",value:"remove",className:"pages-menu-quick-action"},a.createElement(f.symbol,{name:"qaDelete"}),"\n                    ",q("Pages_Actions_Page_Delete"),"\n                "):null):null,!p.type.isPage||r.isWixAppsSubPage?a.createElement("a",{href:"#",key:"action-button-info-subpage",className:"action-button"},a.createElement(d.infoIcon,{symbolName:"actionButtonInfo",text:w})):null,x?a.createElement("a",{href:"#",key:"action-button-special-pages",className:"action-button",onClick:m.bind(this,e,g,p,q,r,s,t,u,v,w,x)},a.createElement(d.infoIcon,{symbolName:"actionButtonSpecialPages",propagate:!0,text:w})):null):null,v?a.createElement("div",{key:"action-buttons-mobile"},a.createElement("a",{href:"javascript://settings",className:"action-button action-settings",onClick:n.bind(this,e,g,p,q,r,s,t,u,v,w,x)},a.createElement(f.symbol,{name:"quickActionsSettings"})),!p.type.isPage||r.isWixAppsSubPage?a.createElement("a",{href:"#",key:"action-button-info-subpage",className:"action-button"},a.createElement(d.infoIcon,{symbolName:"actionButtonInfo",text:w})):null,x?a.createElement("a",{key:"action-button-",className:"action-button action-button-special-pages-mobile",onClick:o.bind(this,e,g,p,q,r,s,t,u,v,w,x)},r.isTpaPage?a.createElement(d.infoIcon,{key:"action-button-special-pages-tpa-mobile",symbolName:"actionButtonSpecialPages",propagate:!0,text:w}):null,r.isBlogPage?a.createElement(d.infoIcon,{key:"action-button-special-pages-blog-mobile",symbolName:"actionButtonBlogPages",propagate:!0,text:w}):null):null):null)}function q(){var d=this.getTreeViewClass(),e=this.hasChildren(),h=this.props.dataSource,i=g.translate,j=this.props.dataSource.pageData||{},k=c.pageMenuItemHelpers,l=this.props.editorAPI,m=this.props.editorAPI.viewMode.get()===this.props.editorAPI.viewMode.VIEW_MODES.DESKTOP,n=this.props.editorAPI.viewMode.get()===this.props.editorAPI.viewMode.VIEW_MODES.MOBILE;return a.createElement("li",{className:b.keys(b.pick({"tree-collapsed":this.state.collapsed,"has-children":this.hasChildren(),"pages-tree-node":!0},b.identity)).join(" ")},a.createElement("span",{className:"expander",onClick:this.toggleCollapsed},e&&this.state.collapsed?a.createElement(f.symbol,{key:"expand",name:"expand"}):null,this.state.collapsed?null:a.createElement(f.symbol,{key:"collapse",name:"collapse"})),p.apply(this,[d,e,h,i,j,k,l,m,n]),a.createElement(d,this.passNodeProps()))}return function(){return q.apply(this,[])}}),define("rEditor/pagesMenu/pageNode/mobile/nodeContentMobileMainMenu",["react","rEditor/pagesMenu/pageNodeRenderers"],function(a,b){"use strict";return a.createClass({displayName:"nodeContentMobileMainMenu",render:function(){return b.mobile.mainMenu(this.props.dataSource).call(this)}})}),define("rEditor/rootComps/panels/pagesPanelMobile.rt",["react/addons","lodash","baseUI","pagesMenu","panels","core","symbols","util","rEditor/pagesMenu/pagesTree/pagesTree","rEditor/pagesMenu/subPages/subPages","rEditor/pagesMenu/pageNode/pageNode.rt","rEditor/pagesMenu/pageNode/mobile/nodeContentMobileMainMenu"],function(a,b,c,d,e,f,g,h,i,j,k,l){"use strict";function m(){var m=(this.state.selectedPageMenuItem,this.state.isSubPagesMenuOpenedByButton),o=(this.state.selectedPageMenuItem&&this.state.selectedPageMenuItem.pageData,this.state.pagesList),p=this.state.menuItemIdToShowSettingsFor&&this.getMenuItemToShowSettingsFor();return a.createElement(e.frames.pagesPanelFrame,{className:b.keys(b.pick({"pages-panel-frame":!0,"pages-panel-mobile":!0,"pages-panel-settings-opened":!!this.state.menuItemIdToShowSettingsFor},b.identity)).join(" "),panelName:this.props.panelName,title:h.translate("Pages_Mobile_Menu_Title"),helpId:"24b83680-5690-488d-b382-ac051e329c23"},a.createElement("div",{className:"pages-panel-shadow"}),!m&&this.state.menuItemIdToShowSettingsFor&&p?a.createElement(d.settingsPanels.mobile.mainMenu,{key:"page-settings-panel",menuItem:p,closeSettingsPanel:this.closeSettingsPanel}):null,m&&this.state.menuItemIdToShowSettingsFor&&p?a.createElement(d.settingsPanels.mobile.subpage,{key:"page-settings-panel-mobile",menuItem:p,closeSettingsPanel:this.closeSettingsPanel,actions:{openBlogManager:this.openBlogManager,openStoreManager:this.openStoreManager}}):null,a.createElement("div",{className:b.keys(b.pick({"pages-menu":!0,wixapps:m},b.identity)).join(" ")},a.createElement("div",{className:b.keys(b.pick({"pages-tree-container":!0,"pages-tree-shrinked":o.totalVisible>17},b.identity)).join(" ")},a.createElement(c.firstTimeInfoBox,{context:"pages-panel",id:"pages-menu-mobile-view",icon:"pagesMobileFirstTime",title:"MobilePages_teaser_title",text:"MobilePages_teaser_text",hide:!1,userPrefs:this.getEditorAPI().getUserPreferences(),biLearnMore:this.getEditorAPI().bi.event.bind(null,f.bi.events.commonControls.FIRST_TIME_INFO_BOX.LEARN_MORE),biClose:this.getEditorAPI().bi.event.bind(null,f.bi.events.commonControls.FIRST_TIME_INFO_BOX.CLOSE)}),a.createElement(i,{nodeContent:l,pagesList:o,onNodeToggled:this.onPageToggled,actions:{openSettingsPanel:this.openSettingsPanel,openSubPagesMenu:this.openSubPagesMenu},valueLink:this.linkPage()}),0===o.length?a.createElement("div",{key:"noPagesFoundSymbolContainer",className:"no-pages"},a.createElement(g.symbol,{name:"noPagesFound"}),a.createElement("div",{},h.translate("Pages_Menu_Empty_Title")),a.createElement("div",{},h.translate("Pages_Menu_Empty_Text"))):null),m?a.createElement(j,{key:"subpages-menu",selectedMenuItem:this.state.selectedPageMenuItem,isSubPagesMenuOpenedByButton:this.state.isSubPagesMenuOpenedByButton,userPrefs:this.getEditorAPI().getUserPreferences(),actions:{openSettingsPanel:this.openSettingsPanel,closeSettingsPanel:this.closeSettingsPanel,updateMenuItemIdToShowSettingsFor:this.updateMenuItemIdToShowSettingsFor,closeSubPagesMenu:this.closeSubPagesMenu}}):null))}return function(){return m.apply(this,[])}}),define("rEditor/rootComps/panels/pagesPanelMobile",["react","core","lodash","rEditor/utils/menuItemsRepository","rEditor/rootComps/panels/pagesPanelMobile.rt","rEditor/rootComps/panels/pagesPanelMixin"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"pagesPanelMobile",mixins:[a.addons.LinkedStateMixin,f],getInitialState:function(){return{isSubPagesMenuOpenedByButton:null}},render:e})}),define("rEditor/rootComps/panels/myMediaPanel.rt",["react/addons","lodash","baseUI","util","core","panels"],function(a,b,c,d,e,f){"use strict";function g(a){a.preventDefault()}function h(a,b,c){this.openMediaManager(a.type)}function i(b,e){return a.createElement("li",{className:"panel-button",onClick:h.bind(this,b,e)},a.createElement("div",{className:"panel-button-inner"},a.createElement("span",{className:"label"},a.createElement("i",{style:{backgroundImage:"url("+this.getIcon(b.type)+")"}}),a.createElement("span",{},d.translate(b.name))),a.createElement("div",{className:"action"},a.createElement(c.symbol,{name:"arrowWithStates"}))))}return function(){return a.createElement(f.frames.leftPanelFrame,{ref:"mediaPanel",className:"panel-background",panelName:this.props.panelName,panelClass:"my-uploads-panel",panelIndex:this.props.panelIndex,label:d.translate("MY_UPLOADS_PANEL_HEADER_TITLE"),helpId:"e1df1248-6bd6-4497-ad2a-2a42cd357eae",onContextMenu:g.bind(this)},a.createElement(c.firstTimeInfoBox,{id:"my-uploads-panel",title:"MY_UPLOADS_PANEL_FIRST_TIME_HELP_TITLE",text:"MY_UPLOADS_PANEL_FIRST_TIME_HELP_TEXT",userPrefs:this.getUserPref(),hide:!1,biLearnMore:this.getEditorAPI().bi.event.bind(null,e.bi.events.commonControls.FIRST_TIME_INFO_BOX.LEARN_MORE),biClose:this.getEditorAPI().bi.event.bind(null,e.bi.events.commonControls.FIRST_TIME_INFO_BOX.CLOSE)}),a.createElement.apply(this,["ul",{},b.map(this.getSections(),i.bind(this))]))}}),define("rEditor/rootComps/panels/myMediaPanelAddCompData",[],function(){"use strict";function b(a){var b=Math.min(600,a.width);return{componentType:"wysiwyg.viewer.components.WPhoto",layout:{width:b,height:Math.floor(b*a.height/a.width)},data:{width:a.width,height:a.height,alt:"",uri:a.uri,title:a.title,type:"Image",description:""}}}function c(b){var c=b.uri.split(".").pop();return{componentType:"wysiwyg.viewer.components.documentmedia.DocumentMedia",layout:{width:90,height:140},data:{title:b.title,uri:a[c]||a.other,description:"",width:105,height:141,type:"Image",link:{docId:b.uri,name:b.title,type:"DocumentLink"}},style:"dm1",props:{type:"DocumentMediaProperties",showTitle:!1}}}function d(a){return{componentType:"wysiwyg.common.components.singleaudioplayer.viewer.SingleAudioPlayer",layout:{width:304,height:60},data:{originalFileName:a.title,uri:a.uri,type:"SingleAudioPlayer"},props:{autoplay:!1,loop:!1,showArtist:!0,showTrack:!0,volume:50,type:"SingleAudioPlayerProperties"},style:"SingleAudioPlayer_1"}}var a={pdf:"40d80b8089c8418a961cb75d96d491f7.png",doc:"b8964aa7650d463fac3b77e0d00e8f12.png",docx:"b8964aa7650d463fac3b77e0d00e8f12.png",ppt:"a41192b40f324972a1d919a8350965f8.png",ppx:"a41192b40f324972a1d919a8350965f8.png",xls:"757aeccaa7f4409b93913c55e36a194d.png",xlsx:"757aeccaa7f4409b93913c55e36a194d.png",odp:"ac1fbe0592434c58889947de5714b3c7.png",odt:"ac1fbe0592434c58889947de5714b3c7.png",other:"046956f7d55f4143a30b3b54669ee243.png"};return{picture:b,document:c,music:d}}),define("rEditor/rootComps/panels/myMediaPanel",["react","lodash","core","util","tpa","rEditor/rootComps/panels/myMediaPanel.rt","rEditor/rootComps/panels/myMediaPanelAddCompData"],function(a,b,c,d,e,f,g){"use strict";function h(a){return b.findKey(g,function(b){return b.structure&&b.structure.componentType===a})}function i(a){var b=g[a.mediaType];return b?b(a):void console.error("Unsupported media type",a.mediaType)}return a.createClass({displayName:"MyMediaPanel",mixins:[c.mixins.editorAPIMixin],closePanel:function(){this.refs.mediaPanel.close()},iconMap:{DOCUMENT:d.media.getMediaUrl("rEditor/myMediaPanel/document.png"),IMAGE:d.media.getMediaUrl("rEditor/myMediaPanel/image.png"),MUSIC:d.media.getMediaUrl("rEditor/myMediaPanel/music.png"),MUSIC_PRO:d.media.getMediaUrl("rEditor/myMediaPanel/music_pro.png")},titleMap:{IMAGE:"MMGR_API_IMAGE_MANAGE_TITLE",MUSIC:"MMGR_API_MUSIC_MANAGE_TITLE",DOCUMENT:"MMGR_API_DOCUMENT_MANAGE_TITLE"},getSections:function(){var a=this.getEditorAPI().mediaServices.mediaManager.categories,b=[{name:"MY_UPLOADS_MY_IMAGES_LINK_LABEL",type:a.IMAGE},{name:"MY_UPLOADS_MY_MUSIC_LINK_LABEL",type:a.MUSIC},{name:"MY_UPLOADS_MY_DOCUMENT_LINK_LABEL",type:a.DOCUMENT}];return b},getIcon:function(a){return this.iconMap[a]},openMediaManager:function(a){var b=this.getEditorAPI(),e=b.mediaServices.mediaManager;b.bi.event(c.bi.events.myMediaPanel.my_uploads_panel_section_click,{section:a}),e.open(a,{multiSelect:!0,callback:this.onItemsSelected,translation:{title:d.translate(this.titleMap[a])}})},onItemsSelected:function(a){if(a){var c=this.getEditorAPI();c.pasteLogic.addContext.resetPastePosition(),b.forEach(a,this.addComponent)}},addComponent:function(a,d,e){var f=this.getEditorAPI(),g=i(a),j=f.pages.getCurrentPageId(),k=f.pasteLogic.addContext.getPastePosition(f,g.layout,j);b.merge(g.layout,k);var l=f.pages.getReference(j);f.waitForChangesApplied(function(){f.components.add(l,g,void 0,function(a){d===e.length-1&&(f.selection.selectComponentByCompRef(a),f.history.add("added component")),f.bi.event(c.bi.events.addPanel.COMPONENT_ADDED_TO_STAGE,{origin:"my_uploads",category:h(g.componentType),component_type:g.componentType,component_id:a.id,adding_method:"click"})})})},getUserPref:function(){return this.getEditorAPI().getUserPreferences()},render:f})}),define("rEditor/rootComps/panels/backgroundPanel/bgPanelBiEvents",[],function(){"use strict";function a(a,b,c,d){if(d.origin){var f,g,h,i,e=a.pages.getCurrentPageId(),j=c.ref.mediaRef;i="bg_presets"===d.origin?d.presetIndex:null,j&&(f=j.uri||j.videoId||"","undefined"!=typeof j.loop&&(g=(!!j.loop).toString())),(a.isMobileEditor()||!a.pages.background.get(e,"mobile").isPreset)&&(h=!0),a.bi.event(b,{origin:d.origin,bg_media_type:c.ref.mediaRef&&c.ref.mediaRef.type.toLowerCase()||"Color",bg_mobile_detached:(!!h).toString(),bg_media_name:f,bg_page_id:e,bg_preset_index:i,bg_vendor_name:c.ref.mediaRef&&c.ref.mediaRef.artist&&c.ref.mediaRef.artist.name,bg_vendor_media_id:c.ref.mediaRef&&c.ref.mediaRef.artist&&c.ref.mediaRef.artist.id,bg_color:c.ref.color,bg_fitting:c.ref.fittingType,bg_positioning:c.ref.alignType,bg_image_opacity:c.ref.mediaRef&&c.ref.mediaRef.opacity&&Math.floor(100*c.ref.mediaRef.opacity),bg_scroll_with_site:c.ref.scrollType,bg_overlay_color:c.ref.colorOverlay,bg_overlay_color_opacity:c.ref.colorOverlayOpacity&&Math.floor(100*c.ref.colorOverlayOpacity),bg_video_overlay_pattern:c.ref.mediaRef&&c.ref.mediaRef.posterImageRef&&c.ref.mediaRef.posterImageRef.uri,bg_video_loop:g,bg_slideshow_transition_type:"",bg_slideshow_transition_duration:-1,bg_slideshow_transition_direction:"",bg_slideshow_pausebetweenimages:-1})}}function b(a,b){a.bi.event(b)}function c(a,b,c){a.bi.event(b,c)}function d(a,b){a.bi.error(b)}return{changedBackgroundBiEvent:a,applyToOtherClick:b,applyToOtherClosed:c,mobileDataDuplicationError:d}}),define("rEditor/rootComps/panels/backgroundPanel/backgroundPanel.rt",["react/addons","lodash","baseUI","util","panels","uiAnimations","backgroundPresets","experiment!BGPPVideoUpload"],function(a,b,c,d,e,f,g,h){"use strict";function i(a,b,c,d,e){e.preventDefault()}function j(a,b,c,d,e,f){f.preventDefault()}function k(a,b,c,d,e,f){this.replaceColor(f,a)}function l(a,b,c,d,e,f){this.changeColor(f,a)}function m(a,b,c,d,e){this.changeMedia(this.mediaTypes.IMAGE)}function n(a,b,c,d,e){c||this.changeMedia(this.mediaTypes.VIDEO)}function o(b,d,e,g){var i=this.getMediaType(b.ref);return a.createElement("div",{className:"bg-panel-top"},a.createElement("div",{className:"bg-panel-preview",onContextMenu:j.bind(this,b,d,e,g,i)},a.createElement("div",{className:"bg-panel-preview-media",style:this.getCurrentColor(b)}),a.createElement("div",{ref:"previewMedia",className:"bg-panel-preview-media",style:this.getCurrentMedia(b)}),a.createElement("div",{className:"bg-panel-preview-overlay",style:g.getOverlayStyle(b.ref,this.getEditorAPI())}),a.createElement("div",{className:"bg-panel-preview-buttons"},i!==this.mediaTypes.COLOR?a.createElement(c.tooltip,{disabled:!!this.getCurrentSubPanel(),value:this.getSettingTranslation(i),alignment:"top",className:"control-tooltip-small",key:"settings-tooltip"},a.createElement("div",{className:"bg-panel-preview-button"},a.createElement(f.rotatePartAnimation,{selector:".gear-wheel",play:this.isSettingsPanelOpen()},a.createElement(c.toggle,{name:"settings-icon",label:this.getSettingsButtonTranslation(i),valueLink:this.toggleSubPanel(i),labelAfterSymbol:!0})))):null,h&&i===this.mediaTypes.VIDEO?a.createElement(c.tooltip,{key:"video-controls",id:"video-play-tooltip",disabled:this.isPlayBtnTooltipDisabled(i),alignment:"top",className:"control-tooltip-small",value:this.getPlayBtnTranslation()},a.createElement("div",{className:"bg-panel-preview-button"},a.createElement(c.toggle,{name:"play-video",disabled:this.getVideoReadyState()===this.videoReadyStates.IN_PROCESS,
valueLink:this.toggleVideoPlayback(this.isVideoPlaying())}),this.getVideoReadyState()===this.videoReadyStates.IN_PROCESS?a.createElement(c.preloader,{key:"play-spinner"}):null)):null,h||i!==this.mediaTypes.VIDEO?null:a.createElement("div",{className:"bg-panel-preview-button",key:"video-controls"},a.createElement(c.toggle,{name:"play-video",valueLink:this.toggleVideoPlayback(this.isVideoPlaying())}))),i===this.mediaTypes.IMAGE?a.createElement("div",{onClick:k.bind(this,b,d,e,g,i),className:"bg-panel-preview-color",style:this.getCurrentColor(b),key:"bg-fold"},a.createElement(c.symbol,{name:"fold-clipart"})):null),a.createElement("div",{className:"bg-panel-top-actions"},a.createElement("div",{className:"bg-panel-action"},a.createElement(c.button2,{className:"default bg-panel-action-btn",label:"BGPP_PANEL_COLOR_BUTTON",symbolName:"color-btn",onClick:l.bind(this,b,d,e,g,i)})),a.createElement("div",{className:"bg-panel-action"},a.createElement(c.button2,{onClick:m.bind(this,b,d,e,g,i),className:"default bg-panel-action-btn",symbolName:"image-btn",label:"BGPP_PANEL_IMAGE_BUTTON"})),a.createElement(c.tooltip,{disabled:!e,value:"BGPP_PANEL_VIDEO_BUTTON_MOBILE_TOOLTIP",alignment:"top",className:"control-tooltip-small"},a.createElement("div",{className:"bg-panel-action"},a.createElement(c.button2,{onClick:n.bind(this,b,d,e,g,i),disabled:e,className:"default bg-panel-action-btn",symbolName:"video-btn",label:"BGPP_PANEL_VIDEO_BUTTON"})))))}function p(a,b,c,d){this.handleApplyToOtherClick()}function q(){var b=this.getData(),f=this.getCurrentSubPanel(),h=this.getEditorAPI().isMobileEditor(),j=d.backgroundPanelUtils;return a.createElement(e.frames.leftPanelFrame,{ref:"backgroundPanel",className:"bg-panel",panelName:this.props.panelName,label:this.getTranslation("TITLE"),panelIndex:this.props.panelIndex,panelClass:"bg-panel",helpId:h?"f0d8190e-e2da-48be-9f44-7ecff4518a82":"f11a3bb9-cff0-46d4-92ff-cc8cd9d30468",onContextMenu:i.bind(this,b,f,h,j)},o.apply(this,[b,f,h,j]),a.createElement(c.customScroll,{addScrolledClass:!0},a.createElement("div",{className:"bg-panel-preset-list"},a.createElement("div",{className:"bg-panel-preset-list-sections sections","data-tooltip-bounds":"true"},a.createElement(g.presetSection,this.getPresetsProps())))),a.createElement("div",{className:"bg-panel-bottom"},a.createElement(c.button2,{label:"BGPP_PANEL_APPLY_TO_OTHER_BUTTON",onClick:p.bind(this,b,f,h,j),disabled:this.isOnePager(),className:"default"})))}return function(){return q.apply(this,[])}}),define("rEditor/rootComps/panels/backgroundPanel/backgroundPanel",["react","lodash","core","panels","baseUI","util","color","panelUtils","backgroundPresets","rEditor/rootComps/panels/backgroundPanel/bgPanelBiEvents","rEditor/rootComps/panels/backgroundPanel/backgroundPanel.rt"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function y(a,b,c){c||(c=a.pages.getCurrentPageId()),b||(b=a.isMobileEditor()?"mobile":"desktop");var d=a.pages.background.get(c,b);return d}function z(a){a.ref.colorOverlay="",a.ref.colorOverlayOpacity=0,a.ref.imageOverlay=null}function A(a,c,d,e){var f;b.assign(d.ref,b.omit(c.ref,["id","mediaRef","metaData"])),z(d),d.ref.scrollType="scroll",c.ref.mediaRef?(f="WixVideo"===c.ref.mediaRef.type?c.ref.mediaRef.posterImageRef:c.ref.mediaRef,d.ref.mediaRef=b.omit(f,"id")):d.ref.mediaRef=null,a.pages.background.update(e,d,"mobile")}function B(a,c){var d=a[0],e=b.first(d.fileOutput.image),f=b.groupBy(d.fileOutput.video,"quality"),g=b.pick(e,["width","height","url"]);g.type="Image",g.uri=g.url.replace(/^(.*[\/])/,""),delete g.url,g.description=c.path;var h={type:"WixVideo",title:d.title,videoId:d.fileBaseUrl,duration:Math.round(d.fileInput.duration/1e3),posterImageRef:g,opacity:1,autoplay:!0,loop:!0,preload:"auto",mute:!0,artist:{name:d.vendor||"",id:d.reference||""}};return h.qualities=b.map(f,function(a){var c=b.pluck(a,"format"),d=b.pick(a[0],["width","height","quality"]);return d.formats=c,d}),h}function C(a,b){var c=a[0];return{type:"Image",uri:c.fileName,title:c.title,description:b.path,width:c.width,height:c.height,artist:{name:c.vendor||"",id:c.reference||""}}}function D(a,d,e){a===s.APPLY?j.applyToOtherClick(d,c.bi.events.backgroundPanel.panel_apply_to_other_pages_click):e.origin="bg_"+b.invert(s)[a].toLowerCase()}function E(a,b,c){var d=a.getUserPreferences(),e=a.pages.getCurrentPageId();d.session.set("bg_panel_last_media_path_"+e,{type:b,path:c.path})}function F(a){var b=a.getUserPreferences(),c=a.pages.getCurrentPageId();return b.session.get("bg_panel_last_media_path_"+c)||{}}function G(a,b){return a.homePage.get()===b}function H(a,b,c){G(a,c)&&!b.ref.mediaRef&&(b.ref.id=f.guidUtils.getUniqueId(c,"_")+"_bg")}function I(a,b){var c=b.ref.id;c||(c=y(a,"mobile",a.pages.getCurrentPageId()).ref.id);var d=a.userPreferences.session.get("bg_panel_mobile_data_duplications_"+c);d&&d.count&&(b.ref.id=f.guidUtils.getUniqueId(a.pages.getCurrentPageId(),"_")+"_mobile_bg",b.ref.mediaRef&&(b.ref.mediaRef.id=void 0),a.userPreferences.session.set("bg_panel_mobile_data_duplications_"+c,{count:d.count-1}),a.userPreferences.session.set("bg_panel_mobile_data_duplications_"+b.ref.id,{count:0}))}function J(a,b){var c=a.getUserPreferences(),d=a.pages.getCurrentPageId(),e=b===n.VIDEO?"bg_video_settings_data_changed_":"bg_image_settings_data_changed_";c.session.set(e+d,!1),c.session.set("bg_video_settings_pattern_state_"+d,!1)}function K(a,b){a.ref.scrollType="fixed";var c=b.pages.getCurrentPageId(),d=b.getUserPreferences(),e=d.session.get("bg_video_settings_data_changed_"+c);e||z(a)}function L(a,b,c){var d=c.pages.getCurrentPageId(),e=c.getUserPreferences(),f=e.session.get("bg_image_settings_data_changed_"+d);f&&(a.opacity=b.ref.mediaRef&&b.ref.mediaRef.opacity||1),z(b)}function M(){return x}var l=f.imageTransform,m=f.backgroundPanelUtils,n=m.getMediaTypes(),o=352,p=184,q=600,r=600,s={IMAGE_SETTINGS:"rEditor.panels.bgImageSettingsPanel",VIDEO_SETTINGS:"rEditor.panels.bgVideoSettingsPanel",APPLY:"rEditor.panels.backgroundApplyPanel"},t={APPLY_PANEL:"applyPanel",IMAGE_PANEL:"imagePanel",VIDEO_PANEL:"videoPanel",PRESET:"preset",MEDIA:"media",REMOVE:"remove",COLOR:"color"},u={TITLE:{mobile:"BGPP_PANEL_HEADER_MOBILE_TITLE",desktop:"BGPP_PANEL_HEADER_DSKTOP_TITLE"}},v={Image:"BGPP_PANEL_IMAGE_SETTINGS_BUTTON",WixVideo:"BGPP_PANEL_VIDEO_SETTINGS_BUTTON"},w={origin:null,presetIndex:null},x={IN_PROCESS:"in_process",PLAYING_PREVIEW:"playing_preview",IDLE:"idle",NO_VIDEO:"no_video"};return a.createClass({displayName:"backgroundPanel",mixins:[c.mixins.editorAPIMixin,f.blockOuterScrollMixin,h.linkColorPickerMixin],biEventsParams:w,panelBoundingRect:{},mediaTypes:n,getMediaType:m.getMediaType,subPanels:s,videoReadyStates:null,componentDidMount:function(){this.panelBoundingRect=this.getDOMNode().getBoundingClientRect();var a=this.getEditorAPI();a.pages.background.video.registerToPlayingChange(this.playingStatusChanged),this.markMobileDataDuplications()},componentWillUnmount:function(){this.closeSubPanel(this.getCurrentSubPanel());var a=this.getEditorAPI();a.pages.background.video.unregisterToPlayingChange(this.playingStatusChanged),this.pauseVideo(),j.changedBackgroundBiEvent(this.getEditorAPI(),c.bi.events.backgroundPanel.panel_background_changed,this.getData(),this.biEventsParams)},getInitialState:function(){return this.videoReadyStates=M(),this.biEventsParams={origin:null,presetIndex:null},{isVideoPlaying:!1,videoReadyState:this.videoReadyStates.IDLE}},componentDidUpdate:function(){this.getVideoReadyState()===this.videoReadyStates.IDLE&&e.tooltipManager.hide("video-play-tooltip")},previewVideo:function(){var a=this.getEditorAPI();a.pages.background.video.play()},pauseVideo:function(){var a=this.getEditorAPI();a.getPreviewMode()||a.pages.background.video.pause()},isVideoPlaying:function(){var a=this.getEditorAPI();return a.pages.background.video.isPlaying()},getVideoReadyState:function(){var a=this.getEditorAPI();return a.pages.background.video.getReadyState()},playingStatusChanged:function(){this.forceUpdate()},videoReadyStateChanged:function(){this.forceUpdate()},linkedBackgroundColor:function(a,b,c){var d=b[c].replace(/[\{\}]/g,"");return{value:d,requestChange:function(d){b[c]=/color_/.test(d)?"{"+d+"}":d,this.biEventsParams.origin="bg_color_picker",this.onRequestChange(a)}.bind(this)}},getCurrentSubPanel:function(){var a=b.find(this.props.editorState.openPanels,function(a){return b.contains(s,a.name)});return a&&a.name},isSettingsPanelOpen:function(){var a=this.getCurrentSubPanel();return a===s.IMAGE_SETTINGS||a===s.VIDEO_SETTINGS},closeSubPanel:function(a){a&&d.panelManager.closePanelByName(a)},getData:function(a){return y(this.getEditorAPI(),a)},handleMobileDataChange:function(a,b,c,d){if(H(c,b,d),"mobile"===a)b.isPreset=!1,b.ref.scrollType="scroll",I(c,b);else{var e=y(c,"mobile",d);e.isPreset&&(I(c,e),A(c,b,e,d))}},onRequestChange:function(a,b,c){var d=this.getEditorAPI(),e=d.isMobileEditor()?"mobile":"desktop";c=c||d.pages.getCurrentPageId(),H(d,a,c),this.handleMobileDataChange(e,a,d,c),d.pages.background.update(c,a,e),this.undoHandler(b),this.state.isVideoPlaying&&(this.pauseVideo(),this.setState({isVideoPlaying:!1}))},undoHandler:function(a){var c=this.getEditorAPI(),d=b.values(t);b.contains(d,a)&&c.history.add("background panel - "+a)},toggleSubPanel:function(a){var b=this.getCurrentSubPanel();return{value:b&&b!==this.subPanels.APPLY,requestChange:function(){var b=a===this.mediaTypes.VIDEO?this.subPanels.VIDEO_SETTINGS:this.subPanels.IMAGE_SETTINGS;this.toggleSubPanelChange(b)}.bind(this)}},toggleSubPanelChange:function(a){var b=this.getCurrentSubPanel();a===b?this.closeSubPanel(a):this.openSubPanel(a)},openSubPanel:function(a){D(a,this.getEditorAPI(),this.biEventsParams);var b=this.getSubPanelProps();d.panelManager.openPanel(a,b,!0)},getSubPanelProps:function(a){return{requestChange:this.onRequestChange,undoHandler:this.undoHandler,undoOrigins:t,getData:this.getData,panelName:a,top:this.panelBoundingRect.top,left:this.panelBoundingRect.left+this.panelBoundingRect.width+15,width:290}},getCurrentMedia:function(a){var d,c={};if(a.ref.mediaRef){d=this.getMediaType(a.ref)===this.mediaTypes.IMAGE?a.ref.mediaRef:a.ref.mediaRef.posterImageRef;var e=m.getImageDisplayData(a.ref.fittingType,a.ref.alignType,d.uri,d.width,d.height,o,p);c.backgroundImage="url("+f.url.joinURL(m.MEDIA_URL_PREFIX,e.uri)+")",c.opacity=d.opacity,b.assign(c,e.css.container)}return b.assign(c,this.getCurrentColor(a)),c},getCurrentColor:function(a){var b=m.getColorValue(this.getEditorAPI(),a.ref.color);return{backgroundColor:b}},toggleVideoPlayback:function(a){return{value:a,requestChange:function(a){a?this.previewVideo():this.pauseVideo()}.bind(this)}},replaceColor:function(a,b){this.setColorPicker(a,b,this.colorPickerPanelHandleReplace.bind(this),!0)},changeColor:function(a,b){var c=!b.ref.mediaRef;this.setColorPicker(a,b,this.colorPickerPanelHandleChange.bind(this),c)},setColorPicker:function(a,b,c,d){var e=b.ref.color.replace(/[\{\}]/g,""),f={top:a.clientY,left:a.clientX};this.openColorPicker(c,e,!0,f,d,!0)},colorPickerPanelHandleReplace:function(a){this.closeSubPanel(this.getCurrentSubPanel());var b=this.getData();b.ref.color=/color_/.test(a)?"{"+a+"}":a,this.biEventsParams.origin="bg_color_picker",this.onRequestChange(b)},colorPickerPanelHandleChange:function(a){this.closeSubPanel(this.getCurrentSubPanel());var b=this.getData();b.ref.mediaRef&&(b.ref.mediaRef=null,J(this.getEditorAPI(),n.VIDEO),J(this.getEditorAPI(),n.IMAGE),z(b),this.undoHandler(t.REMOVE)),b.ref.color=/color_/.test(a)?"{"+a+"}":a,this.biEventsParams.origin="bg_color_picker",this.onRequestChange(b)},selectPreset:function(a,c,d){var f=this.getData(),g=this.getEditorAPI();e.tooltipManager.hideAll(),this.closeSubPanel(this.getCurrentSubPanel()),b.extend(a,b.omit(f,"ref")),E(g,this.getMediaType(a.ref),{path:a.path}),delete a.path,delete a.presetIndex,J(g,n.VIDEO),J(g,n.IMAGE),this.biEventsParams={presetIndex:d,origin:"bg_presets"},this.onRequestChange(a,t.PRESET)},onMediaManagerCallback:function(a,b,c){if(b){var d,e,f=this.getEditorAPI(),g=this.getData();E(f,a,c),a===this.mediaTypes.VIDEO?(d=B(b,c),K(g,f),J(f,n.IMAGE),e=d.posterImageRef,g.ref.scrollType="fixed"):a===this.mediaTypes.IMAGE&&(d=C(b,c),L(d,g,f),J(f,n.VIDEO),e=d);var i,h=m.isSmallerFromContainer(e.width,e.height,q,r);i=a===this.mediaTypes.IMAGE&&h?l.fittingTypes.LEGACY_BG_FIT_AND_TILE:l.fittingTypes.SCALE_TO_FILL,g.ref.fittingType=i,g.ref.alignType=l.alignTypes.CENTER,g.ref.mediaRef=d,this.biEventsParams.origin="bg_media_manager_"+a,this.onRequestChange(g,t.MEDIA)}},openMediaManager:function(a,b){if(a){var e,c=this.getEditorAPI(),d=c.mediaServices.mediaManager,f=F(c),g=f.type===a?f.path||"":"";a===this.mediaTypes.IMAGE?e=d.categories.BG_IMAGE:a===this.mediaTypes.VIDEO&&(e=d.categories.BG_VIDEO),this.closeSubPanel(this.getCurrentSubPanel()),d.open(e,{callback:b,path:g})}},changeMedia:function(a){this.openMediaManager(a,this.onMediaManagerCallback.bind(this,a))},closePanel:function(){this.refs.backgroundPanel.close()},getTranslation:function(a){var b=this.getEditorAPI().isMobileEditor()?"mobile":"desktop";return f.translate(u[a][b])},getSettingsButtonTranslation:function(a){return v[a]},handleApplyToOtherClick:function(){this.isOnePager()||this.toggleSubPanelChange(this.subPanels.APPLY)},isOnePager:function(){return 1===this.getEditorAPI().pages.getPageIdList().length},markMobileDataDuplications:function(){var a=this.getEditorAPI(),b=a.getUserPreferences(),d=this.getData("mobile").ref.id,e=b.session.get("bg_panel_mobile_data_duplications_"+d);if(!e){for(var f=a.pages.getCurrentPageId(),g=0,h=a.pages.getPagesData(),i=0;i<h.length;i++)h[i].id!==f&&h[i].pageBackgrounds.mobile.ref.id===d&&g++;b.session.set("bg_panel_mobile_data_duplications_"+d,{count:g}),g&&j.mobileDataDuplicationError(this.getEditorAPI(),c.bi.errors.BG_MOBILE_DATA_DUPLICATION_ERROR)}},isPlayBtnTooltipDisabled:function(){return this.getVideoReadyState()===this.videoReadyStates.IDLE},getPlayBtnTranslation:function(){var a="",b=this.getVideoReadyState();return b===this.videoReadyStates.PLAYING_PREVIEW?a="BGPP_PANEL_VIDEO_PLAYBACK_PREVIEW_READY_TOOLTIP":b===this.videoReadyStates.IN_PROCESS&&(a="BGPP_PANEL_VIDEO_PLAYBACK_NOT_READY_TOOLTIP"),a},getSettingTranslation:function(a){var b="";return a===this.mediaTypes.IMAGE?b="BGPP_PANEL_IMAGE_SETTINGS_BUTTON_TOOLTIP":a===this.mediaTypes.VIDEO&&(b="BGPP_PANEL_VIDEO_SETTINGS_BUTTON_TOOLTIP"),b},getPresetsProps:function(){return{desktopPresets:i.backgroundDesktopPresets,mobilePresets:i.backgroundMobilePresets,title:f.translate("BGPP_PANEL_SELECTED_SECTION_TITLE"),infoTooltip:"BGPP_PANEL_SELECTED_SECTION_TOOLTIP",onSelectPreset:this.selectPreset,thumbWidth:88,thumbHeight:59}},render:function(){return k.apply(this)}})}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgImageSettingsPanel.rt",["react/addons","lodash","baseUI","symbols","panels","experiment!bgParallax"],function(a,b,c,d,e,f){"use strict";function g(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function h(b,d,e){return a.createElement(c.dropDown.option,{key:"fittingTypeOption"+e,value:d.value},d.label)}function i(){var d=this.props.getData();return a.createElement(e.frames.bgSubPanelFrame,g({helpId:"54c7eb1c-a6c7-46c9-9261-96eecf3bb0eb",className:"background-image-settings-panel background-sub-panel",label:"BGPP_SETTINGS_IMAGE_PANEL_HEADER_TITLE"},b.omit(this.props,"children")),a.createElement(c.customScroll,{},a.createElement("div",{className:"bg-image-settings-panel-scrollbox bg-settings-panel-scrollbox"},a.createElement(c.slider,{valueLink:this.linkedBackgroundOpacityData(d,d.ref.mediaRef,"opacity"),label:"BGPP_SETTINGS_IMAGE_OPACITY_TITLE",min:0,max:100,step:1}),a.createElement("hr",{className:"divider-long"}),a.createElement("div",{className:"color-picker-input-wrapper"},a.createElement(c.colorPickerInput,g({label:"BGPP_SETTINGS_IMAGE_BG_COLOR_TITLE",ref:"bgColorPickerInput",className:"label-left",valueLink:this.linkedBackgroundColor(d,d.ref,"color")},this.getColorPickerProps()))),a.createElement("hr",{className:"divider-long"}),a.createElement(c.sectionDividerLabeled,{label:"BGPP_SETTINGS_IMAGE_LAYOUT_SECTION_TITLE"}),a.createElement("hr",{className:"divider-long"}),this.getEditorAPI().isMobileEditor()?null:a.createElement("div",{key:"scrollTypeRadiosDivider"},f?a.createElement("div",{key:"parallax-toggle"},a.createElement(c.toggle,{valueLink:this.isParallaxEnabled(d,d.ref,"scrollType"),label:"BGPP_SETTINGS_IMAGE_SCROLL_PARALLAX"}),a.createElement("hr",{className:"divider-short"})):null,a.createElement(c.radioButtons,{valueLink:this.linkedBackgroundData(d,d.ref,"scrollType"),disabled:"parallax"===d.ref.scrollType,options:this.getScrollOptions()})),a.createElement("hr",{className:"divider-long"}),a.createElement.apply(this,[c.dropDown.select,{valueLink:this.linkedBackgroundData(d,d.ref,"fittingType"),label:"BGPP_SETTINGS_IMAGE_FITTING_TITLE"},b.map(this.getFittingOptions(d.ref.scrollType),h.bind(this,d))]),a.createElement("hr",{className:"divider-long"}),a.createElement(c.alignment,{options:c.commonData.ALIGNMENT_MODES_XY,valueLink:this.linkedBackgroundData(d,d.ref,"alignType"),label:"BGPP_SETTINGS_IMAGE_ALIGN_TITLE"}))))}return function(){return i.apply(this,[])}}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgImageSettingsPanel",["core","react","lodash","panels","util","panelUtils","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgImageSettingsPanel.rt"],function(a,b,c,d,e,f,g){"use strict";function o(a){var b=a.getUserPreferences(),c=a.pages.getCurrentPageId();b.session.set("bg_image_settings_data_changed_"+c,!0)}var h=e.backgroundPanelUtils,i=e.imageTransform.fittingTypes,j=600,k=600,l=[{label:"BGPP_SETTINGS_IMAGE_FITTING_SCALE_TO_FILL",value:i.SCALE_TO_FILL},{label:"BGPP_SETTINGS_IMAGE_FITTING_SCALE_TO_FIT",value:i.SCALE_TO_FIT},{label:"BGPP_SETTINGS_IMAGE_FITTING_ORIGINAL_SIZE",value:i.LEGACY_BG_NORMAL},{label:"BGPP_SETTINGS_IMAGE_FITTING_TILE",value:i.LEGACY_BG_FIT_AND_TILE},{label:"BGPP_SETTINGS_IMAGE_FITTING_TILE_HORIZONTALLY",value:i.LEGACY_BG_FIT_AND_TILE_HORIZONTAL},{label:"BGPP_SETTINGS_IMAGE_FITTING_TILE_VERTICALLY",value:i.LEGACY_BG_FIT_AND_TILE_VERTICAL}],m=[{label:"BGPP_SETTINGS_IMAGE_FITTING_SCALE_TO_FILL",value:i.SCALE_TO_FILL},{label:"BGPP_SETTINGS_IMAGE_FITTING_TILE",value:i.LEGACY_BG_FIT_AND_TILE}],n={opacity:1,fittingType:i.SCALE_TO_FILL,alignType:"center",scrollType:"scroll"};return b.createClass({displayName:"bgImageSettingsPanel",mixins:[a.mixins.editorAPIMixin,f.linkColorPickerMixin],childContextTypes:{reportUIChange:b.PropTypes.func},getInitialState:function(){return this.lastScrollingType=null,{}},shouldComponentUpdate:function(a){var b=a.getData();return b.ref.mediaRef&&"Image"===b.ref.mediaRef.type?!0:(d.panelManager.closePanelByName(a.panelName),!1)},getChildContext:function(){return{reportUIChange:this.onUIChange}},onUIChange:function(a){"slider"===a&&this.props.undoHandler(this.props.undoOrigins.IMAGE_PANEL)},linkedBackgroundData:function(a,b,c){var d="undefined"==typeof b[c]?n[c]:b[c];return{value:d,requestChange:function(d){b[c]=d,this.props.requestChange(a,this.props.undoOrigins.IMAGE_PANEL),o(this.getEditorAPI()),"parallax"!==a.ref.scrollType&&(this.lastScrollingType=a.ref.scrollType)}.bind(this)}},linkedBackgroundOpacityData:function(a,b,c){var d="undefined"==typeof b[c]?n[c]:b[c];return d*=100,{value:d,requestChange:function(d){d/=100,b[c]=d,this.props.requestChange(a),o(this.getEditorAPI())}.bind(this)}},linkedBackgroundColor:function(a,b,c){var d=b[c].replace(/[\{\}]/g,"");return{value:d,requestChange:function(d){b[c]=/color_/.test(d)?"{"+d+"}":d,this.props.requestChange(a),o(this.getEditorAPI())}.bind(this)}},getColorPickerProps:function(){return{useMouseEvent:!0,colorResolver:this.resolveColor,openColorPicker:this.openColorPicker,previewOnHover:!0}},getFittingOptions:function(a){return"parallax"===a?m:l},isParallaxEnabled:function(a,b,c){return{value:"parallax"===b[c],requestChange:function(d){d?b[c]="parallax":(b[c]=this.lastScrollingType||n[c],this.lastScrollingType=b[c]),this.setFittingType(a),this.props.requestChange(a,this.props.undoOrigins.IMAGE_PANEL)}.bind(this)}},setFittingType:function(a){var b,d=a.ref.fittingType,e=[i.LEGACY_BG_FIT_AND_TILE,i.LEGACY_BG_FIT_AND_TILE_HORIZONTAL,i.LEGACY_BG_FIT_AND_TILE_VERTICAL];if(c.contains(e,d))b=i.LEGACY_BG_FIT_AND_TILE;else if(d===i.SCALE_TO_FILL)b=d;else{var f=a.ref.mediaRef,g=h.isSmallerFromContainer(f.width,f.height,j,k);b=g?i.LEGACY_BG_FIT_AND_TILE:i.SCALE_TO_FILL}a.ref.fittingType=b},getScrollOptions:function(){var a=[{value:"fixed",label:"BGPP_SETTINGS_IMAGE_SCROLL_NO"},{value:"scroll",label:"BGPP_SETTINGS_IMAGE_SCROLL_YES"}];return a},render:g})}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgVideoSettingsPanel.rt",["react/addons","lodash","baseUI","symbols","panels","util"],function(a,b,c,d,e,f){"use strict";function g(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function h(b,d,e,f){return a.createElement(c.dropDown.option,{key:"playbackOption"+f,value:e.value},e.label,"\n                \n            ")}function i(){var d=this.props.getData(),i=f.translate;return a.createElement(e.frames.bgSubPanelFrame,g({helpId:"7f54f04e-6e0b-4f73-96e2-6c98dd28e822",className:"background-video-settings-panel background-sub-panel",label:"BGPP_SETTINGS_VIDEO_PANEL_HEADER_TITLE"},b.omit(this.props,"children")),a.createElement(c.customScroll,{},a.createElement("div",{className:"bg-video-settings-panel-scrollbox bg-settings-panel-scrollbox"},a.createElement("div",{className:"background-video-patterns-control"},a.createElement(c.thumbnails,{radioType:"class",valueLink:this.linkedPatternOption(d,d.ref.imageOverlay),maxThumbsPerRow:"4",title:"BGPP_SETTINGS_VIDEO_OVERLAY_PATTERN_TITLE",options:this.thumbPatternOptions}),d.ref.imageOverlay?a.createElement(c.buttonsGroup,{className:"overlay-pattern-btn-group",valueLink:this.applyInversePattern(d,d.ref.imageOverlay),options:this.getInvertPatternOption(),key:"inversePattern"}):null),a.createElement("hr",{className:"divider-long"}),a.createElement(c.toggle,{valueLink:this.applyOverlayColor(d),label:"BGPP_SETTINGS_VIDEO_OVERLAY_COLOR_TITLE"}),this.isColorOverlay(d)?a.createElement("hr",{className:"divider-short",key:"color-picker-input-divider"}):null,this.isColorOverlay(d)?a.createElement(c.colorPickerInputWithOpacity,b.assign({},{ref:"bgColorPickerInput",key:"color-picker-input",label:"BGPP_SETTINGS_VIDEO_COLOR_OPACITY_TITLE",valueLink:this.linkColorWithOpacity(d,d.ref)},this.getColorPickerProps())):null,a.createElement("hr",{className:"divider-long"}),a.createElement(c.sectionDividerLabeled,{label:"BGPP_SETTINGS_VIDEO_PLAYBACK_SECTION_TITLE"}),this.getEditorAPI().isDesktopEditor()?a.createElement("hr",{className:"divider-long",key:"whptoDividerImageDesc"}):null,a.createElement.apply(this,[c.dropDown.select,{valueLink:this.linkedBackgroundData(d,d.ref.mediaRef,"playbackSpeed"),label:f.translate("BGPP_SETTINGS_VIDEO_PLAYBACK_TITLE"),shouldTranslate:!1},b.map(this.getPlaybackOptions(),h.bind(this,d,i))]),a.createElement("hr",{className:"divider-long"}),a.createElement(c.toggle,{valueLink:this.linkedBackgroundData(d,d.ref.mediaRef,"loop"),label:"BGPP_SETTINGS_VIDEO_LOOP_TITLE"}))))}return function(){return i.apply(this,[])}}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgVideoSettingsPanel",["react","core","lodash","panels","panelUtils","util","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgVideoSettingsPanel.rt"],function(a,b,c,d,e,f,g){"use strict";function o(a,b){var c=a.getUserPreferences(),d=a.pages.getCurrentPageId();c.session.set("bg_video_settings_pattern_state_"+d,b)}function p(a){var b=a.getUserPreferences(),c=a.pages.getCurrentPageId();b.session.set("bg_video_settings_data_changed_"+c,!0)}function q(a){return a===j}function r(a,b){var d;if(!a.ref.imageOverlay){var e=b.pages.getCurrentPageId(),f=b.getUserPreferences();return d=f.session.get("bg_video_settings_pattern_state_"+e),d?j:i}return c.find(i,{uri:a.ref.imageOverlay.uri})?i:j}for(var h=[{value:null,className:"v-overlay-pat-0-icon"},{value:"",className:"v-overlay-pat-1-icon"},{value:"",className:"v-overlay-pat-2-icon"},{value:"",className:"v-overlay-pat-3-icon"},{value:"",className:"v-overlay-pat-4-icon"},{value:"",className:"v-overlay-pat-5-icon"},{value:"",className:"v-overlay-pat-6-icon"},{value:"",className:"v-overlay-pat-7-icon"}],i=[{uri:"0da768_8b89980121844d37be099f0dbe33e3e3.png",width:6,height:6},{uri:"0da768_4371c7e64a49489bb88c536f515f2040.png",width:6,height:6},{uri:"0da768_361994b0f154464682a0aaf9724471cc.png",width:56,height:56},{uri:"0da768_880a3209e3744cd0a96b66835a01b8c5.png",width:256,height:256},{uri:"0da768_2729bfbce3874276a7dd057098f93949.png",width:6,height:6},{uri:"0da768_8fae2cc5b7bf477fb13faa1f2582dbd2.png",width:4,height:6},{uri:"0da768_2326357be59441978a570bec687a94d0.png",width:3,height:3}],j=[{uri:"0da768_5810e2bd76f64c77a67904ad2b073444.png",width:6,height:6},{uri:"0da768_46b55443eb984c0eacfbdcb1b67a2b7b.png",width:6,height:6},{uri:"0da768_d3e25a05cedd404f807528f6a4750388.png",width:56,height:56},{uri:"0da768_95dbd595356148718d5876246a20fe90.png",width:256,height:256},{uri:"0da768_0ffcd1b0986d43b4aaa061b8b17d4040.png",width:6,height:6},{uri:"0da768_0c0d2dc79bc14f6b8275c3b72fec1ab6.png",width:4,height:6},{uri:"0da768_09a75bbb10944eafb4539206b6a3c615.png",width:3,height:3}],k=0;k<i.length;k++)i[k].type="Image",j[k].type="Image";var l=[{value:.25,label:"0.25x"},{value:.5,label:"0.50x"},{value:1,label:f.translate("BGPP_SETTINGS_VIDEO_PLAYBACK_NORMAL")},{value:1.25,label:"1.25x"},{value:1.5,label:"1.50x"},{value:2,label:"2.00x"}],m=[{value:!1,label:"BGPP_SETTINGS_VIDEO_OVERLAY_PATTERN_DARKER"},{value:!0,label:"BGPP_SETTINGS_VIDEO_OVERLAY_PATTERN_LIGHTER"}],n={loop:!0,uri:null,colorOverlay:"#ffffff",colorOverlayOpacity:.2,scrollType:"scroll",playbackSpeed:1};return a.createClass({displayName:"bgVideoSettingsPanel",mixins:[b.mixins.editorAPIMixin,e.linkColorPickerMixin],propTypes:{getData:a.PropTypes.func,undoHandler:a.PropTypes.func,requestChange:a.PropTypes.func,undoOrigins:a.PropTypes.shape({VIDEO_PANEL:a.PropTypes.object})},childContextTypes:{reportUIChange:a.PropTypes.func},getInitialState:function(){this.lastColor="",this.lastColorOpacity=null;var a=this.props.getData();return this.currentPatterns=r(a,this.getEditorAPI()),this.patternState=q(this.currentPatterns),this.thumbPatternOptions=this.fillThumbPatternOptions(this.currentPatterns),null},getChildContext:function(){return{reportUIChange:this.onUIChange}},onUIChange:function(a){"slider"===a.toLowerCase()&&this.props.undoHandler(this.props.undoOrigins.VIDEO_PANEL)},linkedPatternOption:function(a,b){return{value:b&&b.uri||null,requestChange:function(b){if(b){var d=c.find(this.currentPatterns,{uri:b});this.patternState=q(this.currentPatterns),a.ref.imageOverlay=a.ref.imageOverlay||{},c.assign(a.ref.imageOverlay,d)}else a.ref.imageOverlay=null;o(this.getEditorAPI(),this.patternState),this.props.requestChange(a,this.props.undoOrigins.VIDEO_PANEL),p(this.getEditorAPI())}.bind(this)}},applyInversePattern:function(a,b){return{value:this.patternState,requestChange:function(d){var e=c.findIndex(this.currentPatterns,function(a){return a.uri===b.uri});this.currentPatterns=d?j:i,this.fillThumbPatternOptions(this.currentPatterns),c.assign(a.ref.imageOverlay,this.currentPatterns[e]),this.patternState=d,o(this.getEditorAPI(),d),this.props.requestChange(a,this.props.undoOrigins.VIDEO_PANEL),p(this.getEditorAPI())}.bind(this)}},isColorOverlay:function(a){return!c.isEmpty(a.ref.colorOverlay)&&c.isNumber(a.ref.colorOverlayOpacity)},applyOverlayColor:function(a){return{value:this.isColorOverlay(a),requestChange:function(b){b?(a.ref.colorOverlay=this.lastColor?this.lastColor:a.ref.color,a.ref.colorOverlayOpacity=c.isNumber(this.lastColorOpacity)?this.lastColorOpacity:n.colorOverlayOpacity):(this.lastColor=a.ref.colorOverlay,this.lastColorOpacity=a.ref.colorOverlayOpacity,a.ref.colorOverlay="",a.ref.colorOverlayOpacity=0),this.props.requestChange(a,this.props.undoOrigins.VIDEO_PANEL),p(this.getEditorAPI())}.bind(this)}},linkColorWithOpacity:function(a,b){return{value:{color:b.colorOverlay.replace(/[\{\}]/g,""),alpha:b.colorOverlayOpacity},requestChange:function(c){b.colorOverlay=/color_/.test(c.color)?"{"+c.color+"}":c.color,b.colorOverlayOpacity=c.alpha,this.props.requestChange(a),p(this.getEditorAPI())}.bind(this)}},getColorPickerProps:function(){return{colorResolver:this.resolveColor,openColorPicker:this.openColorPicker,previewOnHover:!0,useMouseEvent:!0,enableHistory:!0}},shouldComponentUpdate:function(a){var b=a.getData();return b.ref.mediaRef&&"WixVideo"===b.ref.mediaRef.type?!0:(d.panelManager.closePanelByName(a.panelName),!1)},linkedBackgroundData:function(a,b,c){return{value:b&&"undefined"!=typeof b[c]?b[c]:n[c],requestChange:function(d){b[c]=d,this.props.requestChange(a,this.props.undoOrigins.VIDEO_PANEL),p(this.getEditorAPI())}.bind(this)}},getPlaybackOptions:function(){return l},fillThumbPatternOptions:function(a){return c.forEach(a,function(b,c){h[c+1].value=a[c].uri}),h},getInvertPatternOption:function(){return m},render:g})}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanelPageItem.rt",["react/addons","lodash","baseUI","symbols"],function(a,b,c,d){"use strict";function e(){var e=this.props.page,f=this.initialBgData,g=this.getCurrentPageData();return a.createElement("div",{className:b.keys(b.pick(this.getItemClassNames(e),b.identity)).join(" ")},a.createElement("label",{className:"item-label"},f?a.createElement(c.toggle,{name:"checkbox",labelAfterSymbol:!0,key:"normal-checkbox",className:"bg-apply-checkbox",valueLink:this.linkState("checked"),disabled:this.getIsCurrentPage()}):null,f?a.createElement("span",{className:"page-preview",key:"page-preview",style:this.getBgImageUrl(this.state.checked?g:f)},this.getMediaType(this.state.checked?g.ref:this.initialBgData.ref)===this.mediaTypes.VIDEO?a.createElement("div",{key:"page-preview-video-controls",className:"page-preview-video-controls"},a.createElement(c.symbol,{name:"bgVideoIndicator"})):null):null,a.createElement("span",{className:"page-name"},e.label,"\n            ",a.createElement("span",{className:"page-info"},e.pageData&&e.pageData.isHome?a.createElement(d.symbol,{name:"pageItemHomeIcon",key:"isHome"}):null,e.pageData&&e.pageData.isTpaPage&&!e.pageData.isTpaSubPage?a.createElement(d.symbol,{name:"actionButtonSpecialPages",key:"isTpaPage"}):null,e.pageData&&e.pageData.isBlogPage&&!e.pageData.isBlogSubPage?a.createElement(d.symbol,{name:"actionButtonBlogPages",key:"isBlogPage"}):null,e.type.isLink?a.createElement(d.symbol,{name:"pageItemLinkIcon",key:"isLink"}):null,e.type.isDropdown?a.createElement(d.symbol,{name:"pageItemDropdownIcon",key:"isDropDown"}):null,e.isVisible?null:a.createElement(d.symbol,{name:"pageItemHideIcon",key:"isHidden"})))))}return function(){return e.apply(this,[])}}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanelPageItem",["react","core","lodash","util","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanelPageItem.rt"],function(a,b,c,d,e){"use strict";function k(a,b){var c=a.isMobileEditor()?"mobile":"desktop",d=a.pages.background.get(b,c);return d}var f=d.imageTransform,g=d.backgroundPanelUtils,h=g.getMediaTypes(),i=50,j=35;return a.createClass({mixins:[b.mixins.editorAPIMixin,a.addons.LinkedStateMixin],displayName:"bgApplyPanelPageItem",mediaTypes:h,initialBgData:null,getInitialState:function(){return this.initialBgData=this.getData(this.props.page.pageData),{checked:this.getIsCurrentPage()}},componentWillReceiveProps:function(a){
this.props.page.type.isPage&&!this.getIsCurrentPage()&&null!==a.valueLink.value&&this.props.valueLink.value!==a.valueLink.value&&this.setState({checked:a.valueLink.value})},componentWillUpdate:function(a,b){this.props.page.type.isPage&&!this.getIsCurrentPage()&&b.checked!==this.state.checked&&this.props.valueLink.requestChange(b.checked,this.props.page.pageData.id,this.initialBgData)},getItemClassNames:function(a){return{"bg-apply-panel-item":!0,"item-hidden":!a.isVisible,"current-page":this.getIsCurrentPage(),"item-first-level":!this.props.isSubMenu,"item-second-level":this.props.isSubMenu,"item-second-level-last":this.props.isSubMenuLast,"item-is-page":a.type.isPage}},getData:function(a){return a?k(this.getEditorAPI(),a.id):null},getMediaType:function(a){return g.getMediaType(a)},getCurrentPageData:function(){return this.props.currentPageBgData},getBgImageUrl:function(a){var b=g.getColorValue(this.getEditorAPI(),a.ref.color),e={backgroundColor:b},k=this.getMediaType(a.ref);if(k!==h.COLOR){var l=k===h.IMAGE?a.ref.mediaRef:a.ref.mediaRef.posterImageRef,m=g.isSmallerFromContainer(l.width,l.height,i,j),n=g.getImageDisplayData(m?f.fittingTypes.TILE:f.fittingTypes.SCALE_TO_FILL,a.ref.alignType,l.uri,l.width,l.height,i,j);e.backgroundImage="url("+d.url.joinURL(g.MEDIA_URL_PREFIX,n.uri)+")",c.assign(e,n.css.container)}return e},getIsCurrentPage:function(){return this.props.currentPageId===(this.props.page.type.isPage&&this.props.page.pageData.id)},render:e})}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanel.rt",["react/addons","lodash","util","baseUI","panels","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanelPageItem","symbols"],function(a,b,c,d,e,f,g){"use strict";function h(a,c){var d=b.assign({},a,c);return a.hasOwnProperty("style")&&(d.style=b.defaults(d.style,a.style)),a.hasOwnProperty("className")&&c.hasOwnProperty("className")&&(d.className=c.className+" "+a.className),d}function i(c,d,e,g,h){return a.createElement("li",{key:"page"+e+"subPage"+h},a.createElement(f,b.assign({},{valueLink:this.pagesStateChange(g.id,!1),ref:"page"+e+"subPage"+h},this.getSubPagesProps(g,h,d.items.length-1))))}function j(c,d,e){return a.createElement("li",{key:"page"+e},a.createElement(f,b.assign({},{valueLink:this.pagesStateChange(d.id,!1),ref:"page"+e},{page:d,currentPageId:this.currentPageId,currentPageBgData:this.currentPageBgData})),d.items.length?a.createElement.apply(this,["ul",{key:"pageItems"},b.map(d.items,i.bind(this,c,d,e))]):null)}function k(){var f=this.props.getData();return a.createElement(e.frames.bgSubPanelFrame,h({helpId:"18df7de7-066e-49e6-b005-f01c72d4f680",className:"bg-apply-panel background-sub-panel",label:"BGPP_SETTINGS_APLLY_PANEL_HEADER_TITLE"},b.omit(this.props,"children")),a.createElement("div",{className:"bg-apply-panel-wrapper"},a.createElement("div",{className:"bg-apply-panel-description"},"\n            ",c.translate("BGPP_SETTINGS_APLLY_PANEL_DESCRIPTION"),"\n        "),a.createElement("div",{className:"bg-apply-panel-all"},a.createElement(d.toggle,{name:"checkbox",labelAfterSymbol:!0,className:"bg-apply-checkbox",value:this.state.markAllPagesDisplay,onChange:this.handleSelectAllChange,indeterminate:this.state.indeterminate,label:"BGPP_SETTINGS_APLLY_TO_ALL"})),a.createElement(d.customScroll,{},a.createElement("div",{className:"bg-apply-panel-scrollbox bg-settings-panel-scrollbox"},a.createElement.apply(this,["ul",{className:"bg-apply-panel-scrollbox-list"},b.map(this.siteMenuItems,j.bind(this,f))])))))}return function(){return k.apply(this,[])}}),define("rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanel",["react","lodash","panels","util","rEditor/utils/menuItemsRepository","core","rEditor/rootComps/panels/backgroundPanel/bgPanelBiEvents","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanel.rt"],function(a,b,c,d,e,f,g,h){"use strict";function i(a,c){return c=c||[],b.forEach(a,function(a){a.pageData&&(c.push(a),a.pageData.isBlogPage&&!a.pageData.isBlogSubPage&&i.call(this,e.getMenuBlogSubItems(this.getEditorAPI()),c),a.pageData.isTpaPage&&!a.pageData.isTpaSubPage&&i.call(this,e.getMenuTpaSubItems(this.getEditorAPI(),a.pageData.tpaApplicationId),c)),i.call(this,a.items,c)},this),b.uniq(c,"id")}function j(a,c){var d=!1;b.forEach(a,function(a){a.pageData&&(a.pageData.isBlogPage?a.items=a.items.concat(e.getMenuBlogSubItems(c)):!d&&a.pageData.isTpaPage&&(d=!0,a.items=a.items.concat(e.getMenuTpaSubItems(c,a.pageData.tpaApplicationId))))})}function k(a){var c=b.filter(a,function(a){return a.items=b.filter(a.items,"pageData"),a.pageData||!b.isEmpty(a.items)});return c}function l(a,b){var c=a.isMobileEditor()?"mobile":"desktop",d=a.pages.background.get(b,c);return d}function m(a,c,d,e){var f;b.forEach(e,function(e){f=e.checked?n(b.cloneDeep(d),e.pageId,c):e.originalPageBgData,a.requestChange(f,null,e.pageId)}),e.length>0&&a.undoHandler(a.undoOrigins.APPLY_PANEL)}function n(a,b,c){var d=c.isMobileEditor()?"mobile":"desktop",e=c.pages.background.get(b,d);return a.ref.mediaRef&&e.ref.mediaRef&&a.ref.mediaRef.type===e.ref.mediaRef.type?(a.ref.mediaRef.id=e.ref.mediaRef.id,"WixVideo"===a.ref.mediaRef.type&&(a.ref.mediaRef.posterImageRef.id=e.ref.mediaRef.posterImageRef.id,a.ref.imageOverlay&&(a.ref.imageOverlay.id=e.ref.imageOverlay&&e.ref.imageOverlay.id))):a.ref.mediaRef&&(delete a.ref.mediaRef.id,"WixVideo"===a.ref.mediaRef.type&&(delete a.ref.mediaRef.posterImageRef.id,a.ref.imageOverlay&&delete a.ref.imageOverlay.id)),a.ref.id=e.ref.id,a}return a.createClass({displayName:"backgroundApplyPanel",mixins:[c.mixins.panelFrameMixin,f.mixins.editorAPIMixin,d.draggableMixin,a.addons.LinkedStateMixin],selectedItems:[],appliedPages:[],flatSitePages:null,sitePages:null,currentPageId:null,currentPageBgData:null,getInitialState:function(){return this.selectedItems=[],this.appliedPages=[],this.flatSitePages=null,this.sitePages=null,this.currentPageId=this.getEditorAPI().pages.getCurrentPageId(),this.currentPageBgData=l(this.getEditorAPI(),this.currentPageId),{markAllPagesDisplay:!1,indeterminate:!1}},componentWillMount:function(){this.updatePageList()},componentWillUpdate:function(){this.updatePageList()},componentDidUpdate:function(){this.appliedPages.length>0&&(m(this.props,this.getEditorAPI(),this.currentPageBgData,this.appliedPages),this.appliedPages=[])},componentWillUnmount:function(){g.applyToOtherClosed(this.getEditorAPI(),f.bi.events.backgroundPanel.panel_apply_to_other_pages_ok,{all_pages_selected:(this.flatSitePages.length===this.selectedItems.length+1).toString(),num_unselected_pages:this.flatSitePages.length-this.selectedItems.length,num_selected_pages:this.selectedItems.length})},updatePageList:function(){this.siteMenuItems=this.getTrimmedMenuItems(),this.flatSitePages=this.getFlatPagesList()},handleSelectAllChange:function(a){b.forEach(this.flatSitePages,function(c){c.pageData.id!==this.currentPageId&&(a?b.contains(this.selectedItems,c.pageData.id)||this.selectedItems.push(c.pageData.id):b.pull(this.selectedItems,c.pageData.id))},this),this.setState({markAllPagesDisplay:a})},pagesStateChange:function(){var a=null;return this.flatSitePages.length===this.selectedItems.length+1&&(a=!0),0===this.selectedItems.length&&(a=!1),{value:a,requestChange:function(a,c,d){a&&c!==this.currentPageId?b.contains(this.selectedItems,c)||this.selectedItems.push(c):b.pull(this.selectedItems,c);var e=this.flatSitePages.length===this.selectedItems.length+1,f=!e&&this.selectedItems.length>0;if(e!==this.state.markAllPagesDisplay||f!==this.state.indeterminate){var g={markAllPagesDisplay:e,indeterminate:f};this.setState(g)}this.appliedPages.push({checked:a,originalPageBgData:d,pageId:c})}.bind(this)}},getFlatPagesList:function(){var a=e.getDesktopMenuItems(this.getEditorAPI());return i.call(this,a)},getTrimmedMenuItems:function(){var a=e.getDesktopMenuItems(this.getEditorAPI());return a=k(a),j(a,this.getEditorAPI()),a},getSubPagesProps:function(a,b,c){return{page:a,currentPageId:this.currentPageId,isSubMenu:!0,currentPageBgData:this.currentPageBgData,isSubMenuLast:b===c}},render:h})}),define("rEditor/rootComps/panels/siteSettings/siteSettingsPanel.rt",["react/addons","lodash","baseUI","panels"],function(a,b,c,d){"use strict";return function(){return a.createElement(d.frames.focusPanelFrame,{panelName:this.props.panelName,width:"1210",height:"90%",shouldHideHeader:!0,className:"site-settings-panel"},a.createElement("iframe",{ref:"siteSettingsFrame",width:"100%",height:"100%",src:this.getSettingsIframeUrl(),frameBorder:"0"}),a.createElement(c.preloader,{className:b.keys(b.pick({hidden:!this.state.showLoader},b.identity)).join(" ")}))}}),define("rEditor/rootComps/panels/siteSettings/siteSettingsPanel",["react","core","lodash","panels","rEditor/rootComps/panels/siteSettings/siteSettingsPanel.rt"],function(a,b,c,d,e){"use strict";function i(a){return c.isObject(a)&&!c.isEmpty(a.action)&&c.isString(a.action)}function j(a){var b=this.refs.siteSettingsFrame.getDOMNode();b.contentWindow.postMessage(JSON.stringify(a),"*")}function k(a,b){var e=a.action,g=d.panelManager;switch(e){case f.GET_METATAGS:j.call(this,{payload:b.seo.headTags.get(),callId:a.callId});break;case f.SET_METATAGS:b.seo.headTags.set(a.value,c.noop,c.noop);break;case f.NOTIFY_SITENAME_CHANGED:b.siteName.set(a.value);break;case f.CLOSE:this.close();break;case f.OPEN_HELP:g.openHelpCenter(h)}}var f={CLOSE:"CLOSE",OPEN_HELP:"OPEN_HELP",SET_METATAGS:"SET_METATAGS",GET_METATAGS:"GET_METATAGS",NOTIFY_SITENAME_CHANGED:"NOTIFY_SITENAME_CHANGED"},g=["https://www.wix.com","http://www.wix.com"],h="49cebc11-f15c-4cf8-82d9-2c36c5397520";return a.createClass({displayName:"siteSettingsPanel",render:e,mixins:[b.mixins.editorAPIMixin,d.mixins.panelFrameMixin],propTypes:{tab:a.PropTypes.string},getInitialState:function(){return{showLoader:!0}},getDefaultProps:function(){return{tab:"overview"}},componentWillMount:function(){window.addEventListener("message",this.handlePostMessage,!1)},componentWillUnmount:function(){window.removeEventListener("message",this.handlePostMessage,!1)},componentDidMount:function(){this.refs.siteSettingsFrame.getDOMNode().addEventListener("load",this.hideLoader)},handlePostMessage:function(a){var d=this.getEditorAPI();if(c.contains(g,a.origin)&&!c.isEmpty(a.data)&&c.isString(a.data))try{this.hideLoader();var e=JSON.parse(a.data);i(e)&&k.call(this,e,d)}catch(f){d.bi.error(b.bi.errors.SITE_SETTINGS_JSON_PARSE_ERROR,{dsc:'message: "'+f.message+'" data: "'+a.data+'"',errscp:this.constructor.displayName})}},getSettingsIframeUrl:function(){var a=this.getEditorAPI(),b=a.generalInfo.getMetaSiteId();return"http://wix.com/my-account/sites/"+b+"/site-settings/"+this.props.tab+"/?mode=editor-dialog"},hideLoader:function(){this.state.showLoader&&this.setState({showLoader:!1})}})}),define("rEditor/rootComps/topBar/menuBar/menuBarItem.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(){this.props.onHover(this.props.menuItem,this.props.index)}return function(){return a.createElement(c.tooltip,{value:this.getTooltipText(),alignment:c.uiConstants.TOOLTIP.ALIGNMENT.RIGHT,disabled:!this.getTooltipText()},a.createElement("li",{className:b.keys(b.pick(this.getClasses(),b.identity)).join(" ")},a.createElement("a",{onClick:this.onClick,onMouseEnter:d.bind(this)},a.createElement("label",{className:"menu-bar-item-label"},this.props.isCheckbox?a.createElement("input",{key:"checkItemInput",ref:"checkboxInput",type:"checkbox",className:"menu-bar-item-checkbox",checked:this.props.viewTools[this.props.menuPropsKey],onChange:this.handleCheckChange}):null,"\n                ",this.props.label,"\n                ",a.createElement("span",{className:"shortcut"},this.props.shortcutLabel)))))}}),define("rEditor/rootComps/topBar/menuBar/menuBarItem",["react","lodash","core","rEditor/rootComps/topBar/menuBar/menuBarItem.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"menuBarItem",propTypes:{action:a.PropTypes.func,bi:a.PropTypes.oneOfType([a.PropTypes.array,a.PropTypes.object]),disabled:a.PropTypes.bool,index:a.PropTypes.number,editorAPI:a.PropTypes.object,isCheckbox:a.PropTypes.bool,shortcutLabel:a.PropTypes.string,label:a.PropTypes.string,menuPropsKey:a.PropTypes.string,closeDropDownHandle:a.PropTypes.func,viewTools:a.PropTypes.object,className:a.PropTypes.string,isSelected:a.PropTypes.bool},componentDidUpdate:function(a){!a.isSelected&&this.props.isSelected&&this.props.onHover(this.props.menuItem,this.props.index)},getClasses:function(){var a={"menu-bar-item":!0,"menu-bar-item-action":!0,"menu-bar-item-action-selected":this.props.isSelected,"enabled-item":!this.props.disabled,"menu-bar-item-separator":this.props.separator};return this.props.className&&(a[this.props.className]=!0),a},handleCheckChange:function(a){var b=a.target.checked;this.executeAction(b)},onClick:function(){this.props.isCheckbox||this.executeAction()},sendBI:function(){if(this.props.editorAPI&&this.props.bi){var a=[].concat(this.props.bi),c=this.props.editorAPI;b.forEach(a,function(a){c.bi.event(a.type,a.fields)},this)}},executeAction:function(a){var b=this.props.action;if(b&&!this.props.disabled)if(this.sendBI(),this.props.isCheckbox){var c=void 0!==a?a:!this.refs.checkboxInput.getDOMNode().checked;b(c)}else b(),this.props.closeDropDownHandle()},getTooltipText:function(){return this.props.editorAPI.tooltipTextService.getSelectedComponentTooltipText(this.props.menuItem.key)},render:d})}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/menuActionsPanel.rt",["react/addons","lodash","rEditor/rootComps/topBar/menuBar/menuBarItem"],function(a,b,c){"use strict";function d(d,e){return a.createElement(c,b.assign({},{ref:d.key,key:d.key,isSelected:e===this.state.selectedMenuItemIndex,menuItem:d,index:e},this.getItemProps(d)))}return function(){return a.createElement("div",{className:"menubar-actions-panel"},a.createElement.apply(this,["ul",{},b.map(this.getSelectedMenuChildren(this.props.selectedMenu),d.bind(this))]))}}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/menuActionsPanel",["react","lodash","util","panels","rEditor/rootComps/topBar/menuBar/menuBarItemsDefinitions","rEditor/rootComps/topBar/dropPanels/menuPanels/menuActionsPanel.rt"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"menuActionsPanel",PropTypes:{selectedMenu:a.PropTypes.object.isRequired,onMenuItemHover:a.PropTypes.func,closeDropDownHandle:a.PropTypes.func},mixins:[d.mixins.statefulKeyboardContextMixin],keyboardShortcutsContextNamePrefix:"TOP_BAR_DROP_PANEL_",getInitialState:function(){return{selectedMenuItemIndex:null}},componentWillReceiveProps:function(a){this.props.selectedMenu.key!==a.selectedMenu.key&&this.setState({selectedMenuItemIndex:null})},getItemProps:function(a){var c=e[a.key];if(c){var d=this.isMenuItemDisabled(c,a.key),f=this.getLabel(c),g=this.props.viewTools,h={disabled:d,onHover:function(a,b){this.props.onMenuItemHover&&this.props.onMenuItemHover(a),this.setState({selectedMenuItemIndex:b})}.bind(this),label:f,closeDropDownHandle:this.props.closeDropDownHandle,viewTools:g,editorAPI:this.props.editorAPI},i=b.clone(c);return b.assign(i,h),i}return null},getSelectedMenuChildren:function(a){var c=a&&a.children||[];return c&&(c=b.filter(c,this.isMenuBarItemShowing,this)),c},isMenuBarItemShowing:function(a){return!!e[a.key]},getLabel:function(a){return a.labelFunc&&a.labelFunc()||a.label},isMenuItemDisabled:function(a,c){var d=this.props.editorAPI;if("PASTE"===c)return!d.clipboardContainsComp()||!d.isDesktopEditor();var e=!1;if(a.compActionRestrictionNames){var f=d.getCompRestrictions(d.selection.getSelectedComponents()),g=a.compActionRestrictionNames||[];e=e||b(g).map(function(a){return!!f[a]}).indexOf(!1)>-1}return!e&&a.disabledChecker&&(e=a.disabledChecker()),e},getNumberOfMenuItems:function(){return this.getSelectedMenuChildren(this.props.selectedMenu).length},getKeyboardShortcuts:function(){var a=this,b=c.keyboardShortcuts.CONTEXTS.MENU_BAR,d=c.keyboardShortcuts.extendContext(b,{up:function(b){var d,c=a.state.selectedMenuItemIndex;d=null===c||0===c?a.getNumberOfMenuItems()-1:c-1,a.setState({selectedMenuItemIndex:d}),b.preventDefault()},down:function(b){var d,c=a.state.selectedMenuItemIndex;d=null===c?0:(c+1)%a.getNumberOfMenuItems(),a.setState({selectedMenuItemIndex:d}),b.preventDefault()},enter:function(b){var c=a.state.selectedMenuItemIndex;if(null!==c){var d=a.getSelectedMenuChildren(a.props.selectedMenu)[c].key,e=a.refs[d];e.executeAction&&e.executeAction()}b.preventDefault()}});return d},render:f})}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/promotionPanel.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(){var b=this.props.menuKey.toLowerCase(),d=this.props.classes;return a.createElement("div",{className:"menu-bar-promotion-box",style:this.props.style,onClick:this.onClick},a.createElement("div",{className:"graphics-container "+(d.graphics||"graphics-"+b),key:b},this.props.image?a.createElement("img",{key:"promotionImage",src:this.props.image}):null,this.props.symbol?a.createElement(c.symbol,{key:"promotionSymbol",name:this.props.symbol}):null),this.props.title?a.createElement("div",{key:"title",className:d.title||"title"},this.translateIfNeeded(this.props.title)):null,this.props.message?a.createElement("div",{key:"msg",className:d.message||"message"},this.translateIfNeeded(this.props.message)):null)}return function(){return d.apply(this,[])}}),define("rEditor/rootComps/topBar/dropPanels/menuPanels/promotionPanel",["react","lodash","util","rEditor/rootComps/topBar/dropPanels/menuPanels/promotionPanel.rt"],function(a,b,c,d){"use strict";function e(a,c){if(a&&c){var d=b.cloneDeep(c);b.forEach(d,function(b){b.fields&&b.fields.category&&(b.fields.category+="(Image)"),a.bi.event(b.type,b.fields)})}}return a.createClass({displayName:"promotionPanel",mixins:[c.translationMixin],propTypes:{menuKey:a.PropTypes.string.isRequired,image:a.PropTypes.string,symbol:a.PropTypes.string,title:a.PropTypes.string,message:a.PropTypes.string,action:a.PropTypes.func,bi:a.PropTypes.oneOfType([a.PropTypes.array,a.PropTypes.object]),classes:a.PropTypes.object,editorAPI:a.PropTypes.object},getDefaultProps:function(){return{classes:{}}},onClick:function(){this.props.action&&(this.props.action(null,!0),e(this.props.editorAPI,b.compact([].concat(this.props.bi))))},render:d})}),define("rEditor/rootComps/topBar/dropPanels/dropPanels",["rEditor/rootComps/topBar/dropPanels/menuPanels/menuActionsPanel","rEditor/rootComps/topBar/dropPanels/menuPanels/checkListPanel","rEditor/rootComps/topBar/dropPanels/menuPanels/promotionPanel"],function(a,b,c){"use strict";return{menuActionsPanel:a,checkListPanel:b,promotionPanel:c}}),define("rEditor/rootComps/panels/editorVersionInfoPanel/editorVersionInfoPanel.rt",["react/addons","lodash","baseUI","panels","util"],function(a,b,c,d,e){"use strict";return function(){return a.createElement(d.frames.focusPanelFrame,{ref:"frame",panelName:this.props.panelName,title:"Editor Version Info",frameClassName:"editorVersionInfoPanel"},a.createElement("div",{className:"content"},a.createElement("div",{className:"row"},a.createElement("label",{},"Editor Version:"),a.createElement("span",{},this.getEditorVersion())),a.createElement("div",{className:"row"},a.createElement("label",{},"Viewer Version:"),a.createElement("span",{},this.getViewerVersion()))),a.createElement("div",{className:"panel-footer"},a.createElement(c.button,{type:"button",shouldTranslate:!1,label:"OK",className:"done-button",onClick:this.close})))}}),define("rEditor/rootComps/panels/editorVersionInfoPanel/editorVersionInfoPanel",["react","util","jquery","rEditor/rootComps/panels/editorVersionInfoPanel/editorVersionInfoPanel.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"editorVersionInfoPanel",panelName:"editorVersionInfoPanel",getEditorVersion:function(){return b.editorModel.editorVersion||"unknown"},getViewerVersion:function(){var a=c("#preview")[0];return a?a.contentWindow.siteModel.baseVersion||"unknown":"unknown"},close:function(){this.refs.frame&&this.refs.frame.close()},render:d})}),define("rEditor/rootComps/panels/applyStylePanel/applyStylePanel.rt",["react/addons","lodash","panels","baseUI","util","symbols","addPanelInfra"],function(a,b,c,d,e,f,g){"use strict";return function(){return a.createElement(c.frames.confirmationPanelFrame,{panelName:this.props.panelName,className:"apply-style-panel",onConfirm:this.onConfirm,onCancel:this.onCancel,shouldHideHeader:!0,confirmLabel:"COPY_DESIGN_APPLY",ref:"frame",cancelLabel:"COPY_DESIGN_APPLY_CANCEL"},a.createElement("header",{className:"save-publish-panel-header"},a.createElement("button",{className:"close",onClick:this.close},a.createElement(f.symbol,{name:"headerCloseButton"})),a.createElement("button",{className:"help",onClick:this.openHelpCenter,key:"help"},"?"),a.createElement("span",{className:"title"},e.translate("COPY_DESIGN_TITLE")),a.createElement("span",{className:"subtitle"},e.translate("COPY_DESIGN_DESCRIPTION_LINE1"))),a.createElement("div",{className:"panel-content"},a.createElement("div",{className:"current-style-container container-wrapper"},a.createElement("div",{className:"current-style-header header"},a.createElement("span",{className:"text"},e.translate("COPY_DESIGN_LABEL_LEFT"))),a.createElement("div",{className:"current-style comp-container"},a.createElement(g.designPanelLiveComponentSection,this.getSelectedCompProps()))),a.createElement("div",{className:"applied-styles-container container-wrapper"},this.getThemeAndPersonalizeStylesToRender().length>0?a.createElement("div",{key:"applyStyleHeader",className:"applied-styles-header header"},a.createElement("span",{className:"text"}," ",e.translate("COPY_DESIGN_LABEL_RIGHT"),a.createElement("span",{}))):null,a.createElement(d.customScroll,{},a.createElement("div",{className:"comp-themed-styles comp-container"},this.getThemeAndPersonalizeStylesToRender().length>0?a.createElement(g.designPanelLiveComponentSection,b.assign({},{key:"appliesStylesLiveSections"},this.getThemeAndPersonalizeStylesProps())):null,0===this.getThemeAndPersonalizeStylesToRender().length?a.createElement("div",{className:"empty-styles",key:"emptyStylesKey"},a.createElement(f.symbol,{name:"nothingToEditASP"}),a.createElement("div",{className:"empty-style-text text"},e.translate("COPY_DESIGN_EMPTY_LABEL"))):null)))))}}),define("rEditor/rootComps/panels/applyStylePanel/applyStylePanel",["react","lodash","core","panels","rEditor/rootComps/panels/applyStylePanel/applyStylePanel.rt"],function(a,b,c,d,e){"use strict";function n(a,d){var e=a.style||a.styleId;return b.isString(e)&&(e=c.styleManager.getStyleById(d.theme,d.components,e)),e}function o(a){return"demonew@wix.com"===a.generalInfo.getUserInfo().email||"guyg@wix.com"===a.generalInfo.getUserInfo().email}function p(a,d){var e=b.pluck(c.styleManager.getUniqueCustomStyleList(a.theme,a.components,d),"id"),f=b.pluck(c.styleManager.getThemedStyleForComp(a.theme,a.components,d),"id"),g=f.concat(e);return m[d]&&b.forEach(m[d],function(d){e=b.pluck(c.styleManager.getUniqueCustomStyleList(a.theme,a.components,d),"id"),f=b.pluck(c.styleManager.getThemedStyleForComp(a.theme,a.components,d),"id"),g=g.concat(f).concat(e)}),g}function q(a,d){var e=b.pluck(c.styleManager.getUniqueCustomStyleList(a.theme,a.components,d),"id");return m[d]&&b.forEach(m[d],function(d){var f=b.pluck(c.styleManager.getUniqueCustomStyleList(a.theme,a.components,d),"id");e=e.concat(f)}),e}function r(a,d){var e=b.pluck(c.styleManager.getUniqueStyleList(a.theme,a.components,d),"id");return m[d]&&b.forEach(m[d],function(d){var f=b.pluck(c.styleManager.getUniqueStyleList(a.theme,a.components,d),"id");e=e.concat(f)}),e}function s(a){return l[a]&&l[a].compOverrideType?l[a].compOverrideType:a}function t(a,c,d,e,k,m){var o={additionalBehaviours:{iconEnabledForComps:[],infoIcon:"none",labelMode:"none"},help:{hide:!0},categoryId:d.substring(d.lastIndexOf(".")+1),hide:!1,id:c,onClick:m,onItemDrag:function(){},parentType:"ADD_PANEL",props:{compTypes:s(d),horizontalMargin:g,verticalMargin:f,scaleProportion:{x:l[d]&&l[d].scale?l[d].scale:h,y:l[d]&&l[d].scale?l[d].scale:h}},showSectionHeader:!1,stylesForSection:e,additionalScaling:1,selectedItemKey:k,getAdditionalElementProps:function(c){var d=n(c,a),e={};return b.contains(i,d.skin)?(e.text="DESIGN_LABEL_NO_COLOR",e.className="design-panel-transparent-skin-item"):b.contains(j,d.skin)&&(e.text="Design_Label_No_Frame",e.className="design-panel-no-frame-skin-item"),e}};return l[d]&&l[d].maxFontSize&&(o.props.maxFontSize=l[d].maxFontSize),o}function u(a,d){return b.filter(a,function(a){var e=c.styleManager.getStyleById(d.theme,d.components,a);return!b.contains(j,e.skin)})}var f=30,g=20,h=1,i=["wysiwyg.viewer.skins.page.TransparentPageSkin","wysiwyg.viewer.skins.screenwidthcontainer.TransparentHalfScreen","wysiwyg.viewer.skins.screenwidthcontainer.TransparentScreen","wysiwyg.viewer.skins.area.TransparentArea"],j=["wysiwyg.viewer.skins.photo.NoSkinPhoto","wysiwyg.viewer.skins.VideoSkin"],k=["wysiwyg.viewer.components.MatrixGallery","wysiwyg.viewer.components.SlideShowGallery","wysiwyg.viewer.components.SliderGallery","wysiwyg.viewer.components.PaginatedGridGallery"],l={"wysiwyg.viewer.components.HeaderContainer":{scale:.5},"wysiwyg.viewer.components.FooterContainer":{scale:.5},"wysiwyg.viewer.components.ScreenWidthContainer":{scale:.5},"mobile.core.components.Page":{compOverrideType:"pageContainer"},"wysiwyg.viewer.components.Video":{scale:.5},"wysiwyg.viewer.components.VerticalLine":{maxFontSize:10},"wysiwyg.viewer.components.FiveGridLine":{maxFontSize:10},fiveGridLineFullWidth:{maxFontSize:10},"wysiwyg.common.components.singleaudioplayer.viewer.SingleAudioPlayer":{maxFontSize:10},"wysiwyg.viewer.components.AudioPlayer":{maxFontSize:10},"wysiwyg.viewer.components.menus.DropDownMenu":{maxFontSize:15},"wysiwyg.common.components.verticalmenu.viewer.VerticalMenu":{maxFontSize:15},"wysiwyg.viewer.components.SiteButton":{maxFontSize:22},"mobile.core.components.Container":{scale:.5},"core.components.Container":{scale:.5},"core.components.ContainerOBC":{scale:.5},"wysiwyg.viewer.components.BgImageStrip":{scale:.5},"wysiwyg.viewer.components.ContactForm":{scale:.5},"wysiwyg.common.components.subscribeform.viewer.SubscribeForm":{scale:.5},"wysiwyg.viewer.components.GoogleMap":{scale:.5},"wysiwyg.viewer.components.WPhoto":{scale:.5},"wysiwyg.viewer.components.MatrixGallery":{scale:.25,maxFontSize:12},"wysiwyg.viewer.components.SlideShowGallery":{scale:.25,maxFontSize:12},"wysiwyg.viewer.components.SliderGallery":{scale:.25,maxFontSize:12},"wysiwyg.viewer.components.PaginatedGridGallery":{scale:.25,maxFontSize:12}},m={"mobile.core.components.Container":["core.components.Container","core.components.ContainerOBC"],"core.components.Container":["mobile.core.components.Container","core.components.ContainerOBC"],"core.components.ContainerOBC":["mobile.core.components.Container","core.components.Container"]};return a.createClass({displayName:"applyStylePanel",getInitialState:function(){return{selectedItems:[]}},close:function(){this.refs.frame.close();var a=this.props.editorAPI,b=this.props.selectedComp;a.bi.event(c.bi.events.applyStyle.COPY_STYLE_CANCEL,{component_id:b.id,component_type:a.components.getType(b)})},onCancel:function(){var a=this.props.editorAPI,b=this.props.selectedComp;a.bi.event(c.bi.events.applyStyle.COPY_STYLE_CANCEL,{component_id:b.id,component_type:a.components.getType(b)})},onConfirm:function(){var a=this.props.editorAPI,d=a.components.style.getId(this.props.selectedComp),e=a.components.getType(this.props.selectedComp),f=c.styleManager.getStyleById(a.theme,a.components,d),g=this.props.selectedComp;a.bi.event(c.bi.events.applyStyle.COPY_STYLE_APPLY,{num_of_styles_chosen:this.state.selectedItems.length,component_id:g.id,component_type:a.components.getType(g)}),b.forEach(this.state.selectedItems,function(d){var g=d.split("."),h=g[g.length-1],i=h.substring(h.indexOf("_")+1),j=c.styleManager.getStyleById(a.theme,a.components,i),k=[j],l=c.styleManager.getDuplicateToStyleList(a.theme,a.components,j,e);o(a)&&(l=b.filter(l,{styleType:"custom"})),k=k.concat(l),b.forEach(k,function(b){var c={skin:f.skin,style:f.style,type:b.type};a.theme.styles.update(b.id,c)})})},getSelectedCompProps:function(){var a=this.props.editorAPI,c=this.props.selectedComp,d=a.components.getType(c),e="selectedComp"+c.id,f=a.components.style.getId(c),g=[{styleId:f,compType:s(d)}];return t(a,e,d,g,this.state.selectedItems,b.noop)},getThemeAndPersonalizeStylesProps:function(){var a=this.props.editorAPI,b=this.props.selectedComp,c="themeAndMyForComp"+b.id,d=a.components.getType(b),e=this.themeAndPersonalizedStylesToRender?this.themeAndPersonalizedStylesToRender:this.getThemeAndPersonalizeStylesToRender();return t(a,c,d,e,this.state.selectedItems,this.updateListOfStyleToUpdate)},getThemeAndPersonalizeStylesToRender:function(){if(this.themeAndPersonalizedStylesToRender)return this.themeAndPersonalizedStylesToRender;var a=this.props.editorAPI,d=this.props.selectedComp,e=a.components.getType(d),f=a.components.style.getId(d),g=c.styleManager.getStyleById(a.theme,a.components,f),h=[];h=o(a)?p(a,e):b.contains(k,e)?q(a,e):r(a,e),h=u(h,a);var i=[];return b.forEach(h,function(b){var d=c.styleManager.getStyleById(a.theme,a.components,b);b===f||c.styleManager.isEqualWithoutTypeConsideration(d,g)||i.push({compType:s(e),styleId:b})}),this.themeAndPersonalizedStylesToRender=i,i},updateListOfStyleToUpdate:function(a,d,e,f){var g=b.clone(this.state.selectedItems),h=f.split("."),i=h[h.length-1],j=i.substring(i.indexOf("_")+1),k=b.contains(g,f);k?b.remove(g,function(a){return a===f}):g.push(f);var l=this.props.selectedComp,m=this.props.editorAPI;m.bi.event(c.bi.events.applyStyle.COPY_STYLE_CHOOSE_STYLES_TO_REPLACE_CLICK,{style_id:j,status:!k,component_id:l.id,component_type:m.components.getType(l)}),this.setState({selectedItems:g})},openHelpCenter:function(){var a="b853c294-8ff1-418f-b4d2-29d7b59a85c3";d.panelManager.openHelpCenter(a)},render:e})}),define("rEditor/rootComps/panels/panels",["rEditor/rootComps/panels/pagesPanel","rEditor/rootComps/panels/pagesPanelMobile","rEditor/rootComps/panels/myMediaPanel","rEditor/rootComps/panels/backgroundPanel/backgroundPanel","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgImageSettingsPanel","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgVideoSettingsPanel","rEditor/rootComps/panels/backgroundPanel/backgroundSubPanels/bgApplyPanel","rEditor/rootComps/panels/siteSettings/siteSettingsPanel","rEditor/rootComps/topBar/dropPanels/dropPanels","rEditor/rootComps/panels/editorVersionInfoPanel/editorVersionInfoPanel","rEditor/rootComps/panels/applyStylePanel/applyStylePanel"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";return{pagesPanel:a,pagesPanelMobile:b,myMediaPanel:c,backgroundPanel:d,bgImageSettingsPanel:e,bgVideoSettingsPanel:f,backgroundApplyPanel:g,siteSettingsPanel:h,topBar:{menuActionsPanel:i.menuActionsPanel,checkListPanel:i.checkListPanel,promotionPanel:i.promotionPanel},editorVersionInfoPanel:j,applyStylePanel:k}}),define("rEditor",["rEditor/rootComps/editor","rEditor/rootComps/panels/panels","rEditor/app/EditorAPI"],function(a,b,c){"use strict";return{editorComp:a,panels:b,EditorAPI:c}});