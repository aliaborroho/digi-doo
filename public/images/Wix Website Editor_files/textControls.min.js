define("textControls/comps/iconButton.rt",["react/addons","lodash","symbols","baseUI"],function(a,b,c,d){"use strict";return function(){return a.createElement(d.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:d.uiConstants.TOOLTIP.STYLE_TYPE.SMALL},a.createElement("div",{className:"icon-button-container"},a.createElement("button",{className:this.getClassName(),onClick:this.handleClick,style:this.props.style,disabled:this.props.disabled},this.props.name?a.createElement("span",{key:"key"+this.props.name},a.createElement(c.symbol,{name:this.props.name})):null,a.createElement("span",{},this.props.children),this.props.popupMode?a.createElement(d.arrowButton,{key:"iconButtonArrow",withoutBorder:!0}):null)))}}),define("textControls/comps/iconButton",["react","lodash","textControls/comps/iconButton.rt","baseUI"],function(a,b,c,d){"use strict";function e(a){var b={};switch(a){case"textOutdentLeft":case"textOutdentRight":b.category="decrease";break;case"textIndentLeft":case"textIndentRight":b.category="increase";break;case"textWriteDirectionLeft":b.category="RTL";break;case"textWriteDirectionRight":b.category="LTR"}return b}return a.createClass({displayName:"iconButton",render:c,mixins:[d.reportUIChangeMixin],propTypes:{isSelected:a.PropTypes.bool,buttonMode:a.PropTypes.bool,popupMode:a.PropTypes.bool},contextTypes:{reportUIChange:a.PropTypes.func},getDefaultProps:function(){return{isSelected:!1,buttonMode:!0,popupMode:!1}},getClassName:function(){var a="";return this.props.className&&(a+=" "+this.props.className),this.props.isSelected&&(a+=" selected"),this.props.buttonMode&&!this.props.popupMode&&(a+=" icon-button"),this.props.popupMode&&(a+=" icon-button popup"),a.trim()},handleClick:function(){var a=e(this.props.name);this.reportUIChange(a,this.props.name||this.props.biName),this.props.onClick()}})}),define("textControls/comps/colorDrop.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("span",{},this.props.isBackColor||this.props.colorDropOnly?null:a.createElement("span",{key:"backColorDrop"},a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"symbol-textForeColor","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"22px",height:"18px"},a.createElement("path",{fill:this.props.fill?this.props.fill:"none","fill-rule":"evenodd",d:"M 17 3C 17 3 27.03 17 17 17 6.9 17 17 3 17 3Z"}),a.createElement("path",{"fill-rule":"evenodd",d:"M 16.96 18C 13.35 18 12 14.95 12 13.03 12 9.97 15.69 4.09 16.12 3.43 16.12 3.43 16.95 2.12 16.95 2.12 16.95 2.12 17.8 3.42 17.8 3.42 18.23 4.08 22 9.97 22 13.03 22 15.09 20.44 18 16.96 18ZM 16.96 3.97C 16.96 3.97 13 10.18 13 13.03 13 14.52 14.02 16.99 16.96 16.99 19.89 16.99 21 14.52 21 13.03 21 10.18 16.96 3.97 16.96 3.97ZM 3.6 9.02C 3.6 9.02 2 13.03 2 13.03 2 13.03-0 13.03-0 13.03-0 13.03 5 1 5 1 5 1 6 0 6 0 6 0 7 0 7 0 7 0 8 1 8 1 8 1 11 7.01 11 7.01 11 7.01 11 11.02 11 11.02 11 11.02 9.4 9.02 9.4 9.02 9.4 9.02 3.6 9.02 3.6 9.02ZM 7 3.01C 7 3.01 6 3.01 6 3.01 6 3.01 4.4 7.01 4.4 7.01 4.4 7.01 8.6 7.01 8.6 7.01 8.6 7.01 7 3.01 7 3.01Z"}))),this.props.isBackColor&&!this.props.colorDropOnly?a.createElement("span",{key:"foreColorDrop"},a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"symbol-textBackColor","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"28px",height:"21px"},a.createElement("path",{fill:this.props.fill?this.props.fill:"none","fill-rule":"evenodd",d:"M 23 6C 23 6 33.03 20 23 20 12.9 20 23 6 23 6Z"}),a.createElement("path",{"fill-rule":"evenodd",d:"M 22.96 21C 19.35 21 18 17.95 18 16.03 18 12.98 21.69 7.09 22.12 6.43 22.12 6.43 22.95 5.12 22.95 5.12 22.95 5.12 23.8 6.42 23.8 6.42 24.23 7.09 28 12.97 28 16.03 28 18.09 26.44 21 22.96 21ZM 22.96 6.97C 22.96 6.97 19 13.18 19 16.03 19 17.52 20.02 20 22.96 20 25.89 20 27 17.52 27 16.03 27 13.18 22.96 6.97 22.96 6.97ZM 14 6.01C 14 6.01 15 10.02 15 10.02 15 10.02 12 10.02 12 10.02 12 10.02 13 6.01 13 6.01 13 6.01 14 6.01 14 6.01ZM 18 10.02C 18 10.02 15 4.01 15 4.01 15 4.01 14 3.01 14 3.01 14 3.01 13 3.01 13 3.01 13 3.01 12 4.01 12 4.01 12 4.01 6.63 16.03 6.63 16.03 6.63 16.03 9 16.03 9 16.03 9 16.03 11 12.02 11 12.02 11 12.02 16 12.02 16 12.02 16 12.02 16.79 13 16.79 13 16.32 14.18 16 15.26 16 16.03 16 16.93 16.3 18.07 16.98 19.04 16.98 19.04 6 19.04 6 19.04 4.9 19.04 4 18.14 4 17.03 4 17.03 4 15.03 4 15.03 4 15.03 3 15.03 3 15.03 2.45 15.03 2 14.58 2 14.03 2 13.47 2.45 13.02 3 13.02 3 13.02 4 13.02 4 13.02 4 13.02 4 11.02 4 11.02 4 11.02 3 11.02 3 11.02 2.45 11.02 2 10.57 2 10.02 2 9.47 2.45 9.02 3 9.02 3 9.02 4 9.02 4 9.02 4 9.02 4 7.01 4 7.01 4 7.01 2 7.01 2 7.01 1.45 7.01 1 6.57 1 6.01 1 5.46 1.45 5.01 2 5.01 2 5.01 4 5.01 4 5.01 4 5.01 4 2 4 2 4 2 1 2 1 2 0.45 2 0 1.56 0 1 0 0.45 0.45 0 1 0 1 0 4 0 4 0 4 0 20 0 20 0 21.1 0 22 0.9 22 2 22 2 22 4.01 22 4.01 22 4.01 21 5.01 21 5.01 21 5.01 19.43 7.1 18 10.02Z"}))):null,this.props.colorDropOnly?a.createElement("span",{key:"colorDrop"},a.createElement("svg",{width:"13px",height:"20px",viewBox:"0 0 13 20",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},a.createElement("g",{fill:this.props.fill?this.props.fill:"none","fill-rule":"evenodd"},a.createElement("g",{stroke:"#FFFFFF"},a.createElement("path",{d:"M6.444,1.22000003 L5.521,2.66700003 C5.055,3.39800003 0.968,9.90800003 0.968,13.287 C0.968,15.411 2.457,18.783 6.454,18.783 C10.302,18.783 12.032,15.569 12.032,13.287 C12.032,9.90200003 7.857,3.39000003 7.381,2.65900003 L6.444,1.22000003 L6.444,1.22000003 Z"}))))):null)}}),define("textControls/comps/colorDrop",["react","lodash","textControls/comps/colorDrop.rt"],function(a,b,c){"use strict";return a.createClass({propTypes:{fill:a.PropTypes.string},displayName:"colorDrop",render:c})}),define("textControls/comps/textColor.rt",["react/addons","lodash","textControls/comps/colorDrop","textControls/comps/iconButton"],function(a,b,c,d){"use strict";return function(){return a.createElement("span",{},a.createElement(d,{onClick:this.props.onClick,tooltipValue:this.props.tooltipValue,biName:this.getBiName()},a.createElement(c,{isBackColor:this.props.isBackColor,fill:this.props.value})))}}),define("textControls/utils/constants",[],function(){"use strict";return{TEXT_COMP_MAX_HEIGHT:5e3,CK_OFF:2,CK_ON:1,IMAGE_WHITE_LIST_ATTRIBUTES:["src","style","wix-comp"],FORBIDDEN_TAGS:["script","iframe","embed","object","meta"],SENSITIVE_ATTRIBUTES:["href","src","style"],FORBIDDEN_TAGS_AND_ATTRIBUTES:["script","iframe","embed","object","meta","expression","id","comp","dataquery","propertyquery","styleid","skin","skinpart","y","x","scale","angle","idprefix","state","container","listposition","hasproxy","vcfield","vcview","vctype","pos","onAbort","onActivate","onAfterPrint","onAfterUpdate","onBeforeActivate","onBeforeCopy","onBeforeCut","onBeforeDeactivate","onBeforeEditFocus","onBeforePaste","onBeforePrint","onBeforeUnload","onBeforeUpdate","onBegin","onBlur","onBounce","onCellChange","onChange","onClick","onContextMenu","onControlSelect","onCopy","onCut","onDataAvailable","onDataSetChanged","onDataSetComplete","onDblClick","onDeactivate","onDrag","onDragEnd","onDragLeave","onDragEnter","onDragOver","onDragDrop","onDragStart","onDrop","onEnd","onError","onErrorUpdate","onFilterChange","onFinish","onFocus","onFocusIn","onFocusOut","onHashChange","onHelp","onInput","onKeyDown","onKeyPress","onKeyUp","onLayoutComplete","onLoad","onLoseCapture","onMediaComplete","onMediaError","onMessage","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseWheel","onMove","onMoveEnd","onMoveStart","onOffline","onOnline","onOutOfSync","onPaste","onPause","onPopState","onProgress","onPropertyChange","onReadyStateChange","onRedo","onRepeat","onReset","onResize","onResizeEnd","onResizeStart","onResume","onReverse","onRowsEnter","onRowExit","onRowDelete","onRowInserted","onScroll","onSeek","onSelect","onSelectionChange","onSelectStart","onStart","onStop","onStorage","onSyncRestored","onSubmit","onTimeError","onTrackChange","onUndo","onUnload","onURLFlip","seekSegmentTime"],DEFAULT_STYLES_MAP:{h1:{seoTag:"h1",label:"FONT_0_LABEL",tag:"h1",displayName:"text_editor_theme_1",cssClass:"font_0"},h2:{seoTag:"h2",label:"FONT_2_LABEL",tag:"h2",displayName:"text_editor_theme_2",cssClass:"font_2"},h3:{seoTag:"h3",label:"FONT_3_LABEL",tag:"h3",displayName:"text_editor_theme_3",cssClass:"font_3"},h4:{seoTag:"h4",label:"FONT_4_LABEL",tag:"h4",displayName:"text_editor_theme_4",cssClass:"font_4"},h5:{seoTag:"h5",label:"FONT_5_LABEL",tag:"h5",displayName:"text_editor_theme_5",cssClass:"font_5"},h6:{seoTag:"h6",label:"FONT_6_LABEL",tag:"h6",displayName:"text_editor_theme_6",cssClass:"font_6"},p:{seoTag:"p",label:"FONT_7_LABEL",tag:"p",displayName:"text_editor_theme_7",cssClass:"font_7"},div:{seoTag:"p",label:"FONT_8_LABEL",tag:"div",displayName:"text_editor_theme_8",cssClass:"font_8"},address:{seoTag:"p",label:"FONT_9_LABEL",tag:"address",displayName:"text_editor_theme_9",cssClass:"font_9"}},PALETTE_SEQUENCES:["color_11","color_12","color_13","color_14","color_15","color_16","color_17","color_18","color_19","color_20","color_21","color_22","color_23","color_24","color_25","color_26","color_27","color_28","color_29","color_30","color_31","color_32","color_33","color_34","color_35"],TEXT_LIST_TYPES:{textListNone:"nonelist",textListNumbers:"numberedlist",textListBullets:"bulletedlist"},TEXT_BACK_COLOR_TYPES:{textListNone:"noColor"},TEXT_LIST_TYPES_RTL:{textListNone:"nonelist",textListNumbersRight:"numberedlist",textListBulletsRight:"bulletedlist"},ALIGNMENT_TYPES:{textAlignLeft:"justifyleft",textAlignCenter:"justifycenter",textAlignRight:"justifyright",textAlignBlock:"justifyblock"},EFFECTS:{effect_0:{label:"-",value:2},effect_1:{label:"A",value:"rgba(255, 255, 255, 0.6) 1px 1px 1px, rgba(0, 0, 0, 0.6) -1px -1px 1px"},effect_2:{label:"B",value:"rgba(0, 0, 0, 0.298039) 0px 5px 0px"},effect_3:{label:"C",value:"rgba(0, 0, 0, 0.4) 0px 4px 5px"},effect_4:{label:"D",value:"rgba(0, 0, 0, 0.498039) -1px -1px 0px, rgba(0, 0, 0, 0.498039) -1px 1px 0px, rgba(0, 0, 0, 0.498039) 1px 1px 0px, rgba(0, 0, 0, 0.498039) 1px -1px 0px"},effect_5:{label:"E",value:"rgb(255, 255, 255) -1px -1px 0px, rgb(255, 255, 255) -1px 1px 0px, rgb(255, 255, 255) 1px 1px 0px, rgb(255, 255, 255) 1px -1px 0px"},effect_6:{label:"F",value:"rgb(255, 255, 255) 0px 0px 6px"},effect_7:{label:"G",value:"rgb(200, 200, 200) 1px 1px 0px, rgb(180, 180, 180) 0px 2px 0px, rgb(160, 160, 160) 0px 3px 0px, rgba(140, 140, 140, 0.498039) 0px 4px 0px, rgb(120, 120, 120) 0px 0px 0px, rgba(0, 0, 0, 0.498039) 0px 5px 10px"},effect_8:{label:"H",value:"rgb(255, 255, 255) 3px 3px 0px, rgba(0, 0, 0, 0.2) 6px 6px 0px"},effect_9:{label:"I",value:"rgba(10, 189, 240, 0.298039) 3px 3px 0px, rgba(254, 1, 1, 0.298039) -3px -3px 0px"}},FONT_SIZE:{MIN:6,MAX:215},BLOG_CK_EDITOR_FONT_STYLES:{type:"map",metaData:{isPreset:!0,isHidden:!1,description:"",isPersistent:!1},items:{font_0:{seoTag:"h1",label:"FONT_0_LABEL"},font_1:{seoTag:"h2",label:"FONT_1_LABEL"},font_2:{seoTag:"h2",label:"FONT_2_LABEL"},font_3:{seoTag:"h3",label:"FONT_3_LABEL"},font_4:{seoTag:"h4",label:"FONT_4_LABEL"},font_5:{seoTag:"h5",label:"FONT_5_LABEL"},font_6:{seoTag:"h6",label:"FONT_6_LABEL"},font_7:{seoTag:"p",label:"FONT_7_LABEL"},font_8:{seoTag:"p",label:"FONT_8_LABEL"},font_9:{seoTag:"p",label:"FONT_9_LABEL"},font_10:{seoTag:"p",label:"FONT_10_LABEL"}},id:"CK_EDITOR_FONT_STYLES"},BLOG_EDITOR_STYLES:{type:"map",metaData:{isPersistent:!1},items:{h1:{tag:"h1",cssClass:"font_3"},h2:{tag:"h2",cssClass:"font_4"},h3:{tag:"h3",cssClass:"font_5"},h4:{tag:"h4",cssClass:"font_6"},h5:{tag:"h5",cssClass:"font_7"},h6:{tag:"h6",cssClass:"font_8"},p:{tag:"p",cssClass:"font_9"},div:{tag:"div",cssClass:"font_8",label:"default",seoTag:"hatul"}},id:"WIXAPPS_EDITOR_STYLES"},DEFAULT_STYLE_CLASS:"font_100",FALLBACK_STYLE_CLASS:"font_8"}}),define("textControls/utils/fontUtils",["lodash","util","pLoader!santa:fonts"],function(a,b,c){"use strict";function d(a,b,d,e){if(a){var g=c.fontUtils.collectFontsFromTextDataArray([a]),h=f(g,b,d);e.fonts=e.fonts.concat(g),h&&e.urls.push(h)}}function e(b,d,e,g){var h=a(b).map(function(a){return c.fontUtils.getFontFamily(a).replace(/\+/g," ").toLowerCase()}).uniq().value(),i=f(h,e,g);d.fonts=d.fonts.concat(h),i&&d.urls.push(i)}function f(a,b,d){var e=c.fontUtils.getFontsUrlWithParams(a,b,d);return e?e:""}function g(a){var b="http://static.parastorage.com/services/santa/1.428.10/";return c.fontUtils.getWixStoredFontsCssUrlsWithParams(b,a)}function h(a,c,f,h){var i={fonts:[],urls:[]};return d(a,c,f,i),e(h,i,c,f),i.urls=i.urls.concat(g(f)),"WixSite"===c&&i.urls.push(b.serviceTopology.publicStaticsUrl+"/css/Helvetica/fontFace.css"),i}function i(a,b,d,e){var f=b[a];return f?c.fontUtils.parseStyleFont(f.cssClass,e,d):void 0}function j(a,b){var d=a.generalInfo.getDocumentType();return b=b||a.theme.fonts.getCharacterSet(),c.fontUtils.getCurrentSelectablefontsWithParams(d,b)}function k(b,d,e){var f=a.groupBy(d,"cssClass"),g="";return a.forEach(e,function(a,d){var e="font: "+c.fontCss.fontToCSSWithColor(a,b),h=l(d,f);g+=h+"{"+e+"}"}),g}function l(b,c){var d="";return c[b]&&a.forEach(c[b],function(a){d+=a.tag+", "}),d+="."+b}function m(a){return a=a.toLowerCase(),c.fontMetadata[a]}function n(){var b=a.clone(c.fontMetadata);return a.forEach(b,function(a,b){a.cssFontFamily=c.fontUtils.getFontFamilyWithFallbacks(b)}),b}function o(b,d){var e={};a.forEach(c.fontMetadata,function(a,b){a.cdnName&&(e[b]=b)});var g=f(a.keys(e),b,d);return{missingFontsNames:e,missingFontsUrl:g}}function p(a){return this.stringifyFont(a,!1)}function q(a){return a===!0?"700":a===!1?"normal":a}function r(a){return a===!0?"italic":a===!1?"normal":a}function s(c,d,e){var f=r(c.italic)+" "+c.variant+" "+q(c.bold)+" "+c.size+"/"+c.lineHeight+" "+c.family.replace(/\s/g,"+");if(d&&c.color){var g=b.colors.getColorInHex(c.color);if(e){var h=a.findKey(e,function(a){return a===g});h&&(g="{"+h+"}")}f+=" "+g}return f}return{getStyleFont:i,getFontsToLoad:h,parseStyleFont:c.fontUtils.parseStyleFont,stringifyFontWithoutColor:p,stringifyFont:s,createFontsCssString:k,getCurrentSelectableFontsWithParams:j,getFont:m,getWixStoredFontsCss:g,getFontsMetadata:n,getTextCustomFonts:d,getAllCustomFontsUrls:o,getFontsUrlWithParams:f}}),define("textControls/utils/dataUtils",["lodash","textControls/utils/constants"],function(a,b){"use strict";function d(a){return a.replace(/<!--[^>]*>/g,"")}function e(b){var c=[];a.forEach(b.children,function(a){g(a)?c.push(a):(f(a),l(a),e(a))})}function f(b){var d=h(b)?j(b):i(b);a.forEach(d,function(a){b.removeAttribute(c+a)},this)}function g(d){return a.some(b.FORBIDDEN_TAGS,function(a){return d.nodeName.toLowerCase()===c+a},this)}function h(a){return"img"===a.nodeName.toLowerCase()}function i(c){var d=b.FORBIDDEN_TAGS_AND_ATTRIBUTES;return"a"===c.nodeName.toLowerCase()&&a.pull(d,"dataquery"),d}function j(c){var d=a.difference(k(c),b.IMAGE_WHITE_LIST_ATTRIBUTES);return d}function k(b){var c=a.map(b.attributes,function(a){return a.nodeName.toLowerCase()});return c}function l(c){var d;a.forEach(b.SENSITIVE_ATTRIBUTES,function(a){d=c.getAttribute(a),d&&(d=d.toLowerCase(),("style"!==a&&d.indexOf("script")>-1||d.indexOf("expression")>-1)&&c.removeAttribute(a))})}function m(a){var b=window.document.createElement("div");return b.innerHTML=a,b.textContent.length<1}var c="";return{removeHtmlComments:d,removeRedundantNodesAndAttributes:e,isEmptyHtmlText:m}}),define("textControls/utils/ckUtils",["textControls/utils/constants","textControls/utils/fontUtils","util","textControls/utils/dataUtils","jquery","lodash"],function(a,b,c,d,e,f){"use strict";function g(a){var b=[];return f.forEach(a,function(a,c){var d=c.split("_")[1];b[d]=a}),{color:b}}function h(a,b){var c=a.editable().getDocument();f.forEach(b.urls,function(a){c.appendStyleSheet(a)})}function i(a,c,d,e){var f=g(a),h=b.createFontsCssString(f,c,d);e.document.appendStyleText(h)}function j(a,c,d,e,f,g,j){i(j,d,e,a),h(a,b.getFontsToLoad(c,f,g,e))}function k(a,b){var c=a.split(","),d="#"+l(c[0])+l(c[1])+l(c[2]);return b&&(d+=l(255*c[3])),d}function l(a){for(a=a||"00",a=parseFloat(a),"number"==typeof a&&(a=Math.round(a),a=a.toString(16));a.length<2;)a="0"+a;return a.toUpperCase()}function m(a){return 0===a.indexOf("#")?a.toUpperCase():k(a)}function n(a,b){var c={};return f.forEach(b,function(b,d){var e=a+d;c[e]=m(b)}),c}function o(a,b,c){a.config.stylesMap=b,a.config.colorsMap=n("",c),a.config.bgColorsMap=n("back",c),CKEDITOR.plugins.wixParser.resetTheMaps(a.config)}function p(b,c){b.on("beforeCommandExec",function(b){var d=b.data.name;if("fontFamily"===d){var e=b.data.commandData;if(e&&e!==a.CK_OFF){var f=e.replace(/"/g,"").split(",");c(f)}}})}function q(a){a.getCommand("fontFamily").editorFocus=!0,a.getCommand("backColor").editorFocus=!0,a.getCommand("foreColor").editorFocus=!0}function r(b,d,g,i,k,l,m,n,r,s,t){var u=e.parseHTML(l);u&&1===u.length&&3===u[0].nodeType&&(l="<p>"+l+"</p>");var v=CKEDITOR.replace(b,{customConfig:"my/myConfig.js",removePlugins:"resize"+(d?",autogrow":""),autoGrow_maxHeight:d?0:a.TEXT_COMP_MAX_HEIGHT,autoGrow_minHeight:d?0:n.layout.height});return v.on("instanceReady",function(a){var b=a.editor,u=b.document.$.defaultView.frameElement;q(b),z(),c.url.isTrue("isqa")&&(u.id="CurrentTextEditor"),b.container.hide(),b.on("change",g,this),b.on("selectionChange",i),b.on("selectionCheck",i),b.on("resize",function(a){var b=a.data.newHeight;f.isNumber(b)&&b!==a.data.oldHeight&&k(b)}),e(u).bind("mousewheel",function(a){d&&(a.preventDefault(),a.stopPropagation())}),o(b,m,n.themeColors),b.on("dataReady",function(){j(b,l,m,n.themeFonts,n.documentType,n.languages,n.themeColors)}),b.setData(l,{noSnapshot:!0,callback:function(){b.resetUndo(),n.layout&&y(b,n.layout.height,n.layout.width),H(b),E(b),r&&setTimeout(r,250)}}),b.on("focus",s),p(b,function(a){var c=t(a);h(b,c)})}),v}function s(){return CKEDITOR&&"loaded"===CKEDITOR.status}function t(a){return a&&"ready"===a.status}function u(a){return a.plugins.wixpreservestyle.fixDom(a),d.removeHtmlComments(a.getData())}function v(b,c){c.execCommand("wixLink",{dataQuery:"#"+b}),c.execCommand("underline"),c.getCommand("underline")===a.CK_OFF&&c.execCommand("underline")}function w(a){var b=a.createRange();b.selectNodeContents(a.document.getBody()),b.select()}function x(a){a.setReadOnly(!0),a.getSelection().removeAllRanges()}function y(a,b,c){a.resize(c||"100%",b,!0,!1,!1)}function z(){CKEDITOR.plugins.autogrow&&CKEDITOR.plugins.autogrow.refreshHeightConfig&&CKEDITOR.plugins.autogrow.refreshHeightConfig()}function A(a,b){a.setKeystroke(CKEDITOR.CTRL+66,!1),b?a.setKeystroke(CKEDITOR.CTRL+66,"unBold"):a.setKeystroke(CKEDITOR.CTRL+66,"bold")}function B(a,b){a.setKeystroke(CKEDITOR.CTRL+73,!1),b?a.setKeystroke(CKEDITOR.CTRL+73,"unItalic"):a.setKeystroke(CKEDITOR.CTRL+73,"italic")}function C(a){var b=a.getSelection();t(a)&&(b.ignoreFillingCharRemoveOnSelectionChange(),a.focus(),b.resumeFillingCharRemoveOnSelectionChange())}function D(a,b){var c=a.editable().getDocument().$,d=e(c).find("#transparentSelectionCss");b?0===d.length&&e(c).find("head").append('<style id="transparentSelectionCss">body ::selection{background: transparent;} body::-moz-selection{background: transparent;}</style>'):d&&d.remove()}function E(a){var b=a.editable().getDocument().$;e(b).find("head").append('<style id="overflowCss">body {overflow: hidden !important;}</style>')}function F(a){var b=a.editable().getDocument().$;e(b).find("head").find("#overflowCss").remove()}function G(a){var b=a.editable().getDocument().$;e(b).scrollTop(0)}function H(a){var b=a.editable().getDocument().$,d=c.serviceTopology.scriptsLocationMap["santa-versions"]+"/viewer.css",f='<link rel="stylesheet" href="'+d+'" type="text/css" charset="utf-8"></link>';e(b).find("head").append(f)}function I(a,b,c){var d=c.undoManager.currentImage,e=b?"afterUndo":"afterRedo",f=b?"undo":"redo",g=c.getCommand(f);g&&g.on(e,function(){d.equalsContent(c.undoManager.currentImage)&&a()})}return{convertToHexColor:m,createCKInstance:r,isCKLoaded:s,isEditorReady:t,getData:u,createLink:v,selectAll:w,prepareClosing:x,focus:C,toggleSelectionToTransparent:D,updateThemeStyles:i,loadFontsToCK:h,afterUndoRedoCallback:I,refreshHeightConfig:z,setOverflowCss:E,removeOverflowCss:F,scrollCkToTop:G,toggleBoldShortcutKey:A,toggleItalicShortcutKey:B}}),define("textControls/comps/textColor",["react","lodash","textControls/comps/textColor.rt","textControls/utils/ckUtils"],function(a,b,c){"use strict";return a.createClass({displayName:"textColor",propTypes:{tooltipValue:a.PropTypes.string,value:a.PropTypes.string,isBackColor:a.PropTypes.bool,onClick:a.PropTypes.func.isRequired},getDefaultProps:function(){return{isBackColor:!1}},getBiName:function(){var a=this.props.isBackColor?"textHighlight":"textColor";return a},render:c})}),define("textControls/comps/fontFamily.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(b,d){return a.createElement(c.dropDown.option,{shouldTranslate:!1,value:b.value,className:"font-option "+(this.props.optionsClass?this.props.optionsClass:""),key:this.props.value,searchText:b.label},a.createElement("div",{className:"font-option-container"},a.createElement("div",{className:"font-image",style:b.style}),a.createElement("span",{className:"font-label"},b.label)))}return function(){return a.createElement(c.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:this.props.tooltipStyleType},a.createElement("div",{style:{display:"inline"}},a.createElement.apply(this,[c.dropDown.combobox,{label:this.props.label,ref:"combobox",optionsWidth:this.props.optionsWidth,valueLink:this.props.valueLink,value:this.props.value,className:"font-family-dd "+(this.props.toolbarMode?"toolbar-mode":""),onChange:this.props.onChange,infoText:this.props.infoText,infoTitle:this.props.infoTitle},b.map(this.state.fontsItems,d.bind(this)),this.props.footerText&&(this.props.footerOnClick||this.props.footerText)?a.createElement(c.dropDown.footer,{key:"font_family_footer"},a.createElement("span",{onClick:this.handleFooterOnClick},this.props.footerText)):null])))}}),define("textControls/comps/fontFamily",["react","lodash","textControls/comps/fontFamily.rt","util"],function(a,b,c,d){"use strict";return a.createClass({displayName:"fontFamily",render:c,getInitialState:function(){return{fontsItems:this.getFontsItems(this.props.fonts)}},getDefaultProps:function(){return{optionsWidth:284}},componentWillReceiveProps:function(a){b.isEqual(this.props.fonts,a.fonts)||this.setState({fontsItems:this.getFontsItems(a.fonts)})},getFontsItems:function(a){var c=[],e=a;return b.forEach(e,function(a){var e={groupName:a.lang,items:[]};b.forEach(a.fonts,function(b){if("legacy"!==b.permissions){var c=b.spriteIndex+b.characterSets.indexOf(a.lang),f=-24*c,g={label:b.displayName,value:b.fontFamily,style:{backgroundImage:"url("+d.media.getMediaUrl("textEditor/fonts.v1.png")+")",backgroundPosition:"0px "+f+"px",backgroundRepeat:"no-repeat",height:"24px",width:"264px",pointerEvents:"none"}};e.items.push(g)}}),c.push(e)}),b(c).pluck("items").flattenDeep().value()},handleFooterOnClick:function(){this.props.footerOnClick()},isExpanded:function(){return this.refs.combobox.isExpanded()}})}),define("textControls/comps/textStyle.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(b,d){return a.createElement(c.dropDown.option,{value:b.cssClass,key:b.displayName+b.family,className:"style-option "+(this.props.optionsClass?this.props.optionsClass:"")},a.createElement("div",{className:"style-option-header"},a.createElement("div",{className:"style-color-container"},a.createElement("span",{className:"style-color",style:{backgroundColor:b.cssColor}})),a.createElement("span",{className:"style-name",style:this.getDisplayStyle(b)},this.translateIfNeeded(b.displayName))),a.createElement("div",{className:"style-option-footer"},a.createElement("span",{className:"style-size"},b.size),a.createElement("span",{className:"style-tag"},"<",b.seoTag,">")),a.createElement("div",{className:"style-option-label"},this.translateIfNeeded(b.displayName)))}return function(){return a.createElement(c.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:this.props.tooltipStyleType},a.createElement("div",{style:{display:"inline"}},a.createElement.apply(this,[c.dropDown.select,{label:this.props.label,value:this.props.value,onChange:this.props.onChange,ref:"dropdown",infoText:this.props.infoText,infoTitle:this.props.infoTitle,optionsWidth:this.props.optionsWidth,className:"text-style-dd "+(this.props.toolbarMode?"toolbar-mode":""),setSelectedAnyway:!0,doNotFocus:this.props.doNotFocus},b.map(this.getStyleOptions(),d.bind(this)),this.isCustom()?a.createElement(c.dropDown.option,{key:"textStyleCustom",value:this.props.value,className:"style-option",style:{display:"none"}},"\n                ",this.state.nullLabel,"\n            "):null])))}}),define("textControls/comps/textStyle",["react","lodash","textControls/comps/textStyle.rt","textControls/utils/constants","textControls/utils/fontUtils","util"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"textStyle",mixins:[f.translationMixin],propTypes:{nullLabel:a.PropTypes.string},getNullLabelFromProps:function(){return this.props.nullLabel||this.translateIfNeeded("list_design_panel_Customize_TextField_CustomTheme_DropdownItem_Label")},getInitialState:function(){return{nullLabel:this.getNullLabelFromProps()}},getDefaultProps:function(){return{stylesMap:d.DEFAULT_STYLES_MAP,toolbarMode:!1,optionsWidth:264}},getStyleOptions:function(){return b.map(this.props.stylesMap,function(a){var c=e.getStyleFont(a.tag,this.props.stylesMap,this.props.themeColors,this.props.themeFonts);return b.assign(c,b.pick(a,["seoTag","cssClass","displayName"]))},this)},getDisplayStyle:function(a){var b={fontWeight:a.weight,fontFamily:a.family+","+a.fontWithFallbacks,fontSize:parseInt(a.size,10)<=28?a.size:"28px",fontStyle:a.style};return b},isExpanded:function(){return this.refs.dropdown.isExpanded()},render:c,isCustom:function(){return!b.some(this.props.stylesMap,{cssClass:this.props.value})}})}),define("textControls/comps/textPopup.rt",["react/addons","lodash","textControls/comps/iconButton"],function(a,b,c){"use strict";return function(){return a.createElement("div",{className:"text-popup-control"},a.createElement("span",{},a.createElement(c,{ref:"popupButton",isSelected:this.state.popupOpen,style:{width:this.props.width},onClick:this.togglePopup,popupMode:!0,name:this.props.iconName},this.props.label?a.createElement("span",{key:"textPopupLabel"},this.props.label):null)),a.createElement("div",{className:"tri with-shadow",style:{visibility:this.state.popupOpen?"visible":"hidden"}}),a.createElement("div",{className:"text-popup with-shadow",ref:"popupContainer",style:{visibility:this.state.popupOpen?"visible":"hidden"}},a.createElement("span",{},this.props.children)),a.createElement("div",{className:"tri cover-shadow",style:{visibility:this.state.popupOpen?"visible":"hidden"}}))}}),define("textControls/comps/textPopup",["react","lodash","util","textControls/comps/textPopup.rt"],function(a,b,c,d){"use strict";return a.createClass({displayName:"textPopup",propTypes:{label:a.PropTypes.string,iconName:a.PropTypes.string,width:a.PropTypes.number},mixins:[c.outerClickMixin],getInitialState:function(){return{popupOpen:!1}},togglePopup:function(){var a=!this.state.popupOpen;this.setState({popupOpen:a}),a&&this.setPopupPosition()},hide:function(){this.state.popupOpen&&this.setState({popupOpen:!1})},onOuterClick:function(){this.hide()},setPopupPosition:function(){var a=this.refs.popupButton.getDOMNode().getBoundingClientRect();if(this.refs.popupContainer){var b=this.refs.popupContainer.getDOMNode(),c=0-b.getBoundingClientRect().width/2,d=a.height+10;b.style.setProperty("bottom",d+"px"),b.style.setProperty("right",c+"px")}},render:d})}),define("textControls/comps/lineHeight.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(a){this.selectionChange(a)}return function(){return a.createElement("div",{className:"control-line-height"},this.props.infoText||this.props.infoTitle?a.createElement(c.infoIcon,{key:"lineHeightInfo",title:this.props.infoTitle,text:this.props.infoText}):null,a.createElement(c.radioButtons,{value:this.getSelectedOption(),label:"text_editor_line_spacing_label",onChange:d.bind(this),options:this.props.options}),a.createElement("div",{style:{display:b.isNumber(this.state.value)?"block":"none"}},a.createElement(c.slider,{value:this.props.value,min:.5,max:3,stepperMax:9,stepperStep:.01,step:.1,onChange:this.handleSliderChange,onSlideEnd:this.props.onSlideEnd})))}}),define("textControls/comps/lineHeight",["react","lodash","textControls/comps/lineHeight.rt","baseUI"],function(a,b,c,d){"use strict";return a.createClass({displayName:"lineHeight",render:c,mixins:[d.inputMixin],propTypes:{infoText:a.PropTypes.string,infoTitle:a.PropTypes.string,options:a.PropTypes.arrayOf(a.PropTypes.shape({label:a.PropTypes.string.isRequired,value:a.PropTypes.string.isRequired})),label:a.PropTypes.string,value:a.PropTypes.oneOfType([a.PropTypes.string,a.PropTypes.number])},getInitialState:function(){var a=this.getValueFromProps();return{value:a}},getDefaultProps:function(){return{options:[{value:"auto",label:"text_editor_line_spacing_automatic"},{value:"custom",label:"text_editor_line_spacing_customize"}]}},getSelectedOption:function(){var a="auto"===this.state.value?"auto":"custom";return a},handleSliderChange:function(a){this.handleControlChange(a)},selectionChange:function(a){"auto"===a?this.handleControlChange(a):this.handleControlChange(1.2)},handleControlChange:function(a){b.isNumber(a)&&this.setState({value:a}),this.callOnChangeIfExists(a)},componentWillReceiveProps:function(a){var b=this.getValueFromProps(a);this.getValueFromProps(this.props)!==b&&this.setState({value:b})}})}),define("textControls/comps/iconsDropDown.rt",["react/addons","lodash","baseUI"],function(a,b,c){"use strict";function d(b,d){return a.createElement(c.dropDown.option,{value:b,className:"icons-dd-option",key:d},a.createElement(c.symbol,{name:d}))}return function(){return a.createElement(c.tooltip,{value:this.props.tooltipValue,disabled:!this.props.tooltipValue,styleType:this.props.tooltipStyleType},a.createElement("div",{style:{display:"inline-block",verticalAlign:"middle"}},a.createElement.apply(this,[c.dropDown.select,{ref:"dropdown",shouldTranslate:!1,value:this.props.value,onChange:this.props.onChange,className:"icons-dd "+this.props.className,optionsWidth:56,template:this.props.fixedIconName?this.getFixedIcon:void 0,doNotFocus:this.props.doNotFocus},b.map(this.props.items,d.bind(this))])))}}),define("textControls/comps/iconsDropDown",["react","lodash","textControls/comps/iconsDropDown.rt","baseUI"],function(a,b,c,d){"use strict";return a.createClass({displayName:"iconsDropDown",propTypes:{fixedIconName:a.PropTypes.string},render:c,getFixedIcon:function(){return this.props.fixedIconName?a.createElement(d.symbol,{name:this.props.fixedIconName}):void 0},isExpanded:function(){return this.refs.dropdown.isExpanded()}})}),define("textControls/comps/textBackgroundColor.rt",["react/addons","lodash","textControls/comps/colorDrop","textControls/comps/textColor","textControls/utils/constants","baseUI"],function(a,b,c,d,e,f){"use strict";function g(){this.props.onClick()}function h(b,c){return a.createElement(f.dropDown.option,{value:b,className:"icons-dd-option",key:c},a.createElement(f.symbol,{name:c}))}return function(){return a.createElement("span",{},this.shouldRenderDropOwn()?null:a.createElement(d,{onClick:g.bind(this),tooltipValue:this.props.tooltipValue,key:"backColorButton",tooltipStyleType:this.props.tooltipStyleType,isBackColor:!0,value:this.props.color}),this.shouldRenderDropOwn()?a.createElement(f.tooltip,{value:this.props.tooltipValue,styleType:this.props.tooltipStyleType,key:"backColorDropdown"},a.createElement("span",{},a.createElement.apply(this,[f.dropDown.select,{
ref:"dropdown",shouldTranslate:!1,value:this.getDropDownValue(),onChange:this.handleChange,className:"back-color-dd",optionsWidth:40,toggleIcon:!1,template:this.getTemplate,setSelectedAnyway:!0,doNotFocus:this.props.doNotFocus},b.map(e.TEXT_BACK_COLOR_TYPES,h.bind(this)),this.props.colorDrop?a.createElement(f.dropDown.option,{key:"colorDropOption",value:"customColor",className:"icons-dd-option"},a.createElement(c,{colorDropOnly:!0,fill:this.props.color})):null]))):null)}}),define("textControls/comps/textBackgroundColor",["react","lodash","textControls/comps/textBackgroundColor.rt","baseUI","textControls/comps/colorDrop"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"backColorDropDown",render:c,getDefaultProps:function(){return{colorDrop:!0}},shouldRenderDropOwn:function(){return null!==this.props.color},getDropDownValue:function(){return null===this.props.color?"noColor":"customColor"},getTemplate:function(){return a.createElement(e,{fill:this.props.color,isBackColor:!0})},handleChange:function(a){"noColor"===a&&this.props.handleNoColor&&this.props.handleNoColor(),"customColor"===a&&this.props.onClick&&this.props.onClick()},isExpanded:function(){return this.refs.dropdown.isExpanded()}})}),define("textControls/comps/richTextInput.rt",["react/addons","lodash","ckeditor","textControls/comps/iconButton","textControls/comps/textColor","textControls/comps/fontFamily","textControls/comps/textStyle","textControls/comps/textPopup","textControls/comps/lineHeight","textControls/comps/iconsDropDown","textControls/comps/textBackgroundColor","textControls/utils/constants","baseUI"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){"use strict";function n(a,b){this.execFormatBlockCommand(b)}function o(a,b){this.changeFontFamily(b)}function p(a,b){this.execCommand("fontSize",b+"px")}function q(a){this.openColorPicker(!0)}function r(a){this.handleColorClick(!1)}function s(a){this.execCommand("resetTheme")}function t(a){this.toggleToolbar()}function u(a,b){this.changeAlignment(b)}function v(a,b){this.execListCommand(b)}function w(a){this.execCommand("outdent")}function x(a){this.execCommand("indent")}function y(a,b){this.execLineHeightCommand(b)}function z(a,b){this.execCommand("letterSpacing",b+"em")}function A(a){this.execCommand("bidiltr")}function B(a){this.execCommand("bidirtl")}function C(){var b=m.uiConstants.TOOLTIP.STYLE_TYPE.SMALL;return this.props.hideToolbar?null:a.createElement("div",{className:"rich-text-toolbar",key:"richTextToolBar"},a.createElement("section",{},a.createElement(g,{value:this.getFormatBlockValue(),themeColors:this.props.themeColors,ref:"textStyle",tooltipStyleType:b,themeFonts:this.props.themeFonts,toolbarMode:!0,hasSmallArrow:!0,tooltipValue:"text_editor_theme_label",optionsWidth:264,onChange:n.bind(this,b)}),a.createElement(f,{ref:"fontFamily",tooltipStyleType:b,value:this.getValue("fontFamily"),onChange:o.bind(this,b),tooltipValue:"text_editor_font_label",fonts:this.props.fonts,toolbarMode:!0}),a.createElement(h,{label:this.getValue("fontSize")+" px",width:71,ref:"fontSizePopUp"},a.createElement(m.slider,{label:"text_editor_font_size_label",id:"font-size-slider",value:this.getValue("fontSize"),min:6,max:176,stepperMax:999,onChange:p.bind(this,b),onSlideEnd:this.focus})),a.createElement(m.toggleButton,this.getBoldProps()),a.createElement(m.toggleButton,this.getItalicProps()),a.createElement(m.toggleButton,this.getUnderlineProps()),a.createElement(e,{value:this.getValue("foreColor"),onClick:q.bind(this,b),tooltipValue:this.getTooltipValue("text_color"),tooltipStyleType:b,ref:"foreColorButton"}),a.createElement(k,{ref:"backColorButton",color:this.getBackColorValue(),onClick:r.bind(this,b),handleNoColor:this.execNoBackColor,tooltipValue:this.getTooltipValue("text_highlight"),tooltipStyleType:b}),a.createElement(m.toggleButton,this.getLinkProps()),a.createElement(d,{onClick:s.bind(this,b),name:"textRemoveFormat",tooltipValue:"text_editor_reset_button",tooltipStyleType:b}),a.createElement("span",{className:"expand-toolbar-button",onClick:t.bind(this,b)},this.state.extraToolbarOpened?null:a.createElement("span",{className:"more-text",key:"richTextToolBarMore"},a.createElement(m.symbol,{name:"accordionClose"}),a.createElement("span",{},this.translateIfNeeded("list_dbe_edit_item_text_toolbar_more"))),this.state.extraToolbarOpened?a.createElement("span",{className:"less-text",key:"richTextToolBarLess"},a.createElement(m.symbol,{name:"accordionOpen"}),a.createElement("span",{},this.translateIfNeeded("list_dbe_edit_item_text_toolbar_less"))):null)),this.state.extraToolbarOpened?a.createElement("div",{key:"richTextToolBarDivider",className:"toolbar-divider"}):null,this.state.extraToolbarOpened?a.createElement("section",{key:"richTextToolBarExtraControls"},a.createElement(j,{ref:"textAlign",className:"align-dd",value:this.getTextAlignment(),onChange:u.bind(this,b),items:l.ALIGNMENT_TYPES,tooltipValue:this.getTooltipValue("alignment"),tooltipStyleType:b}),a.createElement(j,{ref:"textBullets",className:"bullets-dd",value:this.getListType(),onChange:v.bind(this,b),items:this.getBulletsItems(),tooltipValue:this.getTooltipValue("bullets_and_numbering"),tooltipStyleType:b,fixedIconName:this.getBulletsIconName()}),a.createElement(d,{onClick:w.bind(this,b),name:this.getBooleanValue("bidiltr")?"textOutdentLeft":"textOutdentRight",tooltipValue:this.getTooltipValue("decrease_indent"),tooltipStyleType:b}),a.createElement(d,{onClick:x.bind(this,b),name:this.getBooleanValue("bidiltr")?"textIndentLeft":"textIndentRight",tooltipValue:this.getTooltipValue("increase_indent"),tooltipStyleType:b}),a.createElement(h,{iconName:"textLineHeight",ref:"lineHeightPopUp"},a.createElement(i,{value:this.getLineHeightValue(),onChange:y.bind(this,b),onSlideEnd:this.focus})),a.createElement(h,{iconName:"textCharSpacing",ref:"charSpacingPopUp"},a.createElement(m.slider,{value:this.getLetterSpacingValue(),min:-.1,max:.7,stepperMin:-.4,stepperMax:3,step:.05,stepperStep:.01,onChange:z.bind(this,b),label:"text_editor_character_spacing_label",onSlideEnd:this.focus})),this.getBooleanValue("bidirtl")?a.createElement(d,{onClick:A.bind(this,b),key:"richTextWriteLTR",name:"textWriteDirectionLeft",tooltipValue:this.getTooltipValue("text_direction"),tooltipStyleType:b}):null,this.getBooleanValue("bidiltr")?a.createElement(d,{onClick:B.bind(this,b),key:"richTextWriteRTL",name:"textWriteDirectionRight",tooltipValue:this.getTooltipValue("text_direction"),tooltipStyleType:b}):null):null)}return function(){return a.createElement("div",{className:this.getClassName("rich-text-input-control")+" "+(this.props.hideToolbar?"":"with-toolbar")+" "+(this.props.isResizing?"resizing":""),style:this.props.layout,ref:"textStyle"},C.apply(this,[]),a.createElement("div",{className:"rich-text-content"},a.createElement("div",{ref:"editorContainer"})))}}),define("textControls/mixins/textTooltipMixin",["react","baseUI","core"],function(a,b,c){"use strict";return{getTooltipValue:function(a,b){return"bold"===a||"italic"===a||"underline"===a?this.getTooltipWithShortcut(a,b):"text_editor_buttons_tooltip_"+a},getTooltipWithShortcut:function(d,e){return a.createElement(b.popoverTemplates.keyboardShortcutTooltip,{label:"text_editor_buttons_tooltip_"+d,shortcut:c.constants.KEYBOARD_SPECIAL_KEY.label+" + "+e})}}}),define("textControls/utils/shadowUtils",["lodash","jquery","util"],function(a,b,c){"use strict";function d(){return new RegExp(/(rgba?\([^\)]*\))/g)}function e(){return new RegExp(/(#[0-9a-f]{3,6})/g)}function f(a){var b=g(a);return b.replace(/\s+/g,"").toLowerCase()}function g(a){var b=e(),d=a.match(b),f=a;if(null!==d)for(var g=0;g<d.length;g++){var h=c.colors.hexToRgb(d[g]),i=c.colors.rgbObjectToString(h);f=f.replace(d[g],i)}return f}function h(b,c){var e=d(),f=b.match(e),g=c.match(e);return a.isEqual(f,g)||j(f,g)}function i(a,b){for(var c=0;3>c;c++)if(a[c]!==b[c])return!1;return Math.floor(1e3*a[3])===Math.floor(1e3*b[3])}function j(a,b){if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(0===a[c].indexOf("rgba")&&0===b[c].indexOf("rgba")){var d=k(a[c]),e=k(b[c]);if(!i(d,e))return!1}else if(a[c]!==b[c])return!1;return!0}function k(a){return a.replace("rgba(","").replace(")","").split(",")}function l(a,b){var c=a.replace(d(),""),e=b.replace(d(),"");return c===e}function m(a,b){return h(a,b)&&l(a,b)}function n(a,b){var c=f(a),d=f(b);return c===d||m(c,d)}return{cssTextShadowCompare:n}}),define("textControls/comps/richTextInput",["react","lodash","jquery","textControls/comps/richTextInput.rt","util","textControls/utils/ckUtils","textControls/utils/constants","textControls/utils/fontUtils","baseUI","textControls/mixins/textTooltipMixin","textControls/utils/shadowUtils"],function(a,b,c,d,e,f,g,h,i,j,k){"use strict";function m(a){return b.contains(l,a)}function n(a,b,c,d){if(c){switch(a){case"fontSize":return b===g.CK_OFF?parseInt(c.size,10):parseInt(b,10);case"bold":return"normal"===c.weight&&b===g.CK_OFF?g.CK_OFF:g.CK_ON;case"italic":return"normal"===c.style&&b===g.CK_OFF?g.CK_OFF:g.CK_ON;case"fontFamily":if(b===g.CK_OFF)return h.getFont(c.family).fontFamily;var e=p(b);return d[e]?d[e].fontFamily:"";case"foreColor":return b===g.CK_OFF?c.cssColor:b}return b}}function o(a,b,c){var d=a.getCommand("formatBlock").state;return g.DEFAULT_STYLES_MAP[d]||(d=a.plugins.wixpreservestyle.getSavedStyles(a).formatBlock),h.getStyleFont(d,g.DEFAULT_STYLES_MAP,b,c)}function p(a){return"string"==typeof a?a.toLowerCase().replace(/['"\s]/g,""):a}function q(a){var c={},d={};return b.forEach(a,function(a){b.forEach(a.fonts,function(a){c[p(a.cssFontFamily)]=a,d[a.fontFamily]=a.cssFontFamily})}),{normalizedCssToFont:c,fontFamilyToCss:d}}function r(a,c){var d=b.findKey(c,function(b){return b===a});return b.contains(g.PALETTE_SEQUENCES,d)?d:a}function s(a){var c=e.colors.rgbToHex;return b.contains(a,"rgba")?c(e.colors.rgbaStringToObject(a)):b.contains(a,"rgb")?c(e.colors.rgbStringToObject(a)):a}function t(a,b){return function(){a.execCommand(b)}}function u(a){return function(){a.openLinkDialog()}}var l=["bold","fontSize","fontFamily","foreColor","italic"];return a.createClass({displayName:"richTextInput",render:d,mixins:[e.translationMixin,j,e.outerClickMixin,i.inputMixin],propTypes:{panelManager:a.PropTypes.object.isRequired,themeColors:a.PropTypes.object.isRequired,themeFonts:a.PropTypes.object.isRequired,documentType:a.PropTypes.string.isRequired,languages:a.PropTypes.array.isRequired,fonts:a.PropTypes.array.isRequired,isFixedHeight:a.PropTypes.bool,isFocusOnInit:a.PropTypes.bool,selectAllOnInit:a.PropTypes.bool,onFocus:a.PropTypes.func,onBlur:a.PropTypes.func,hideToolbar:a.PropTypes.bool,openLinkDialog:a.PropTypes.func.isRequired,linkDialogPanelName:a.PropTypes.string,openColorPicker:a.PropTypes.func.isRequired,colorPickerPanelName:a.PropTypes.string},showScroll:function(){f.removeOverflowCss(this.editor)},hideScroll:function(){f.setOverflowCss(this.editor),f.scrollCkToTop(this.editor)},onOuterClick:function(){this.props.hideToolbar||!this._isFocused||this.isAnySubPanelOpen()||(this._isFocused=!1,this.props.onBlur&&this.props.onBlur())},handleFocus:function(){this.props.hideToolbar&&!this._isFocused&&(this._isFocused=!0,this.props.onFocus&&this.props.onFocus())},isAnySubPanelOpen:function(){var a=this.refs.textStyle.isExpanded(),b=this.refs.fontFamily.isExpanded(),c=this.refs.textBullets?this.refs.textBullets.isExpanded():!1,d=this.refs.textAlign?this.refs.textAlign.isExpanded():!1,e=this.refs.backColorButton&&this.refs.backColorButton.refs.dropdown?this.refs.backColorButton.refs.dropdown.isExpanded():!1;return this.isColorPickerOpen||this.isLinkDialogOpen||a||b||c||d||e},focus:function(){var a=this.editor;setTimeout(function(){f.focus(a)},0)},handleHeightChange:function(a){this.props.onHeightChange&&this.isReady()&&this.props.onHeightChange(a)},handleCKCreated:function(){this.props.onShow?this.props.onShow(this.showEditor):this.showEditor()},fontsDataGetter:function(a){var b=h.getFontsUrlWithParams(a,this.props.documentType,this.props.languages);return{fonts:a,urls:[b]}},createCK:function(){f.isCKLoaded()?this.editor=f.createCKInstance(this.refs.editorContainer.getDOMNode(),this.props.isFixedHeight,this.handleDataChange,this.handleSelectionChange,this.handleHeightChange,this.getValueFromProps().text,g.DEFAULT_STYLES_MAP,this.props,this.handleCKCreated,this.handleFocus,this.fontsDataGetter):setTimeout(this.createCK,50)},showEditor:function(){this.editor.container.show(),this.props.isFocusOnInit&&f.focus(this.editor),this.props.selectAllOnInit&&f.selectAll(this.editor)},getDefaultProps:function(){return{isFocusOnInit:!0}},getInitialState:function(){return{extraToolbarOpened:!1}},handleDataChange:function(){if(this.isReady()){var a=f.getData(this.editor);a!==this._internalTextValue&&(this._internalTextValue=a,this.callOnChangeIfExists({text:a,linkList:this._links}))}},cacheLinks:function(){this.getValueFromProps().linkList?this._links=b.cloneDeep(this.getValueFromProps().linkList):this._links=[]},componentDidMount:function(){this.createCK(),this.fontsMaps=q(this.props.fonts),this.props.position&&this.props.position.height&&(this.originalHeight=this.props.position.height),this._internalTextValue=this.getValueFromProps().text,this.cacheLinks()},componentWillUnmount:function(){f.isEditorReady(this.editor)&&this.editor.destroy()},getValue:function(a){if(f.isEditorReady(this.editor)){var b=this.editor.getCommand(a).state;if(m(a)){var c=o(this.editor,this.props.themeColors,this.props.themeFonts);return n(a,b,c,this.fontsMaps.normalizedCssToFont)}return b}return""},getBooleanValue:function(a){return f.isEditorReady(this.editor)?1===this.getValue(a):!1},getTextAlignment:function(){if(f.isEditorReady(this.editor)){var a=this;return b.find(g.ALIGNMENT_TYPES,function(b){return a.editor.getCommand(b).state===g.CK_ON})}return""},getBulletsItems:function(){var a=this.getBooleanValue("bidiltr")?g.TEXT_LIST_TYPES:g.TEXT_LIST_TYPES_RTL;return a},getBulletsIconName:function(){var a=this.getBooleanValue("bidiltr")?"textListBullets":"textListBulletsRight";return a},getListType:function(){if(f.isEditorReady(this.editor)){if(this.editor.getCommand(g.TEXT_LIST_TYPES.textListNumbers).state===g.CK_ON)return g.TEXT_LIST_TYPES.textListNumbers;if(this.editor.getCommand(g.TEXT_LIST_TYPES.textListBullets).state===g.CK_ON)return g.TEXT_LIST_TYPES.textListBullets}return g.TEXT_LIST_TYPES.textListNone},getTextShadowValue:function(){if(f.isEditorReady(this.editor)){var a=this.editor.getCommand("textShadow").state;if(a!==g.CK_OFF){var c=b.findKey(g.EFFECTS,function(b){return b.value!==g.CK_OFF?k.cssTextShadowCompare(b.value,a):void 0});if(c)return c}}return"EFFECT_0"},changeTextShadow:function(a){var b=this.editor.getCommand("textShadow").state,c=b!==a?a:g.CK_OFF;this.execCommand("textShadow",c)},getLetterSpacingValue:function(){if(f.isEditorReady(this.editor)){var a=this.getValue("letterSpacing");return a===g.CK_OFF?0:parseFloat(a)}return""},getLineHeightValue:function(){if(f.isEditorReady(this.editor)){var a=this.getValue("lineHeight");return a===g.CK_OFF?"auto":parseFloat(a)}return""},getBackColorValue:function(){if(f.isEditorReady(this.editor)){var a=this.getValue("backColor");return a===g.CK_OFF?null:a}},getSelectionChangeCallbacks:function(){return this.selectionChangeCallbacks||(this.selectionChangeCallbacks=[]),this.selectionChangeCallbacks},registerOnSelectionChange:function(a){this.getSelectionChangeCallbacks().push(a)},unregisterOnSelectionChange:function(a){b.remove(this.getSelectionChangeCallbacks(),function(b){return b===a})},handleSelectionChange:function(){b.forEach(this.getSelectionChangeCallbacks(),function(a){a()}),this.props.hideToolbar||this.forceUpdate()},execCommand:function(a,b){f.isEditorReady(this.editor)&&(this.editor.execCommand(a,b),this.editor.fire("selectionCheck"))},toggleToolbar:function(){var a=!this.state.extraToolbarOpened;this.setState({extraToolbarOpened:a})},changeAlignment:function(a){a!==this.getTextAlignment()&&this.execCommand(a),f.focus(this.editor)},execListCommand:function(a){var b=this.getListType();a!==b&&(a===g.TEXT_LIST_TYPES.textListNone?this.execCommand(b):this.execCommand(a)),f.focus(this.editor)},execLineHeightCommand:function(a){"auto"===a?this.execCommand("lineHeight",g.CK_OFF):this.execCommand("lineHeight",a+"em")},changeFontFamily:function(a){this.execCommand("fontFamily",this.fontsMaps.fontFamilyToCss[a]),f.focus(this.editor)},getFormatBlockValue:function(){if(f.isEditorReady(this.editor)){var a=this.getValue("formatBlock");return g.DEFAULT_STYLES_MAP[a]||(a=this.editor.plugins.wixpreservestyle.getSavedStyles(this.editor).formatBlock),g.DEFAULT_STYLES_MAP[a].cssClass}return""},execFormatBlockCommand:function(a){var c=b.findKey(g.DEFAULT_STYLES_MAP,function(b){return b.cssClass===a});this.execCommand("formatBlock",c),f.focus(this.editor)},componentDidUpdate:function(a,c){var d=b.difference(this.props.languages,a.languages);if(d.length>0){var e=h.getWixStoredFontsCss(d);f.loadFontsToCK(this.editor,{urls:e})}if(b.isEqual(a.fonts,this.props.fonts)||(this.fontsMaps=q(this.props.fonts)),b.isEqual(a.themeFonts,this.props.themeFonts)||f.updateThemeStyles(this.props.themeColors,g.DEFAULT_STYLES_MAP,this.props.themeFonts,this.editor),this.getValueFromProps().text!==this._internalTextValue&&(this._internalTextValue=this.getValueFromProps().text,this.editor.setData(this.getValueFromProps().text)),!this.props.hideToolbar&&c.extraToolbarOpened!==this.state.extraToolbarOpened){var i=this.editor.getResizable().getSize("height");this.state.extraToolbarOpened?i-=50:i+=50,this.editor.resize("100%",i)}this.props.isResizing&&!b.isEqual(this.props.layout,a.layout)&&(this.editor.resize(this.props.layout.width,this.props.layout.height),this.editor.config.autoGrow_minHeight=this.props.layout.height,f.refreshHeightConfig()),this.cacheLinks()},getCurrentLinkData:function(){var a=this.getValue("wixLink");return null!==a&&a!==g.CK_OFF?("#"===a.charAt(0)&&(a=a.substring(1)),b.find(this._links,{id:a})):void 0},isLinkDialogClosed:function(){var a=this.props.linkDialogPanelName||"panels.toolPanels.linkPanel";return this.isPanelClosed(a)},linkDialogObserver:function(){this.isLinkDialogClosed()&&(this.focus(),this.props.panelManager.unregisterObserver(this.linkDialogObserver),this.isLinkDialogOpen=!1)},openLinkDialog:function(){function g(c){c.id=d,b.remove(a._links,{id:d}),a._links.push(c)}function h(){a.execCommand("wixUnlink"),b.remove(a._links,{id:d})}function i(b){b.id=e.guidUtils.getUniqueId("textLink","_"),f.createLink(b.id,a.editor),"EmailLink"!==b.type||b.subject||(b.subject=""),a._links.push(b)}var a=this,c=this.getCurrentLinkData(),d=c&&c.id;this.props.openLinkDialog(c,function(b){var c=!1;d?(c=!0,b?g(b):h()):b&&(c=!0,i(b)),c&&a.callOnChangeIfExists({text:f.getData(a.editor),linkList:a._links})}),this.props.panelManager&&this.props.panelManager.registerObserver(this.linkDialogObserver),this.isLinkDialogOpen=!0},isPanelClosed:function(a){return-1===b.findIndex(this.props.panelManager.getOpenPanels(),{name:a})},isColorPickerClosed:function(){var a=this.props.colorPickerPanelName||"panels.toolPanels.colorPicker.colorPickerPanel";return this.isPanelClosed(a)},colorPickerObserver:function(){var a=this.isColorPickerClosed();f.toggleSelectionToTransparent(this.editor,!a),a&&(this.focus(),this.props.panelManager.unregisterObserver(this.colorPickerObserver),this.isColorPickerOpen=!1,this.forceIsCustomStyleValue=void 0)},_getRelativeToButtonPosition:function(a){var b=a?this.refs.foreColorButton.getDOMNode():this.refs.backColorButton.getDOMNode(),d=c(b).offset(),e=d.top-c(document).scrollTop(),f=d.left;return{top:370>=e?e+40:e-370,left:f}},handleColorClick:function(a,b){this.openColorPicker(a,b)},openColorPicker:function(a,c){var d=this,e=a?"foreColor":"backColor",f=a?this.getValue(e):this.getBackColorValue(),h=s(f),i=a&&this.isColorFromTheme(),j=r(s(f),this.props.themeColors);f=j?j:s(f),c||(c=this._getRelativeToButtonPosition(a)),this.props.openColorPicker(f,function(a){a="noColor"!==a&&a?a:g.CK_OFF,b.contains(a,"color")&&(a=d.props.themeColors[a]),i&&a===h?d.execCommand(e,g.CK_OFF):d.execCommand(e,a)},c),this.props.panelManager&&this.props.panelManager.registerObserver(this.colorPickerObserver),this.isColorPickerOpen=!0,this.forceIsCustomStyleValue=this.isCustomStyle()},execNoBackColor:function(){return this.execCommand("backColor",g.CK_OFF)},isReady:function(){return f.isEditorReady(this.editor)&&this.editor.container.isVisible()},openLanguageSupport:function(){this.props.openLanguageSupport()},hasLink:function(){return null!==this.getValue("wixLink")},isCustomStyle:function(){if(void 0!==this.forceIsCustomStyleValue)return this.forceIsCustomStyleValue;var a=!1,c=this;return b.forEach(l,function(b){c.editor.getCommand(b).state!==g.CK_OFF&&(a=!0)}),(this.editor.getCommand("unBold").state!==g.CK_OFF||this.editor.getCommand("unItalic").state!==g.CK_OFF)&&(a=!0),a},isColorFromTheme:function(){return this.editor.getCommand("foreColor").state===g.CK_OFF},getBoldProps:function(){var a={name:"textBold",instanceId:"textBold",tooltipValue:this.getTooltipValue("bold","B")},b=o(this.editor,this.props.themeColors,this.props.themeFonts);return"normal"===b.weight?(a.value=this.getBooleanValue("bold"),a.onChange=t(this,"bold"),f.toggleBoldShortcutKey(this.editor,!1)):(a.value=!this.getBooleanValue("unBold"),a.onChange=t(this,"unBold"),f.toggleBoldShortcutKey(this.editor,!0)),a},getItalicProps:function(){var a={name:"textItalic",instanceId:"textItalic",tooltipValue:this.getTooltipValue("italic","I")},b=o(this.editor,this.props.themeColors,this.props.themeFonts);return"normal"===b.style?(a.value=this.getBooleanValue("italic"),a.onChange=t(this,"italic"),f.toggleItalicShortcutKey(this.editor,!1)):(a.value=!this.getBooleanValue("unItalic"),a.onChange=t(this,"unItalic"),f.toggleItalicShortcutKey(this.editor,!0)),a},getUnderlineProps:function(){var a={name:"textUnderline",instanceId:"textUnderline",tooltipValue:this.getTooltipValue("underline","U"),value:this.getBooleanValue("underline"),onChange:t(this,"underline")};return a},getLinkProps:function(){var a={name:"textLink",instanceId:"textLink",tooltipValue:this.getTooltipValue("link"),value:this.hasLink(),onChange:u(this)};return a},registerSaveThemeUndoRedoHandler:function(a,b){f.afterUndoRedoCallback(a,b,this.editor)}})}),define("textControls/comps/textEffectButton.rt",["react/addons","lodash"],function(a,b){"use strict";return function(){return a.createElement("span",{className:this.props.className},a.createElement("button",{className:b.keys(b.pick({"text-effect-button":!0,selected:this.props.isSelected},b.identity)).join(" "),onClick:this.props.onClick},a.createElement("span",{},this.props.children)))}}),define("textControls/comps/textEffectButton",["react","lodash","textControls/comps/textEffectButton.rt"],function(a,b,c){"use strict";return a.createClass({displayName:"textEffectButton",render:c})}),define("textControls/comps/textEffects.rt",["react/addons","lodash","textControls/comps/textEffectButton","symbols","baseUI","textControls/utils/constants"],function(a,b,c,d,e,f){"use strict";function g(){this.handleOnChange(f.CK_OFF)}function h(a,b){this.handleOnChange(a.value,b)}function i(b,d){return a.createElement(c,{isSelected:this.props.value===d,onClick:h.bind(this,b,d),key:d,className:d},a.createElement("span",{className:"text-shadow-effect",style:{textShadow:b.value}},this.translateIfNeeded("text_editor_"+d)))}return function(){return a.createElement.apply(this,["div",{className:"text-effect-container"},a.createElement(e.tooltip,{value:"text_editor_effects_tooltip_no_effect",styleType:e.uiConstants.TOOLTIP.STYLE_TYPE.SMALL},a.createElement("span",{onClick:g.bind(this),className:"text-none-icon "+("EFFECT_0"===this.props.value?"selected":"")})),b.map(this.getShadowEffects(),i.bind(this))])}}),define("textControls/comps/textEffects",["react","lodash","textControls/comps/textEffects.rt","util","textControls/utils/constants","baseUI"],function(a,b,c,d,e,f){"use strict";return a.createClass({displayName:"textEffects",mixins:[d.translationMixin,f.reportUIChangeMixin],render:c,getDefaultProps:function(){return{value:"effect_0",onChange:function(){}}},contextTypes:{reportUIChange:a.PropTypes.func},getShadowEffects:function(){var a=e.EFFECTS;return a.effect_0&&delete a.effect_0,a},handleOnChange:function(a,b){this.props.onChange(a);var c=2===a?"none":b;this.reportUIChange({value:c,control_name:"text_effects"})}})}),define("textControls/comps/textLinkButton.rt",["react/addons","lodash","textControls/comps/iconButton"],function(a,b,c){"use strict";return function(){return a.createElement(c,b.assign({},{name:"Link",onClick:this.openLinkDialog},this.props))}}),define("textControls/comps/textLinkButton",["react","lodash","textControls/comps/textLinkButton.rt","panels"],function(a,b,c,d){"use strict";return a.createClass({displayName:"textLinkButton",mixins:[d.linkToMixin],render:c})}),define("textControls/comps/themeFontsLoader",["react","lodash","textControls/utils/fontUtils"],function(a,b,c){"use strict";var d=[];return a.createClass({displayName:"themeFontsLoader",render:function(){var e=[];try{var f=c.getFontsToLoad("",this.props.documentType,this.props.languages,this.props.themeFonts);b.forEach(f.urls,function(c){b.contains(d,c)||(e.push(a.DOM.link({rel:"stylesheet",type:"text/css",href:c,key:c})),d.push(c))})}catch(g){console.log(g)}return a.DOM.div.apply(void 0,e)},shouldComponentUpdate:function(a){return!b.isEqual(a,this.props)}})}),define("textControls/comps/saveTextStyleConfirmation.rt",["react/addons","lodash","panels","core","baseUI"],function(a,b,c,d,e){"use strict";return function(){return a.createElement(c.frames.focusPanelFrame,{ref:"frame",key:"saveTextConfirmationPanel",helpId:"1df23b96-45a4-41e0-b356-e1ee05308c9b",className:"text-style-save-confirm-panel",title:this.translateIfNeeded("text_editor_save_theme_dialog_header"),panelName:this.props.panelName},a.createElement("div",{className:"text-style-save-confirm-content"},a.createElement("span",{},this.translateIfNeeded("text_editor_save_theme_dialog_text_1")),a.createElement("span",{className:"bold"}," '",this.props.textStyleName,"' "),a.createElement("span",{},this.translateIfNeeded("text_editor_save_theme_dialog_text_2")),a.createElement("a",{onClick:this.openLearnMore},this.translateIfNeeded("text_editor_save_theme_dialog_learn_more")),a.createElement("div",{className:"footer-buttons"},a.createElement(e.toggle,{name:"checkbox",labelAfterSymbol:!0,key:"dontShowAgainCheckbox",label:"text_editor_save_theme_dialog_dont_show",valueLink:this.linkDontShowAgainValue()}),a.createElement(e.button,{onClick:this.handleOnSave,className:"save-button",label:"text_editor_save_theme_confirm_button"}))))}}),define("textControls/comps/saveTextStyleConfirmation",["react","panels","util","core","textControls/comps/saveTextStyleConfirmation.rt"],function(a,b,c,d,e){"use strict";return a.createClass({displayName:"saveTextStyleConfirmation",propTypes:{editorAPI:a.PropTypes.object.isRequired,panelName:a.PropTypes.string.isRequired,dontShowAgainKey:a.PropTypes.string.isRequired,onConfirm:a.PropTypes.func.isRequired,textStyleName:a.PropTypes.string.isRequired,userPrefType:a.PropTypes.oneOf(["site","session","global"])},mixins:[c.translationMixin,d.mixins.editorAPIMixin,b.mixins.reportBiEventOnUiChangeMixin,b.mixins.dontShowAgainMixin],getDefaultProps:function(){return{userPrefType:"session"}},getInitialState:function(){return{dontShowAgain:this.getDontShowAgain()}},handleOnSave:function(){this.props.onConfirm(),this.close()},close:function(){b.panelManager.closePanelByName(this.props.panelName)},openLearnMore:function(){b.panelManager.openHelpCenter("1df23b96-45a4-41e0-b356-e1ee05308c9b")},render:e})}),define("textControls/utils/mobileUtils",["lodash","jquery","textControls/utils/fontUtils"],function(a,b,c){"use strict";function d(a,b){var c={},d=document.createElement("div");return d.innerHTML=a,f(d,c,b,""),parseInt(e(c),10)}function e(b){var c,d="";return a.forEach(b,function(a,b){(void 0===c||a>c)&&(c=a,d=b)}),d}function f(b,c,d,e){"#text"!==b.nodeName&&(e=g(b,d)?g(b,d):e,a.forEach(b.childNodes,function(a){if("#text"===a.nodeName){if(e){var b=a.textContent.replace(/ /g,"").length;c[e]||(c[e]=0),c[e]+=b}}else f(a,c,d,e)}))}function g(d,e){var f=b(d).css("fontSize");return f||a.forEach(d.classList,function(a){e[a]&&(f=c.parseStyleFont(a,e).size)}),f}return{getMostCommonTextSize:d}}),define("textControls/utils/textMigrationDomHelper",["lodash","jquery"],function(a,b){"use strict";function d(a){if(null===a)return"null";if(a.$family)return a.$family();if(a.nodeName){if(1===a.nodeType)return"element";if(3===a.nodeType)return/\S/.test(a.nodeValue)?"textnode":"whitespace"}else if("number"==typeof a.length){if(a.callee)return"arguments";if("item"in a)return"collection"}return typeof a}function e(b){var c=b.attributes,d=[];if(c.length<20)d=g(c);else{var e=b.getProperties("class","style","dir","href","background","action","src","data","align","alt","color","face","label","for","link","id","name","value");a.forEach(e,function(a,b){b&&a&&d.push({name:b,value:a})})}return d}function f(a,b){if(a!==b)for(var c;c=a.firstChild;)b.appendChild(a.removeChild(c))}function g(a){function b(a){for(var b=[],c=a.length;c--;)b.unshift(a[c]);return b}return b(a)}function h(b,c){if(b.tagName.toLowerCase()===c.toLowerCase())return b;var d=document.createElement(c),g=e(b);return a.forEach(g,function(a){d.setAttribute(a.name,a.value)}),f(b,d),b.parentNode&&b.parentNode.replaceChild(d,b),d}function i(b){var d=b.tagName&&b.tagName.toLowerCase();return a.contains(c,d)}function j(a){return a.every(function(a){return"whitespace"===d(a)})}function k(a){return"element"===d(a)}function l(a){return"textnode"===d(a)}function m(b){return a.some(b.children,i)}function n(b){var c=b.parentNode,d=g(b.childNodes);a.each(d,function(a){c.insertBefore(a,b)}),c.removeChild(b)}function o(a){var b=e(a);if(!b)return!1;for(var c=0;c<b.length;c++){var d=b[c].value;if(d)return!0}return!1}function p(a,c){var d=b(a);d.removeClass(c),0===d.prop("class").length&&d.removeAttr("class")}function q(a,c){b(a).css(c);var d=a.getAttribute("style");d&&" "===d.charAt(d.length-1)&&a.setAttribute("style",d.substr(0,d.length-1))}var c=["audio","dd","dt","li","video","address","article","aside","blockquote","details","div","dl","fieldset","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","menu","nav","ol","p","pre","section","table","ul","center","dir","noframes"];return{moveChildren:f,collectionToArray:g,isBlockElement:i,hasBlockElementChildren:m,isDomElement:k,isTextNode:l,isElementHasAttributes:o,replaceElementWithItsChildren:n,renameNode:h,isOnlyWhiteSpace:j,removeClass:p,setStyle:q}}),define("textControls/utils/textMigrationStylesHelper",["jquery","lodash","textControls/utils/textMigrationDomHelper","textControls/utils/fontUtils"],function(a,b,c,d){"use strict";function e(a){var b=a.classList;if(!b)return null;for(var c=0;c<b.length;c++)if(b[c].indexOf("font_")>-1)return b[c];return null}function f(b,d){if(e(b))return b;var g=a(b).clone();g.empty();for(var i=c.collectionToArray(b.childNodes),j=0;j<i.length;j++){var k=i[j];if(e(k)||h(k)){var l=a(k).clone();l.empty();var m=f(k,l.get(0));return g.append(a(m)),l.get(0).firstChild&&a(d).append(l),g.get(0)}a(d).append(a(k))}return g.get(0)}function g(b){if(h(b)){var d=a(b).clone(!1);d.empty();for(var i=c.collectionToArray(b.childNodes),k=0;k<i.length;k++){var l=i[k];if(e(l)||h(l)){var m=a(l).clone(!1);m.empty();var n=f(l,m);return m.get(0).firstChild&&d.append(m),a(b).before(d),a(b).before(a(n)),j(n),void g(b)}d.append(a(l))}}}function h(b){return c.isDomElement(b)&&a(b).find('span[class*="font_"]').length}function i(a,d){if(c.isDomElement(a)){var f=e(a);f&&"span"===a.tagName.toLowerCase()?d.push(a):b.forEach(a.children,function(a){d.concat(i(a,d))})}return d}function j(a){if(e(a)&&g(a),h(a)){var c=i(a,[]);b.forEach(c,g)}}function k(a){if(c.isTextNode(a))return!0;if(e(a))return!1;for(var b=c.collectionToArray(a.childNodes),d=0;d<b.length;d++)if(k(b[d]))return!0;
return!1}function l(a){var c=0,d=null;return b.forEach(a,function(a,b){a>c&&(c=a,d=b)}),d}function m(a){var c={};return b.forEach(a,function(a){var b=e(a);c[b]=c[b]||0,c[b]+=a.textContent.length}),l(c)}function n(a,b,c,e){var f=a&&d.parseStyleFont(a,c,e),g=d.parseStyleFont(b,c,e);return g?f&&f.color===g.color?null:"#"===g.color.charAt(0)?{isRef:!1,value:g.color}:{isRef:!0,value:g.color.replace("{","").replace("}","")}:null}function p(a,c,e,f){var g=a&&d.parseStyleFont(a,e,f),h=d.parseStyleFont(c,e,f),i={};return b.each(o,function(a,b){g&&g[a]===h[a]||(i[b]=h[a])}),i}var o={"font-family":"family","font-size":"size","font-style":"style","font-variant":"variant","font-weight":"weight","line-height":"lineHeight"};return{flattenStyledSpans:j,isBlockContainUnstyledText:k,getStyledSpansRecursive:i,getMostCommonStyle:m,getElementStyleClass:e,getStyleDelta:p,getColorDelta:n}}),define("textControls/utils/textStylesMigration",["lodash","jquery","textControls/utils/textMigrationDomHelper","textControls/utils/textMigrationStylesHelper","textControls/utils/fontUtils","textControls/utils/constants"],function(a,b,c,d,e,f){"use strict";function j(b,e,f,g){a.forEach(e,function(a){var e=d.getElementStyleClass(a);e===b?0===a.childNodes.length?a.destroy():k(a,b):(c.removeClass(a,e),l(b,e,a,f,g))})}function k(a,d){b(a).removeClass(d),c.isElementHasAttributes(a)||c.replaceElementWithItsChildren(a)}function l(a,e,f,g,h){var i=d.getStyleDelta(a,e,g,h),j=f;c.setStyle(j,i);var k=d.getColorDelta(a,e,g,h);k&&(k.isRef?b(j).addClass(k.value):c.setStyle(j,{color:k.value}))}function m(b,d,f,g){var h;if(a.contains(a.keys(f),d)){var i=e.parseStyleFont(d,f,g);h=i.lineHeight,c.setStyle(b,{"line-height":h}),n(b,h),b=o(b,d)}return b}function n(a,b){var d=document.createElement("span");c.setStyle(d,{"line-height":b}),c.moveChildren(a,d),a.appendChild(d)}function o(a,b){var d=i[b];return c.renameNode(a,d)}function p(b){return a.contains(h,b)}function q(a){return p(a)?f.FALLBACK_STYLE_CLASS:a}function r(a,c,e){var f=d.getStyledSpansRecursive(a,[]),g=d.getMostCommonStyle(f),h=null;if(g){var i=q(g);return i!==g&&(h=g,g=i),b(a).addClass(g),j(g,f,c,e),h&&s(a,g,h,c,e),g}return null}function s(a,b,d,f,g){var h=e.parseStyleFont(d,f,g).size,i=e.parseStyleFont(b,f,g).size;i>h&&c.setStyle(a,{"font-size":h})}function t(a,d,e){if(!d||!e)return null;if(a&&a.tagName===d&&a.hasClass(e))return null;var f=c.renameNode(a,d);return b(f).addClass(e),f}function u(a,b,c,e,f){if(0!==a.childNodes.length){d.flattenStyledSpans(a);var g=null;if(d.isBlockContainUnstyledText(a)){var h=t(a,b,c),i=d.getStyledSpansRecursive(h,[]);j(null,i,e,f)}else g=r(a,e,f),g&&m(a,g,e,f);v(a,g,e,f)}}function v(a,c,d,e){var f=b(a).find('span[class*="font_"]');f.length&&j(c,f,d,e)}function w(a,d,e,f,g){if(!c.isOnlyWhiteSpace(a)){var h=document.createElement("p");b(a[0]).before(b(h)),b(h).append(b(a)),u(h,d,e,f,g)}}function x(b,d,e,f,h){var i=[],j=c.collectionToArray(b.childNodes);a.forEach(j,function(b){if(c.isBlockElement(b)){i.length>0&&(w(i,d,e,f,h),i=[]);var j=!a.contains(g,b.tagName.toLowerCase())||c.hasBlockElementChildren(b);j?x(b,d,e,f,h):u(b,d,e,f,h)}else i.push(b)}),i.length>0&&w(i,d,e,f,h)}var g=["h1","h2","h3","h4","h5","h6","p","div"],h=["font_1","font_10"],i=a.transform(f.DEFAULT_STYLES_MAP,function(a,b){a[b.cssClass]=b.seoTag});return{migrateElement:x,verifyNoStyledSpans:v}}),define("textControls/utils/textSimpleFormatMigration",["lodash","jquery","textControls/utils/textMigrationDomHelper","textControls/utils/textMigrationStylesHelper","textControls/utils/constants"],function(a,b,c,d,e){"use strict";function f(a){g(a),h(a),i(a),j(a),k(a),l(a),m(a)}function g(a){var c=b(a).find(".bold");n(c,"bold","strong")}function h(a){var c=b(a).find(".italic");n(c,"italic","em")}function i(a){var c=b(a).find(".underline");n(c,"underline","u")}function j(a){var c=b(a).find(".alignRight");o(c,"alignRight","text-align","right")}function k(a){var c=b(a).find(".alignCenter");o(c,"alignCenter","text-align","center")}function l(a){var c=b(a).find(".alignJustify");o(c,"alignJustify","text-align","justify")}function m(c){var f=b(c).find("ul, ol");a.each(f,function(a){d.getElementStyleClass(a)||b(a).addClass(e.DEFAULT_STYLE_CLASS)})}function n(d,e,f){a.forEach(d,function(a){var d=document.createElement(f);c.moveChildren(a,d),c.removeClass(a,e),c.isElementHasAttributes(a)||"span"!==a.nodeName.toLowerCase()?b(a).append(b(d)):b(a).replaceWith(b(d))})}function o(b,d,e,f){a.forEach(b,function(a){c.removeClass(a,d);var b={};b[e]=f,c.setStyle(a,b)})}return{migrateElement:f}}),define("textControls/utils/textMigrationHandler",["lodash","textControls/utils/textStylesMigration","textControls/utils/textSimpleFormatMigration"],function(a,b,c){"use strict";function d(d,e,f,g,h){if(g=g||"p",h=h||"font_8",!a.isString(d))return null;if(""===d)return a.template('<<%= defaultTag %> class="<%= defaultClass %>"></<%= defaultTag %>>')({defaultTag:g,defaultClass:h});var i=document.createElement("div");return i.innerHTML=d,b.migrateElement(i,g,h,e,f),c.migrateElement(i),i.innerHTML}return{migrateText:d}}),define("textControls/utils/migrationUtils",["lodash","textControls/utils/textMigrationHandler"],function(a,b){"use strict";function c(a,b){var c=b.components.data.get(a);return"StyledText"!==c.type&&"MediaRichText"!==c.type}function d(c,d,e,f,g){function i(b,c){return!a.contains(["id","metaData"],c)}var h=b.migrateText(c.text,d,e,f,g),j=a.omit(c,i);return j.type="StyledText",j.stylesMapId="CK_EDITOR_PARAGRAPH_STYLES",j.text=h,j}function e(a,b){var c=b.components.data.get(a);c=d(c,b.theme.fonts.getAll(),b.theme.colors.getAll()),b.components.data.update(a,c,!0),b.components.style.setId(a,"txtNew")}return{isOldTextComponent:c,migrateComponent:e}}),define("textControls/mixins/textEditorMixin",[],function(){"use strict";return{getEditor:function(){return this.textEditor||(this.textEditor=this.getEditorAPI().text.getEditor()),this.textEditor},getThemeFonts:function(){return this.getEditorAPI().theme.fonts.getAll()},execCommand:function(a,b){var c=this.getEditor();c&&c.execCommand(a,b)},getValue:function(a){var b=this.getEditor();return b?b.getValue(a):""},getBooleanValue:function(a){var b=this.getEditor();return b?b.getBooleanValue(a):!1},getListType:function(){var a=this.getEditor();return a?a.getListType():""},getTextAlignment:function(){var a=this.getEditor();return a?a.getTextAlignment():""},selectionChange:function(){this.forceUpdate()},componentDidMount:function(){var a=this.getEditor();a&&a.registerOnSelectionChange(this.selectionChange)},componentWillUnmount:function(){var a=this.getEditor();a&&a.unregisterOnSelectionChange(this.selectionChange)},changeFontFamily:function(a){var b=this.getEditor();b&&b.changeFontFamily(a)},execListCommand:function(a){var b=this.getEditor();b&&b.execListCommand(a)},execLineHeightCommand:function(a){var b=this.getEditor();b&&b.execLineHeightCommand(a)},changeAlignment:function(a){var b=this.getEditor();b&&b.changeAlignment(a)},changeTextShadow:function(a){var b=this.getEditor();b&&b.changeTextShadow(a)},getTextShadowValue:function(){var a=this.getEditor();return a?a.getTextShadowValue():""},getLetterSpacingValue:function(){var a=this.getEditor();return a?a.getLetterSpacingValue():""},getLineHeightValue:function(){var a=this.getEditor();return a?a.getLineHeightValue():""},getBackColorValue:function(a){var b=this.getEditor();return b?b.getBackColorValue(a):void 0},getLink:function(){var a=this.getEditor();a&&a.getLink()},openLinkDialog:function(){var a=this.getEditor();a&&a.openLinkDialog()},openColorPicker:function(a,b){var c=this.getEditor();c&&c.openColorPicker(a,b)},handleColorClick:function(a,b){var c=this.getEditor();c&&c.handleColorClick(a,b)},getFormatBlockValue:function(){var a=this.getEditor();return a?a.getFormatBlockValue():""},execNoBackColor:function(){var a=this.getEditor();a&&a.execNoBackColor()},execFormatBlockCommand:function(a){var b=this.getEditor();b&&b.execFormatBlockCommand(a)},openLanguageSupport:function(){var a=this.getEditor();a&&a.openLanguageSupport()},focus:function(){var a=this.getEditor();a&&a.focus()},hasLink:function(){var a=this.getEditor();return a?a.hasLink():void 0},isCustomStyle:function(){var a=this.getEditor();return a?a.isCustomStyle():void 0},getBoldProps:function(){var a=this.getEditor();return a?a.getBoldProps():void 0},getItalicProps:function(){var a=this.getEditor();return a?a.getItalicProps():void 0},getUnderlineProps:function(){var a=this.getEditor();return a?a.getUnderlineProps():void 0},getLinkProps:function(){var a=this.getEditor();return a?a.getLinkProps():void 0},registerSaveThemeUndoRedoHandler:function(a,b){var c=this.getEditor();return c?c.registerSaveThemeUndoRedoHandler(a,b):void 0},registerRedoCallback:function(a){var b=this.getEditor();return b?b.registerRedoCallback(a):void 0}}}),define("textControls",["react","textControls/comps/richTextInput","textControls/comps/iconButton","textControls/comps/fontFamily","textControls/comps/iconsDropDown","textControls/comps/textBackgroundColor","textControls/comps/textStyle","textControls/comps/textColor","textControls/comps/textEffects","textControls/comps/lineHeight","textControls/comps/textLinkButton","textControls/comps/textPopup","textControls/comps/themeFontsLoader","textControls/comps/saveTextStyleConfirmation","textControls/utils/constants","textControls/utils/fontUtils","textControls/utils/dataUtils","textControls/utils/mobileUtils","textControls/utils/shadowUtils","textControls/utils/migrationUtils","textControls/mixins/textTooltipMixin","textControls/mixins/textEditorMixin"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){"use strict";return{textStyle:g,fontFamily:d,iconButton:c,iconsDropDown:e,textBackgroundColor:f,richTextInput:b,textColor:h,textEffects:i,lineHeight:j,textLinkButton:k,textPopup:l,themeFontsLoader:m,constants:o,fontUtils:p,dataUtils:q,mobileUtils:r,shadowUtils:s,textTooltipMixin:u,saveTextStyleConfirmation:n,textEditorMixin:v,migrationUtils:t}});